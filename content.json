{"meta":{"title":"Joker's Blog","subtitle":null,"description":"ä¸ªäººåˆ†äº«åšå®¢","author":"Joker","url":"https://meandni.com"},"pages":[{"title":"About","date":"2018-08-14T06:25:14.000Z","updated":"2018-08-14T06:26:37.000Z","comments":true,"path":"about/index.html","permalink":"https://meandni.com/about/index.html","excerpt":"","text":"ä¸ªäººåˆ†äº«åšå®¢ä»‹ç»é¡µé¢"},{"title":"","date":"2018-08-14T06:24:40.000Z","updated":"2018-08-14T06:24:40.000Z","comments":true,"path":"categories/index.html","permalink":"https://meandni.com/categories/index.html","excerpt":"","text":""},{"title":"","date":"2018-08-14T06:22:53.000Z","updated":"2018-08-14T06:22:53.000Z","comments":true,"path":"tags/index.html","permalink":"https://meandni.com/tags/index.html","excerpt":"","text":""}],"posts":[{"title":"å°†ReactNativeé›†æˆåˆ°ç°æœ‰åŸç”Ÿåº”ç”¨(Android)","slug":"integration-with-existing-apps","date":"2018-08-15T11:59:00.000Z","updated":"2018-08-16T09:55:46.000Z","comments":true,"path":"2018/08/15/integration-with-existing-apps/","link":"","permalink":"https://meandni.com/2018/08/15/integration-with-existing-apps/","excerpt":"","text":"å¦‚æœä½ æ­£å‡†å¤‡ä»å¤´å¼€å§‹åˆ¶ä½œä¸€ä¸ªæ–°çš„åº”ç”¨ï¼Œé‚£ä¹ˆ React Native ä¼šæ˜¯ä¸ªéå¸¸å¥½çš„é€‰æ‹©ã€‚ä½†å¦‚æœä½ åªæƒ³ç»™ç°æœ‰çš„åŸç”Ÿåº”ç”¨ä¸­æ·»åŠ ä¸€ä¸¤ä¸ªè§†å›¾æˆ–æ˜¯ä¸šåŠ¡æµç¨‹ï¼ŒReact Native ä¹ŸåŒæ ·ä¸åœ¨è¯ä¸‹ã€‚åªéœ€ç®€å•å‡ æ­¥ï¼Œä½ å°±å¯ä»¥ç»™åŸæœ‰åº”ç”¨åŠ ä¸Šæ–°çš„åŸºäº React Native çš„ç‰¹æ€§ã€ç”»é¢å’Œè§†å›¾ç­‰ã€‚ å…·ä½“çš„æ­¥éª¤æ ¹æ®ä½ æ‰€å¼€å‘çš„ç›®æ ‡å¹³å°ä¸åŒè€Œä¸åŒã€‚ æ ¸å¿ƒæ¦‚å¿µæŠŠ React Native ç»„ä»¶é›†æˆåˆ° Android åº”ç”¨ä¸­æœ‰å¦‚ä¸‹å‡ ä¸ªä¸»è¦æ­¥éª¤ï¼š é…ç½®å¥½ React Native ä¾èµ–å’Œé¡¹ç›®ç»“æ„ã€‚ åˆ›å»º js æ–‡ä»¶ï¼Œç¼–å†™ React Native ç»„ä»¶çš„ js ä»£ç ã€‚ åœ¨åº”ç”¨ä¸­æ·»åŠ ä¸€ä¸ªRCTRootViewã€‚è¿™ä¸ªRCTRootViewæ­£æ˜¯ç”¨æ¥æ‰¿è½½ä½ çš„ React Native ç»„ä»¶çš„å®¹å™¨ã€‚ å¯åŠ¨ React Native çš„ Packager æœåŠ¡ï¼Œè¿è¡Œåº”ç”¨ã€‚ éªŒè¯è¿™éƒ¨åˆ†ç»„ä»¶æ˜¯å¦æ­£å¸¸å·¥ä½œã€‚ å¼€å‘ç¯å¢ƒå‡†å¤‡é¦–å…ˆæŒ‰ç…§å¼€å‘ç¯å¢ƒæ­å»ºæ•™ç¨‹æ¥å®‰è£… React Native åœ¨ Android å¹³å°ä¸Šæ‰€éœ€çš„ä¸€åˆ‡ä¾èµ–è½¯ä»¶ã€‚ 1. é…ç½®é¡¹ç›®ç›®å½•ç»“æ„é¦–å…ˆåˆ›å»ºä¸€ä¸ªç©ºç›®å½•ç”¨äºå­˜æ”¾ React Native é¡¹ç›®ï¼Œç„¶ååœ¨å…¶ä¸­åˆ›å»ºä¸€ä¸ª/androidå­ç›®å½•ï¼ŒæŠŠä½ ç°æœ‰çš„ Android é¡¹ç›®æ‹·è´åˆ°/androidå­ç›®å½•ä¸­ã€‚ 2. å®‰è£… JavaScript ä¾èµ–åŒ…åœ¨é¡¹ç›®æ ¹ç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ªåä¸ºpackage.jsonçš„ç©ºæ–‡æœ¬æ–‡ä»¶ï¼Œç„¶åå¡«å…¥ä»¥ä¸‹å†…å®¹ï¼š 12345678&#123; &quot;name&quot;: &quot;MyReactNativeApp&quot;, &quot;version&quot;: &quot;0.0.1&quot;, &quot;private&quot;: true, &quot;scripts&quot;: &#123; &quot;start&quot;: &quot;node node_modules/react-native/local-cli/cli.js start&quot; &#125;&#125; ç¤ºä¾‹ä¸­çš„versionå­—æ®µæ²¡æœ‰å¤ªå¤§æ„ä¹‰ï¼ˆé™¤éä½ è¦æŠŠä½ çš„é¡¹ç›®å‘å¸ƒåˆ° npm ä»“åº“ï¼‰ã€‚scriptsä¸­æ˜¯ç”¨äºå¯åŠ¨ packager æœåŠ¡çš„å‘½ä»¤ã€‚ æ¥ä¸‹æ¥æˆ‘ä»¬ä½¿ç”¨ yarn æˆ– npmï¼ˆä¸¤è€…éƒ½æ˜¯ node çš„åŒ…ç®¡ç†å™¨ï¼‰æ¥å®‰è£… React å’Œ React Native æ¨¡å—ã€‚è¯·æ‰“å¼€ä¸€ä¸ªç»ˆç«¯/å‘½ä»¤æç¤ºè¡Œï¼Œè¿›å…¥åˆ°é¡¹ç›®ç›®å½•ä¸­ï¼ˆå³åŒ…å«æœ‰ package.json æ–‡ä»¶çš„ç›®å½•ï¼‰ï¼Œç„¶åè¿è¡Œä¸‹åˆ—å‘½ä»¤æ¥å®‰è£…ï¼š 1$ yarn add react-native è¿™æ ·é»˜è®¤ä¼šå®‰è£…æœ€æ–°ç‰ˆæœ¬çš„ React Nativeï¼ŒåŒæ—¶ä¼šæ‰“å°å‡ºç±»ä¼¼ä¸‹é¢çš„è­¦å‘Šä¿¡æ¯ï¼ˆä½ å¯èƒ½éœ€è¦æ»šåŠ¨å±å¹•æ‰èƒ½æ³¨æ„åˆ°ï¼‰ï¼š warning â€œreact-native@0.52.2â€œ has unmet peer dependency â€œreact@16.2.0â€œ. è¿™æ˜¯æ­£å¸¸ç°è±¡ï¼Œæ„å‘³ç€æˆ‘ä»¬è¿˜éœ€è¦å®‰è£…æŒ‡å®šç‰ˆæœ¬çš„ Reactï¼š 1$ yarn add react@16.2.0 æ³¨æ„å¿…é¡»ä¸¥æ ¼åŒ¹é…è­¦å‘Šä¿¡æ¯ä¸­æ‰€åˆ—å‡ºçš„ç‰ˆæœ¬ï¼Œé«˜äº†æˆ–è€…ä½äº†éƒ½ä¸å¯ä»¥ã€‚ å¦‚æœä½ ä½¿ç”¨å¤šä¸ªç¬¬ä¸‰æ–¹ä¾èµ–ï¼Œå¯èƒ½è¿™äº›ç¬¬ä¸‰æ–¹å„è‡ªè¦æ±‚çš„ react ç‰ˆæœ¬æœ‰æ‰€å†²çªï¼Œæ­¤æ—¶åº”ä¼˜å…ˆæ»¡è¶³react-nativeæ‰€éœ€è¦çš„reactç‰ˆæœ¬ã€‚å…¶ä»–ç¬¬ä¸‰æ–¹èƒ½ç”¨åˆ™ç”¨ï¼Œä¸èƒ½ç”¨åˆ™åªèƒ½è€ƒè™‘é€‰æ‹©å…¶ä»–åº“ã€‚ æ‰€æœ‰ JavaScript ä¾èµ–æ¨¡å—éƒ½ä¼šè¢«å®‰è£…åˆ°é¡¹ç›®æ ¹ç›®å½•ä¸‹çš„node_modules/ç›®å½•ä¸­ï¼ˆè¿™ä¸ªç›®å½•æˆ‘ä»¬åŸåˆ™ä¸Šä¸å¤åˆ¶ã€ä¸ç§»åŠ¨ã€ä¸ä¿®æ”¹ã€ä¸ä¸Šä¼ ï¼Œéšç”¨éšè£…ï¼‰ã€‚ æŠŠnode_modules/ç›®å½•è®°å½•åˆ°.gitignoreæ–‡ä»¶ä¸­ï¼ˆå³ä¸ä¸Šä¼ åˆ°ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿï¼Œåªä¿ç•™åœ¨æœ¬åœ°ï¼‰ã€‚ æŠŠ React Native æ·»åŠ åˆ°ä½ çš„åº”ç”¨ä¸­é…ç½® mavenåœ¨ä½ çš„ app ä¸­ build.gradle æ–‡ä»¶ä¸­æ·»åŠ  React Native ä¾èµ–: 12345dependencies &#123; compile &apos;com.android.support:appcompat-v7:23.0.1&apos; ... compile &quot;com.facebook.react:react-native:+&quot; // From node_modules&#125; å¦‚æœæƒ³è¦æŒ‡å®šç‰¹å®šçš„ React Native ç‰ˆæœ¬ï¼Œå¯ä»¥ç”¨å…·ä½“çš„ç‰ˆæœ¬å·æ›¿æ¢ +ï¼Œå½“ç„¶å‰ææ˜¯ä½ ä» npm é‡Œä¸‹è½½çš„æ˜¯è¿™ä¸ªç‰ˆæœ¬ã€‚ åœ¨é¡¹ç›®çš„ build.gradle æ–‡ä»¶ä¸­ä¸º React Native æ·»åŠ ä¸€ä¸ª maven ä¾èµ–çš„å…¥å£ï¼Œå¿…é¡»å†™åœ¨ â€œallprojectsâ€ ä»£ç å—ä¸­: 12345678910allprojects &#123; repositories &#123; maven &#123; // All of React Native (JS, Android binaries) is installed from npm url &quot;$rootDir/../node_modules/react-native/android&quot; &#125; ... &#125; ...&#125; ç¡®ä¿ä¾èµ–è·¯å¾„çš„æ­£ç¡®ï¼ä»¥å…åœ¨ Android Studio è¿è¡Œ Gradle åŒæ­¥æ„å»ºæ—¶æŠ›å‡º â€œFailed to resolve: com.facebook.react:react-native:0.x.xâ€ å¼‚å¸¸ã€‚ é…ç½®æƒé™æ¥ç€ï¼Œåœ¨ AndroidManifest.xml æ¸…å•æ–‡ä»¶ä¸­å£°æ˜ç½‘ç»œæƒé™: &lt;uses-permission android:name=&quot;android.permission.INTERNET&quot; /&gt; å¦‚æœéœ€è¦è®¿é—® DevSettingsActivity ç•Œé¢ï¼ˆå³å¼€å‘è€…èœå•ï¼‰ï¼Œåˆ™è¿˜éœ€è¦åœ¨ AndroidManifest.xml ä¸­å£°æ˜: &lt;activity android:name=&quot;com.facebook.react.devsupport.DevSettingsActivity&quot; /&gt; å¼€å‘è€…èœå•ä¸€èˆ¬ä»…ç”¨äºåœ¨å¼€å‘æ—¶ä» Packager æœåŠ¡å™¨åˆ·æ–° JavaScript ä»£ç ï¼Œæ‰€ä»¥åœ¨æ­£å¼å‘å¸ƒæ—¶ä½ å¯ä»¥å»æ‰è¿™ä¸€æƒé™ã€‚ ä»£ç é›†æˆNow we will actually modify the native Android application to integrate React Native. React Native ç»„ä»¶æˆ‘ä»¬é¦–å…ˆè¦å†™çš„æ˜¯â€High Scoreâ€ï¼ˆå¾—åˆ†æ’è¡Œæ¦œï¼‰çš„ JavaScript ç«¯çš„ä»£ç ã€‚ 1. åˆ›å»ºä¸€ä¸ªindex.jsæ–‡ä»¶é¦–å…ˆåœ¨é¡¹ç›®æ ¹ç›®å½•ä¸­åˆ›å»ºä¸€ä¸ªç©ºçš„index.jsæ–‡ä»¶ã€‚(æ³¨æ„åœ¨ 0.49 ç‰ˆæœ¬ä¹‹å‰æ˜¯ index.android.js æ–‡ä»¶) index.jsæ˜¯ React Native åº”ç”¨åœ¨ Android ä¸Šçš„å…¥å£æ–‡ä»¶ã€‚è€Œä¸”å®ƒæ˜¯ä¸å¯æˆ–ç¼ºçš„ï¼å®ƒå¯ä»¥æ˜¯ä¸ªå¾ˆç®€å•çš„æ–‡ä»¶ï¼Œç®€å•åˆ°å¯ä»¥åªåŒ…å«ä¸€è¡Œrequire/importå¯¼å…¥è¯­å¥ã€‚æœ¬æ•™ç¨‹ä¸­ä¸ºäº†ç®€å•ç¤ºèŒƒï¼ŒæŠŠå…¨éƒ¨çš„ä»£ç éƒ½å†™åˆ°äº†index.jsé‡Œï¼ˆå½“ç„¶å®é™…å¼€å‘ä¸­æˆ‘ä»¬å¹¶ä¸æ¨èè¿™æ ·åšï¼‰ã€‚ 2. æ·»åŠ ä½ è‡ªå·±çš„ React Native ä»£ç åœ¨index.jsä¸­æ·»åŠ ä½ è‡ªå·±çš„ç»„ä»¶ã€‚è¿™é‡Œæˆ‘ä»¬åªæ˜¯ç®€å•çš„æ·»åŠ ä¸€ä¸ª&lt;Text&gt;ç»„ä»¶ï¼Œç„¶åç”¨ä¸€ä¸ªå¸¦æœ‰æ ·å¼çš„&lt;View&gt;ç»„ä»¶æŠŠå®ƒåŒ…èµ·æ¥ã€‚ 12345678910111213141516171819202122232425import React from \"react\";import &#123; AppRegistry, StyleSheet, Text, View &#125; from \"react-native\";class HelloWorld extends React.Component &#123; render() &#123; return ( &lt;View style=&#123;styles.container&#125;&gt; &lt;Text style=&#123;styles.hello&#125;&gt;Hello, World&lt;/Text&gt; &lt;/View&gt; ); &#125;&#125;var styles = StyleSheet.create(&#123; container: &#123; flex: 1, justifyContent: \"center\" &#125;, hello: &#123; fontSize: 20, textAlign: \"center\", margin: 10 &#125;&#125;);AppRegistry.registerComponent(\"MyReactNativeApp\", () =&gt; HelloWorld); 3. é…ç½®æƒé™ä»¥ä¾¿å¼€å‘ä¸­çš„çº¢å±é”™è¯¯èƒ½æ­£ç¡®æ˜¾ç¤ºå¦‚æœä½ çš„åº”ç”¨ä¼šè¿è¡Œåœ¨ Android 6.0ï¼ˆAPI level 23ï¼‰æˆ–æ›´é«˜ç‰ˆæœ¬ï¼Œè¯·ç¡®ä¿ä½ åœ¨å¼€å‘ç‰ˆæœ¬ä¸­æœ‰æ‰“å¼€æ‚¬æµ®çª—(overlay)æƒé™ã€‚ä½ å¯ä»¥åœ¨ä»£ç ä¸­ä½¿ç”¨Settings.canDrawOverlays(this);æ¥æ£€æŸ¥ã€‚ä¹‹æ‰€ä»¥éœ€è¦è¿™ä¸€æƒé™ï¼Œæ˜¯å› ä¸ºæˆ‘ä»¬ä¼šæŠŠå¼€å‘ä¸­çš„æŠ¥é”™æ˜¾ç¤ºåœ¨æ‚¬æµ®çª—ä¸­ï¼ˆä»…åœ¨å¼€å‘é˜¶æ®µéœ€è¦ï¼‰ã€‚åœ¨ Android 6.0ï¼ˆAPI level 23ï¼‰ä¸­ç”¨æˆ·éœ€è¦æ‰‹åŠ¨åŒæ„æˆæƒã€‚å…·ä½“è¯·æ±‚æˆæƒçš„åšæ³•æ˜¯åœ¨onCreate()ä¸­æ·»åŠ å¦‚ä¸‹ä»£ç ã€‚å…¶ä¸­OVERLAY_PERMISSION_REQ_CODEæ˜¯ç”¨äºå›ä¼ æˆæƒç»“æœçš„å­—æ®µã€‚ 1234567891011private final int OVERLAY_PERMISSION_REQ_CODE = 1; // ä»»å†™ä¸€ä¸ªå€¼...if (Build.VERSION.SDK_INT &gt;= Build.VERSION_CODES.M) &#123; if (!Settings.canDrawOverlays(this)) &#123; Intent intent = new Intent(Settings.ACTION_MANAGE_OVERLAY_PERMISSION, Uri.parse(\"package:\" + getPackageName())); startActivityForResult(intent, OVERLAY_PERMISSION_REQ_CODE); &#125;&#125; Finally, the onActivityResult() method (as shown in the code below) has to be overridden to handle the permission Accepted or Denied cases for consistent UX. 12345678910@Overrideprotected void onActivityResult(int requestCode, int resultCode, Intent data) &#123; if (requestCode == OVERLAY_PERMISSION_REQ_CODE) &#123; if (Build.VERSION.SDK_INT &gt;= Build.VERSION_CODES.M) &#123; if (!Settings.canDrawOverlays(this)) &#123; // SYSTEM_ALERT_WINDOW permission not granted &#125; &#125; &#125;&#125; æŒæ¡æ ¸å¿ƒç§‘æŠ€ï¼šReactRootViewæˆ‘ä»¬è¿˜éœ€è¦æ·»åŠ ä¸€äº›åŸç”Ÿä»£ç æ¥å¯åŠ¨ React Native çš„è¿è¡Œæ—¶ç¯å¢ƒå¹¶è®©å®ƒå¼€å§‹æ¸²æŸ“ã€‚é¦–å…ˆéœ€è¦åœ¨ä¸€ä¸ªActivityä¸­åˆ›å»ºä¸€ä¸ªReactRootViewå¯¹è±¡ï¼Œç„¶ååœ¨è¿™ä¸ªå¯¹è±¡ä¹‹ä¸­å¯åŠ¨ React Native åº”ç”¨ï¼Œå¹¶å°†å®ƒè®¾ä¸ºç•Œé¢çš„ä¸»è§†å›¾ã€‚ å¦‚æœä½ æƒ³åœ¨å®‰å“ 5.0 ä»¥ä¸‹çš„ç³»ç»Ÿä¸Šè¿è¡Œï¼Œè¯·ç”¨ com.android.support:appcompat åŒ…ä¸­çš„ AppCompatActivity ä»£æ›¿ Activity ã€‚ 1234567891011121314151617181920212223242526272829public class MyReactActivity extends Activity implements DefaultHardwareBackBtnHandler &#123; private ReactRootView mReactRootView; private ReactInstanceManager mReactInstanceManager; @Override protected void onCreate(Bundle savedInstanceState) &#123; super.onCreate(savedInstanceState); mReactRootView = new ReactRootView(this); mReactInstanceManager = ReactInstanceManager.builder() .setApplication(getApplication()) .setBundleAssetName(\"index.android.bundle\") .setJSMainModulePath(\"index\") .addPackage(new MainReactPackage()) .setUseDeveloperSupport(BuildConfig.DEBUG) .setInitialLifecycleState(LifecycleState.RESUMED) .build(); // æ³¨æ„è¿™é‡Œçš„MyReactNativeAppå¿…é¡»å¯¹åº”â€œindex.jsâ€ä¸­çš„ // â€œAppRegistry.registerComponent()â€çš„ç¬¬ä¸€ä¸ªå‚æ•° mReactRootView.startReactApplication(mReactInstanceManager, \"MyReactNativeApp\", null); setContentView(mReactRootView); &#125; @Override public void invokeDefaultOnBackPressed() &#123; super.onBackPressed(); &#125;&#125; If you are using a starter kit for React Native, replace the â€œHelloWorldâ€ string with the one in your index.js file (itâ€™s the first argument to the AppRegistry.registerComponent() method). å¦‚æœä½ ä½¿ç”¨çš„æ˜¯ Android Studio , å¯ä»¥ä½¿ç”¨Alt + Enterå¿«æ·é”®æ¥è‡ªåŠ¨ä¸º MyReactActivity ç±»è¡¥ä¸Šç¼ºå¤±çš„ import è¯­å¥ã€‚æ³¨æ„BuildConfigåº”è¯¥æ˜¯åœ¨ä½ è‡ªå·±çš„åŒ…ä¸­è‡ªåŠ¨ç”Ÿæˆï¼Œæ— éœ€é¢å¤–å¼•å…¥ã€‚åƒä¸‡ä¸è¦ä»com.facebook...çš„åŒ…ä¸­å¼•å…¥ï¼ æˆ‘ä»¬éœ€è¦æŠŠ MyReactActivity çš„ä¸»é¢˜è®¾å®šä¸º Theme.AppCompat.Light.NoActionBar ï¼Œå› ä¸ºé‡Œé¢æœ‰è®¸å¤šç»„ä»¶éƒ½ä½¿ç”¨äº†è¿™ä¸€ä¸»é¢˜ã€‚ 12345&lt;activity android:name=\".MyReactActivity\" android:label=\"@string/app_name\" android:theme=\"@style/Theme.AppCompat.Light.NoActionBar\"&gt;&lt;/activity&gt; ä¸€ä¸ªReactInstanceManagerå¯ä»¥åœ¨å¤šä¸ª activities æˆ– fragments é—´å…±äº«ã€‚ You will want to make your own ReactFragment or ReactActivity and have a singleton holder that holds a ReactInstanceManager. When you need the ReactInstanceManager (e.g., to hook up the ReactInstanceManager to the lifecycle of those Activities or Fragments) use the one provided by the singleton. ä¸‹ä¸€æ­¥æˆ‘ä»¬éœ€è¦æŠŠä¸€äº› activity çš„ç”Ÿå‘½å‘¨æœŸå›è°ƒä¼ é€’ç»™ReactInstanceManagerï¼š 1234567891011121314151617181920212223242526272829@Overrideprotected void onPause() &#123; super.onPause(); if (mReactInstanceManager != null) &#123; mReactInstanceManager.onHostPause(this); &#125;&#125;@Overrideprotected void onResume() &#123; super.onResume(); if (mReactInstanceManager != null) &#123; mReactInstanceManager.onHostResume(this, this); &#125;&#125;@Overrideprotected void onDestroy() &#123; super.onDestroy(); if (mReactInstanceManager != null) &#123; mReactInstanceManager.onHostDestroy(this); &#125; if (mReactRootView != null) &#123; mReactRootView.unmountReactApplication(); &#125;&#125; æˆ‘ä»¬è¿˜éœ€è¦æŠŠåé€€æŒ‰é’®äº‹ä»¶ä¼ é€’ç»™ React Nativeï¼š 12345678@Override public void onBackPressed() &#123; if (mReactInstanceManager != null) &#123; mReactInstanceManager.onBackPressed(); &#125; else &#123; super.onBackPressed(); &#125;&#125; This allows JavaScript to control what happens when the user presses the hardware back button (e.g. to implement navigation). When JavaScript doesnâ€™t handle the back button press, your invokeDefaultOnBackPressed method will be called. By default this simply finishes your Activity. Finally, we need to hook up the dev menu. By default, this is activated by (rage) shaking the device, but this is not very useful in emulators. So we make it show when you press the hardware menu button (use Ctrl + M if youâ€™re using Android Studio emulator): 12345678@Overridepublic boolean onKeyUp(int keyCode, KeyEvent event) &#123; if (keyCode == KeyEvent.KEYCODE_MENU &amp;&amp; mReactInstanceManager != null) &#123; mReactInstanceManager.showDevOptionsDialog(); return true; &#125; return super.onKeyUp(keyCode, event);&#125; ç°åœ¨ activity å·²å°±ç»ªï¼Œå¯ä»¥è¿è¡Œä¸€äº› JavaScript ä»£ç äº†ã€‚ æµ‹è¯•é›†æˆç»“æœYou have now done all the basic steps to integrate React Native with your current application. Now we will start the React Native packager to build the index.bundle package and the server running on localhost to serve it. 1. è¿è¡Œ Packagerè¿è¡Œåº”ç”¨é¦–å…ˆéœ€è¦å¯åŠ¨å¼€å‘æœåŠ¡å™¨ï¼ˆPackagerï¼‰ã€‚ä½ åªéœ€åœ¨é¡¹ç›®æ ¹ç›®å½•ä¸­æ‰§è¡Œä»¥ä¸‹å‘½ä»¤å³å¯ï¼š 1$ yarn start 2. è¿è¡Œä½ çš„åº”ç”¨ä¿æŒ packager çš„çª—å£è¿è¡Œä¸è¦å…³é—­ï¼Œç„¶ååƒå¾€å¸¸ä¸€æ ·ç¼–è¯‘è¿è¡Œä½ çš„ Android åº”ç”¨(åœ¨å‘½ä»¤è¡Œä¸­æ‰§è¡Œ./gradlew installDebugæˆ–æ˜¯åœ¨ Android Studio ä¸­ç¼–è¯‘è¿è¡Œ)ã€‚ ç¼–è¯‘æ‰§è¡Œä¸€åˆ‡é¡ºåˆ©è¿›è¡Œä¹‹åï¼Œåœ¨è¿›å…¥åˆ° MyReactActivity æ—¶åº”è¯¥å°±èƒ½ç«‹åˆ»ä» packager ä¸­è¯»å– JavaScript ä»£ç å¹¶æ‰§è¡Œå’Œæ˜¾ç¤ºï¼š Screenshot åœ¨ Android Studio ä¸­æ‰“åŒ…ä½ ä¹Ÿå¯ä»¥ä½¿ç”¨ Android Studio æ¥æ‰“ release åŒ…ï¼å…¶æ­¥éª¤åŸºæœ¬å’ŒåŸç”Ÿåº”ç”¨ä¸€æ ·ï¼Œåªæ˜¯åœ¨æ¯æ¬¡ç¼–è¯‘æ‰“åŒ…ä¹‹å‰éœ€è¦å…ˆæ‰§è¡Œ js æ–‡ä»¶çš„æ‰“åŒ…(å³ç”Ÿæˆç¦»çº¿çš„ jsbundle æ–‡ä»¶)ã€‚å…·ä½“çš„ js æ‰“åŒ…å‘½ä»¤å¦‚ä¸‹ï¼š 1$ react-native bundle --platform android --dev false --entry-file index.js --bundle-output android/com/your-company-name/app-package-name/src/main/assets/index.android.bundle --assets-dest android/com/your-company-name/app-package-name/src/main/res/ æ³¨æ„æŠŠä¸Šè¿°å‘½ä»¤ä¸­çš„è·¯å¾„æ›¿æ¢ä¸ºä½ å®é™…é¡¹ç›®çš„è·¯å¾„ã€‚å¦‚æœ assets ç›®å½•ä¸å­˜åœ¨ï¼Œåˆ™éœ€è¦æå‰è‡ªå·±åˆ›å»ºä¸€ä¸ªã€‚ ç„¶ååœ¨ Android Studio ä¸­æ­£å¸¸ç”Ÿæˆ release ç‰ˆæœ¬å³å¯ï¼ æˆ‘é‡åˆ°çš„é—®é¢˜å°±æ˜¯ä¸€è¿›å…¥ReactNativeçš„Activityå°±é—ªé€€åˆ°å‰é¢çš„é¡µé¢ï¼ŒåæŸ¥çœ‹logå‘ç°1java.lang.UnsatisfiedLinkError: couldn&apos;t find DSO to load: libreactnativejni è§£å†³æ–¹æ³•åœ¨ä¸¤å¤„æ·»åŠ é…ç½®ï¼šapp#build.gradle 123456defaultConfig &#123; //... ndk &#123; abiFilters &quot;armeabi-v7a&quot;, &quot;x86&quot; &#125; &#125;","categories":[{"name":"éåŸåˆ›","slug":"éåŸåˆ›","permalink":"https://meandni.com/categories/éåŸåˆ›/"}],"tags":[{"name":"android","slug":"android","permalink":"https://meandni.com/tags/android/"},{"name":"æ··åˆå¼€å‘","slug":"æ··åˆå¼€å‘","permalink":"https://meandni.com/tags/æ··åˆå¼€å‘/"},{"name":"reactnative","slug":"reactnative","permalink":"https://meandni.com/tags/reactnative/"}]},{"title":"çœ‹ã€Šç¬¬ä¸€è¡Œä»£ç ã€‹(Androud)","slug":"ã€Šç¬¬ä¸€è¡Œä»£ç ã€‹","date":"2018-08-14T14:21:00.000Z","updated":"2018-08-16T05:21:20.000Z","comments":true,"path":"2018/08/14/b62/","link":"","permalink":"https://meandni.com/2018/08/14/b62/","excerpt":"","text":"è¯»ä¹¦æ„Ÿå—æœ¬ç€æŸ¥æ¼è¡¥ç¼ºçš„æ€åº¦ï¼Œåˆšæ¥å­¦æ ¡éšæ‰‹æ‹¿åˆ°ä¸€æœ¬ä¹¦çœ‹äº†èµ·æ¥ï¼Œå°±è¿™ä¹ˆä¸€ä¸‹å­çœ‹å®Œäº†ï¼Œæœ‰ä¸€ä¸ªæ„Ÿè§‰ï¼ŒæŠ€æœ¯ä¹‹ç±»çš„ä¹¦è¿˜è¦æ˜¯æœ‰ç‚¹åŸºç¡€çœ‹çš„ï¼Œä¸ä»…æ•ˆç‡é«˜è€Œä¸”è·ç›Šç¡®å®ä¸å°‘ã€‚ ä¹Ÿæ²¡æœ‰éƒ½çœ‹ï¼Œå‰é¢å·²ç»æ¥è§¦å¤ªå¤šçš„ä¸œè¥¿å°±æ²¡å»çœ‹äº†ï¼Œå¤§æ¦‚ä»¥åè¿˜ä¼šå½“å·¥å…·ä¹¦æ¥ç¿»ä¸€ç¿»ï¼Œä¸»è¦æ˜¯ä»æˆ‘ä¹‹å‰æ²¡æ¥è§¦çš„å¹¿æ’­çœ‹èµ·ï¼Œçœ‹ç€çœ‹ç€å‘ç°ä¹‹å‰ä¸ä¼šçš„ä¸œè¥¿å±…ç„¶æŒæ¡äº†ï¼Œç€å®è®©æˆ‘å€æ„Ÿè‡ªä¿¡ï¼Œæœ‰äº†ç»§ç»­çœ‹çš„åŠ¨åŠ›ï¼ŒåŠ ä¸Šæ‰‹å¤´æ­£åœ¨åšä¸€ä¸ªè‡ªå·±æ„Ÿè§‰è¿˜ç®—æ¯”è¾ƒæ»¡æ„çš„é¡¹ç›®ï¼Œä¸€ä¸‹å­æ„Ÿè§‰è‡ªå·±ç¦»å¤§ç¥çš„è·ç¦»åˆè¿‘äº†ä¸€ç‚¹ï¼ˆğŸ˜†ï¼‰ã€‚æˆ‘æ˜¯çœŸçš„æå…¶è®¨åŒâ€œå¤§ç¥â€è¿™ä¸ªè¯ï¼Œç¬¬ä¸€ä¸ªåŸå› æ˜¯çœ‹è¿‡å¤ªå¤šæ‰€è°“çš„å¤§ç¥å…¶å®åªæ˜¯è²Œä¼¼æˆ–è€…è¯´æ˜¯è¢«åˆ«äººå¹å‡ºæ¥çš„ï¼Œå†è¯´è¿™ä¸ªé¢†åŸŸæœ¬æ¥å°±æ²¡æœ‰å¤šå°‘çœŸæ­£å¤§ç¥ï¼Œæˆ‘æš‚æ—¶æ˜¯è¿™ä¹ˆæƒ³çš„ï¼Œå¯èƒ½å› ä¸ºæˆ‘çš„çœ¼ç•Œè¿˜å¤ªçª„ï¼Œä½ ä¸å¯èƒ½ä»€ä¹ˆéƒ½ä¼šï¼Œå°±ç®—ä½ ä¼šçš„å¾ˆå¤šä½ ä¹Ÿåº”è¯¥è°¦è™šä¸€ç‚¹ï¼Œæ‰€ä»¥æˆ‘è¦è°¦è™šä¸€ç‚¹ğŸ˜€ã€‚ ç”¨æˆ‘å‰é˜µå­éå¸¸å–œæ¬¢è¯´çš„è¯ï¼Œå°±æ˜¯å­¦ä¹ ç¼–ç¨‹è·Ÿå­¦ä¹ è‹±è¯­å…¶å®æ²¡ä»€ä¹ˆä¸¤æ ·ï¼Œä½ å­¦äº†ä½ å°±ä¼šäº†ï¼Œä½ çœ‹è¿‡ä¸€æ ·ä¸œè¥¿å¹¶ä¸”å»ç»ƒä¹ äº†ä½ è‡ªç„¶ä¹Ÿå°±ä¼šäº†ï¼Œæ²¡ä»€ä¹ˆå¤©èµ‹ä¹‹ç±»çš„ï¼ˆè¿™ä¹Ÿæ˜¯æˆ‘æš‚æ—¶çš„æƒ³æ³•ï¼‰ï¼Œåªæœ‰ä½ æœ‰æ²¡æœ‰å…´è¶£ï¼ æˆ‘éƒ½ä¸çŸ¥é“æˆ‘è¦ä¸è¦åšè¿™ç§ç¨‹åºå‘˜å·¥ä½œï¼Œå…´è¶£æˆ‘æ˜¯æœ‰çš„ï¼Œä¸ç„¶ä¹Ÿä¸ä¼šæŠ•å…¥åˆ°è¿åƒé¥­ä¸Šå•æ‰€çš„æ—¶é—´éƒ½å¿˜è®°äº†ï¼Œä½†æœ‰æ—¶çœŸçš„æ˜¯è§‰å¾—æˆ‘ä¸æƒ³åšè¿™ç§åŠå…¬å®¤å†œæ°‘,æå…¶è¿èƒŒæˆ‘çš„æœ¬æ„ï½ï½æˆ‘çš„æœ¬æ„å…¶å®å¯èƒ½æ˜¯èƒ½æœ‰ä¸åŠ³è€Œè·ï¼ŒæŠŠæ¢¦é‡Œæƒ³çš„ç›´æ¥å˜ç°çš„ä¸œè¥¿ã€‚ çŸ¥è¯†ç‚¹å¹¿æ’­ï¼ˆBroadcastï¼‰æ¥æ”¶å¹¿æ’­ï¼ˆBroadReceiverï¼‰çœ‹å‰é¢ä¸¤å°èŠ‚ï¼Œé€šä¿—çš„ç†è§£ä¹Ÿä¸è¿‡æ˜¯ç›‘å¬äº†æŸæŸäº‹ä»¶ï¼ˆæ¯”å¦‚ç½‘ç»œæ˜¯å¦è¿æ¥ï¼‰ï¼Œä¹‹åå‘ç”Ÿä¸€ä¸ªåŠ¨ä½œã€‚ ç½‘ç»œå˜åŒ–è¿™ä¸ªå¹¿æ’­é€šè¿‡IntentFilterçš„addActionæ–¹æ³•æ‹¿åˆ°ï¼Œç„¶åé€šè¿‡regosterReceiveræ–¹æ³•å°†è¯¥å¹¿æ’­å’Œæˆ‘ä»¬è‡ªå®šä¹‰çš„å¹¿æ’­æ¥æ”¶å™¨ç»‘å®šèµ·æ¥ã€‚ è¿™é‡Œçš„å¹¿æ’­ç•Œæ¥æ”¶å™¨regosterReceiverå°±æ˜¯æˆ‘ä»¬å†™çš„ä¸€ä¸ªç±»ï¼Œå¹¿æ’­å‘å‡ºæ¥ä¹‹åï¼Œæˆ‘ä»¬çš„ç±»å®ä¾‹åŒ–å‡ºæ¥çš„å¯¹è±¡çš„onReceiveæ–¹æ³•ä¼šè¢«è‡ªåŠ¨è°ƒç”¨ï¼Œè¿™é‡Œæˆ‘ä»¬æƒ³å¹²å˜›å°±å¹²å˜›äº†ã€‚ å‘é€å¹¿æ’­æ–¹æ³•ç±»ä¼¼äºæ‰“å¼€å¦ä¸€ä¸ªActivityï¼Œç”¨çš„æ˜¯intentå®ä¾‹åŒ–çš„æ—¶å€™å°†è‡ªå®šä¹‰çš„å¹¿æ’­ä¼ å…¥å‚æ•°ï¼Œç„¶åè°ƒç”¨sendBroadcastæ–¹æ³•ã€‚ å…¶ä»–çš„å°±æ˜¯å…‰æ³¢å¯ä»¥è·¨åº”ç”¨ç¨‹åºä¼ æ’­ï¼ˆå½“ç„¶ï¼Œæœ‰æ—¶ä¸ºäº†å®‰å…¨å¯ä»¥ä½¿ç”¨æœ¬åœ°å¹¿æ’­ï¼‰ï¼Œæœ‰åºå¹¿æ’­å¯ä»¥è®¾ç½®ä¼˜å…ˆæƒé€‰æ‹©é‚£ä¸ªæ¥æ”¶è€…å…ˆæ‰§è¡Œ æœ€ä½³å®è·µè¿™æœ¬ä¹¦æ¯”è¾ƒå¥½çš„å°±æ˜¯æ¯ä¸€ä¸ªç« èŠ‚çš„æœ€ä½³å®è·µï¼ŒçŸ¥è¯†ç‚¹å…¨é¢è€Œä¸”æœ‰ç‚¹éš¾åº¦ã€å®è·µæ€§æ¯”è¾ƒå¤§ã€‚ è¿™ä¸€ç« æ˜¯å®ç°Appç™»é™†åå‘é€å¹¿æ’­å¼ºåˆ¶é€€å‡ºç™»é™†çš„åŠŸèƒ½ï¼Œè¿™é‡Œä¸å¤šè¯´äº†ï½ æ‰‹æœºå¤šåª’ä½“é€šçŸ¥ï¼ˆNotificationï¼‰","categories":[{"name":"åŸåˆ›","slug":"åŸåˆ›","permalink":"https://meandni.com/categories/åŸåˆ›/"}],"tags":[{"name":"android","slug":"android","permalink":"https://meandni.com/tags/android/"},{"name":"è¯»ä¹¦","slug":"è¯»ä¹¦","permalink":"https://meandni.com/tags/è¯»ä¹¦/"}]},{"title":"Hello World","slug":"hello-world","date":"2018-08-14T03:27:16.000Z","updated":"2018-08-15T01:02:49.000Z","comments":true,"path":"2018/08/14/3eeb/","link":"","permalink":"https://meandni.com/2018/08/14/3eeb/","excerpt":"","text":"Welcome to Hexo! This is your very first post. Check documentation for more info. If you get any problems when using Hexo, you can find the answer in troubleshooting or you can ask me on GitHub. åšå®¢è¿è‡³Hexoï¼Œæ‰˜ç®¡åœ¨GitHubä¸Šï¼Œä»¥åå¯ä»¥å¼€å§‹èˆ’é€‚çš„å­¦ä½œä¹‹æ—…äº†ï½ Quick StartCreate a new post1$ hexo new \"My New Post\" More info: Writing Run server1$ hexo server More info: Server Generate static files1$ hexo generate More info: Generating Deploy to remote sites1$ hexo deploy More info: Deployment","categories":[],"tags":[]}]}