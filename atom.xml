<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Joker&#39;s Blog</title>
  
  <subtitle>ä¸ªäººåˆ†äº«åšå®¢</subtitle>
  <link href="/atom.xml" rel="self"/>
  
  <link href="https://meandni.com/"/>
  <updated>2019-04-04T14:51:49.446Z</updated>
  <id>https://meandni.com/</id>
  
  <author>
    <name>Joker</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>2019ç¬¬äºŒæ¬¡é˜…è¯»è®°å½•</title>
    <link href="https://meandni.com/2019/03/12/reading-record2/"/>
    <id>https://meandni.com/2019/03/12/reading-record2/</id>
    <published>2019-03-12T06:53:59.000Z</published>
    <updated>2019-04-04T14:51:49.446Z</updated>
    
    <content type="html"><![CDATA[<p><a href="https://www.jianshu.com/p/fb59c770160c" target="_blank" rel="noopener">å¼ºç¼“å­˜å’Œåå•†ç¼“å­˜</a></p><p><a href="https://juejin.im/post/5a6c87c46fb9a01ca560b4d7" target="_blank" rel="noopener">ç¼“å­˜è¯¦è§£</a></p><p><a href="https://juejin.im/post/5a35ed25f265da431d3cc1b1" target="_blank" rel="noopener">è½»æ¾ç†è§£JSå‡½æ•°èŠ‚æµå’Œå‡½æ•°é˜²æŠ–</a></p><p><a href="https://juejin.im/post/5c80e846518825355a71d154" target="_blank" rel="noopener">Flutter çš„æ¸²æŸ“é€»è¾‘åŠå’Œ Native é€šä¿¡</a></p><p><a href="https://mp.weixin.qq.com/s/CQQXD0TrlbaNWjoClIcDtw" target="_blank" rel="noopener">Flutter åŸç†ç®€è§£</a></p><p><a href="http://www.cnblogs.com/shanyou/p/4085802.html" target="_blank" rel="noopener">TCP/IP, WebSocket å’Œ MQTT</a></p><p><a href="https://blog.csdn.net/jamesliulyc/article/details/6711828" target="_blank" rel="noopener">androidå¼€å‘æ—¶ï¼Œfinish()è·ŸSystem.exit(0)çš„åŒºåˆ«(è½¬)</a></p><hr><p><a href="https://juejin.im/post/5b1cebece51d4506ae71addf" target="_blank" rel="noopener">AjaxåŸç†ä¸€ç¯‡å°±å¤Ÿäº†</a></p><p><a href="https://www.cnblogs.com/dowinning/archive/2012/04/19/json-jsonp-jquery.html" target="_blank" rel="noopener">ã€åŸåˆ›ã€‘è¯´è¯´JSONå’ŒJSONPï¼Œä¹Ÿè®¸ä½ ä¼šè±ç„¶å¼€æœ—ï¼Œå«jQueryç”¨ä¾‹</a></p><p><a href="https://zhenhua-lee.github.io/react/history.html" target="_blank" rel="noopener">react-routerçš„å®ç°åŸç†</a></p><p><a href="http://blog.poetries.top/2018/12/20/react-router-anaylse/" target="_blank" rel="noopener">React RouteråŸç†</a>ğŸŒŸ</p><p><a href="https://juejin.im/post/5b50b0dd6fb9a04f932ff53f" target="_blank" rel="noopener">é¢è¯•å®˜æ‰€è®¤ä¸ºçš„å•ä¾‹æ¨¡å¼</a></p><hr><p><a href="https://www.toutiao.com/i6545790064104833539/" target="_blank" rel="noopener">ä¸ºä»€ä¹ˆHashMapéçº¿ç¨‹å®‰å…¨</a></p><p><a href="https://juejin.im/post/5c6fbf54f265da2db718216a" target="_blank" rel="noopener">TCPå’ŒUDPæ¯”è¾ƒ</a></p><p> <a href="https://www.cnblogs.com/codingmylife/archive/2012/10/21/2732980.html" target="_blank" rel="noopener">ç¨³å®šæ’åºå’Œä¸ç¨³å®šæ’åº</a></p><p><a href="https://www.cnblogs.com/codingmylife/archive/2012/10/21/2732980.html" target="_blank" rel="noopener">ç¨³å®šæ’åºå’Œä¸ç¨³å®šæ’åº</a></p><p><a href="https://juejin.im/entry/58371f13a22b9d006882902d" target="_blank" rel="noopener">é¢è¯•æ—§æ•Œä¹‹çº¢é»‘æ ‘ï¼ˆç›´ç™½ä»‹ç»æ·±å…¥ç†è§£ï¼‰</a></p><p><a href="https://blog.csdn.net/sinat_35297665/article/details/80979181" target="_blank" rel="noopener">TCPç¬¬å››æ¬¡æŒ¥æ‰‹ä¸ºä»€ä¹ˆè¦ç­‰å¾…2MSL</a></p><p><a href="https://juejin.im/post/5ad43b86f265da239236cedc" target="_blank" rel="noopener">Webå®‰å…¨é˜²èŒƒâ€”â€“é˜²æ­¢é‡æ”¾æ”»å‡»</a></p><p><a href="https://blog.csdn.net/u012758088/article/details/76020966" target="_blank" rel="noopener">ç½‘ç»œç¼–ç¨‹â€”é“¾è·¯å±‚æŠ¥æ–‡ã€ç½‘ç»œå±‚IPæŠ¥æ–‡ã€ä¼ è¾“å±‚TCPæŠ¥æ–‡</a></p><hr><p><a href="https://juejin.im/post/5c98a834f265da6111675253" target="_blank" rel="noopener">Flutter å®ç°åŸç†åŠåœ¨é©¬èœ‚çªçš„è·¨å¹³å°å¼€å‘å®è·µ</a></p><hr><p><a href="https://www.jianshu.com/p/b0b6b88fe9fe" target="_blank" rel="noopener">1- Httpsæµç¨‹å’ŒåŸç†</a></p><p><a href="https://www.cnblogs.com/liyuhui-Z/p/7844880.html" target="_blank" rel="noopener">HTTPS å»ºç«‹è¿æ¥çš„è¯¦ç»†è¿‡ç¨‹</a></p><p><a href="https://www.cnblogs.com/chentingk/p/6497107.html" target="_blank" rel="noopener">ç”Ÿäº§è€…æ¶ˆè´¹è€…æ¨¡å¼-Javaå®ç°</a></p><p><a href="https://www.cnblogs.com/gavinsp/p/5513536.html" target="_blank" rel="noopener">æ•°æ®åº“ç´¢å¼•è¯¦è§£</a></p><p><a href="https://www.cnblogs.com/gonjan-blog/p/6685611.html" target="_blank" rel="noopener">javaåŠ¨æ€ä»£ç†å®ç°ä¸åŸç†è¯¦ç»†åˆ†æ</a></p><p><a href="https://www.cnblogs.com/chengxiao/p/6842045.html" target="_blank" rel="noopener">ConcurrentHashMapå®ç°åŸç†åŠæºç åˆ†æ</a></p><p><a href="https://www.cnblogs.com/gonjan-blog/p/6685611.html" target="_blank" rel="noopener">javaåŠ¨æ€ä»£ç†å®ç°ä¸åŸç†è¯¦ç»†åˆ†æ</a></p><hr><p><a href="http://web.jobbole.com/85541/" target="_blank" rel="noopener">è°ˆè°ˆHTTPåè®®ä¸­çš„çŸ­è½®è¯¢ã€é•¿è½®è¯¢ã€é•¿è¿æ¥å’ŒçŸ­è¿æ¥</a></p><p><a href="https://www.cnblogs.com/lizhengxian/p/5075635.html" target="_blank" rel="noopener">Androidè¿›ç¨‹é—´é€šä¿¡çš„å‡ ç§æ–¹å¼</a></p><p><a href="https://blog.csdn.net/wh_sjc/article/details/70283843" target="_blank" rel="noopener">è¿›ç¨‹é—´çš„äº”ç§é€šä¿¡æ–¹å¼ä»‹ç»</a></p><p><a href="https://www.cnblogs.com/withyou/p/4789170.html" target="_blank" rel="noopener">é¢å‘å¯¹è±¡ä¹‹å¤šæ€ç†è§£ï¼Œå¤šæ€çš„ä½œç”¨ä¸å¥½å¤„</a></p><p><a href="https://blog.csdn.net/luoshixian099/article/details/51908175" target="_blank" rel="noopener">ç®—æ³•å¯¼è®ºâ€“æœ€å°ç”Ÿæˆæ ‘ï¼ˆKruskalå’ŒPrimç®—æ³•ï¼‰</a></p><p><a href="https://juejin.im/entry/584abdff61ff4b0058d50547" target="_blank" rel="noopener">é¢è¯•æ—§æ•Œä¹‹ Java æ³›å‹ ï¼šä¸»è¦æ¦‚å¿µåŠç‰¹ç‚¹</a></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;&lt;a href=&quot;https://www.jianshu.com/p/fb59c770160c&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;å¼ºç¼“å­˜å’Œåå•†ç¼“å­˜&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://juejin.im/post/5a6c8
      
    
    </summary>
    
      <category term="æ•´ç†" scheme="https://meandni.com/categories/%E6%95%B4%E7%90%86/"/>
    
    
      <category term="é˜…è¯»" scheme="https://meandni.com/tags/%E9%98%85%E8%AF%BB/"/>
    
  </entry>
  
  <entry>
    <title>Flutterè¿›é˜¶ï¼šè·¯ç”±ã€è·¯ç”±æ ˆè¯¦è§£åŠæ¡ˆä¾‹åˆ†æ</title>
    <link href="https://meandni.com/2019/03/04/flutter-route/"/>
    <id>https://meandni.com/2019/03/04/flutter-route/</id>
    <published>2019-03-04T12:18:54.000Z</published>
    <updated>2019-03-05T14:02:33.503Z</updated>
    
    <content type="html"><![CDATA[<h1 id="è·¯ç”±åˆä½“éªŒ"><a href="#è·¯ç”±åˆä½“éªŒ" class="headerlink" title="è·¯ç”±åˆä½“éªŒ"></a>è·¯ç”±åˆä½“éªŒ</h1><p>è·¯ç”±ï¼ˆRoutesï¼‰æ˜¯ä»€ä¹ˆï¼Ÿè·¯ç”±æ˜¯å±å¹•æˆ–åº”ç”¨ç¨‹åºé¡µé¢çš„æŠ½è±¡ã€‚</p><p>Flutter ä½¿æˆ‘ä»¬èƒ½å¤Ÿä¼˜é›…åœ°ç®¡ç†è·¯ç”±ä¸»è¦ä¾èµ–çš„æ˜¯ Navigatorï¼ˆå¯¼èˆªå™¨ï¼‰ç±»ã€‚è¿™æ˜¯ä¸€ä¸ªç”¨äºç®¡ç†ä¸€ç»„å…·æœ‰æŸç§è¿›å‡ºè§„åˆ™çš„é¡µé¢çš„ Widgetï¼Œä¹Ÿå°±æ˜¯è¯´ç”¨å®ƒæˆ‘ä»¬èƒ½å¤Ÿå®ç°å„ä¸ªé¡µé¢é—´æœ‰è§„å¾‹çš„åˆ‡æ¢ã€‚è€Œè¿™é‡Œçš„è§„åˆ™ä¾¿æ˜¯åœ¨å…¶å†…éƒ¨ç»´æŠ¤çš„ä¸€ä¸ªâ€œ è·¯ç”±æ ˆâ€ã€‚</p><p>å­¦ä¹  Android çš„åŒå­¦çŸ¥é“ Activity çš„å¯åŠ¨æ¨¡å¼å¯ä»¥å®ç°å„ç§ä¸šåŠ¡éœ€æ±‚ï¼ŒiOS ä¸­ä¹Ÿæœ‰åµŒå¥—è·¯ç”±çš„åŠŸèƒ½ï¼ŒFlutter ä½œä¸ºæœ€æœ‰æ½œåŠ›çš„è·¨å¹³å°æ¡†æ¶å½“ç„¶è¦å¸å–ä¼—å®¶ä¹‹ç²¾åï¼Œå®ƒå½“ç„¶å®Œå…¨æœ‰èƒ½åŠ›å®ç°åŸç”Ÿçš„å„ç§æ•ˆæœï¼</p><p>æˆ‘ä»¬å…ˆå°è¯•å®ç°ä¸€ä¸ªå°çš„åŠŸèƒ½ã€‚</p><h2 id="ç»„ä»¶è·¯ç”±"><a href="#ç»„ä»¶è·¯ç”±" class="headerlink" title="ç»„ä»¶è·¯ç”±"></a>ç»„ä»¶è·¯ç”±</h2><p>å½“æˆ‘ä»¬ç¬¬ä¸€æ¬¡æ‰“å¼€åº”ç”¨ç¨‹åºï¼Œå‡ºç°åœ¨çœ¼å‰çš„ä¾¿æ˜¯è·¯ç”±æ ˆä¸­çš„ç¬¬ä¸€ä¸ªä¹Ÿæ˜¯æœ€åº•éƒ¨å®ä¾‹ï¼š</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">void</span> main() &#123;</span><br><span class="line">  runApp(MaterialApp(home: Screen1()));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¦åœ¨å †æ ˆä¸Šæ¨é€æ–°çš„å®ä¾‹ï¼Œæˆ‘ä»¬å¯ä»¥è°ƒç”¨å¯¼èˆªå™¨ <code>Navigator.push</code> ï¼Œä¼ å…¥å½“å‰ context å¹¶ä¸”ä½¿ç”¨æ„å»ºå™¨å‡½æ•°åˆ›å»º MaterialPageRoute å®ä¾‹ï¼Œè¯¥å‡½æ•°å¯ä»¥åˆ›å»ºæ‚¨æƒ³è¦åœ¨å±å¹•ä¸Šæ˜¾ç¤ºçš„å†…å®¹ã€‚ ä¾‹å¦‚ï¼š</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">new</span> RaisedButton(</span><br><span class="line">   onPressed:()&#123;</span><br><span class="line">   Navigator.push(context, MaterialPageRoute&lt;<span class="keyword">void</span>&gt;(</span><br><span class="line">      builder: (BuildContext context) &#123;</span><br><span class="line">        <span class="keyword">return</span> Scaffold(</span><br><span class="line">          appBar: AppBar(title: Text(<span class="string">'My Page'</span>)),</span><br><span class="line">          body: Center(</span><br><span class="line">            child: FlatButton(</span><br><span class="line">              child: Text(<span class="string">'POP'</span>),</span><br><span class="line">              onPressed: () &#123;</span><br><span class="line">                Navigator.pop(context);</span><br><span class="line">              &#125;,</span><br><span class="line">            ),</span><br><span class="line">          ),</span><br><span class="line">        );</span><br><span class="line">      &#125;,</span><br><span class="line">    ));</span><br><span class="line">   &#125;,</span><br><span class="line">   child: <span class="keyword">new</span> Text(<span class="string">"Push to Screen 2"</span>),</span><br><span class="line">),</span><br></pre></td></tr></table></figure><p>ç‚¹å‡»æ‰§è¡Œä¸Šæ–¹æ“ä½œï¼Œæˆ‘ä»¬å°†æˆåŠŸæ‰“å¼€ç¬¬äºŒä¸ªé¡µé¢ã€‚</p><h2 id="å‘½åè·¯ç”±"><a href="#å‘½åè·¯ç”±" class="headerlink" title="å‘½åè·¯ç”±"></a>å‘½åè·¯ç”±</h2><p>åœ¨ä¸€èˆ¬åº”ç”¨ä¸­ï¼Œæˆ‘ä»¬ç”¨çš„æœ€å¤šçš„è¿˜æ˜¯å‘½åè·¯ç”±ï¼Œå®ƒæ˜¯å°†åº”ç”¨ä¸­éœ€è¦è®¿é—®çš„æ¯ä¸ªé¡µé¢å‘½åä¸ºä¸é‡å¤çš„å­—ç¬¦ä¸²ï¼Œæˆ‘ä»¬ä¾¿å¯ä»¥é€šè¿‡è¿™ä¸ªå­—ç¬¦ä¸²æ¥å°†è¯¥é¡µé¢å®ä¾‹æ¨è¿›è·¯ç”±ã€‚</p><blockquote><p>ä¾‹å¦‚ï¼Œâ€™/ homeâ€™ è¡¨ç¤º HomeScreenï¼Œ â€˜/ loginâ€™ è¡¨ç¤º LoginScreenã€‚ â€˜/â€˜ è¡¨ç¤ºä¸»é¡µé¢ã€‚ è¿™é‡Œçš„å‘½åè§„èŒƒä¸ REST API å¼€å‘ä¸­çš„è·¯ç”±ç±»ä¼¼ã€‚ æ‰€ä»¥ â€˜/â€˜ é€šå¸¸è¡¨ç¤ºçš„æ˜¯æˆ‘ä»¬çš„æ ¹é¡µé¢ã€‚</p></blockquote><p>è¯·çœ‹ä¸‹æ–¹æ¡ˆä¾‹ï¼š</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">new</span> MaterialApp(</span><br><span class="line">  home: <span class="keyword">new</span> Screen1(),</span><br><span class="line">  routes: &lt;<span class="built_in">String</span>, WidgetBuilder&gt; &#123;</span><br><span class="line">    <span class="string">'/screen1'</span>: (BuildContext context) =&gt; <span class="keyword">new</span> Screen1(),</span><br><span class="line">    <span class="string">'/screen2'</span> : (BuildContext context) =&gt; <span class="keyword">new</span> Screen2(),</span><br><span class="line">    <span class="string">'/screen3'</span> : (BuildContext context) =&gt; <span class="keyword">new</span> Screen3(),</span><br><span class="line">    <span class="string">'/screen4'</span> : (BuildContext context) =&gt; <span class="keyword">new</span> Screen4()</span><br><span class="line">  &#125;,</span><br><span class="line">)</span><br></pre></td></tr></table></figure><p><em>Screen1()ã€Screen2()ç­‰æ˜¯æ¯ä¸ªé¡µé¢çš„ç±»åã€‚</em></p><p>æˆ‘ä»¬åŒæ ·å¯ä»¥å®ç°å‰é¢çš„åŠŸèƒ½ï¼š</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">new</span> RaisedButton(</span><br><span class="line">   onPressed:()&#123;</span><br><span class="line">     Navigator.of(context).pushNamed(<span class="string">'/screen2'</span>);</span><br><span class="line">   &#125;,</span><br><span class="line">   child: <span class="keyword">new</span> Text(<span class="string">"Push to Screen 2"</span>),</span><br><span class="line">),</span><br></pre></td></tr></table></figure><p>æˆ–è€…ï¼š</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">new</span> RaisedButton(</span><br><span class="line">   onPressed:()&#123;</span><br><span class="line">     Navigator.pushNamed(context, <span class="string">"/screen2"</span>)</span><br><span class="line">   &#125;,</span><br><span class="line">   child: <span class="keyword">new</span> Text(<span class="string">"Push to Screen 2"</span>),</span><br><span class="line">),</span><br></pre></td></tr></table></figure><p>åŒæ ·å¯ä»¥å®ç°ä¸Šæ–¹æ•ˆæœã€‚</p><h2 id="Pop"><a href="#Pop" class="headerlink" title="Pop"></a>Pop</h2><p>å®ç°ä¸Šé¢ä¸¤ç§æ–¹æ³•ï¼Œæ­¤æ—¶ï¼Œè·¯ç”±æ ˆä¸­çš„æƒ…å†µå¦‚ä¸‹ï¼š</p><figure class="image-bubble">                <div class="img-lightbox">                    <div class="overlay"></div>                    <img src="/images/route1.png" alt="1_RKtC1MKJbjSfMjUlR-2K7g" title="">                </div>                <div class="image-caption">1_RKtC1MKJbjSfMjUlR-2K7g</div>            </figure><p>ç°åœ¨ï¼Œå½“æˆ‘ä»¬æƒ³è¦å›é€€çš„åˆ°ä¸»å±å¹•æ—¶ï¼Œæˆ‘ä»¬åˆ™éœ€è¦ä½¿ç”¨ pop æ–¹æ³•ä» Navigator çš„å †æ ˆä¸­å¼¹å‡º Routesã€‚</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Navigator.of(context).pop();</span><br></pre></td></tr></table></figure><figure class="image-bubble">                <div class="img-lightbox">                    <div class="overlay"></div>                    <img src="/images/route2.png" alt="1_hq7qfAer0wCCSyIBKr7sfg" title="">                </div>                <div class="image-caption">1_hq7qfAer0wCCSyIBKr7sfg</div>            </figure><p>ä½¿ç”¨ Scaffold æ—¶ï¼Œé€šå¸¸ä¸éœ€è¦æ˜¾å¼å¼¹å‡ºè·¯å¾„ï¼Œå› ä¸º Scaffold ä¼šè‡ªåŠ¨å‘å…¶ AppBar æ·»åŠ ä¸€ä¸ªâ€œåé€€â€æŒ‰é’®ï¼ŒæŒ‰ä¸‹æ—¶ä¼šè°ƒç”¨ <code>Navigator.pop()</code>ã€‚ </p><p>åœ¨ Android ä¸­ï¼ŒæŒ‰ä¸‹è®¾å¤‡åé€€æŒ‰é’®ä¹Ÿä¼šè¿™æ ·åšã€‚ä½†æ˜¯ï¼Œæˆ‘ä»¬ä¹Ÿæœ‰å¯èƒ½éœ€è¦å°†æ­¤æ–¹æ³•ç”¨äºå…¶ä»–ç»„ä»¶ï¼Œä¾‹å¦‚åœ¨ç”¨æˆ·å•å‡»â€œå–æ¶ˆâ€æŒ‰é’®æ—¶å¼¹å‡º AlertDialogã€‚</p><blockquote><p><strong>è¿™é‡Œè¦æ³¨æ„çš„æ˜¯ï¼š</strong>åˆ‡å‹¿ç”¨ push ä»£æ›¿ popï¼Œæœ‰åŒå­¦è¯´æˆ‘åœ¨ Screen2 push Screen1 éƒ¨ç…§æ ·èƒ½å®ç°è¿™ä¸ªåŠŸèƒ½å—ï¼Ÿå…¶å®ä¸ç„¶å•Šï¼Œè¯·çœ‹ä¸‹å›¾ï¼š</p></blockquote><figure class="image-bubble">                <div class="img-lightbox">                    <div class="overlay"></div>                    <img src="/images/route3.png" alt="1_Xsyo5c8s1JwO6f2OQ1nNEg" title="">                </div>                <div class="image-caption">1_Xsyo5c8s1JwO6f2OQ1nNEg</div>            </figure><blockquote><p>æ‰€ä»¥ <strong>push åªç”¨äºå‘æ ˆä¸­æ·»åŠ å®ä¾‹ï¼Œpop å¼¹å‡ºå®ä¾‹ï¼ï¼ˆç‰¹æ®Šéœ€æ±‚é™¤å¤–ï¼‰</strong></p></blockquote><h1 id="è¯¦è§£è·¯ç”±æ ˆ"><a href="#è¯¦è§£è·¯ç”±æ ˆ" class="headerlink" title="è¯¦è§£è·¯ç”±æ ˆ"></a>è¯¦è§£è·¯ç”±æ ˆ</h1><p>å‰é¢ï¼Œæˆ‘ä»¬å·²ç»çŸ¥é“å¦‚ä½•ç®€å•åœ¨è·¯ç”±æ ˆä¸­ pushã€pop å®ä¾‹ï¼Œç„¶è€Œï¼Œå½“é‡åˆ°ä¸€äº›ç‰¹æ®Šçš„æƒ…å†µï¼Œè¿™æ˜¾ç„¶ä¸èƒ½æ»¡è¶³éœ€æ±‚ã€‚å­¦ä¹  Android çš„åŒå­¦çŸ¥é“ Activity çš„å„ç§å¯åŠ¨æ¨¡å¼å¯ä»¥å®Œæˆç›¸åº”éœ€æ±‚ï¼ŒFlutter å½“ç„¶ä¹Ÿæœ‰ç±»ä¼¼çš„å¯ä»¥è§£å†³å„ç§ä¸šåŠ¡éœ€æ±‚çš„å®ç°æ–¹å¼ï¼</p><p>è¯·çœ‹ä¸‹é¢ä½¿ç”¨æ–¹æ³•ä¸æ¡ˆä¾‹åˆ†æã€‚</p><h2 id="pushReplacementNamed-ä¸-popAndPushNamed"><a href="#pushReplacementNamed-ä¸-popAndPushNamed" class="headerlink" title="pushReplacementNamed ä¸ popAndPushNamed"></a>pushReplacementNamed ä¸ popAndPushNamed</h2><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">RaisedButton(</span><br><span class="line">  onPressed: () &#123;</span><br><span class="line">    Navigator.pushReplacementNamed(context, <span class="string">"/screen4"</span>);</span><br><span class="line">  &#125;,</span><br><span class="line">  child: Text(<span class="string">"pushReplacementNamed"</span>),</span><br><span class="line">),</span><br><span class="line">RaisedButton(</span><br><span class="line">  onPressed: () &#123;</span><br><span class="line">    Navigator.popAndPushNamed(context, <span class="string">"/screen4"</span>);</span><br><span class="line">  &#125;,</span><br><span class="line">  child: Text(<span class="string">"popAndPushNamed"</span>),</span><br><span class="line">),</span><br></pre></td></tr></table></figure><p><em>æˆ‘ä»¬åœ¨ Screen3 é¡µé¢ä½¿ç”¨ <code>pushReplacementNamed</code> ä¸ <code>popAndPushNamed</code> æ–¹æ³• push äº† Screen4ã€‚</em></p><p>æ­¤æ—¶è·¯ç”±æ ˆæƒ…å†µå¦‚ä¸‹ï¼š</p><figure class="image-bubble">                <div class="img-lightbox">                    <div class="overlay"></div>                    <img src="/images/route4.png" alt="1_cr77kgOgz7KRjwvMAVXoAg" title="">                </div>                <div class="image-caption">1_cr77kgOgz7KRjwvMAVXoAg</div>            </figure><p><strong>Screen4 ä»£æ›¿äº† Screen</strong>ã€‚</p><p><code>pushReplacementNamed</code> ä¸ <code>popAndPushNamed</code> çš„åŒºåˆ«åœ¨äºï¼š  <code>popAndPushNamed</code>  èƒ½å¤Ÿæ‰§è¡Œ Screen2 å¼¹å‡ºçš„åŠ¨ç”»ä¸ Screen3 æ¨è¿›çš„åŠ¨ç”»è€Œ <code>pushReplacementNamed</code> ä»…æ˜¾ç¤º Screen3 æ¨è¿›çš„åŠ¨ç”»ã€‚</p><figure class="image-bubble">                <div class="img-lightbox">                    <div class="overlay"></div>                    <img src="/images/route10.gif" alt="1_cr77kgOgz7KRjwvMAVXoAg" title="">                </div>                <div class="image-caption">1_cr77kgOgz7KRjwvMAVXoAg</div>            </figure><p>æ¡ˆä¾‹ï¼š</p><blockquote><p><strong>pushReplacementNamed</strong>ï¼šå½“ç”¨æˆ·æˆåŠŸç™»å½•å¹¶ä¸”ç°åœ¨åœ¨ <code>HomeScreen</code> ä¸Šæ—¶ï¼Œæ‚¨ä¸å¸Œæœ›ç”¨æˆ·è¿˜èƒ½å¤Ÿè¿”å›åˆ° <code>LoginScreen</code>ã€‚å› æ­¤ï¼Œç™»å½•åº”å®Œå…¨ç”±é¦–é¡µæ›¿æ¢ã€‚å¦ä¸€ä¸ªä¾‹å­æ˜¯ä» <code>SplashScreen</code> è½¬åˆ° <code>HomeScreen</code>ã€‚ å®ƒåº”è¯¥åªæ˜¾ç¤ºä¸€æ¬¡ï¼Œç”¨æˆ·ä¸èƒ½å†ä» <code>HomeScreen</code> è¿”å›å®ƒã€‚ åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œç”±äºæˆ‘ä»¬è¦è¿›å…¥ä¸€ä¸ªå…¨æ–°çš„å±å¹•ï¼Œæˆ‘ä»¬å¯èƒ½éœ€è¦å€ŸåŠ©æ­¤æ–¹æ³•ã€‚</p><p><strong>popAndPushNamed</strong>ï¼šå‡è®¾æ‚¨æ­£åœ¨æœ‰ä¸€ä¸ª <code>Shopping</code> åº”ç”¨ç¨‹åºï¼Œè¯¥åº”ç”¨ç¨‹åºåœ¨ <code>ProductsListScreen</code> ä¸­æ˜¾ç¤ºäº§å“åˆ—è¡¨ï¼Œç”¨æˆ·å¯ä»¥åœ¨ <code>FiltersScreen</code> ä¸­åº”ç”¨è¿‡æ»¤å•†å“ã€‚ å½“ç”¨æˆ·å•å‡»â€œåº”ç”¨ç­›é€‰â€æŒ‰é’®æ—¶ï¼Œåº”å¼¹å‡º <code>FiltersScreen</code> å¹¶ä½¿ç”¨æ–°çš„è¿‡æ»¤å™¨å€¼æ¨å›åˆ° <code>ProductsListScreen</code>ã€‚ è¿™é‡Œ <code>popAndPushNamed</code> æ˜¾ç„¶æ›´ä¸ºåˆé€‚ã€‚</p></blockquote><h2 id="pushNamedAndRemoveUntil"><a href="#pushNamedAndRemoveUntil" class="headerlink" title="pushNamedAndRemoveUntil"></a>pushNamedAndRemoveUntil</h2><blockquote><p>ç”¨æˆ·å·²ç»ç™»é™†è¿›å…¥ <code>HomeScreen</code> ï¼Œç„¶åç»è¿‡ä¸€ç³»åˆ—æ“ä½œå›åˆ°é…åˆåªç•Œé¢æƒ³è¦é€€å‡ºç™»å½•ï¼Œä½ ä¸èƒ½å¤Ÿç›´æ¥ Push è¿›å…¥ <code>LoginScreen</code> å§ï¼Ÿ<strong>ä½ éœ€è¦å°†ä¹‹å‰è·¯ç”±ä¸­çš„å®ä¾‹å…¨éƒ¨åˆ é™¤æ˜¯çš„ç”¨æˆ·ä¸ä¼šåœ¨å›åˆ°å…ˆå‰çš„è·¯ç”±ä¸­ã€‚</strong></p></blockquote><p>pushNamedAndRemoveUntil å¯å®ç°è¯¥åŠŸèƒ½ï¼š</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Navigator.of(context).pushNamedAndRemoveUntil(<span class="string">'/screen4'</span>, (Route&lt;<span class="keyword">dynamic</span>&gt; route) =&gt; <span class="keyword">false</span>);</span><br></pre></td></tr></table></figure><p>è¿™é‡Œçš„ <code>(Route&lt;dynamic&gt; route) =&gt; false</code> èƒ½å¤Ÿç¡®ä¿åˆ é™¤å…ˆå‰æ‰€æœ‰å®ä¾‹ã€‚</p><figure class="image-bubble">                <div class="img-lightbox">                    <div class="overlay"></div>                    <img src="/images/route5.png" alt="Logging out removes all routes and takes user back to LoginScreen" title="">                </div>                <div class="image-caption">Logging out removes all routes and takes user back to LoginScreen</div>            </figure><p>ç°åœ¨åˆæœ‰ä¸€ä¸ªéœ€æ±‚ï¼šæˆ‘ä»¬ä¸å¸Œæœ›åˆ é™¤å…ˆå‰æ‰€æœ‰å®ä¾‹ï¼Œ<strong>æˆ‘ä»¬åªè¦æ±‚åˆ é™¤æŒ‡å®šä¸ªæ•°çš„å®ä¾‹</strong>ã€‚</p><blockquote><p>æˆ‘ä»¬æœ‰ä¸€ä¸ªéœ€è¦ä»˜æ¬¾äº¤æ˜“çš„è´­ç‰©åº”ç”¨ã€‚åœ¨åº”ç”¨ç¨‹åºä¸­ï¼Œä¸€æ—¦ç”¨æˆ·å®Œæˆäº†æ”¯ä»˜äº¤æ˜“ï¼Œå°±åº”è¯¥ä»å †æ ˆä¸­åˆ é™¤æ‰€æœ‰ä¸äº¤æ˜“æˆ–è´­ç‰©è½¦ç›¸å…³çš„é¡µé¢ï¼Œå¹¶ä¸”ç”¨æˆ·åº”è¯¥è¢«å¸¦åˆ° <code>PaymentConfirmationScreen</code> ,å•å‡»åé€€æŒ‰é’®åº”è¯¥åªå°†å®ƒä»¬å¸¦å›åˆ° <code>ProductsListScreen</code> æˆ– <code>HomeScreen</code>ï¼š</p></blockquote><figure class="image-bubble">                <div class="img-lightbox">                    <div class="overlay"></div>                    <img src="/images/route6.png" alt="1_aaZxoLUbKdFPgiIkBAmw7w" title="">                </div>                <div class="image-caption">1_aaZxoLUbKdFPgiIkBAmw7w</div>            </figure><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Navigator.of(context).pushNamedAndRemoveUntil(<span class="string">'/screen4'</span>, ModalRoute.withName(<span class="string">'/screen1'</span>));</span><br></pre></td></tr></table></figure><p>é€šè¿‡ä»£ç ï¼Œæˆ‘ä»¬æ¨é€ <code>Screen4</code> å¹¶åˆ é™¤æ‰€æœ‰è·¯ç”±ï¼Œç›´åˆ° <code>Screen1</code>ï¼š</p><figure class="image-bubble">                <div class="img-lightbox">                    <div class="overlay"></div>                    <img src="/images/route7.png" alt="1_D81iZF-BikxXJHak7_NkhA" title="">                </div>                <div class="image-caption">1_D81iZF-BikxXJHak7_NkhA</div>            </figure><h2 id="popUntil"><a href="#popUntil" class="headerlink" title="popUntil"></a>popUntil</h2><p>æƒ³è±¡ä¸€ä¸‹ï¼Œæˆ‘ä»¬åœ¨åº”ç”¨ç¨‹åºä¸­è¦å¡«å†™ä¸€ç³»åˆ—ä¿¡æ¯ï¼Œè¡¨å•åˆ†å¸ƒåœ¨å¤šä¸ªé¡µé¢ä¸­ã€‚å‡è®¾éœ€è¦å¡«å†™ä¸‰ä¸ªé¡µé¢çš„è¡¨å•ä¸€æ­¥æ¥ç€ä¸€æ­¥ã€‚  ç„¶è€Œï¼Œåœ¨è¡¨å•çš„ç¬¬ 3 éƒ¨åˆ†ï¼Œç”¨æˆ·å–æ¶ˆäº†å¡«å†™è¡¨å•ã€‚ ç”¨æˆ·å•å‡»å–æ¶ˆå¹¶ä¸”åº”å¼¹å‡ºæ‰€æœ‰ä¹‹å‰ä¸è¡¨å•ç›¸å…³çš„é¡µé¢ï¼Œå¹¶ä¸”åº”è¯¥å°†ç”¨æˆ·å¸¦å› <code>HomeScreen</code> æˆ–è€… <code>DashboardScreen</code>ï¼Œè¿™ç§æƒ…å†µä¸‹æ•°æ®å±äºæ•°æ®æ— æ•ˆï¼ æˆ‘ä»¬ä¸ä¼šåœ¨è¿™é‡Œæ¨æ–°ä»»ä½•æ–°ä¸œè¥¿ï¼Œåªæ˜¯å›åˆ°ä»¥å‰çš„è·¯ç”±æ ˆä¸­ã€‚</p><figure class="image-bubble">                <div class="img-lightbox">                    <div class="overlay"></div>                    <img src="/images/route8.png" alt="1_qV7mF0Kow2zch-fjksmA_Q" title="">                </div>                <div class="image-caption">1_qV7mF0Kow2zch-fjksmA_Q</div>            </figure><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Navigator.popUntil(context, ModalRoute.withName(<span class="string">'/screen2'</span>));</span><br></pre></td></tr></table></figure><h2 id="Popup-routesï¼ˆå¼¹å‡ºè·¯ç”±ï¼‰"><a href="#Popup-routesï¼ˆå¼¹å‡ºè·¯ç”±ï¼‰" class="headerlink" title="Popup routesï¼ˆå¼¹å‡ºè·¯ç”±ï¼‰"></a>Popup routesï¼ˆå¼¹å‡ºè·¯ç”±ï¼‰</h2><p>è·¯ç”±ä¸ä¸€å®šè¦é®æŒ¡æ•´ä¸ªå±å¹•ã€‚ <a href="https://docs.flutter.io/flutter/widgets/PopupRoute-class.html" target="_blank" rel="noopener">PopupRoute</a>s ä½¿ç”¨ <a href="https://docs.flutter.io/flutter/widgets/ModalRoute/barrierColor.html" target="_blank" rel="noopener">ModalRoute.barrierColor</a>  è¦†ç›–å±å¹•ï¼Œ<a href="https://docs.flutter.io/flutter/widgets/ModalRoute/barrierColor.html" target="_blank" rel="noopener">ModalRoute.barrierColor</a> åªèƒ½éƒ¨åˆ†ä¸é€æ˜ä»¥å…è®¸å½“å‰å±å¹•æ˜¾ç¤ºã€‚ å¼¹å‡ºè·¯ç”±æ˜¯â€œæ¨¡æ€â€çš„ï¼Œå› ä¸ºå®ƒä»¬é˜»æ­¢äº†å¯¹ä¸‹é¢å…¶ä»–ç»„ä»¶çš„è¾“å…¥ã€‚</p><p>æœ‰ä¸€äº›æ–¹æ³•å¯ä»¥åˆ›å»ºå’Œæ˜¾ç¤ºè¿™ç±»å¼¹å‡ºè·¯ç”±ã€‚ ä¾‹å¦‚ï¼šshowDialogï¼ŒshowMenu å’Œ showModalBottomSheetã€‚ å¦‚ä¸Šæ‰€è¿°ï¼Œè¿™äº›å‡½æ•°è¿”å›å…¶æ¨é€è·¯ç”±çš„ Futureï¼ˆå¼‚æ­¥æ•°æ®ï¼Œå‚è€ƒä¸‹é¢çš„æ•°æ®éƒ¨åˆ†ï¼‰ã€‚ æ‰§è¡Œå¯ä»¥ç­‰å¾…è¿”å›çš„å€¼åœ¨å¼¹å‡ºè·¯ç”±æ—¶æ‰§è¡Œæ“ä½œã€‚</p><p>è¿˜æœ‰ä¸€äº›ç»„ä»¶å¯ä»¥åˆ›å»ºå¼¹å‡ºè·¯ç”±ï¼Œå¦‚ PopupMenuButton å’Œ DropdownButtonã€‚ è¿™äº›ç»„ä»¶åˆ›å»º PopupRoute çš„å†…éƒ¨å­ç±»ï¼Œå¹¶ä½¿ç”¨ Navigator çš„ push å’Œ pop æ–¹æ³•æ¥æ˜¾ç¤ºå’Œå…³é—­å®ƒä»¬ã€‚</p><h2 id="è‡ªå®šä¹‰è·¯ç”±"><a href="#è‡ªå®šä¹‰è·¯ç”±" class="headerlink" title="è‡ªå®šä¹‰è·¯ç”±"></a>è‡ªå®šä¹‰è·¯ç”±</h2><p>æ‚¨å¯ä»¥åˆ›å»ºè‡ªå·±çš„ä¸€ä¸ªçª—å£zç»„ä»¶åº“è·¯ç”±ç±»ï¼ˆå¦‚ PopupRouteï¼ŒModalRoute æˆ– PageRouteï¼‰çš„å­ç±»ï¼Œä»¥æ§åˆ¶ç”¨äºæ˜¾ç¤ºè·¯å¾„çš„åŠ¨ç”»è¿‡æ¸¡ï¼Œè·¯å¾„çš„æ¨¡æ€å±éšœçš„é¢œè‰²å’Œè¡Œä¸ºä»¥åŠè·¯å¾„çš„å…¶ä»–å„ä¸ªç‰¹æ€§ã€‚</p><p>PageRouteBuilder ç±»å¯ä»¥æ ¹æ®å›è°ƒå®šä¹‰è‡ªå®šä¹‰è·¯ç”±ã€‚ ä¸‹é¢æ˜¯ä¸€ä¸ªåœ¨è·¯ç”±å‡ºç°æˆ–æ¶ˆå¤±æ—¶æ—‹è½¬å¹¶æ·¡åŒ–å…¶å­èŠ‚ç‚¹çš„ç¤ºä¾‹ã€‚ æ­¤è·¯ç”±ä¸ä¼šé®æŒ¡æ•´ä¸ªå±å¹•ï¼Œå› ä¸ºå®ƒæŒ‡å®šäº†opaqueï¼šfalseï¼Œå°±åƒå¼¹å‡ºè·¯ç”±ä¸€æ ·ã€‚</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">Navigator.push(context, PageRouteBuilder(</span><br><span class="line">  opaque: <span class="keyword">false</span>,</span><br><span class="line">  pageBuilder: (BuildContext context, _, __) &#123;</span><br><span class="line">    <span class="keyword">return</span> Center(child: Text(<span class="string">'My PageRoute'</span>));</span><br><span class="line">  &#125;,</span><br><span class="line">  transitionsBuilder: (___, Animation&lt;<span class="built_in">double</span>&gt; animation, ____, Widget child) &#123;</span><br><span class="line">    <span class="keyword">return</span> FadeTransition(</span><br><span class="line">      opacity: animation,</span><br><span class="line">      child: RotationTransition(</span><br><span class="line">        turns: Tween&lt;<span class="built_in">double</span>&gt;(begin: <span class="number">0.5</span>, end: <span class="number">1.0</span>).animate(animation),</span><br><span class="line">        child: child,</span><br><span class="line">      ),</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">));</span><br></pre></td></tr></table></figure><figure class="image-bubble">                <div class="img-lightbox">                    <div class="overlay"></div>                    <img src="/images/route9.gif" alt="ezgif-3-14c32a6d8764" title="">                </div>                <div class="image-caption">ezgif-3-14c32a6d8764</div>            </figure><p>è·¯ç”±ä¸¤éƒ¨åˆ†æ„æˆï¼Œâ€œpageBuilderâ€å’Œâ€œtransitionsBuilderâ€ã€‚ è¯¥é¡µé¢æˆä¸ºä¼ é€’ç»™ buildTransitions æ–¹æ³•çš„å­ä»£çš„åä»£ã€‚ é€šå¸¸ï¼Œé¡µé¢åªæ„å»ºä¸€æ¬¡ï¼Œå› ä¸ºå®ƒä¸ä¾èµ–äºå…¶åŠ¨ç”»å‚æ•°ï¼ˆåœ¨æ­¤ç¤ºä¾‹ä¸­ä»¥_å’Œ__è¡¨ç¤ºï¼‰ã€‚ è¿‡æ¸¡æ˜¯å»ºç«‹åœ¨æ¯ä¸ªå¸§çš„æŒç»­æ—¶é—´ã€‚</p><h2 id="åµŒå¥—è·¯ç”±"><a href="#åµŒå¥—è·¯ç”±" class="headerlink" title="åµŒå¥—è·¯ç”±"></a>åµŒå¥—è·¯ç”±</h2><p>ä¸€ä¸ªåº”ç”¨ç¨‹åºå¯ä»¥ä½¿ç”¨å¤šä¸ªè·¯ç”±å¯¼èˆªå™¨ã€‚å°†ä¸€ä¸ªå¯¼èˆªå™¨åµŒå¥—åœ¨å¦ä¸€ä¸ªå¯¼èˆªå™¨ä¸‹æ–¹å¯ç”¨äºåˆ›å»ºâ€œå†…éƒ¨æ—…ç¨‹â€ï¼Œä¾‹å¦‚é€‰é¡¹å¡å¼å¯¼èˆªï¼Œç”¨æˆ·æ³¨å†Œï¼Œå•†åº—ç»“å¸æˆ–ä»£è¡¨æ•´ä¸ªåº”ç”¨ç¨‹åºå­éƒ¨åˆ†çš„å…¶ä»–ç‹¬ç«‹ä¸ªä½“ã€‚</p><p>iOSåº”ç”¨ç¨‹åºçš„æ ‡å‡†åšæ³•æ˜¯ä½¿ç”¨é€‰é¡¹å¡å¼å¯¼èˆªï¼Œå…¶ä¸­æ¯ä¸ªé€‰é¡¹å¡éƒ½ç»´æŠ¤è‡ªå·±çš„å¯¼èˆªå†å²è®°å½•ã€‚å› æ­¤ï¼Œæ¯ä¸ªé€‰é¡¹å¡éƒ½æœ‰è‡ªå·±çš„å¯¼èˆªå™¨ï¼Œåˆ›å»ºäº†ä¸€ç§â€œå¹¶è¡Œå¯¼èˆªâ€ã€‚</p><p>é™¤äº†é€‰é¡¹å¡çš„å¹¶è¡Œå¯¼èˆªä¹‹å¤–ï¼Œè¿˜å¯ä»¥å¯åŠ¨å®Œå…¨è¦†ç›–é€‰é¡¹å¡çš„å…¨å±é¡µé¢ã€‚ä¾‹å¦‚ï¼šå…¥èŒæµç¨‹æˆ–è­¦æŠ¥å¯¹è¯æ¡†ã€‚å› æ­¤ï¼Œå¿…é¡»å­˜åœ¨ä½äºé€‰é¡¹å¡å¯¼èˆªä¸Šæ–¹çš„â€œæ ¹â€å¯¼èˆªå™¨ã€‚å› æ­¤ï¼Œæ¯ä¸ªé€‰é¡¹å¡çš„ Navigators å®é™…ä¸Šéƒ½æ˜¯åµŒå¥—åœ¨ä¸€ä¸ªæ ¹å¯¼èˆªå™¨ä¸‹é¢çš„Navigatorsã€‚</p><p>ç”¨äºé€‰é¡¹å¡å¼å¯¼èˆªçš„åµŒå¥—å¯¼èˆªå™¨ä½äº WidgetApp å’Œ <a href="https://docs.flutter.io/flutter/cupertino/CupertinoTabView-class.html" target="_blank" rel="noopener">CupertinoTabView</a> ä¸­ï¼Œå› æ­¤åœ¨è¿™ç§æƒ…å†µä¸‹æ‚¨æ— éœ€æ‹…å¿ƒåµŒå¥—çš„å¯¼èˆªå™¨ï¼Œä½†å®ƒæ˜¯ä½¿ç”¨åµŒå¥—å¯¼èˆªå™¨çš„çœŸå®ç¤ºä¾‹ã€‚</p><p>ä»¥ä¸‹ç¤ºä¾‹æ¼”ç¤ºäº†å¦‚ä½•ä½¿ç”¨åµŒå¥—çš„ Navigator æ¥å‘ˆç°ç‹¬ç«‹çš„ç”¨æˆ·æ³¨å†Œè¿‡ç¨‹ã€‚</p><p>å°½ç®¡æ­¤ç¤ºä¾‹ä½¿ç”¨ä¸¤ä¸ª Navigators æ¥æ¼”ç¤ºåµŒå¥—çš„ Navigatorsï¼Œä½†ä»…ä½¿ç”¨ä¸€ä¸ª Navigato rå°±å¯ä»¥è·å¾—ç±»ä¼¼çš„ç»“æœã€‚ </p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyApp</span> <span class="keyword">extends</span> <span class="title">StatelessWidget</span> </span>&#123;</span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  Widget build(BuildContext context) &#123;</span><br><span class="line">    <span class="keyword">return</span> MaterialApp(</span><br><span class="line">      <span class="comment">// ...some parameters omitted...</span></span><br><span class="line">      <span class="comment">// MaterialApp contains our top-level Navigator</span></span><br><span class="line">      initialRoute: <span class="string">'/'</span>,</span><br><span class="line">      routes: &#123;</span><br><span class="line">        <span class="string">'/'</span>: (BuildContext context) =&gt; HomePage(),</span><br><span class="line">        <span class="string">'/signup'</span>: (BuildContext context) =&gt; SignUpPage(),</span><br><span class="line">      &#125;,</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SignUpPage</span> <span class="keyword">extends</span> <span class="title">StatelessWidget</span> </span>&#123;</span><br><span class="line"> <span class="meta">@override</span></span><br><span class="line"> Widget build(BuildContext context) &#123;</span><br><span class="line">   <span class="comment">// SignUpPage builds its own Navigator which ends up being a nested</span></span><br><span class="line">   <span class="comment">// Navigator in our app.</span></span><br><span class="line">   <span class="keyword">return</span> Navigator(</span><br><span class="line">     initialRoute: <span class="string">'signup/personal_info'</span>,</span><br><span class="line">     onGenerateRoute: (RouteSettings settings) &#123;</span><br><span class="line">       WidgetBuilder builder;</span><br><span class="line">       <span class="keyword">switch</span> (settings.name) &#123;</span><br><span class="line">         <span class="keyword">case</span> <span class="string">'signup/personal_info'</span>:</span><br><span class="line">           <span class="comment">// Assume CollectPersonalInfoPage collects personal info and then</span></span><br><span class="line">           <span class="comment">// navigates to 'signup/choose_credentials'.</span></span><br><span class="line">           builder = (BuildContext _) =&gt; CollectPersonalInfoPage();</span><br><span class="line">           <span class="keyword">break</span>;</span><br><span class="line">         <span class="keyword">case</span> <span class="string">'signup/choose_credentials'</span>:</span><br><span class="line">           <span class="comment">// Assume ChooseCredentialsPage collects new credentials and then</span></span><br><span class="line">           <span class="comment">// invokes 'onSignupComplete()'.</span></span><br><span class="line">           builder = (BuildContext _) =&gt; ChooseCredentialsPage(</span><br><span class="line">             onSignupComplete: () &#123;</span><br><span class="line">               <span class="comment">// Referencing Navigator.of(context) from here refers to the</span></span><br><span class="line">               <span class="comment">// top level Navigator because SignUpPage is above the</span></span><br><span class="line">               <span class="comment">// nested Navigator that it created. Therefore, this pop()</span></span><br><span class="line">               <span class="comment">// will pop the entire "sign up" journey and return to the</span></span><br><span class="line">               <span class="comment">// "/" route, AKA HomePage.</span></span><br><span class="line">               Navigator.of(context).pop();</span><br><span class="line">             &#125;,</span><br><span class="line">           );</span><br><span class="line">           <span class="keyword">break</span>;</span><br><span class="line">         <span class="keyword">default</span>:</span><br><span class="line">           <span class="keyword">throw</span> Exception(<span class="string">'Invalid route: <span class="subst">$&#123;settings.name&#125;</span>'</span>);</span><br><span class="line">       &#125;</span><br><span class="line">       <span class="keyword">return</span> MaterialPageRoute(builder: builder, settings: settings);</span><br><span class="line">     &#125;,</span><br><span class="line">   );</span><br><span class="line"> &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>Navigator.of åœ¨ç»™å®š BuildContext ä¸­æœ€è¿‘çš„æ ¹ Navigator ä¸Šè¿è¡Œã€‚ ç¡®ä¿åœ¨é¢„æœŸçš„ Navigator ä¸‹é¢æä¾›BuildContextï¼Œå°¤å…¶æ˜¯åœ¨åˆ›å»ºåµŒå¥— Navigators çš„å¤§å‹æ„å»ºæ–¹æ³•ä¸­ã€‚ Builder ç»„ä»¶å¯ç”¨äºè®¿é—®ç»„ä»¶å­æ ‘ä¸­æ‰€éœ€ä½ç½®çš„ BuildContextã€‚</p><h1 id="é¡µé¢é—´æ•°æ®ä¼ é€’"><a href="#é¡µé¢é—´æ•°æ®ä¼ é€’" class="headerlink" title="é¡µé¢é—´æ•°æ®ä¼ é€’"></a>é¡µé¢é—´æ•°æ®ä¼ é€’</h1><h2 id="æ•°æ®ä¼ é€’"><a href="#æ•°æ®ä¼ é€’" class="headerlink" title="æ•°æ®ä¼ é€’"></a>æ•°æ®ä¼ é€’</h2><p>åœ¨ä¸Šé¢çš„å¤§å¤šæ•°ç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬æ¨é€æ–°è·¯ç”±æ—¶æ²¡æœ‰å‘é€æ•°æ®ï¼Œä½†åœ¨å®é™…åº”ç”¨ä¸­è¿™ç§æƒ…å†µåº”ç”¨å¾ˆå°‘ã€‚ è¦å‘é€æ•°æ®ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨ Navigator å°†æ–°çš„ MaterialPageRoute ç”¨æˆ‘ä»¬çš„æ•°æ®æ¨é€åˆ°å †æ ˆä¸Šï¼ˆè¿™é‡Œæ˜¯ <code>userName</code>ï¼‰</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">String</span> userName = <span class="string">"John Doe"</span>;</span><br><span class="line">Navigator.push(</span><br><span class="line">    context,</span><br><span class="line">    <span class="keyword">new</span> MaterialPageRoute(</span><br><span class="line">        builder: (BuildContext context) =&gt;</span><br><span class="line">        <span class="keyword">new</span> Screen5(userName)));</span><br></pre></td></tr></table></figure><p>è¦åœ¨ <code>Screen5</code> ä¸­å¾—åˆ°æ•°æ®ï¼Œæˆ‘ä»¬åªéœ€åœ¨ <code>Screen5</code> ä¸­æ·»åŠ ä¸€ä¸ªå‚æ•°åŒ–æ„é€ å‡½æ•°ï¼š</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Screen5</span> <span class="keyword">extends</span> <span class="title">StatelessWidget</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">final</span> <span class="built_in">String</span> userName;</span><br><span class="line">  Screen5(<span class="keyword">this</span>.userName);</span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  Widget build(BuildContext context) &#123;</span><br><span class="line">  <span class="built_in">print</span>(userName)</span><br><span class="line">  ...</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™è¡¨ç¤ºæˆ‘ä»¬ä¸ä»…å¯ä»¥ä½¿ç”¨ <code>MaterialPageRoute</code> ä½œä¸º <code>push</code> æ–¹æ³•ï¼Œè¿˜å¯ä»¥ä½¿ç”¨ <code>pushReplacement</code> ï¼Œ<code>pushAndPopUntil</code> ç­‰ã€‚åŸºæœ¬ä¸Šä»æˆ‘ä»¬æè¿°çš„ä¸Šè¿°æ–¹æ³•ä¸­è·¯ç”±æ–¹æ³•ï¼Œç¬¬ä¸€ä¸ªå‚æ•°ç°åœ¨å°†é‡‡ç”¨ <code>MaterialPageRoute</code> è€Œä¸æ˜¯ <code>namedRoute</code> çš„ <code>String</code>ã€‚</p><h2 id="æ•°æ®è¿”å›"><a href="#æ•°æ®è¿”å›" class="headerlink" title="æ•°æ®è¿”å›"></a>æ•°æ®è¿”å›</h2><p>æˆ‘ä»¬å¯èƒ½è¿˜æƒ³ä»æ–°é¡µé¢è¿”å›æ•°æ®ã€‚ å°±åƒä¸€ä¸ªè­¦æŠ¥åº”ç”¨ç¨‹åºï¼Œå¹¶ä¸ºè­¦æŠ¥è®¾ç½®ä¸€ä¸ªæ–°éŸ³è°ƒï¼Œæ‚¨å°†æ˜¾ç¤ºä¸€ä¸ªå¸¦æœ‰éŸ³é¢‘éŸ³è°ƒé€‰é¡¹åˆ—è¡¨çš„å¯¹è¯æ¡†ã€‚ æ˜¾ç„¶ï¼Œä¸€æ—¦å¼¹å‡ºå¯¹è¯æ¡†ï¼Œæ‚¨å°†éœ€è¦æ‰€é€‰çš„é¡¹ç›®æ•°æ®ã€‚ å®ƒå¯ä»¥è¿™æ ·å®ç°ï¼š</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">new</span> RaisedButton(onPressed: ()<span class="keyword">async</span>&#123;</span><br><span class="line">  <span class="built_in">String</span> value = <span class="keyword">await</span> Navigator.push(context, <span class="keyword">new</span> MaterialPageRoute&lt;<span class="built_in">String</span>&gt;(</span><br><span class="line">      builder: (BuildContext context) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> Center(</span><br><span class="line">          child: <span class="keyword">new</span> GestureDetector(</span><br><span class="line">              child: <span class="keyword">new</span> Text(<span class="string">'OK'</span>),</span><br><span class="line">              onTap: () &#123; Navigator.pop(context, <span class="string">"Audio1"</span>); &#125;</span><br><span class="line">          ),</span><br><span class="line">        );</span><br><span class="line">      &#125;</span><br><span class="line">  )</span><br><span class="line">  );</span><br><span class="line">  <span class="built_in">print</span>(value);</span><br><span class="line"></span><br><span class="line">&#125;,</span><br><span class="line">  child: <span class="keyword">new</span> Text(<span class="string">"Return"</span>),)</span><br></pre></td></tr></table></figure><p><em>åœ¨ <code>Screen4</code> ä¸­å°è¯•å¹¶æ£€æŸ¥æ§åˆ¶å°çš„æ‰“å°å€¼ã€‚</em></p><p>å¦è¯·æ³¨æ„ï¼šå½“è·¯ç”±ç”¨äºè¿”å›å€¼æ—¶ï¼Œè·¯ç”±çš„ç±»å‹å‚æ•°åº”ä¸ pop çš„ç»“æœç±»å‹åŒ¹é…ã€‚ è¿™é‡Œæˆ‘ä»¬éœ€è¦ä¸€ä¸ª String æ•°æ®ï¼Œæ‰€ä»¥æˆ‘ä»¬ä½¿ç”¨äº† <code>MaterialPageRoute &lt;String&gt;</code>ã€‚ ä¸æŒ‡å®šç±»å‹ä¹Ÿæ²¡å…³ç³»ã€‚</p><h1 id="å…¶ä»–æ•ˆæœè§£é‡Š"><a href="#å…¶ä»–æ•ˆæœè§£é‡Š" class="headerlink" title="å…¶ä»–æ•ˆæœè§£é‡Š"></a>å…¶ä»–æ•ˆæœè§£é‡Š</h1><h2 id="maybePop"><a href="#maybePop" class="headerlink" title="maybePop"></a>maybePop</h2><p>æºç ï¼š</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">static</span> Future&lt;<span class="built_in">bool</span>&gt; maybePop&lt;T <span class="keyword">extends</span> <span class="built_in">Object</span>&gt;(BuildContext context, [ T result ]) &#123;</span><br><span class="line">    <span class="keyword">return</span> Navigator.of(context).maybePop&lt;T&gt;(result);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@optionalTypeArgs</span></span><br><span class="line">  Future&lt;<span class="built_in">bool</span>&gt; maybePop&lt;T <span class="keyword">extends</span> <span class="built_in">Object</span>&gt;([ T result ]) <span class="keyword">async</span> &#123;</span><br><span class="line">    <span class="keyword">final</span> Route&lt;T&gt; route = _history.last;</span><br><span class="line">    <span class="keyword">assert</span>(route._navigator == <span class="keyword">this</span>);</span><br><span class="line">    <span class="keyword">final</span> RoutePopDisposition disposition = <span class="keyword">await</span> route.willPop();</span><br><span class="line">    <span class="keyword">if</span> (disposition != RoutePopDisposition.bubble &amp;&amp; mounted) &#123;</span><br><span class="line">      <span class="keyword">if</span> (disposition == RoutePopDisposition.pop)</span><br><span class="line">        pop(result);</span><br><span class="line">      <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure><p>å¦‚æœæˆ‘ä»¬åœ¨åˆå§‹è·¯ç”±ä¸Šå¹¶ä¸”æœ‰äººé”™è¯¯åœ°è¯•å›¾å¼¹å‡ºè¿™ä¸ªå”¯ä¸€é¡µé¢æ€ä¹ˆåŠï¼Ÿ å¼¹å‡ºå †æ ˆä¸­å”¯ä¸€çš„é¡µé¢å°†å…³é—­æ‚¨çš„åº”ç”¨ç¨‹åºï¼Œå› ä¸ºå®ƒåé¢å·²ç»æ²¡æœ‰é¡µé¢äº†ã€‚è¿™æ˜¾ç„¶æ˜¯ä¸å¥½çš„ä½“éªŒã€‚ è¿™å°±æ˜¯ <code>maybePop()</code> èµ·çš„ä½œç”¨ã€‚ ç‚¹å‡» <code>Screen1</code> ä¸Šçš„ <code>maybePop</code> æŒ‰é’®ï¼Œæ²¡æœ‰ä»»ä½•æ•ˆæœã€‚ åœ¨ <code>Screen3</code> ä¸Šå°è¯•ç›¸åŒçš„æ“ä½œï¼Œå¯ä»¥æ­£å¸¸å¼¹å‡ºã€‚</p><p>è¿™ç§æ•ˆæœä¹Ÿå¯é€šè¿‡ canPop å®ç°ï¼š</p><h2 id="canPop"><a href="#canPop" class="headerlink" title="canPop"></a>canPop</h2><p>æºç ï¼š</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">static</span> <span class="built_in">bool</span> canPop(BuildContext context) &#123;</span><br><span class="line">    <span class="keyword">final</span> NavigatorState navigator = Navigator.of(context, nullOk: <span class="keyword">true</span>);</span><br><span class="line">    <span class="keyword">return</span> navigator != <span class="keyword">null</span> &amp;&amp; navigator.canPop();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">bool</span> canPop() &#123;</span><br><span class="line">    <span class="keyword">assert</span>(_history.isNotEmpty);</span><br><span class="line">    <span class="keyword">return</span> _history.length &gt; <span class="number">1</span> || _history[<span class="number">0</span>].willHandlePopInternally;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure><p>å¦‚æœå ä¸­å®ä¾‹å¤§äº 1 æˆ– willHandlePopInternally å±æ€§ä¸º true è¿”å› trueï¼Œå¦åˆ™è¿”å› falseã€‚</p><p>æˆ‘ä»¬å¯ä»¥é€šè¿‡åˆ¤æ–­ canPop æ¥ç¡®å®šæ˜¯å¦èƒ½å¤Ÿå¼¹å‡ºè¯¥é¡µé¢ã€‚</p><h2 id="å¦‚ä½•å»é™¤é»˜è®¤è¿”å›æŒ‰é’®"><a href="#å¦‚ä½•å»é™¤é»˜è®¤è¿”å›æŒ‰é’®" class="headerlink" title="å¦‚ä½•å»é™¤é»˜è®¤è¿”å›æŒ‰é’®"></a>å¦‚ä½•å»é™¤é»˜è®¤è¿”å›æŒ‰é’®</h2><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">AppBar(&#123;</span><br><span class="line">    Key key,</span><br><span class="line">    <span class="keyword">this</span>.leading,</span><br><span class="line">    <span class="keyword">this</span>.automaticallyImplyLeading = <span class="keyword">true</span>,</span><br><span class="line">    <span class="keyword">this</span>.title,</span><br><span class="line">    <span class="keyword">this</span>.actions,</span><br><span class="line">    <span class="keyword">this</span>.flexibleSpace,</span><br><span class="line">    <span class="keyword">this</span>.bottom,</span><br><span class="line">    <span class="keyword">this</span>.elevation = <span class="number">4.0</span>,</span><br><span class="line">    <span class="keyword">this</span>.backgroundColor,</span><br><span class="line">    <span class="keyword">this</span>.brightness,</span><br><span class="line">    <span class="keyword">this</span>.iconTheme,</span><br><span class="line">    <span class="keyword">this</span>.textTheme,</span><br><span class="line">    <span class="keyword">this</span>.primary = <span class="keyword">true</span>,</span><br><span class="line">    <span class="keyword">this</span>.centerTitle,</span><br><span class="line">    <span class="keyword">this</span>.titleSpacing = NavigationToolbar.kMiddleSpacing,</span><br><span class="line">    <span class="keyword">this</span>.toolbarOpacity = <span class="number">1.0</span>,</span><br><span class="line">    <span class="keyword">this</span>.bottomOpacity = <span class="number">1.0</span>,</span><br><span class="line">  &#125;) : <span class="keyword">assert</span>(automaticallyImplyLeading != <span class="keyword">null</span>),</span><br><span class="line">       <span class="keyword">assert</span>(elevation != <span class="keyword">null</span>),</span><br><span class="line">       <span class="keyword">assert</span>(primary != <span class="keyword">null</span>),</span><br><span class="line">       <span class="keyword">assert</span>(titleSpacing != <span class="keyword">null</span>),</span><br><span class="line">       <span class="keyword">assert</span>(toolbarOpacity != <span class="keyword">null</span>),</span><br><span class="line">       <span class="keyword">assert</span>(bottomOpacity != <span class="keyword">null</span>),</span><br><span class="line">       preferredSize = Size.fromHeight(kToolbarHeight + (bottom?.preferredSize?.height ?? <span class="number">0.0</span>)),</span><br><span class="line">       <span class="keyword">super</span>(key: key);</span><br></pre></td></tr></table></figure><p>å°† <code>automaticallyImplyLeading</code>ç½®ä¸º <code>false</code></p><h1 id="å‚è€ƒé“¾æ¥"><a href="#å‚è€ƒé“¾æ¥" class="headerlink" title="å‚è€ƒé“¾æ¥"></a>å‚è€ƒé“¾æ¥</h1><p><a href="https://docs.flutter.io/flutter/widgets/Navigator-class.html" target="_blank" rel="noopener">https://docs.flutter.io/flutter/widgets/Navigator-class.html</a></p><p><a href="https://medium.com/flutter-community/flutter-push-pop-push-1bb718b13c31" target="_blank" rel="noopener">https://medium.com/flutter-community/flutter-push-pop-push-1bb718b13c31</a></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;è·¯ç”±åˆä½“éªŒ&quot;&gt;&lt;a href=&quot;#è·¯ç”±åˆä½“éªŒ&quot; class=&quot;headerlink&quot; title=&quot;è·¯ç”±åˆä½“éªŒ&quot;&gt;&lt;/a&gt;è·¯ç”±åˆä½“éªŒ&lt;/h1&gt;&lt;p&gt;è·¯ç”±ï¼ˆRoutesï¼‰æ˜¯ä»€ä¹ˆï¼Ÿè·¯ç”±æ˜¯å±å¹•æˆ–åº”ç”¨ç¨‹åºé¡µé¢çš„æŠ½è±¡ã€‚&lt;/p&gt;
&lt;p&gt;Flutter ä½¿æˆ‘ä»¬èƒ½å¤Ÿä¼˜é›…åœ°ç®¡ç†è·¯ç”±
      
    
    </summary>
    
      <category term="åŸåˆ›" scheme="https://meandni.com/categories/%E5%8E%9F%E5%88%9B/"/>
    
    
      <category term="flutterè¿›é˜¶" scheme="https://meandni.com/tags/flutter%E8%BF%9B%E9%98%B6/"/>
    
  </entry>
  
  <entry>
    <title>Flutterå®è·µï¼šæ·±å…¥ Flutter çš„çŠ¶æ€ç®¡ç†æ–¹å¼(3)â€”â€”Reduxä¸æ—…é€”å°ç»“</title>
    <link href="https://meandni.com/2019/02/09/flutter-state3/"/>
    <id>https://meandni.com/2019/02/09/flutter-state3/</id>
    <published>2019-02-09T08:54:54.000Z</published>
    <updated>2019-02-09T12:16:34.855Z</updated>
    
    <content type="html"><![CDATA[<p>è‡³æ­¤ï¼Œè¿™å·²ç»æ˜¯æ¢ç´¢ Flutter çŠ¶æ€ç®¡ç†æ–¹å¼æ–‡ç« çš„æœ€åä¸€ç¯‡ï¼ŒåŒæ—¶è¿™ä¹Ÿæ˜¯æ–°å¹´åçš„ç¬¬ä¸€ç¯‡æ–‡ç« ï¼Œä¹‹åæˆ‘å°†å°†ä»–ä»¬åº”ç”¨åœ¨å®é™…é¡¹ç›®ä¸­å¼€å‘å¹¶å°†å€¼çš„å­¦ä¹ çš„é¡¹ç›®å¼€æºå‡ºæ¥ã€‚å¯¹äºå…¶ä¸­è®²è§£å¯èƒ½æœ‰ç‚¹æµ…å°åˆ™æ­¢ï¼Œå› ä¸ºç»™å‡ºçš„å®ä¾‹ç›¸å¯¹ç®€å•ï¼Œä½†ç›¸ä¿¡èªæ˜çš„ç¨‹åºå‘˜éƒ½ä¼šæœ‰è‡ªå·±çš„å­¦ä¹ æ–¹æ³•ï¼Œä½ å¯ä»¥ä»ç»™å‡ºçš„å®ä¾‹ç»“åˆè‡ªå·±çš„æ‰€å­¦å¼•æ·±å‡ºæ›´å¥½çš„è®¾è®¡æ–¹æ³•ã€‚</p><p>åŒæ—¶è¦é€ç»™å¤§å®¶çš„å»ºè®®æ˜¯ï¼šè¯·åœ¨éœ€è¦è¿™äº›çŠ¶æ€ç®¡ç†æ–¹å¼æ—¶ä½¿ç”¨å®ƒï¼Œæˆ‘è§è¿‡ä¸å°‘çš„å¼€å‘è€…éƒ½æœ‰ç”¨å¤§åˆ€ç ç™½èœçš„æ„æ€ï¼Œè¿™å¹¶ä¸æ˜¯ä¸€ä¸ªå¥½ä¹ æƒ¯ï¼Œä½ ä¼šå‘ç°è¿™äº›çŠ¶æ€ç®¡ç†æ–¹å¼æœ‰æ—¶å€™ä¸ä½†ä¸ä¼šä½¿å¼€å‘ç®€å•ï¼Œå…¶å®è¿˜ä¼šåŠ å¤§ä»£ç é‡ï¼Œä½¿å…¶å˜å¾—å¤æ‚ï¼Œå¯¹äºå¦‚ä½•é€‰æ‹©ï¼Œè¿™é‡Œè¿˜ä¸å¤Ÿè¯´æ¸…æ¥šï¼Œå¸Œæœ›ä½ ä»¬éƒ½èƒ½æ‰¾åˆ°è‡ªå·±çš„ç®¡ç†åº”ç”¨ç¨‹åºçš„æ–¹å¼ã€‚</p><p>æ‰€æœ‰å®ä¾‹ï¼š</p><p> github åœ°å€ï¼š<a href="https://github.com/MeandNi/Flutter_StateManagement" target="_blank" rel="noopener">https://github.com/MeandNi/Flutter_StateManagement</a></p><ul><li><a href="https://github.com/MeandNi/Flutter_StateManagement/tree/master/lib/inheritedValue" target="_blank" rel="noopener">InheritedWidget</a></li><li><a href="https://github.com/MeandNi/Flutter_StateManagement/tree/master/lib/scoped" target="_blank" rel="noopener">ScopedModel</a></li><li><a href="https://github.com/MeandNi/Flutter_StateManagement/tree/master/lib/bloc_counter" target="_blank" rel="noopener">bloc_counter</a></li><li><a href="https://github.com/MeandNi/Flutter_StateManagement/tree/master/lib/bloc_cart" target="_blank" rel="noopener">bloc_cart</a></li><li><a href="https://github.com/MeandNi/Flutter_StateManagement/tree/master/lib/bloc_inherited" target="_blank" rel="noopener">bloc with inherited</a></li><li><a href="https://github.com/MeandNi/Flutter_StateManagement/tree/master/lib/redux_counter" target="_blank" rel="noopener">Redux_counter</a></li><li><a href="https://github.com/MeandNi/Flutter_StateManagement/tree/master/lib/redux_cart" target="_blank" rel="noopener">Redux_Cart</a></li></ul><hr><p>Redux ç”± Facebook 2015å¹´æå‡ºï¼Œæ˜¯åŸºäº Flux ç†å¿µå®ç°çš„ä¸€ä¸ªå“åº”å¼æ¡†æ¶çš„çŠ¶æ€ç®¡ç†æ–¹å¼ï¼Œæœ€æ—©åº”ç”¨äº React ä¸­ï¼Œè€Œå React Native ã€ Flutter ç­‰å¤šä¸ªæ¡†æ¶ä¹ŸåŒæ ·å¯ä»¥ä½¿ç”¨ã€‚</p><p>å­¦ä¹  Redux ä¹‹å‰ï¼Œè¯·äº†è§£ Redux æ‰€èƒ½åšåˆ°çš„äº‹æƒ…ï¼š</p><ul><li>å•ä¸€çŠ¶æ€æ¥æºï¼šæ•´ä¸ªåº”ç”¨ç¨‹åºçš„çŠ¶æ€å­˜å‚¨åœ¨å•ä¸ªçš„å¯¹è±¡æ ‘ä¸­ã€‚</li><li>çŠ¶æ€åªè¯»ï¼šæ›´æ”¹çŠ¶æ€çš„å”¯ä¸€æ–¹æ³•æ˜¯å‘å‡ºä¸€ä¸ª actionï¼ˆä¸€ä¸ªæè¿°å‘ç”Ÿä»€ä¹ˆäº‹ä»¶çš„å¯¹è±¡ï¼‰ã€‚</li><li>ä½¿ç”¨çº¯å‡½æ•°æ›´æ”¹çŠ¶æ€ï¼šé€šè¿‡ reducersï¼ŒçŠ¶æ€çŸ¥é“å¦‚ä½•é€šè¿‡æ“ä½œè¿›è¡Œæ”¹å˜ï¼Œreducersä¾¿æ˜¯ä¸€ä¸ªçº¯å‡½æ•°ã€‚</li></ul><figure class="image-bubble">                <div class="img-lightbox">                    <div class="overlay"></div>                    <img src="/images/redux1.png" alt="" title="">                </div>                <div class="image-caption"></div>            </figure><p>å¦‚æœä½ ç”¨è¿‡ React ï¼Œç›¸ä¿¡ä½ å¯¹ä¸Šé¢çš„æ¦‚å¿µå·²ç»å¾ˆæ¸…æ™°äº†ï¼Œæ²¡ä½¿ç”¨è¿‡ï¼Ÿä¹Ÿ OKï¼Œä¸‹é¢æ…¢æ…¢é“æ¥â€¦.</p><p>æ•´ä½“çš„æ€è·¯ï¼šæ‰€æœ‰çŠ¶æ€å­˜æ”¾åœ¨ store ä¸­ï¼ŒRedux å°† store å†…æ‰€æœ‰çŠ¶æ€æ”¾å…¥å¯¹åº”çš„ç»„ä»¶ä¸­å‘ˆç°åœ¨ Ui ä¸Šï¼Œç”¨æˆ·ä¸ UI äº¤äº’ï¼ˆå¦‚ç‚¹å‡»ï¼‰å‘èµ·ä¸€ä¸ª actionï¼ˆä¸€ä¸ªæè¿°è¡Œä¸ºçš„å¯¹è±¡ï¼‰ï¼Œstore å¯åˆ¤åˆ« actionç±»å‹å¹¶ä½œç”¨ç›¸åº”çš„ reducerï¼ˆæ“ä½œæ”¹å˜çŠ¶æ€çš„çº¯å‡½æ•°ï¼‰ï¼Œreducer å®Œæˆç›¸åº”æ”¹å˜åå°†æ•°æ®æ”¾åˆ°å…¨å±€çš„ store ä¸­ï¼Œå®ç°æ”¹å˜ã€‚</p><figure class="image-bubble">                <div class="img-lightbox">                    <div class="overlay"></div>                    <img src="/images/redux2.png" alt="" title="">                </div>                <div class="image-caption"></div>            </figure><p>æ€è·¯ç®€å•ï¼Œæè¿°èµ·æ¥è›®å¤æ‚ï¼Œå…¶å®å®ƒçš„ç›®çš„å°±æ˜¯å®ç°ä»£ç ä½œç”¨åŸŸçš„åˆ†ç¦»ã€‚</p><p>é‚£ä¹ˆå¦‚ä½•è®©å°†ä»¥ä¸Šæè¿°åº”ç”¨äºå®é™…çš„åº”ç”¨ç¨‹åºä¸­å‘¢ï¼Ÿ</p><h2 id="redux-å®ç°è®¡æ•°å™¨åº”ç”¨"><a href="#redux-å®ç°è®¡æ•°å™¨åº”ç”¨" class="headerlink" title="redux å®ç°è®¡æ•°å™¨åº”ç”¨"></a>redux å®ç°è®¡æ•°å™¨åº”ç”¨</h2><p>å…¶ä¸­çš„å®ç°ä¸ ScopedModel å¾ˆç›¸ä¼¼ï¼Œ<strong>æŠ“ä½ä¸¤ä¸ªè¦ç‚¹ï¼Œå¦‚ä½•åœ¨ UI ä¸­å‘ˆç°ä»¥åŠå¦‚ä½• å‘èµ· action æ”¹å˜çŠ¶æ€ã€‚</strong></p><p>æˆ‘ä»¬é¦–å…ˆå®šä¹‰ ä¸€ä¸ªå…¨å±€çŠ¶æ€ AppStateï¼š</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@immutable</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">AppState</span> </span>&#123;</span><br><span class="line">  <span class="keyword">final</span> counter;</span><br><span class="line">  AppState(<span class="keyword">this</span>.counter);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>é‡Œé¢æœ‰ä¸€ä¸ª counter å˜é‡ç”¨äºè®¡æ•°ã€‚</p><h3 id="Action"><a href="#Action" class="headerlink" title="Action"></a>Action</h3><p>å¦‚å‰é¢æ‰€è¿°ï¼ŒState çš„å˜åŒ–ï¼Œä¼šå¯¼è‡´ UI çš„å˜åŒ–ã€‚ä½†æ˜¯ï¼Œç”¨æˆ·æ¥è§¦ä¸åˆ° Stateï¼Œåªèƒ½æ¥è§¦åˆ° UIã€‚æ‰€ä»¥ï¼ŒState çš„å˜åŒ–å¿…é¡»æ˜¯ UI å¯¼è‡´çš„ã€‚Action å°±æ˜¯ UI å‘å‡ºçš„é€šçŸ¥ï¼Œè¡¨ç¤º State åº”è¯¥è¦å‘ç”Ÿå˜åŒ–äº†ã€‚</p><p>æˆ‘ä»¬è¿™é‡Œæœ‰ä¸€ä¸ªä¿ƒä½¿ counter å¢åŠ çš„ actionï¼š</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">enum</span> Actions &#123; Increment &#125;</span><br></pre></td></tr></table></figure><h3 id="reducer"><a href="#reducer" class="headerlink" title="reducer"></a>reducer</h3><p>Store æ”¶åˆ° Action ä»¥åï¼Œå¿…é¡»ç»™å‡ºä¸€ä¸ªæ–°çš„ Stateï¼Œè¿™æ · View æ‰ä¼šå‘ç”Ÿå˜åŒ–ã€‚è¿™ç§ State çš„è®¡ç®—è¿‡ç¨‹å°±å«åš Reducerã€‚</p><p>Reducer æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œå®ƒæ¥å— Action å’Œå½“å‰ State ä½œä¸ºå‚æ•°ï¼Œè¿”å›ä¸€ä¸ªæ–°çš„ Stateã€‚</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">AppState reducer(AppState prev, action) &#123;</span><br><span class="line">  <span class="keyword">if</span> (action == Actions.Increment) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> AppState(prev.counter + <span class="number">1</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> prev;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>reducer ä¸­åˆ¤æ–­äº† action æ—¶ Increment è¿™ä¸€ç±»å‹ï¼Œå°†ä¸€ä¸ªæ–°çš„ AppState è¿”å›åˆ° storeã€‚</p><h3 id="åœ¨-UI-ä¸­å‘ˆç°-StoreConnector"><a href="#åœ¨-UI-ä¸­å‘ˆç°-StoreConnector" class="headerlink" title="åœ¨ UI ä¸­å‘ˆç°(StoreConnector)"></a>åœ¨ UI ä¸­å‘ˆç°(StoreConnector)</h3><p>é¦–å…ˆåˆå§‹åŒ–çŠ¶æ€ï¼š</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">final</span> store = <span class="keyword">new</span> Store(reducer, initialState: <span class="keyword">new</span> AppState(<span class="number">0</span>));</span><br></pre></td></tr></table></figure><p>ç„¶åæ˜¾ç¤ºçŠ¶æ€ï¼š</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">new</span> StoreConnector(</span><br><span class="line">  converter: (store) =&gt; store.state.counter,</span><br><span class="line">  builder: (context, counter) =&gt; <span class="keyword">new</span> Text(</span><br><span class="line">    <span class="string">'$counter'</span>,</span><br><span class="line">    style: Theme.of(context).textTheme.display1,</span><br><span class="line">  ),</span><br><span class="line">)</span><br></pre></td></tr></table></figure><p>é€šè¿‡ converter å±æ€§æ‹¿åˆ° state ä¸­çš„ counter å±æ€§ã€‚</p><p>ç„¶åä¼ å…¥ builder åº”ç”¨åœ¨ç»„ä»¶ä¸­ã€‚</p><h3 id="å‘èµ·-action-æ”¹å˜çŠ¶æ€"><a href="#å‘èµ·-action-æ”¹å˜çŠ¶æ€" class="headerlink" title="å‘èµ· action æ”¹å˜çŠ¶æ€"></a>å‘èµ· action æ”¹å˜çŠ¶æ€</h3><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">new</span> StoreConnector(</span><br><span class="line">    converter: (store) &#123;</span><br><span class="line">      <span class="keyword">return</span> () =&gt; store.dispatch(Actions.Increment);</span><br><span class="line">    &#125;,</span><br><span class="line">    builder: (context, callback) =&gt; <span class="keyword">new</span> FloatingActionButton(</span><br><span class="line">      onPressed: callback,</span><br><span class="line">      tooltip: <span class="string">'Increment'</span>,</span><br><span class="line">      child: <span class="keyword">new</span> Icon(Icons.add),</span><br><span class="line">    ), </span><br><span class="line">),</span><br></pre></td></tr></table></figure><p>åŒæ ·æ˜¯ä½¿ç”¨ StoreConnectorï¼Œç„¶è€Œè¿™æ¬¡é€šè¿‡ converter æ‹¿åˆ°çš„æ˜¯ä¸€ä¸ª <code>store.dispatch(Actions.Increment)</code>ï¼Œ<code>store.dispatch()</code>æ˜¯ View å‘å‡º Action çš„å”¯ä¸€æ–¹æ³•ã€‚è€Œååœ¨ç»„ä»¶ä¸­è°ƒç”¨è¯¥å›è°ƒæ–¹æ³•å³å¯ã€‚</p><h3 id="å®Œæ•´ä»£ç "><a href="#å®Œæ•´ä»£ç " class="headerlink" title="å®Œæ•´ä»£ç "></a>å®Œæ•´ä»£ç </h3><p>å®Œæ•´ä»£ç è¢«æ”¾åœ¨ä¸€ä¸ªæ–‡ä»¶ä¸­ï¼š<a href="https://github.com/MeandNi/Flutter_StateManagement/blob/master/lib/redux/main.dart" target="_blank" rel="noopener">æ ·ä¾‹ä»£ç </a></p><p>Redux åº”ç”¨åœ¨ ShoppingCartï¼š<a href="https://github.com/MeandNi/Flutter_StateManagement/tree/master/lib/redux_cart" target="_blank" rel="noopener">æ ·ä¾‹ä»£ç </a></p><figure class="image-bubble">                <div class="img-lightbox">                    <div class="overlay"></div>                    <img src="/images/redux6.png" alt="" title="">                </div>                <div class="image-caption"></div>            </figure><figure class="image-bubble">                <div class="img-lightbox">                    <div class="overlay"></div>                    <img src="/images/redux5.gif" alt="" title="">                </div>                <div class="image-caption"></div>            </figure><h2 id="å°†-Redux-ç”¨äºæ›´å¤æ‚çš„åº”ç”¨ä¸­"><a href="#å°†-Redux-ç”¨äºæ›´å¤æ‚çš„åº”ç”¨ä¸­" class="headerlink" title="å°† Redux ç”¨äºæ›´å¤æ‚çš„åº”ç”¨ä¸­"></a>å°† Redux ç”¨äºæ›´å¤æ‚çš„åº”ç”¨ä¸­</h2><p>åœ¨å¤æ‚çš„åº”ç”¨ä¸­æˆ‘ä»¬å¯ä»¥å°†åº”ç”¨ç¨‹åºä¸­çš„ reducer æ ¹æ®ä¸šåŠ¡ç±»å‹åˆ†ç¦»ï¼Œä¾‹å¦‚ç”¨æˆ·ä¿¡æ¯ã€äº§å“ä¿¡æ¯ç­‰ä¸åŒä¸šåŠ¡çš„æ“ä½œåˆ†ç¦»åˆ°å•ç‹¬çš„æ¨¡å—ï¼Œ</p><figure class="image-bubble">                <div class="img-lightbox">                    <div class="overlay"></div>                    <img src="/images/redux3.png" alt="" title="">                </div>                <div class="image-caption"></div>            </figure><p>è€Œåå°†å…¶åˆå¹¶ï¼š</p><figure class="image-bubble">                <div class="img-lightbox">                    <div class="overlay"></div>                    <img src="/images/redux4.png" alt="" title="">                </div>                <div class="image-caption"></div>            </figure><p>å®ç°ä¸Šçœ‹çš„åˆ†ç¦»åï¼Œåˆå¯åªå°†ç›¸åº”ä¸šåŠ¡çš„æ•°æ®æ”¾åˆ°ç›¸åº”ä¸šåŠ¡æ ¹ widgetï¼ˆå…¶å­ç»„ä»¶çš„æ‰€æœ‰æ•°æ®å’Œæ“ä½œæ¥è‡ªè¯¥æ ¹ç»„ä»¶ï¼‰</p><p>æˆ‘ä»¬å°†éœ€è¦çš„æ•°æ®åŠæ“ä½œåˆ°ä¸€ä¸ªå¯¹è±¡ä¸­ï¼Œä¼ é€’åˆ°ç»„ä»¶ä¸­ï¼š</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">DeviceFragment</span> <span class="keyword">extends</span> <span class="title">StatelessWidget</span> </span>&#123;</span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  Widget build(BuildContext context) &#123;</span><br><span class="line">    <span class="keyword">return</span> Scaffold(</span><br><span class="line">      body: <span class="keyword">new</span> StoreConnector&lt;AppState, _ViewModel&gt;(</span><br><span class="line">          converter: _ViewModel.fromStore,</span><br><span class="line">          builder: (context, vm) &#123;</span><br><span class="line">            <span class="keyword">return</span> DeviceList(</span><br><span class="line">              devices: vm.devices,</span><br><span class="line">              onStateChanged: vm.onStateChanged,</span><br><span class="line">              onRemove: vm.onRemove,</span><br><span class="line">              onUndoRemove: vm.onUndoRemove,</span><br><span class="line">            );</span><br><span class="line">          &#125;),</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">_ViewModel</span> </span>&#123;</span><br><span class="line">  <span class="keyword">final</span> <span class="built_in">List</span>&lt;Device&gt; devices;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// final bool loading;</span></span><br><span class="line">  <span class="keyword">final</span> <span class="built_in">Function</span>(Device) onStateChanged;</span><br><span class="line">  <span class="keyword">final</span> <span class="built_in">Function</span>(Device) onRemove;</span><br><span class="line">  <span class="keyword">final</span> <span class="built_in">Function</span>(Device) onUndoRemove;</span><br><span class="line"></span><br><span class="line">  _ViewModel(&#123;</span><br><span class="line">    <span class="meta">@required</span> <span class="keyword">this</span>.devices,</span><br><span class="line">    <span class="comment">// @required this.loading,</span></span><br><span class="line">    <span class="meta">@required</span> <span class="keyword">this</span>.onStateChanged,</span><br><span class="line">    <span class="meta">@required</span> <span class="keyword">this</span>.onRemove,</span><br><span class="line">    <span class="meta">@required</span> <span class="keyword">this</span>.onUndoRemove,</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">static</span> _ViewModel fromStore(Store&lt;AppState&gt; store) &#123;</span><br><span class="line">    <span class="keyword">return</span> _ViewModel(</span><br><span class="line">      devices: store.state.devices,</span><br><span class="line">      <span class="comment">// loading: store.state.isLoading,</span></span><br><span class="line">      onStateChanged: (device) &#123;</span><br><span class="line">        store.dispatch(editItem(device.copyWith(state: !device.state)));</span><br><span class="line">      &#125;,</span><br><span class="line">      onRemove: (device) &#123;</span><br><span class="line">        store.dispatch(deleteDevice(device));</span><br><span class="line">      &#125;,</span><br><span class="line">      onUndoRemove: (device) &#123;</span><br><span class="line">        store.dispatch(AddDeviceAction(device));</span><br><span class="line">      &#125;,</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™æ ·ä½¿å¾—äº§ç”Ÿæ¨¡å—åŒ–ç®¡ç†çš„æ€æƒ³ï¼ï¼ˆä»¥ä¸Šå®ä¾‹æ¥è‡ªæ­£åœ¨å¼€å‘çš„ä¸€ä¸ªçœŸå®é¡¹ç›®ï¼Œç›®å‰è¿˜æœªå¼€æºã€‚ï¼‰</p><p>åŒæ—¶ï¼Œåœ¨å®é™…çš„åº”ç”¨ç¨‹åºä¸­ï¼Œä½ ä¸€å®šéœ€è¦åœ¨ç¨‹åºå¯åŠ¨åˆæœŸæ¥åŠ è½½æ¥è‡ªäº‘ç«¯æˆ–è€…æ•°æ®æœ¬åœ°çš„æ•°æ®ï¼Œä½ å¯ä»¥åœ¨å…¥å£çš„é¡µé¢ä¸­æ¥å—ä¸€ä¸ªåŠ è½½æ•°æ®çš„å‡½æ•°ï¼Œæ”¾å…¥ initState å‡½æ•°ä¸­ã€‚</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;è‡³æ­¤ï¼Œè¿™å·²ç»æ˜¯æ¢ç´¢ Flutter çŠ¶æ€ç®¡ç†æ–¹å¼æ–‡ç« çš„æœ€åä¸€ç¯‡ï¼ŒåŒæ—¶è¿™ä¹Ÿæ˜¯æ–°å¹´åçš„ç¬¬ä¸€ç¯‡æ–‡ç« ï¼Œä¹‹åæˆ‘å°†å°†ä»–ä»¬åº”ç”¨åœ¨å®é™…é¡¹ç›®ä¸­å¼€å‘å¹¶å°†å€¼çš„å­¦ä¹ çš„é¡¹ç›®å¼€æºå‡ºæ¥ã€‚å¯¹äºå…¶ä¸­è®²è§£å¯èƒ½æœ‰ç‚¹æµ…å°åˆ™æ­¢ï¼Œå› ä¸ºç»™å‡ºçš„å®ä¾‹ç›¸å¯¹ç®€å•ï¼Œä½†ç›¸ä¿¡èªæ˜çš„ç¨‹åºå‘˜éƒ½ä¼šæœ‰è‡ªå·±çš„å­¦ä¹ æ–¹æ³•ï¼Œä½ å¯ä»¥ä»ç»™å‡ºçš„å®ä¾‹ç»“åˆè‡ª
      
    
    </summary>
    
      <category term="åŸåˆ›" scheme="https://meandni.com/categories/%E5%8E%9F%E5%88%9B/"/>
    
    
      <category term="flutterå®æˆ˜" scheme="https://meandni.com/tags/flutter%E5%AE%9E%E6%88%98/"/>
    
  </entry>
  
  <entry>
    <title>Flutterå®è·µï¼šæ·±å…¥ Flutter çš„çŠ¶æ€ç®¡ç†æ–¹å¼(2)â€”â€”æ¼”åŒ–BloC</title>
    <link href="https://meandni.com/2019/02/02/flutter-state1/"/>
    <id>https://meandni.com/2019/02/02/flutter-state1/</id>
    <published>2019-02-02T04:34:27.000Z</published>
    <updated>2019-02-02T08:29:50.348Z</updated>
    
    <content type="html"><![CDATA[<p>åœ¨ä¸Šç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘è¯¦ç»†ä»‹ç»äº† InheritedWidget åŠ ScopedModel å®ç°åŸç†ä¸æ–¹æ³•ï¼Œæœ‰åŒå­¦è¯´æ‰¾ä¸åˆ°æºç ï¼Œå…¶å®ä¸Šç¯‡æ–‡ç« åŒ…æ‹¬è¿™ç¯‡æ–‡ç« é‡Œçš„æºç éƒ½æŒ‰æ­¥éª¤æ”¾åœ¨<a href="https://github.com/MeandNi/Flutter_StatePro" target="_blank" rel="noopener">æ ·ä¾‹ä»£ç </a>é‡Œäº†ï¼Œæœ‰åŒå­¦è¯´æœ‰ç‚¹æ‡µï¼Œå…¶å®ä¸Šä¸€ç¯‡çš„æ¦‚å¿µè¿‡å¤šè€Œä¸”æœ¬èº«æˆ‘è¡¨è¾¾ä¹Ÿä¸æ˜¯å¾ˆæ¸…æ™°ï¼Œè‹±æ–‡æ–‡æ¡£ä¸­æˆ‘ä¹Ÿè§£é‡Šçš„æ²¡æœ‰å®Œå…¨è¯­ä¹‰åŒ–ï¼Œæ‰€ä»¥è¿˜è¯·è°…è§£ï¼Œ<strong>ç»“åˆå®é™…ä»£ç ä½ ä¼šæœ‰æ›´å¥½åœ°ç†è§£</strong>ã€‚</p><p>è¿™ç¯‡çš„é‡ç‚¹æˆ‘å°†æ”¾åœ¨ BloC çš„å®ç°ä¸Šé¢ï¼Œæˆ‘ä»¬å·²ç»çŸ¥é“ Strems çš„æ¦‚å¿µï¼ŒRXDart æ˜¯ä¾èµ– Streams ä½¿ç”¨çš„è¾“å…¥ï¼ˆ<em>Sink</em>ï¼‰å’Œè¾“å‡ºï¼ˆ<em>stream</em>ï¼‰å°è£…è€Œæˆçš„å“åº”å¼åº“ï¼ŒBloC åŸºäºæ­¤ä¾¿å¯ä»¥å®æ—¶ä¾¦å¬æ•°æ®çš„å˜åŒ–è€Œæ”¹å˜æ•°æ®ï¼Œå¹¶ä¸”ï¼ŒBloC ä¸»è¦è§£å†³çš„é—®é¢˜å°±æ˜¯ä»–ä¸ä¼šä¸€åˆ€åˆ‡çš„æ›´æ–°æ•´ä¸ªçŠ¶æ€æ ‘ï¼Œå®ƒå…³æ³¨çš„æ˜¯æ•°æ®ï¼Œç»è¿‡ä¸€ç³»åˆ—å¤„ç†åå¾—åˆ°å®ƒå¹¶ä¸”åªæ”¹å˜åº”ç”¨å®ƒçš„ widgetã€‚</p><figure class="image-bubble">                <div class="img-lightbox">                    <div class="overlay"></div>                    <img src="/images/flutterstate2.png" alt="" title="">                </div>                <div class="image-caption"></div>            </figure><h3 id="å¦‚ä½•å°†-Stream-ä¸­çš„æ•°æ®åº”ç”¨åˆ°-Widgetï¼Ÿ"><a href="#å¦‚ä½•å°†-Stream-ä¸­çš„æ•°æ®åº”ç”¨åˆ°-Widgetï¼Ÿ" class="headerlink" title="å¦‚ä½•å°† Stream ä¸­çš„æ•°æ®åº”ç”¨åˆ° Widgetï¼Ÿ"></a>å¦‚ä½•å°† Stream ä¸­çš„æ•°æ®åº”ç”¨åˆ° Widgetï¼Ÿ</h3><p>æˆ‘ä»¬å…ˆæ¥å®è·µä¸€ä¸‹å¦‚ä½•åœ¨ widget ä¸­ä½¿ç”¨æ•°æ®ã€‚Flutter æä¾›äº†ä¸€ä¸ªåä¸º <a href="https://docs.flutter.io/flutter/widgets/StreamBuilder-class.html" target="_blank" rel="noopener">StreamBuilder</a> çš„ StatefulWidgetã€‚</p><p>StreamBuilder ç›‘å¬ Streamï¼Œæ¯å½“ä¸€äº›æ•°æ®æµå‡º Stream æ—¶ï¼Œå®ƒä¼šè‡ªåŠ¨é‡å»ºï¼Œè°ƒç”¨å…¶æ„å»ºå™¨å›è°ƒã€‚</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">StreamBuilder&lt;T&gt;(</span><br><span class="line">    key: ...optional, the unique ID of <span class="keyword">this</span> Widget...</span><br><span class="line">    stream: ...the stream to listen to...</span><br><span class="line">    initialData: ...any initial data, <span class="keyword">in</span> <span class="keyword">case</span> the stream would initially be empty...</span><br><span class="line">    builder: (BuildContext context, AsyncSnapshot&lt;T&gt; snapshot)&#123;</span><br><span class="line">        <span class="keyword">if</span> (snapshot.hasData)&#123;</span><br><span class="line">            <span class="keyword">return</span> ...the Widget to be built based on snapshot.data</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ...the Widget to be built <span class="keyword">if</span> no data <span class="keyword">is</span> available</span><br><span class="line">    &#125;,</span><br><span class="line">)</span><br></pre></td></tr></table></figure><p>ä»¥ä¸‹ç¤ºä¾‹ä½¿ç”¨ Stream è€Œä¸æ˜¯ setState() æ¨¡æ‹Ÿé»˜è®¤çš„â€œè®¡æ•°å™¨â€åº”ç”¨ç¨‹åºï¼š</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="string">'dart:async'</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="string">'package:flutter/material.dart'</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">CounterPage</span> <span class="keyword">extends</span> <span class="title">StatefulWidget</span> </span>&#123;</span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  _CounterPageState createState() =&gt; _CounterPageState();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">_CounterPageState</span> <span class="keyword">extends</span> <span class="title">State</span>&lt;<span class="title">CounterPage</span>&gt; </span>&#123;</span><br><span class="line">  <span class="built_in">int</span> _counter = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">final</span> StreamController&lt;<span class="built_in">int</span>&gt; _streamController = StreamController&lt;<span class="built_in">int</span>&gt;();</span><br><span class="line"></span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  <span class="keyword">void</span> dispose()&#123;</span><br><span class="line">    _streamController.close();</span><br><span class="line">    <span class="keyword">super</span>.dispose();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  Widget build(BuildContext context) &#123;</span><br><span class="line">    <span class="keyword">return</span> Scaffold(</span><br><span class="line">      appBar: AppBar(title: Text(<span class="string">'Stream version of the Counter App'</span>)),</span><br><span class="line">      body: Center(</span><br><span class="line">        child: StreamBuilder&lt;<span class="built_in">int</span>&gt;(</span><br><span class="line">          stream: _streamController.stream,</span><br><span class="line">          initialData: _counter,</span><br><span class="line">          builder: (BuildContext context, AsyncSnapshot&lt;<span class="built_in">int</span>&gt; snapshot)&#123;</span><br><span class="line">            <span class="keyword">return</span> Text(<span class="string">'You hit me: <span class="subst">$&#123;snapshot.data&#125;</span> times'</span>);</span><br><span class="line">          &#125;</span><br><span class="line">        ),</span><br><span class="line">      ),</span><br><span class="line">      floatingActionButton: FloatingActionButton(</span><br><span class="line">        child: <span class="keyword">const</span> Icon(Icons.add),</span><br><span class="line">        onPressed: ()&#123;</span><br><span class="line">          _streamController.sink.add(++_counter);</span><br><span class="line">        &#125;,</span><br><span class="line">      ),</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>ç¬¬24-30è¡Œï¼šæˆ‘ä»¬ç›‘å¬æµï¼Œæ¯æ¬¡æœ‰ä¸€ä¸ªæ–°å€¼æµå‡ºè¿™ä¸ªæµæ—¶ï¼Œæˆ‘ä»¬ç”¨è¯¥å€¼æ›´æ–° Text;</li><li>ç¬¬35è¡Œï¼šå½“æˆ‘ä»¬ç‚¹å‡» FloatingActionButton æ—¶ï¼Œæˆ‘ä»¬é€’å¢è®¡æ•°å™¨å¹¶é€šè¿‡æ¥æ”¶å™¨å°†å…¶å‘é€åˆ° Stream; ä¾¦å¬å®ƒçš„ StreamBuilder æ³¨å…¥äº†è¯¥å€¼ç›¸åº”åˆ°åé‡å»ºå¹¶â€œåˆ·æ–°â€è®¡æ•°å™¨;</li><li>æˆ‘ä»¬ä¸å†éœ€è¦ Stateï¼Œæ‰€æœ‰ä¸œè¥¿éƒ½å¯ä»¥é€šè¿‡ Stream æ¥å—;</li><li>è¿™é‡Œå®ç°äº†ç›¸å½“å¤§çš„ä¼˜åŒ–ï¼Œå› ä¸ºè°ƒç”¨ setState() æ–¹æ³•ä¼šå¼ºåˆ¶æ•´ä¸ª Widgetï¼ˆå’Œä»»ä½•å­ç»„ä»¶ï¼‰é‡æ–°æ¸²æŸ“ã€‚ è€Œåœ¨è¿™é‡Œï¼Œåªé‡å»º StreamBuilderï¼ˆå½“ç„¶è¿˜æœ‰å…¶å­ç»„ä»¶ï¼‰;</li><li>æˆ‘ä»¬ä»éœ€è¦ä½¿ç”¨ StatefulWidget çš„å”¯ä¸€åŸå› ï¼Œä»…ä»…æ˜¯å› ä¸ºæˆ‘ä»¬éœ€è¦é€šè¿‡ dispose æ–¹æ³•ç¬¬15è¡Œé‡Šæ”¾StreamController;</li></ul><h3 id="å®ç°çœŸæ­£çš„-BloC"><a href="#å®ç°çœŸæ­£çš„-BloC" class="headerlink" title="å®ç°çœŸæ­£çš„ BloC"></a>å®ç°çœŸæ­£çš„ BloC</h3><p>æ˜¯æ—¶å€™å±•ç°çœŸæ­£çš„è®¡æŠ€æœ¯äº†ï¼Œæˆ‘ä»¬ä¾ç„¶å°† BloC ç”¨äºé»˜è®¤çš„è®¡æ•°å™¨åº”ç”¨ä¸­ï¼š</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">void</span> main() =&gt; runApp(<span class="keyword">new</span> MyApp());</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyApp</span> <span class="keyword">extends</span> <span class="title">StatelessWidget</span> </span>&#123;</span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  Widget build(BuildContext context) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> MaterialApp(</span><br><span class="line">        title: <span class="string">'Streams Demo'</span>,</span><br><span class="line">        theme: <span class="keyword">new</span> ThemeData(</span><br><span class="line">          primarySwatch: Colors.blue,</span><br><span class="line">        ),</span><br><span class="line">        home: BlocProvider&lt;IncrementBloc&gt;(</span><br><span class="line">          bloc: IncrementBloc(),</span><br><span class="line">          child: CounterPage(),</span><br><span class="line">        ),</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">CounterPage</span> <span class="keyword">extends</span> <span class="title">StatelessWidget</span> </span>&#123;</span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  Widget build(BuildContext context) &#123;</span><br><span class="line">    <span class="keyword">final</span> IncrementBloc bloc = BlocProvider.of&lt;IncrementBloc&gt;(context);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> Scaffold(</span><br><span class="line">      appBar: AppBar(title: Text(<span class="string">'Stream version of the Counter App'</span>)),</span><br><span class="line">      body: Center(</span><br><span class="line">        child: StreamBuilder&lt;<span class="built_in">int</span>&gt;(</span><br><span class="line">          stream: bloc.outCounter,</span><br><span class="line">          initialData: <span class="number">0</span>,</span><br><span class="line">          builder: (BuildContext context, AsyncSnapshot&lt;<span class="built_in">int</span>&gt; snapshot)&#123;</span><br><span class="line">            <span class="keyword">return</span> Text(<span class="string">'You hit me: <span class="subst">$&#123;snapshot.data&#125;</span> times'</span>);</span><br><span class="line">          &#125;</span><br><span class="line">        ),</span><br><span class="line">      ),</span><br><span class="line">      floatingActionButton: FloatingActionButton(</span><br><span class="line">        child: <span class="keyword">const</span> Icon(Icons.add),</span><br><span class="line">        onPressed: ()&#123;</span><br><span class="line">          bloc.incrementCounter.add(<span class="keyword">null</span>);</span><br><span class="line">        &#125;,</span><br><span class="line">      ),</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">IncrementBloc</span> <span class="keyword">implements</span> <span class="title">BlocBase</span> </span>&#123;</span><br><span class="line">  <span class="built_in">int</span> _counter;</span><br><span class="line"></span><br><span class="line">  <span class="comment">//</span></span><br><span class="line">  <span class="comment">// Stream to handle the counter</span></span><br><span class="line">  <span class="comment">//</span></span><br><span class="line">  StreamController&lt;<span class="built_in">int</span>&gt; _counterController = StreamController&lt;<span class="built_in">int</span>&gt;();</span><br><span class="line">  StreamSink&lt;<span class="built_in">int</span>&gt; <span class="keyword">get</span> _inAdd =&gt; _counterController.sink;</span><br><span class="line">  Stream&lt;<span class="built_in">int</span>&gt; <span class="keyword">get</span> outCounter =&gt; _counterController.stream;</span><br><span class="line"></span><br><span class="line">  <span class="comment">//</span></span><br><span class="line">  <span class="comment">// Stream to handle the action on the counter</span></span><br><span class="line">  <span class="comment">//</span></span><br><span class="line">  StreamController _actionController = StreamController();</span><br><span class="line">  StreamSink <span class="keyword">get</span> incrementCounter =&gt; _actionController.sink;</span><br><span class="line"></span><br><span class="line">  <span class="comment">//</span></span><br><span class="line">  <span class="comment">// Constructor</span></span><br><span class="line">  <span class="comment">//</span></span><br><span class="line">  IncrementBloc()&#123;</span><br><span class="line">    _counter = <span class="number">0</span>;</span><br><span class="line">    _actionController.stream</span><br><span class="line">                     .listen(_handleLogic);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">void</span> dispose()&#123;</span><br><span class="line">    _actionController.close();</span><br><span class="line">    _counterController.close();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">void</span> _handleLogic(data)&#123;</span><br><span class="line">    _counter = _counter + <span class="number">1</span>;</span><br><span class="line">    _inAdd.add(_counter);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™æ˜¯ä¸Šç¯‡æ–‡ç« çš„æœ€åç»™æ‰“å¤§å®¶åˆ¶é€ æ‚¬å¿µçš„ä»£ç ï¼Ÿäº”è„ä¿±å…¨ï¼ŒåŸºæœ¬å·²ç»å®ç°äº† BloCã€‚</p><p>ç»“åˆä¸Šé¢çš„ä¾‹å­æ¥åˆ†æ BloC ä½“ç°å‡ºæ¥çš„ä¼˜åŠ¿ï¼šï¼ˆå»ºè®®å…ˆå°†<a href="https://github.com/MeandNi/Flutter_StatePro/blob/master/lib/bloc_counter/main.dart" target="_blank" rel="noopener">è¿™æ®µä»£ç </a>è·‘èµ·æ¥ï¼ï¼‰</p><h4 id="ä¸€ï¼ŒBloC-å®ç°äº†è´£ä»»åˆ†ç¦»"><a href="#ä¸€ï¼ŒBloC-å®ç°äº†è´£ä»»åˆ†ç¦»" class="headerlink" title="ä¸€ï¼ŒBloC å®ç°äº†è´£ä»»åˆ†ç¦»"></a>ä¸€ï¼ŒBloC å®ç°äº†è´£ä»»åˆ†ç¦»</h4><p>ä½ å¯ä»¥çœ‹åˆ° CounterPageï¼ˆç¬¬21-45è¡Œï¼‰ï¼Œå…¶ä¸­æ²¡æœ‰ä»»ä½•ä¸šåŠ¡é€»è¾‘ã€‚</p><p>å®ƒæ‰¿æ‹…çš„è´Ÿè´£ä»…æœ‰ï¼š</p><ul><li>æ˜¾ç¤ºè®¡æ•°å™¨ï¼Œç°åœ¨åªåœ¨å¿…è¦æ—¶æ›´æ–°</li><li>æä¾›ä¸€ä¸ªæŒ‰é’®ï¼Œå½“æŒ‰ä¸‹æ—¶ï¼Œè¯·æ±‚æ‰§è¡ŒåŠ¨ä½œ</li></ul><p>æ­¤å¤–ï¼Œæ•´ä¸ªä¸šåŠ¡é€»è¾‘é›†ä¸­åœ¨ä¸€ä¸ªå•ç‹¬çš„ç±»â€œIncrementBlocâ€ä¸­ã€‚</p><p>å¦‚æœç°åœ¨ï¼Œå¦‚æœæˆ‘ä»¬éœ€è¦æ›´æ”¹ä¸šåŠ¡é€»è¾‘ï¼Œåªéœ€æ›´æ–°æ–¹æ³• _handleLogicï¼ˆç¬¬77-80è¡Œï¼‰ã€‚ ä¹Ÿè®¸æ–°çš„ä¸šåŠ¡é€»è¾‘å°†è¦æ±‚åšéå¸¸å¤æ‚çš„äº‹æƒ…â€¦â€¦ CounterPage æ°¸è¿œä¸å®ƒæ— å…³ï¼</p><h4 id="äºŒï¼Œå¯æµ‹è¯•æ€§"><a href="#äºŒï¼Œå¯æµ‹è¯•æ€§" class="headerlink" title="äºŒï¼Œå¯æµ‹è¯•æ€§"></a>äºŒï¼Œå¯æµ‹è¯•æ€§</h4><p>ç°åœ¨ï¼Œæµ‹è¯•ä¸šåŠ¡é€»è¾‘ä¹Ÿå˜å¾—æ›´åŠ å®¹æ˜“ã€‚</p><p>æ— éœ€å†é€šè¿‡ç”¨æˆ·ç•Œé¢æµ‹è¯•ä¸šåŠ¡é€»è¾‘ã€‚ åªéœ€è¦æµ‹è¯• IncrementBloc ç±»ã€‚</p><h4 id="ä¸‰ï¼Œä»»æ„ç»„ç»‡å¸ƒå±€"><a href="#ä¸‰ï¼Œä»»æ„ç»„ç»‡å¸ƒå±€" class="headerlink" title="ä¸‰ï¼Œä»»æ„ç»„ç»‡å¸ƒå±€"></a>ä¸‰ï¼Œä»»æ„ç»„ç»‡å¸ƒå±€</h4><p>ç”±äºä½¿ç”¨äº† Streamsï¼Œæ‚¨ç°åœ¨å¯ä»¥ç‹¬ç«‹äºä¸šåŠ¡é€»è¾‘ç»„ç»‡å¸ƒå±€ã€‚</p><p>ä½ å¯ä»¥ä»åº”ç”¨ç¨‹åºä¸­çš„ä»»ä½•ä½ç½®ç”¨ä»»ä½•æ“ä½œï¼šåªéœ€è°ƒç”¨ <em>.incrementCounter</em> æ¥æ”¶å™¨å³å¯ã€‚</p><p>æ‚¨å¯ä»¥åœ¨ä»»ä½•é¡µé¢çš„ä»»ä½•ä½ç½®æ˜¾ç¤ºè®¡æ•°å™¨ï¼Œåªéœ€èˆ°è‰‡ç›‘å¬ .outCounter æµã€‚</p><h4 id="å››ï¼Œå‡å°‘-â€œbuildâ€-çš„æ•°é‡"><a href="#å››ï¼Œå‡å°‘-â€œbuildâ€-çš„æ•°é‡" class="headerlink" title="å››ï¼Œå‡å°‘ â€œbuildâ€ çš„æ•°é‡"></a>å››ï¼Œå‡å°‘ â€œbuildâ€ çš„æ•°é‡</h4><p>ä¸ç”¨ <code>setState()</code>è€Œæ˜¯ä½¿ç”¨ StreamBuilderï¼Œä»è€Œå¤§å¤§å‡å°‘äº†â€œæ„å»ºâ€çš„æ•°é‡ï¼Œåªå‡å°‘äº†æ‰€éœ€çš„æ•°é‡ã€‚</p><p>è¿™æ˜¯æ€§èƒ½ä¸Šçš„å·¨æé«˜ï¼</p><h4 id="åªæœ‰ä¸€ä¸ªçº¦æŸâ€¦â€¦-BLoCçš„å¯è®¿é—®æ€§"><a href="#åªæœ‰ä¸€ä¸ªçº¦æŸâ€¦â€¦-BLoCçš„å¯è®¿é—®æ€§" class="headerlink" title="åªæœ‰ä¸€ä¸ªçº¦æŸâ€¦â€¦ BLoCçš„å¯è®¿é—®æ€§"></a>åªæœ‰ä¸€ä¸ªçº¦æŸâ€¦â€¦ BLoCçš„å¯è®¿é—®æ€§</h4><p>ä¸ºäº†è¾¾åˆ°å„ç§ç›®çš„ï¼ŒBLoC éœ€è¦å¯è®¿é—®ã€‚</p><p>æœ‰ä»¥ä¸‹å‡ ç§æ–¹æ³•å¯ä»¥è®¿é—®å®ƒï¼š</p><ul><li><p>é€šè¿‡å…¨å±€å•ä¾‹çš„å˜é‡</p><p>è¿™ç§æ–¹å¼å¾ˆå®¹æ˜“å®ç°ï¼Œä½†ä¸æ¨èã€‚ æ­¤å¤–ï¼Œç”±äº Dart ä¸­æ²¡æœ‰ç±»ææ„å‡½æ•°ï¼Œå› æ­¤æˆ‘ä»¬æ°¸è¿œæ— æ³•æ­£ç¡®é‡Šæ”¾èµ„æºã€‚</p></li><li><p>ä½œä¸ºæœ¬åœ°å®ä¾‹</p><p>æ‚¨å¯ä»¥å®ä¾‹åŒ– BLoC çš„æœ¬åœ°å®ä¾‹ã€‚ åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œæ­¤è§£å†³æ–¹æ¡ˆå®Œå…¨ç¬¦åˆéœ€æ±‚ã€‚ åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæ‚¨åº”è¯¥å§‹ç»ˆè€ƒè™‘åœ¨ StatefulWidget ä¸­åˆå§‹åŒ–ï¼Œä»¥ä¾¿æ‚¨å¯ä»¥åˆ©ç”¨ dispose() æ–¹æ³•æ¥é‡Šæ”¾å®ƒã€‚</p></li><li><p>ç”±æ ¹ç»„ä»¶æä¾›<br>ä½¿å…¶å¯è®¿é—®çš„æœ€å¸¸è§æ–¹å¼æ˜¯é€šè¿‡æ ¹ Widgetï¼Œå°†å…¶å®ç°ä¸º StatefulWidgetã€‚</p><p>ä»¥ä¸‹ä»£ç ç»™å‡ºäº†ä¸€ä¸ªé€šç”¨ BlocProvider çš„ç¤ºä¾‹ï¼šï¼ˆè¿™ä¸ªä¾‹å­ç‰›é€¼ï¼ï¼‰</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Generic Interface for all BLoCs</span></span><br><span class="line"><span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">BlocBase</span> </span>&#123;</span><br><span class="line">  <span class="keyword">void</span> dispose();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Generic BLoC provider</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">BlocProvider</span>&lt;<span class="title">T</span> <span class="keyword">extends</span> <span class="title">BlocBase</span>&gt; <span class="keyword">extends</span> <span class="title">StatefulWidget</span> </span>&#123;</span><br><span class="line">  BlocProvider(&#123;</span><br><span class="line">    Key key,</span><br><span class="line">    <span class="meta">@required</span> <span class="keyword">this</span>.child,</span><br><span class="line">    <span class="meta">@required</span> <span class="keyword">this</span>.bloc,</span><br><span class="line">  &#125;): <span class="keyword">super</span>(key: key);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">final</span> T bloc;</span><br><span class="line">  <span class="keyword">final</span> Widget child;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  _BlocProviderState&lt;T&gt; createState() =&gt; _BlocProviderState&lt;T&gt;();</span><br><span class="line"></span><br><span class="line">  <span class="keyword">static</span> T of&lt;T <span class="keyword">extends</span> BlocBase&gt;(BuildContext context)&#123;</span><br><span class="line">    <span class="keyword">final</span> type = _typeOf&lt;BlocProvider&lt;T&gt;&gt;();</span><br><span class="line">    BlocProvider&lt;T&gt; provider = context.ancestorWidgetOfExactType(type);</span><br><span class="line">    <span class="keyword">return</span> provider.bloc;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">static</span> <span class="built_in">Type</span> _typeOf&lt;T&gt;() =&gt; T;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">_BlocProviderState</span>&lt;<span class="title">T</span>&gt; <span class="keyword">extends</span> <span class="title">State</span>&lt;<span class="title">BlocProvider</span>&lt;<span class="title">BlocBase</span>&gt;&gt;</span>&#123;</span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  <span class="keyword">void</span> dispose()&#123;</span><br><span class="line">    widget.bloc.dispose();</span><br><span class="line">    <span class="keyword">super</span>.dispose();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  Widget build(BuildContext context)&#123;</span><br><span class="line">    <span class="keyword">return</span> widget.child;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å…³äºè¿™æ®µé€šç”¨çš„ <em>BlocProvider</em> ä»”ç»†å›å‘³ï¼Œä½ ä¼šå‘ç°å…¶ç²¾å¦™ä¹‹å¤„ï¼</p><p>é€šç”¨ <em>BlocProvider</em> çš„ä¸€äº›è§£é‡Šï¼š</p><p>é¦–å…ˆï¼Œå¦‚ä½•å°†å…¶ç”¨ä½œæ•°æ®æä¾›è€…ï¼Ÿ</p><p>å¦‚æœä½ çœ‹äº†ä¸Šé¢<a href="https://gist.github.com/MeandNi/1161560bf90c5bc7f341844e8126a8f4" target="_blank" rel="noopener">BloC è®¡æ•°å™¨çš„ç¤ºä¾‹ä»£ç </a>ç¤ºä¾‹ä»£ç ï¼Œæ‚¨å°†çœ‹åˆ°ä»¥ä¸‹ä»£ç è¡Œï¼ˆç¬¬12-15è¡Œï¼‰</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">home: BlocProvider&lt;IncrementBloc&gt;(</span><br><span class="line">         bloc: IncrementBloc(),</span><br><span class="line">         child: CounterPage(),</span><br><span class="line">       ),</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨ä»¥ä¸Šä»£ç ï¼Œæˆ‘ä»¬å®ä¾‹åŒ–äº†ä¸€ä¸ªæƒ³è¦å¤„ç† <em>IncrementBloc</em> çš„æ–° <em>BlocProvider</em>ï¼Œå¹¶å°† <em>CounterPage</em> å‘ˆç°ä¸ºå­ç»„ä»¶ã€‚</p><p>ä» <em>BlocProvider</em> å¼€å§‹çš„å­ç»„ä»¶çš„ä»»ä½•ç»„ä»¶éƒ¨åˆ†éƒ½å°†èƒ½å¤Ÿé€šè¿‡ä»¥ä¸‹è¡Œè®¿é—® <em>IncrementBloc</em>ï¼š</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">IncrementBloc bloc = BlocProvider.of&lt;IncrementBloc&gt;(context);</span><br></pre></td></tr></table></figure></li></ul><p>BLoC çš„åŸºæœ¬ä½¿ç”¨å°±ä»‹ç»å®Œäº†ï¼Œæ‰€æœ‰<a href="https://github.com/MeandNi/Flutter_StatePro" target="_blank" rel="noopener">å®ä¾‹ä»£ç åœ¨è¿™é‡Œ</a> ï¼Œæˆ‘å°†æ¯ç§çŠ¶æ€ç®¡ç†çš„æ–¹æ³•åˆ†æ¨¡å—æ”¾åœ¨é‡Œé¢ï¼Œé€‰æ‹©ä½¿ç”¨å“ªç§æ–¹å¼è¿è¡Œä»£ç å³å¯ã€‚</p><h3 id="BloC-å…¶ä»–ä½ å¿…é¡»çŸ¥é“çš„äº‹æƒ…"><a href="#BloC-å…¶ä»–ä½ å¿…é¡»çŸ¥é“çš„äº‹æƒ…" class="headerlink" title="BloC å…¶ä»–ä½ å¿…é¡»çŸ¥é“çš„äº‹æƒ…"></a>BloC å…¶ä»–ä½ å¿…é¡»çŸ¥é“çš„äº‹æƒ…</h3><h4 id="å¯ä»¥å®ç°å¤šä¸ª-BloC"><a href="#å¯ä»¥å®ç°å¤šä¸ª-BloC" class="headerlink" title="å¯ä»¥å®ç°å¤šä¸ª BloC"></a>å¯ä»¥å®ç°å¤šä¸ª BloC</h4><p>åœ¨å¤§å‹é¡¹ç›®ä¸­ï¼Œè¿™æ˜¯éå¸¸å¯å–çš„ã€‚ ç»™ä»¥ä¸‹å‡ ä¸ªå»ºè®®ï¼š</p><ul><li>ï¼ˆå¦‚æœæœ‰ä»»ä½•ä¸šåŠ¡é€»è¾‘ï¼‰æ¯é¡µé¡¶éƒ¨æœ‰ä¸€ä¸ªBLoCï¼Œ</li><li>ç”¨ä¸€ä¸ª ApplicationBloc æ¥å¤„ç†åº”ç”¨ç¨‹åºæ‰€æœ‰çŠ¶æ€</li><li>æ¯ä¸ªâ€œè¶³å¤Ÿå¤æ‚çš„ç»„ä»¶â€éƒ½æœ‰ç›¸åº”çš„BLoCã€‚</li></ul><p>ä»¥ä¸‹ç¤ºä¾‹ä»£ç åœ¨æ•´ä¸ªåº”ç”¨ç¨‹åºçš„é¡¶éƒ¨ä½¿ç”¨ <em>ApplicationBloc</em>ï¼Œç„¶ååœ¨ <em>CounterPage</em> é¡¶éƒ¨ä½¿ç”¨ <em>IncrementBloc</em>ã€‚è¯¥ç¤ºä¾‹è¿˜å±•ç¤ºäº†å¦‚ä½•ä½¿ç”¨ä¸¤ä¸ª Blocï¼š</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">void</span> main() =&gt; runApp(</span><br><span class="line">  BlocProvider&lt;ApplicationBloc&gt;(</span><br><span class="line">    bloc: ApplicationBloc(),</span><br><span class="line">    child: MyApp(),</span><br><span class="line">  )</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyApp</span> <span class="keyword">extends</span> <span class="title">StatelessWidget</span> </span>&#123;</span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  Widget build(BuildContext context)&#123;</span><br><span class="line">    <span class="keyword">return</span> MaterialApp(</span><br><span class="line">      title: <span class="string">'Streams Demo'</span>,</span><br><span class="line">      home: BlocProvider&lt;IncrementBloc&gt;(</span><br><span class="line">        bloc: IncrementBloc(),</span><br><span class="line">        child: CounterPage(),</span><br><span class="line">      ),</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">CounterPage</span> <span class="keyword">extends</span> <span class="title">StatelessWidget</span> </span>&#123;</span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  Widget build(BuildContext context)&#123;</span><br><span class="line">    <span class="keyword">final</span> IncrementBloc counterBloc = BlocProvider.of&lt;IncrementBloc&gt;(context);</span><br><span class="line">    <span class="keyword">final</span> ApplicationBloc appBloc = BlocProvider.of&lt;ApplicationBloc&gt;(context);</span><br><span class="line">    </span><br><span class="line">    ...</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="ä¸ºä½•ä¸ç”¨-InheritedWidget-æ¥å…¨å±€ç®¡ç†-BloC-çš„çŠ¶æ€"><a href="#ä¸ºä½•ä¸ç”¨-InheritedWidget-æ¥å…¨å±€ç®¡ç†-BloC-çš„çŠ¶æ€" class="headerlink" title="ä¸ºä½•ä¸ç”¨ InheritedWidget æ¥å…¨å±€ç®¡ç† BloC çš„çŠ¶æ€"></a>ä¸ºä½•ä¸ç”¨ InheritedWidget æ¥å…¨å±€ç®¡ç† BloC çš„çŠ¶æ€</h4><p>æˆ‘ä¸ºæ­¤ä¹Ÿæ•´ç†äº†ä¸€ä¸ªå°† BLoC ç»“åˆ InheritedWidget ä½¿ç”¨çš„ç¤ºä¾‹ï¼š</p><p>åœ¨å¾ˆå¤šä¸ BLoC ç›¸å…³çš„æ–‡ç« ä¸­ï¼Œæ‚¨å°†çœ‹åˆ° <em>Provider</em> çš„å®ç°å…¶å®æ˜¯ä¸€ä¸ª <em>InheritedWidget</em>ã€‚</p><p>å½“ç„¶ï¼Œ  è¿™æ˜¯å®Œå…¨å¯ä»¥å®ç°çš„ï¼Œç„¶è€Œï¼Œ</p><ul><li>ä¸€ä¸ª <em>InheritedWidget</em> æ²¡æœ‰æä¾›ä»»ä½• <em>dispose</em> æ–¹æ³•ï¼Œè®°ä½ï¼Œåœ¨ä¸å†éœ€è¦èµ„æºæ—¶æ€»æ˜¯é‡Šæ”¾èµ„æºæ˜¯ä¸€ä¸ªå¾ˆå¥½çš„åšæ³•ã€‚</li><li>å½“ç„¶ï¼Œä½ ä¹Ÿå¯ä»¥å°† <em>InheritedWidget</em> åŒ…è£…åœ¨å¦ä¸€ä¸ª <em>StatefulWidget</em> ä¸­ï¼Œä½†æ˜¯ï¼Œä¹æ ·ä½¿ç”¨ <em>InheritedWidget</em> å¹¶æ²¡æœ‰ä»€ä¹ˆä¾¿åˆ©ä¹‹å¤„ï¼</li><li>æœ€åï¼Œå¦‚æœä¸å—æ§åˆ¶ï¼Œä½¿ç”¨ <em>InheritedWidget</em> ç»å¸¸ä¼šå¯¼è‡´ä¸€äº›å‰¯ä½œç”¨ï¼ˆè¯·å‚é˜…ä¸‹é¢çš„  <em>InheritedWidget</em> ä¸Šçš„æé†’ï¼‰ã€‚</li></ul><p>è¿™ 3 ç‚¹è§£é‡Šäº†æˆ‘ä¸ºä½•å°†é€šç”¨ BlocProvider å®ç°ä¸º StatefulWidgetï¼Œè¿™æ ·æˆ‘å°±å¯ä»¥<strong>é‡Šæ”¾èµ„æº</strong>ã€‚</p><blockquote><p>Flutteræ— æ³•å®ä¾‹åŒ–æ³›å‹ç±»å‹</p><p>ä¸å¹¸çš„æ˜¯ï¼ŒFlutter æ— æ³•å®ä¾‹åŒ–æ³›å‹ç±»å‹ï¼Œæˆ‘ä»¬å¿…é¡»å°† BLoC çš„å®ä¾‹ä¼ é€’ç»™ BlocProviderã€‚ ä¸ºäº†åœ¨æ¯ä¸ªBLoCä¸­å¼ºåˆ¶æ‰§è¡Œ dispose() æ–¹æ³•ï¼Œæ‰€æœ‰BLoCéƒ½å¿…é¡»å®ç° BlocBase æ¥å£ã€‚</p></blockquote><h4 id="å…³äºä½¿ç”¨-InheritedWidget-çš„æé†’"><a href="#å…³äºä½¿ç”¨-InheritedWidget-çš„æé†’" class="headerlink" title="å…³äºä½¿ç”¨ InheritedWidget çš„æé†’"></a>å…³äºä½¿ç”¨ InheritedWidget çš„æé†’</h4><p>åœ¨ä½¿ç”¨ <em>InheritedWidget</em> å¹¶é€šè¿‡ <em>context.inheritFromWidgetOfExactType(â€¦)</em> è·å–æŒ‡å®šç±»å‹æœ€è¿‘çš„ <em>Widget</em> æ—¶ï¼Œæ¯å½“InheritedWidget çš„çˆ¶çº§æˆ–è€…å­å¸ƒå±€å‘ç”Ÿå˜åŒ–æ—¶ï¼Œè¿™ä¸ªæ–¹æ³•ä¼šè‡ªåŠ¨å°†å½“å‰ â€œ<em>context</em>â€ï¼ˆ= <em>BuildContext</em>ï¼‰æ³¨å†Œåˆ°è¦é‡å»ºçš„ <em>widget</em> å½“ä¸­ã€‚</p><blockquote><p>è¯·æ³¨æ„ï¼Œä¸ºäº†å®Œå…¨æ­£ç¡®ï¼Œæˆ‘åˆšæ‰è§£é‡Šçš„ä¸ <em>InheritedWidget</em> ç›¸å…³çš„é—®é¢˜åªå‘ç”Ÿåœ¨æˆ‘ä»¬å°† <em>InheritedWidget</em> ä¸ <em>StatefulWidget</em> ç»“åˆä½¿ç”¨æ—¶ã€‚ å½“æ‚¨åªä½¿ç”¨æ²¡æœ‰ State çš„ InheritedWidget æ—¶ï¼Œé—®é¢˜å°±ä¸ä¼šå‘ç”Ÿã€‚ </p></blockquote><h3 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h3><p>Flutter çŠ¶æ€ç®¡ç†çš„è¿™å‡ ç§æ¨¡å¼åŒæ ·å¯ä»¥é€‚ç”¨äºå¾ˆå¤šè½¯ä»¶å¼€å‘ä¸­ï¼Œè€Œ BloC æ¨¡å¼æœ€åˆçš„è®¾æƒ³æ˜¯å®ç°å…è®¸ç‹¬ç«‹äºå¹³å°é‡ç”¨ç›¸åŒçš„ä»£ç ï¼å› æ­¤å¤šèŠ±æ—¶é—´å­¦ä¹ è¿™ç±»æ¨¡å¼ä¾¿æ˜¯è½¯ä»¶å¼€å‘çš„æ ¹åŸºã€‚</p><p>æˆ‘çš„å»ºè®®æ˜¯å°†<strong>å®ä¾‹ä»£ç è¿è¡Œå‡ºæ¥é˜…è¯»ä»£ç </strong>ï¼Œä¾é æ–‡ç« ç†è§£ï¼å¸Œæœ›èƒ½å¸®åŠ©åˆ°ä½ ï¼</p><h3 id="å‚è€ƒé“¾æ¥"><a href="#å‚è€ƒé“¾æ¥" class="headerlink" title="å‚è€ƒé“¾æ¥"></a>å‚è€ƒé“¾æ¥</h3><p>è¿™ç¯‡å†…å®¹æ˜¯æˆ‘åå¤çœ‹å®Œ <a href="https://www.youtube.com/watch?v=RS36gBEp8OI&amp;index=115&amp;list=PLOU2XLYxmsIInFRc3M44HUTQc3b_YJ4-Y" target="_blank" rel="noopener">Build reactive mobile apps with Flutter (Google I/O â€˜18)</a> è°·æ­Œå¤§ä¼šå†™å®Œçš„ã€‚</p><p>å¹¶ä¸”å¤§é‡å€Ÿé‰´äº† <a href="https://www.didierboelens.com/2018/08/reactive-programming---streams---bloc/" target="_blank" rel="noopener">Reactive Programming - Streams - BLoC</a> è¿™ç¯‡æ–‡ç« ã€‚</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;åœ¨ä¸Šç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘è¯¦ç»†ä»‹ç»äº† InheritedWidget åŠ ScopedModel å®ç°åŸç†ä¸æ–¹æ³•ï¼Œæœ‰åŒå­¦è¯´æ‰¾ä¸åˆ°æºç ï¼Œå…¶å®ä¸Šç¯‡æ–‡ç« åŒ…æ‹¬è¿™ç¯‡æ–‡ç« é‡Œçš„æºç éƒ½æŒ‰æ­¥éª¤æ”¾åœ¨&lt;a href=&quot;https://github.com/MeandNi/Flutter_StatePro&quot;
      
    
    </summary>
    
      <category term="åŸåˆ›" scheme="https://meandni.com/categories/%E5%8E%9F%E5%88%9B/"/>
    
    
      <category term="flutterå®æˆ˜" scheme="https://meandni.com/tags/flutter%E5%AE%9E%E6%88%98/"/>
    
  </entry>
  
  <entry>
    <title>Flutterå®è·µï¼šæ·±å…¥æ¢ç´¢ Flutter ä¸­çš„çŠ¶æ€ç®¡ç†æ–¹å¼(1)</title>
    <link href="https://meandni.com/2019/01/30/flutter-state1/"/>
    <id>https://meandni.com/2019/01/30/flutter-state1/</id>
    <published>2019-01-30T12:54:19.000Z</published>
    <updated>2019-02-09T12:15:31.485Z</updated>
    
    <content type="html"><![CDATA[<p>åˆ©ç”¨ Flutter å†…ç½®çš„è®¸å¤šæ§ä»¶æˆ‘ä»¬å¯ä»¥æ‰“é€ å‡ºä¸€æ¬¾ä¸ä»…æ¼‚äº®è€Œä¸”å®Œç¾è·¨å¹³å°çš„ App å¤–å£³ï¼Œæˆ‘åˆ©ç”¨å…¶ç‰¹æ€§å®Œæˆäº†ç±»ä¼¼<a href="https://github.com/MeandNi/Flutter_ZhiHu" target="_blank" rel="noopener">çŸ¥ä¹Appçš„UIç•Œé¢</a>ï¼Œç„¶è€Œä¸€æ¬¾å®Œæ•´çš„åº”ç”¨ç¨‹åºæ˜¾ç„¶ä¸æ­¢æœ‰å¤–å£³è¿™ä¹ˆç®€å•ã€‚å¡«å……åœ¨å¤–å£³é‡Œé¢çš„æ˜¯æ•°æ®ï¼Œæ•°æ®æ¥æºæˆ–ä»æœ¬åœ°ï¼Œæˆ–ä»äº‘ç«¯ï¼Œå¤§é‡çš„æ•°æ®å¤„ç†å¾ˆå®¹æ˜“é€ æˆæ•°æ®çš„æ··ä¹±ï¼Œè€¦åˆåº¦æé«˜ï¼Œä¸ä¾¿äºç»´æŠ¤ï¼Œäºæ˜¯è¯ç”Ÿäº†å¾ˆå¤šè®¾è®¡æ¨¡å¼å’ŒçŠ¶æ€ç®¡ç†çš„æ–¹å¼ã€‚</p><p>ç›®å‰ Flutter å¸¸ç”¨çŠ¶æ€ç®¡ç†æ–¹å¼æœ‰å¦‚ä¸‹å‡ ç§ï¼š</p><ul><li>ScopedModel</li><li>BLoC (Business Logic Component) / Rx</li><li>Redux</li></ul><p>è¿™ç¯‡æ–‡ç« æš‚ä¸”ä¸æè¿™äº›æ¯”è¾ƒå¤æ‚çš„æ¨¡å¼ã€‚æˆ‘ä»¬ç®€å•çš„æå‡ºä¸‰ä¸ªé—®é¢˜ï¼š</p><ul><li>Flutter ä¸­ç»„ä»¶ä¹‹é—´å¦‚ä½•é€šä¿¡ï¼Ÿ</li><li>æ›´æ–° State åç»„ä»¶ä»¥ä½•ç§æ–¹å¼é‡æ–°æ¸²æŸ“ï¼Ÿ</li><li>å¦‚ä½•åœ¨è·¯ç”±è½¬æ¢ä¹‹é—´ä¿æŒçŠ¶æ€åŒæ­¥ï¼Ÿ</li></ul><h3 id="åˆæ¢-State"><a href="#åˆæ¢-State" class="headerlink" title="åˆæ¢ State"></a>åˆæ¢ State</h3><p>æˆ‘ä»¥åˆ›å»ºæ–°é¡¹ç›® Flutter ç»™æˆ‘ä»¬é»˜è®¤çš„è®¡æ•°å™¨åº”ç”¨ä¸ºä¾‹ï¼Œé€šè¿‡è·¯ç”±æˆ‘å°†å…¶æ‹†åˆ†ä¸ºä¸¤éƒ¨åˆ† <code>MyHomePage</code>å’Œ <code>PageTwo</code>ï¼Œ</p><p>MyHomePageï¼ŒæŒæœ‰ä¸€ä¸ª<code>_counter</code>å˜é‡å’Œä¸€ä¸ªå¢åŠ è®¡æ•°çš„æ–¹æ³•ï¼ŒPageTwoï¼Œæ¥æ”¶ä¸¤ä¸ªå‚æ•°(è®¡æ•°çš„è‡³å’Œå¢åŠ è®¡æ•°çš„æ–¹æ³•)ï¼š</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">PageTwo</span> <span class="keyword">extends</span> <span class="title">StatefulWidget</span> </span>&#123;</span><br><span class="line">  <span class="keyword">final</span> <span class="built_in">int</span> count;</span><br><span class="line">  <span class="keyword">final</span> <span class="built_in">Function</span> increment;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> PageTwo(&#123;Key key, <span class="keyword">this</span>.count, <span class="keyword">this</span>.increment&#125;) : <span class="keyword">super</span>(key: key);</span><br><span class="line"></span><br><span class="line">  _PageTwoState createState() =&gt; _PageTwoState();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">_PageTwoState</span> <span class="keyword">extends</span> <span class="title">State</span>&lt;<span class="title">PageTwo</span>&gt; </span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  Widget build(BuildContext context) &#123;</span><br><span class="line">    <span class="keyword">return</span> Scaffold(</span><br><span class="line">      appBar: AppBar(</span><br><span class="line">        title: Text(<span class="string">"Page Two"</span>),</span><br><span class="line">      ),</span><br><span class="line">      body: Center(</span><br><span class="line">        child: Text(widget.count.toString(), style: TextStyle(fontSize: <span class="number">30.0</span>),),</span><br><span class="line">      ),</span><br><span class="line">      floatingActionButton: FloatingActionButton(</span><br><span class="line">        child: Icon(Icons.add),</span><br><span class="line">        onPressed: widget.increment,</span><br><span class="line">      ),</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å‡ºç°çš„çŠ¶å†µæ˜¯ï¼šæˆ‘ä»¬åœ¨é¦–é¡µç‚¹å‡»æŒ‰é’®è§¦å‘è®¡æ•°å™¨å¢åŠ ï¼Œè·¯ç”±åˆ° PageTwo åï¼Œæ•°å€¼æ­£å¸¸æ˜¾ç¤ºï¼Œç„¶è€Œç‚¹å‡»è¿™ä¸ªç•Œé¢ä¸­çš„ add æŒ‰é’®è¯¥é¡µé¢çš„æ•°å€¼å¹¶æœªå‘ç”Ÿæ”¹å˜ï¼Œé€šè¿‡è§‚å¯Ÿçˆ¶é¡µé¢çš„ count å€¼ç¡®å®å‘ç”Ÿäº†æ”¹å˜ï¼Œå› æ­¤å†æ¬¡é€šè¿‡è·¯ç”±åˆ°ç¬¬äºŒä¸ªç•Œé¢ç•Œé¢æ‰æ˜¾ç¤ºæ­£å¸¸ã€‚è§£ç­”ä¸Šé¢ä¸‰ä¸ªé—®é¢˜ï¼š</p><ul><li><p>Flutter ä¸­ç»„ä»¶ä¹‹é—´å¦‚ä½•é€šä¿¡ï¼Ÿ</p><p>å‚æ•°ä¼ é€’ã€‚</p></li><li><p>æ›´æ–° State åç»„ä»¶ä»¥ä½•ç§æ–¹å¼é‡æ–°æ¸²æŸ“ï¼Ÿ</p><p>åªæ¸²æŸ“å½“å‰çš„ç»„ä»¶ï¼ˆå’Œå­ç»„ä»¶ï¼Œè¿™é‡Œæš‚æœªè¯æ˜ï¼Œä½†ç¡®å®æ˜¯è§¦å‘ SetSate() åï¼Œå…¶æ‰€æœ‰å­ç»„ä»¶éƒ½å°†é‡æ–°æ¸²æŸ“ã€‚ï¼‰</p></li><li><p>å¦‚ä½•åœ¨è·¯ç”±è½¬æ¢ä¹‹é—´ä¿æŒçŠ¶æ€åŒæ­¥ï¼Ÿ</p><p>çˆ¶ç»„ä»¶ä¼ é€’çŠ¶æ€å€¼åˆ°å­ç»„ä»¶ï¼Œå­ç»„ä»¶æ‹¿åˆ°å¹¶æ˜¾ç¤ºï¼Œä½†å´ä¸èƒ½å®æ—¶æ›´æ”¹ğŸ˜€ï¼Œæˆ‘ä¸€æ—¶åŠä¼šè¿˜æ­£æ²¡æƒ³å‡ºä»€ä¹ˆè§£å†³æ–¹æ³•ï¼Œæˆ‘ç›¸ä¿¡å³ä½¿èƒ½åšåˆ°ä¹Ÿä¸ä¼˜é›…ã€‚</p></li></ul><p>è¯æ˜è§¦å‘ SetSate() åï¼Œå…¶æ‰€æœ‰å­ç»„ä»¶éƒ½å°†é‡æ–°æ¸²æŸ“ï¼šæˆ‘åœ¨å‰¯ç»„ä»¶ä¸­æ·»åŠ ä¸¤ä¸ªå­ç»„ä»¶ï¼Œä¸€æ—¦è§¦å‘æ¸²æŸ“å˜æ‰“å°ç›¸å…³æ•°æ®ï¼š</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">TestStateless(),</span><br><span class="line">TestStateful()</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">TestStateless</span> <span class="keyword">extends</span> <span class="title">StatelessWidget</span> </span>&#123;</span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  Widget build(BuildContext context) &#123;</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">'build TestStateless'</span>);</span><br><span class="line">    <span class="keyword">return</span> Text(<span class="string">'TestStateless'</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">TestStateful</span> <span class="keyword">extends</span> <span class="title">StatefulWidget</span> </span>&#123;</span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  _TestStatefulState createState() =&gt; _TestStatefulState();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">_TestStatefulState</span> <span class="keyword">extends</span> <span class="title">State</span>&lt;<span class="title">TestStateful</span>&gt; </span>&#123;</span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  Widget build(BuildContext context) &#123;</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">'build TestStateful'</span>);</span><br><span class="line">    <span class="keyword">return</span> Text(<span class="string">'_TestStatefulState'</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ­¤æ—¶åˆ° PageTwo è§¦å‘ add äº‹ä»¶ï¼Œæ—¥å¿—å‡ºæ¥ï¼š</p><figure class="image-bubble">                <div class="img-lightbox">                    <div class="overlay"></div>                    <img src="/images/flutterstate1.png" alt="" title="">                </div>                <div class="image-caption"></div>            </figure><p>é€šè¿‡è¿™ç§ç®€å•çš„æ–¹å¼å·²ç»å¯ä»¥è¯´æ˜ä¸€ä¸ªé—®é¢˜ï¼Œå³ä»¥æœ€ç®€å•çš„æ–¹å¼æˆ‘ä»¬å·²ç»å¯ä»¥å®ŒæˆçŠ¶æ€ä¼ é€’å’Œç»„ä»¶æ¸²æŸ“ï¼Œè€Œè·¯ç”±é—´ä¿æŒçŠ¶æ€ä¸€è‡´è¿˜ä¸èƒ½è§£å†³ã€‚</p><figure class="image-bubble">                <div class="img-lightbox">                    <div class="overlay"></div>                    <img src="/images/flutterstate8.gif" alt="" title="">                </div>                <div class="image-caption"></div>            </figure><h3 id="InheritedWidget"><a href="#InheritedWidget" class="headerlink" title="InheritedWidget"></a>InheritedWidget</h3><p>Google å®˜æ–¹ç»™æˆ‘ä»¬çš„è§£å†³æ–¹æ¡ˆæ˜¯ <code>InheritedWidget</code>ï¼Œæ€ä¹ˆç†è§£ä»–ï¼Œæˆ‘ä»¬å¯ä»¥ç§°å®ƒä¸ºâ€œçŠ¶æ€æ ‘â€ï¼Œå®ƒä½¿å¾—æ‰€æœ‰çš„ widget çš„ State æ¥æºç»Ÿä¸€ï¼Œè¿™æ ·ä¸€æ—¦æœ‰ä¸€å¤„è§¦å‘çŠ¶æ€æ”¹å˜ï¼ŒFlutter ä»¥æŸç§æ–¹å¼æ„Ÿåº”åˆ°äº†ï¼ˆæœ‰ä¸ªç›‘å¬å™¨ï¼‰ï¼Œç æ‰å®ƒï¼Œé•¿å‡ºä¸€ä¸ªæ–°æ ‘ï¼ŒPerfectï¼æ‰€æœ‰åœ°æ–¹éƒ½èƒ½æ„Ÿå—åˆ°ä»–çš„å˜åŒ–ã€‚ä¸Šé¢æåˆ°çš„ç¬¬ä¸€ç§çŠ¶æ€ç®¡ç†æ–¹å¼ <code>ScopedModel</code>ä¾¿æ˜¯åŸºäºæ­¤è€Œäº§ç”Ÿçš„ä¸€å¥—ç¬¬ä¸‰æ–¹åº“ã€‚</p><p>å…¶å®ç°åœ¨çœ‹æ¥ InheritedWidget å·²ç»éå¸¸ç®€å•äº†ï¼Œæˆ‘ä»¬æŠ“ä½ä¸¤ä¸ªç‚¹å³å¯å®Œå…¨æŒæ¡å®ƒï¼š</p><ol><li><p>çŠ¶æ€æ ‘ä¸­çš„æ•°æ®</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyInheritedValue</span> <span class="keyword">extends</span> <span class="title">InheritedWidget</span> </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> MyInheritedValue(&#123;</span><br><span class="line">    Key key,</span><br><span class="line">    <span class="meta">@required</span> <span class="keyword">this</span>.value,</span><br><span class="line">    <span class="meta">@required</span> Widget child,</span><br><span class="line">  &#125;) : <span class="keyword">assert</span>(value != <span class="keyword">null</span>),</span><br><span class="line">       <span class="keyword">assert</span>(child != <span class="keyword">null</span>),</span><br><span class="line">       <span class="keyword">super</span>(key: key, child: child);</span><br><span class="line">  <span class="keyword">final</span> <span class="built_in">int</span> value;</span><br><span class="line">  <span class="keyword">static</span> MyInheritedValue of(BuildContext context) &#123;</span><br><span class="line">    <span class="keyword">return</span> context.inheritFromWidgetOfExactType(MyInheritedValue);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  <span class="built_in">bool</span> updateShouldNotify(MyInheritedValue old) =&gt; </span><br><span class="line">        value != old.value;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ³¨å…¥åˆ°æ ¹ç»„ä»¶ä¸­ï¼š</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Widget build(BuildContext context) &#123;</span><br><span class="line">  <span class="keyword">return</span> MyInheritedValue(</span><br><span class="line">    value: <span class="number">42</span>,</span><br><span class="line">    child: ...</span><br><span class="line">  );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>ä½¿ç”¨çŠ¶æ€æ ‘ä¸­æ•°æ®çš„å…¶ä»– Widget</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">// æ‹¿åˆ°çŠ¶æ€æ ‘ä¸­çš„å€¼</span><br><span class="line">MyInheritedValue.of(context).value</span><br></pre></td></tr></table></figure><p>è¯·æ³¨æ„ï¼šè¿™ç§æƒ…å†µä¸‹æ˜¯ä¸èƒ½æ”¹ InheritedWidget ä¸­çš„å€¼çš„ï¼Œéœ€è¦æ”¹ä¹Ÿå¾ˆç®€å•å°±æ˜¯å°† MyInheritedValue çš„å€¼å°è£…æˆä¸€ä¸ªå¯¹è±¡ï¼Œæ¯æ¬¡æ”¹å˜è¿™ä¸ªå¯¹è±¡çš„å€¼ï¼Œå…·ä½“æ³•ç›¸çœ‹æˆ‘çš„<a href="https://github.com/MeandNi/Flutter_StatePro" target="_blank" rel="noopener">æ ·ä¾‹ä»£ç </a>ï¼</p><p><img src="/images/flutterstate7.png" alt=""></p></li></ol><p>ä¸Šé¢æ‰€è¯´ç æ‰æ•´æ£µæ ‘è¿‡äºç²—æš´å´å¹¶ä¸å¤¸å¼ ï¼Œå› ä¸ºä¸€å¤„æ”¹å˜å®ƒå°†è”åŠ¨æ•´æ£µæ ‘ï¼Œ</p><p>ScopedModel æ˜¯åŸºäº InheritedWidget çš„åº“ï¼Œå®ç°èµ·æ¥ä¸ InheritedWidget å¤§åŒå°å¼‚ï¼Œè€Œä¸”å…¶æœ‰ä¸€ç§å¯ä»¥è®©å±€éƒ¨ç»„ä»¶ä¸æ”¹å˜çš„æ–¹å¼ï¼šè®¾ç½® rebuildOnChange ä¸º falseã€‚</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">return</span> ScopedModelDescendant&lt;CartModel&gt;(</span><br><span class="line">          rebuildOnChange: <span class="keyword">false</span>,</span><br><span class="line">          builder: (context, child, model) =&gt; ProductSquare(</span><br><span class="line">                product: product,</span><br><span class="line">                onTap: () =&gt; model.add(product),</span><br><span class="line">              ),</span><br><span class="line">        );</span><br></pre></td></tr></table></figure><p>å…·ä½“ä»£ç è¯·çœ‹ GitHubï¼ŒScopedModel æ ·ä¾‹æˆªå–ä¸€ä¸ªè€å¤–ç»™çš„å®ä¾‹ï¼Œå°±æ˜¯ä¸‹æ–¹å‚è€ƒé“¾æ¥ Google å¼€å‘è€…å¤§ä¼šä¸Šæ¼”è®²çš„é‚£ä¸¤ä½å…¶ä¸­ä¹‹ä¸€ã€‚</p><figure class="image-bubble">                <div class="img-lightbox">                    <div class="overlay"></div>                    <img src="/images/flutterstate9.gif" alt="" title="">                </div>                <div class="image-caption"></div>            </figure><p>è¿™ç§æ–¹å¼æ˜¾ç„¶æœ‰ç‚¹ä¸è¶³ä¹‹å¤„å°±æ˜¯ä¸€æ—¦é‡åˆ°å°è§„æ¨¡å˜åŠ¨å°±è¦å¼•èµ·å¤§è§„æ¨¡é‡æ–°æ¸²æŸ“ï¼Œæ‰€ä»¥å½“é¡¹ç›®è¾¾åˆ°ä¸€å®šçš„è§„æ¨¡è€ƒè™‘ Google çˆ¸çˆ¸ç»™æˆ‘ä»¬çš„å¦ä¸€ç§è§£å†³æ–¹æ¡ˆã€‚</p><h3 id="Streamsï¼ˆæµï¼‰"><a href="#Streamsï¼ˆæµï¼‰" class="headerlink" title="Streamsï¼ˆæµï¼‰"></a>Streamsï¼ˆæµï¼‰</h3><p>åœ¨ Android å¼€å‘ä¸­æˆ‘ä»¬ç»å¸¸ä¼šç”¨åˆ° RxJava è¿™ç±»å“åº”å¼ç¼–ç¨‹æ–¹æ³•çš„æ¡†æ¶ï¼Œå…¶å¼ºå¤§ä¹‹å¤„æ— é¡»å¤šè¨€ï¼Œè€Œ Stream çœ‹ä¸Šå»å°±æ˜¯åœ¨ Dart è¯­è¨€ä¸­çš„å“åº”å¼ç¼–ç¨‹çš„ä¸€ç§å®ç°ã€‚</p><ul><li><p>Streams æ˜¯ä»€ä¹ˆé¬¼ï¼Ÿ</p><p>å¦‚æœè¦å…·ä½“æŠŠ Streams è¯´æ¸…æ¥šï¼Œä¸€ç¯‡æ–‡ç« ç»å¯¹ä¸å¤Ÿï¼Œè¿™é‡Œå…ˆä»‹ç»ä¸€ä¸‹å…¶ä¸­çš„æ¦‚å¿µï¼Œè¿™ç¯‡æ–‡ç« ç›®çš„å°±æ˜¯å¦‚æ­¤ã€‚å¾…æˆ‘åç»­æƒ³å¥½æ€ä¹ˆå…·ä½“æè¿°æ¸…æ¥šã€‚</p><p>ä½ å¯ä»¥æŠŠå®ƒæƒ³è±¡æˆä¸€ä¸ªç®¡é“ï¼Œæœ‰å…¥å£ï¼ˆStreamSinkï¼‰å’Œå‡ºå£ï¼ˆï¼‰ï¼Œæˆ‘ä»¬å°†æƒ³è¦å¤„ç†çš„æ•°æ®ä»å…¥å£æ”¾å…¥ç»è¿‡è¯¥ç®¡é“ç»è¿‡ä¸€ç³»åˆ—å¤„ç†ï¼ˆç»ç”± <em>StreamController</em>ï¼‰ä»å‡ºå£ä¸­å‡ºæ¥ï¼Œè€Œå‡ºå£åˆæœ‰ä¸€ä¸ªç±»ä¼¼ç›‘å¬å™¨ä¹‹ç‰©ï¼Œæˆ‘ä»¬ä¸çŸ¥é“å®ƒä½•æ—¶åˆ°æ¥æˆ–è€…ä½•æ—¶å¤„ç†ç»“æŸã€‚ä½†æ˜¯å½“å‡ºå£çš„ç›‘å¬å™¨æ‹¿åˆ°ä¸œè¥¿ä¾¿ç«‹å³åšå‡ºç›¸åº”çš„ååº”ã€‚</p></li><li><p>é‚£äº›ä¸œè¥¿å¯ä»¥æ”¾å…¥ç®¡é“ï¼Ÿ<br>ä»»ä½•å˜é‡ã€å¯¹è±¡ã€æ•°ç»„ã€ç”šè‡³äº‹ä»¶éƒ½å¯ä»¥è¢«å½“ä½œæ•°æ®æºä»å…¥å£æ”¾è¿›å»ã€‚</p></li><li><p>Streams ç§ç±»</p><ol><li>Single-subscription Streamï¼Œâ€œå•è®¢é˜…â€æµï¼Œè¿™ç§ç±»å‹çš„æµåªå…è®¸åœ¨è¯¥æµçš„æ•´ä¸ªç”Ÿå‘½å‘¨æœŸå†…ä½¿ç”¨å•ä¸ªä¾¦å¬å™¨ã€‚å³ä½¿åœ¨ç¬¬ä¸€ä¸ªè®¢é˜…è¢«å–æ¶ˆåï¼Œä¹Ÿæ— æ³•åœ¨æ­¤ç±»æµä¸Šæ”¶å¬ä¸¤æ¬¡ã€‚</li><li>Broadcast Streamsï¼Œç¬¬äºŒç§ç±»å‹çš„Streamå…è®¸ä»»æ„æ•°é‡çš„ä¾¦å¬å™¨ã€‚å¯ä»¥éšæ—¶å‘å¹¿æ’­æµæ·»åŠ ä¾¦å¬å™¨ã€‚ æ–°çš„ä¾¦å¬å™¨å°†åœ¨å®ƒå¼€å§‹æ”¶å¬ Stream æ—¶æ”¶åˆ°äº‹ä»¶ã€‚</li></ol><p>ä¾‹å­ï¼š</p></li></ul><p>ç¬¬ä¸€ä¸ªç¤ºä¾‹æ˜¾ç¤ºäº†â€œå•è®¢é˜…â€æµï¼Œåªæ‰“å°è¾“å…¥çš„æ•°æ®ã€‚ ä½ ä¼šå‘ç°æ˜¯å“ªç§æ•°æ®ç±»å‹æ— å…³ç´§è¦ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">import &apos;dart:async&apos;;</span><br><span class="line"></span><br><span class="line">void main() &#123;</span><br><span class="line">  //</span><br><span class="line">  // Initialize a &quot;Single-Subscription&quot; Stream controller</span><br><span class="line">  //</span><br><span class="line">  final StreamController ctrl = StreamController();</span><br><span class="line">  </span><br><span class="line">  //</span><br><span class="line">  // Initialize a single listener which simply prints the data</span><br><span class="line">  // as soon as it receives it</span><br><span class="line">  //</span><br><span class="line">  final StreamSubscription subscription = ctrl.stream.listen((data) =&gt; print(&apos;$data&apos;));</span><br><span class="line"></span><br><span class="line">  //</span><br><span class="line">  // We here add the data that will flow inside the stream</span><br><span class="line">  //</span><br><span class="line">  ctrl.sink.add(&apos;my name&apos;);</span><br><span class="line">  ctrl.sink.add(1234);</span><br><span class="line">  ctrl.sink.add(&#123;&apos;a&apos;: &apos;element A&apos;, &apos;b&apos;: &apos;element B&apos;&#125;);</span><br><span class="line">  ctrl.sink.add(123.45);</span><br><span class="line">  </span><br><span class="line">  //</span><br><span class="line">  // We release the StreamController</span><br><span class="line">  //</span><br><span class="line">  ctrl.close();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç¬¬äºŒä¸ªç¤ºä¾‹æ˜¾ç¤ºâ€œå¹¿æ’­â€æµï¼Œå®ƒä¼ è¾¾æ•´æ•°å€¼å¹¶ä»…æ‰“å°å¶æ•°ã€‚ æˆ‘ä»¬ç”¨ StreamTransformer æ¥è¿‡æ»¤ï¼ˆç¬¬14è¡Œï¼‰å€¼ï¼Œåªè®©å¶æ•°ç»è¿‡ã€‚</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="string">'dart:async'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">void</span> main() &#123;</span><br><span class="line">  <span class="comment">//</span></span><br><span class="line">  <span class="comment">// Initialize a "Broadcast" Stream controller of integers</span></span><br><span class="line">  <span class="comment">//</span></span><br><span class="line">  <span class="keyword">final</span> StreamController&lt;<span class="built_in">int</span>&gt; ctrl = StreamController&lt;<span class="built_in">int</span>&gt;.broadcast();</span><br><span class="line">  </span><br><span class="line">  <span class="comment">//</span></span><br><span class="line">  <span class="comment">// Initialize a single listener which filters out the odd numbers and</span></span><br><span class="line">  <span class="comment">// only prints the even numbers</span></span><br><span class="line">  <span class="comment">//</span></span><br><span class="line">  <span class="keyword">final</span> StreamSubscription subscription = ctrl.stream</span><br><span class="line">      .where((value) =&gt; (value % <span class="number">2</span> == <span class="number">0</span>))</span><br><span class="line">      .listen((value) =&gt; <span class="built_in">print</span>(<span class="string">'$value'</span>));</span><br><span class="line"></span><br><span class="line">  <span class="comment">//</span></span><br><span class="line">  <span class="comment">// We here add the data that will flow inside the stream</span></span><br><span class="line">  <span class="comment">//</span></span><br><span class="line">  <span class="keyword">for</span>(<span class="built_in">int</span> i=<span class="number">1</span>; i&lt;<span class="number">11</span>; i++)&#123;</span><br><span class="line">  ctrl.sink.add(i);</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="comment">//</span></span><br><span class="line">  <span class="comment">// We release the StreamController</span></span><br><span class="line">  <span class="comment">//</span></span><br><span class="line">  ctrl.close();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="RxDart"><a href="#RxDart" class="headerlink" title="RxDart"></a>RxDart</h3><p>RxDartåŒ…æ˜¯ ReactiveX API çš„ Dart å®ç°ï¼Œå®ƒæ‰©å±•äº†åŸå§‹çš„ Dart Streams API ä»¥ç¬¦åˆ ReactiveX æ ‡å‡†ã€‚</p><figure class="image-bubble">                <div class="img-lightbox">                    <div class="overlay"></div>                    <img src="/images/flutterstate2.png" alt="" title="">                </div>                <div class="image-caption"></div>            </figure><p>ç”±äºå®ƒæœ€åˆå¹¶æœªç”± Google å®šä¹‰ï¼Œå› æ­¤å®ƒä½¿ç”¨ä¸åŒäº Dart çš„å˜é‡ã€‚ ä¸‹è¡¨ç»™å‡ºäº† Dart å’Œ RxDart ä¹‹é—´çš„å…³ç³»ã€‚</p><table><thead><tr><th>Dart</th><th>RxDart</th></tr></thead><tbody><tr><td>Stream</td><td>Observable</td></tr><tr><td>StreamController</td><td>Subject</td></tr></tbody></table><p>RxDart æ‰©å±•äº†åŸå§‹çš„ Dart Streams API å¹¶æä¾›äº† StreamController çš„3ä¸ªä¸»è¦å˜ä½“ï¼š</p><ol><li><p>PublishSubject</p><p>PublishSubject æ˜¯ä¸€ä¸ªæ™®é€šçš„ <strong>broadcast</strong> StreamController ï¼Œæœ‰ä¸€ç‚¹ä¸åŒï¼šstream è¿”å›ä¸€ä¸ª Observable è€Œä¸æ˜¯ä¸€ä¸ª Stream ã€‚</p><p><img src="/images/flutterstate3.png" alt=""></p><p>å¦‚æ‚¨æ‰€è§ï¼ŒPublishSubject ä»…å‘ä¾¦å¬å™¨å‘é€åœ¨è®¢é˜…ä¹‹åæ·»åŠ åˆ° Stream çš„äº‹ä»¶ã€‚</p></li><li><p>BehaviorSubject</p><p>BehaviorSubject ä¹Ÿæ˜¯ä¸€ä¸ª broadcast StreamControllerï¼Œå®ƒè¿”å›ä¸€ä¸ª Observable è€Œä¸æ˜¯ä¸€ä¸ªStreamã€‚</p><p><img src="/images/flutterstate4.png" alt=""></p><p>ä¸ PublishSubject çš„ä¸»è¦åŒºåˆ«åœ¨äº BehaviorSubject è¿˜å°†æœ€åå‘é€çš„äº‹ä»¶å‘é€ç»™åˆšåˆšè®¢é˜…çš„ä¾¦å¬å™¨ã€‚</p></li><li><p>ReplaySubject</p><p>ReplaySubject ä¹Ÿæ˜¯ä¸€ä¸ªå¹¿æ’­ StreamControllerï¼Œå®ƒè¿”å›ä¸€ä¸ª Observable è€Œä¸æ˜¯ä¸€ä¸ª Streamã€‚(èè‰å•°å—¦)</p><p><img src="/images/flutterstate5.png" alt=""></p><p>é»˜è®¤æƒ…å†µä¸‹ï¼ŒReplaySubject å°†Stream å·²ç»å‘å‡ºçš„æ‰€æœ‰äº‹ä»¶ä½œä¸ºç¬¬ä¸€ä¸ªäº‹ä»¶å‘é€åˆ°ä»»ä½•æ–°çš„ä¾¦å¬å™¨ã€‚</p></li></ol><h3 id="BloC"><a href="#BloC" class="headerlink" title="BloC"></a>BloC</h3><p>BLoC ä»£è¡¨ä¸šåŠ¡é€»è¾‘ç»„ä»¶ (<strong>B</strong>usiness <strong>Lo</strong>gic <strong>C</strong>omponent)ã€‚ä¸€èˆ¬çš„ Flutter ä»£ç ä¸šåŠ¡é€»è¾‘å’ŒUIç»„ä»¶ç³…åˆåœ¨ä¸€èµ·ï¼Œä¸æ–¹ä¾¿æµ‹è¯•ï¼Œä¸åˆ©äºå•ç‹¬çš„æµ‹è¯•ä¸šåŠ¡é€»è¾‘éƒ¨åˆ†ï¼Œä¸èƒ½æ›´å¥½çš„é‡ç”¨ä¸šåŠ¡é€»è¾‘ä»£ç ï¼Œä½“ç°åœ¨ï¼Œå¦‚æœç½‘ç»œè¯·æ±‚çš„é€»è¾‘æœ‰æ‰€å˜åŠ¨çš„è¯ï¼ŒåŠ å…¥è¿™ä¸ªä¸šåŠ¡åŠŸèƒ½è¢«ä¸¤ä¸ªç«¯ï¼ˆwebã€flutterï¼‰ä½¿ç”¨çš„è¯ï¼Œæ˜¯éœ€è¦æ”¹åŠ¨ä¸¤ä¸ªåœ°æ–¹çš„ã€‚</p><p>ç®€è€Œè¨€ä¹‹ï¼Œä¸šåŠ¡é€»è¾‘éœ€è¦ï¼š</p><ul><li>è¢«ç§»æ¤åˆ°ä¸€ä¸ªæˆ–å‡ ä¸ª BLoC ä¸­ï¼Œ</li><li>å°½å¯èƒ½ä»è¡¨ç¤ºå±‚ä¸­åˆ é™¤ã€‚ ä¹Ÿå°±æ˜¯è¯´ï¼ŒUIç»„ä»¶åº”è¯¥åªå…³å¿ƒUIäº‹ç‰©è€Œä¸å…³å¿ƒä¸šåŠ¡ï¼Œ</li><li>ä¾èµ– Streams ä½¿ç”¨è¾“å…¥ï¼ˆSinkï¼‰å’Œè¾“å‡ºï¼ˆ<em>stream</em>ï¼‰ï¼Œ</li><li>ä¿æŒå¹³å°ç‹¬ç«‹ï¼Œ</li><li>ä¿æŒç¯å¢ƒç‹¬ç«‹ã€‚</li></ul><p>äº‹å®ä¸Šï¼ŒBLoC æ¨¡å¼æœ€åˆçš„è®¾æƒ³æ˜¯å®ç°å…è®¸ç‹¬ç«‹äºå¹³å°é‡ç”¨ç›¸åŒçš„ä»£ç ï¼šWebåº”ç”¨ç¨‹åºï¼Œç§»åŠ¨åº”ç”¨ç¨‹åºï¼Œåç«¯ã€‚</p><p>Bloc çš„å¤§æ¦‚å°±æ˜¯ Stream åœ¨ Flutter ä¸­çš„æœ€ä½³å®è·µï¼š</p><figure class="image-bubble">                <div class="img-lightbox">                    <div class="overlay"></div>                    <img src="/images/flutterstate6.png" alt="" title="">                </div>                <div class="image-caption"></div>            </figure><ul><li>ç»„ä»¶é€šè¿‡ Sinks å‘ BLoC å‘é€äº‹ä»¶ï¼Œ</li><li>BLoC é€šè¿‡ stream é€šçŸ¥ç»„ä»¶ï¼Œ</li><li>ç”± BLoC å®ç°çš„ä¸šåŠ¡é€»è¾‘ã€‚</li></ul><p>å°† BloC åº”ç”¨åœ¨è®¡æ•°å™¨åº”ç”¨ä¸­ï¼š</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">void</span> main() =&gt; runApp(<span class="keyword">new</span> MyApp());</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyApp</span> <span class="keyword">extends</span> <span class="title">StatelessWidget</span> </span>&#123;</span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  Widget build(BuildContext context) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> MaterialApp(</span><br><span class="line">        title: <span class="string">'Streams Demo'</span>,</span><br><span class="line">        theme: <span class="keyword">new</span> ThemeData(</span><br><span class="line">          primarySwatch: Colors.blue,</span><br><span class="line">        ),</span><br><span class="line">        home: BlocProvider&lt;IncrementBloc&gt;(</span><br><span class="line">          bloc: IncrementBloc(),</span><br><span class="line">          child: CounterPage(),</span><br><span class="line">        ),</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">CounterPage</span> <span class="keyword">extends</span> <span class="title">StatelessWidget</span> </span>&#123;</span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  Widget build(BuildContext context) &#123;</span><br><span class="line">    <span class="keyword">final</span> IncrementBloc bloc = BlocProvider.of&lt;IncrementBloc&gt;(context);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> Scaffold(</span><br><span class="line">      appBar: AppBar(title: Text(<span class="string">'Stream version of the Counter App'</span>)),</span><br><span class="line">      body: Center(</span><br><span class="line">        child: StreamBuilder&lt;<span class="built_in">int</span>&gt;(</span><br><span class="line">          stream: bloc.outCounter,</span><br><span class="line">          initialData: <span class="number">0</span>,</span><br><span class="line">          builder: (BuildContext context, AsyncSnapshot&lt;<span class="built_in">int</span>&gt; snapshot)&#123;</span><br><span class="line">            <span class="keyword">return</span> Text(<span class="string">'You hit me: <span class="subst">$&#123;snapshot.data&#125;</span> times'</span>);</span><br><span class="line">          &#125;</span><br><span class="line">        ),</span><br><span class="line">      ),</span><br><span class="line">      floatingActionButton: FloatingActionButton(</span><br><span class="line">        child: <span class="keyword">const</span> Icon(Icons.add),</span><br><span class="line">        onPressed: ()&#123;</span><br><span class="line">          bloc.incrementCounter.add(<span class="keyword">null</span>);</span><br><span class="line">        &#125;,</span><br><span class="line">      ),</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">IncrementBloc</span> <span class="keyword">implements</span> <span class="title">BlocBase</span> </span>&#123;</span><br><span class="line">  <span class="built_in">int</span> _counter;</span><br><span class="line"></span><br><span class="line">  <span class="comment">//</span></span><br><span class="line">  <span class="comment">// Stream to handle the counter</span></span><br><span class="line">  <span class="comment">//</span></span><br><span class="line">  StreamController&lt;<span class="built_in">int</span>&gt; _counterController = StreamController&lt;<span class="built_in">int</span>&gt;();</span><br><span class="line">  StreamSink&lt;<span class="built_in">int</span>&gt; <span class="keyword">get</span> _inAdd =&gt; _counterController.sink;</span><br><span class="line">  Stream&lt;<span class="built_in">int</span>&gt; <span class="keyword">get</span> outCounter =&gt; _counterController.stream;</span><br><span class="line"></span><br><span class="line">  <span class="comment">//</span></span><br><span class="line">  <span class="comment">// Stream to handle the action on the counter</span></span><br><span class="line">  <span class="comment">//</span></span><br><span class="line">  StreamController _actionController = StreamController();</span><br><span class="line">  StreamSink <span class="keyword">get</span> incrementCounter =&gt; _actionController.sink;</span><br><span class="line"></span><br><span class="line">  <span class="comment">//</span></span><br><span class="line">  <span class="comment">// Constructor</span></span><br><span class="line">  <span class="comment">//</span></span><br><span class="line">  IncrementBloc()&#123;</span><br><span class="line">    _counter = <span class="number">0</span>;</span><br><span class="line">    _actionController.stream</span><br><span class="line">                     .listen(_handleLogic);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">void</span> dispose()&#123;</span><br><span class="line">    _actionController.close();</span><br><span class="line">    _counterController.close();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">void</span> _handleLogic(data)&#123;</span><br><span class="line">    _counter = _counter + <span class="number">1</span>;</span><br><span class="line">    _inAdd.add(_counter);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä½ ä¸€å®šåœ¨è¯´ï¼Œå§æ§½ï¼Œå“‡é ï½ï½ä»€ä¹ˆåŠç©æ„ï¼Œé‚£ä¹ˆå°±ç•™ç€æ‚¬å¿µå§ï¼Œä»Šå¤©å†™ä¸åŠ¨äº†ï¼</p><p>Bolc çš„å…·ä½“å®ç°æˆ‘åœ¨æ ·ä¾‹ä»£ç é‡Œåˆ†ä¸¤æ­¥èµ°æ”¾åœ¨ä¸¤ä¸ªæ–‡ä»¶å¤¹é‡Œï¼å¦‚æœéœ€è¦å¯ä»¥å…ˆå»çœ‹çœ‹å°å°é²œã€‚</p><p>è¿™ç¯‡æ–‡ç« çš„ç›®çš„å°±æ˜¯ä»‹ç»ä¸€äº›æ¦‚å¿µç»™å¤§å®¶å…³äº Streamsã€RXDart åŠ Bloc è¯¦ç»†æ˜äº†çš„è§£é‡Šåç»­æ›´æ–°ï¼</p><h3 id="æ ·ä¾‹ä»£ç "><a href="#æ ·ä¾‹ä»£ç " class="headerlink" title="æ ·ä¾‹ä»£ç "></a>æ ·ä¾‹ä»£ç </h3><p><a href="https://github.com/MeandNi/Flutter_StatePro" target="_blank" rel="noopener">https://github.com/MeandNi/Flutter_StatePro</a></p><h3 id="å‚è€ƒé“¾æ¥"><a href="#å‚è€ƒé“¾æ¥" class="headerlink" title="å‚è€ƒé“¾æ¥"></a>å‚è€ƒé“¾æ¥</h3><p><a href="https://www.youtube.com/watch?v=RS36gBEp8OI&amp;index=115&amp;list=PLOU2XLYxmsIInFRc3M44HUTQc3b_YJ4-Y" target="_blank" rel="noopener">Build reactive mobile apps with Flutter (Google I/O â€˜18)</a></p><p><a href="https://www.didierboelens.com/2018/08/reactive-programming---streams---bloc/" target="_blank" rel="noopener">Reactive Programming - Streams - BLoC</a></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;åˆ©ç”¨ Flutter å†…ç½®çš„è®¸å¤šæ§ä»¶æˆ‘ä»¬å¯ä»¥æ‰“é€ å‡ºä¸€æ¬¾ä¸ä»…æ¼‚äº®è€Œä¸”å®Œç¾è·¨å¹³å°çš„ App å¤–å£³ï¼Œæˆ‘åˆ©ç”¨å…¶ç‰¹æ€§å®Œæˆäº†ç±»ä¼¼&lt;a href=&quot;https://github.com/MeandNi/Flutter_ZhiHu&quot; target=&quot;_blank&quot; rel=&quot;noopene
      
    
    </summary>
    
      <category term="åŸåˆ›" scheme="https://meandni.com/categories/%E5%8E%9F%E5%88%9B/"/>
    
    
      <category term="flutterå®æˆ˜" scheme="https://meandni.com/tags/flutter%E5%AE%9E%E6%88%98/"/>
    
  </entry>
  
  <entry>
    <title>FlutterçŸ¥ä¹Appå®è·µï¼šUI+Json+Utils</title>
    <link href="https://meandni.com/2019/01/29/flutter-zhihu/"/>
    <id>https://meandni.com/2019/01/29/flutter-zhihu/</id>
    <published>2019-01-29T07:17:22.000Z</published>
    <updated>2019-01-29T08:59:53.698Z</updated>
    
    <content type="html"><![CDATA[<h2 id="Flutterå®è·µä¹‹çŸ¥ä¹App"><a href="#Flutterå®è·µä¹‹çŸ¥ä¹App" class="headerlink" title="Flutterå®è·µä¹‹çŸ¥ä¹App"></a>Flutterå®è·µä¹‹çŸ¥ä¹App</h2><p>é¢„è§ˆå›¾ï¼š</p><figure class="image-bubble">                <div class="img-lightbox">                    <div class="overlay"></div>                    <img src="/images/showapp.jpg" alt="appå±•ç¤º" title="">                </div>                <div class="image-caption">appå±•ç¤º</div>            </figure><figure class="image-bubble">                <div class="img-lightbox">                    <div class="overlay"></div>                    <img src="/images/showapp2.jpg" alt="appå±•ç¤º" title="">                </div>                <div class="image-caption">appå±•ç¤º</div>            </figure><figure class="image-bubble">                <div class="img-lightbox">                    <div class="overlay"></div>                    <img src="/images/showgif.gif" alt="appå±•ç¤º" title="">                </div>                <div class="image-caption">appå±•ç¤º</div>            </figure><figure class="image-bubble">                <div class="img-lightbox">                    <div class="overlay"></div>                    <img src="/images/showgif2.gif" alt="appå±•ç¤º" title="">                </div>                <div class="image-caption">appå±•ç¤º</div>            </figure><h4 id="å¼€å‘ç¯å¢ƒ"><a href="#å¼€å‘ç¯å¢ƒ" class="headerlink" title="å¼€å‘ç¯å¢ƒ"></a>å¼€å‘ç¯å¢ƒ</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Flutter 1.0.0 â€¢ channel stable â€¢ https://github.com/flutter/flutter.git</span><br><span class="line">Framework â€¢ revision 5391447fae (9 weeks ago) â€¢ 2018-11-29 19:41:26 -0800</span><br><span class="line">Engine â€¢ revision 7375a0f414</span><br><span class="line">Tools â€¢ Dart 2.1.0 (build 2.1.0-dev.9.4 f9ebf21297)</span><br></pre></td></tr></table></figure><h4 id="ç¼–è¯‘è¿è¡Œ"><a href="#ç¼–è¯‘è¿è¡Œ" class="headerlink" title="ç¼–è¯‘è¿è¡Œ"></a>ç¼–è¯‘è¿è¡Œ</h4><ol><li><p>å…‹éš†ä»£ç </p><p>æºç åœ°å€ï¼š<a href="https://github.com/MeandNi/Flutter_ZhiHu" target="_blank" rel="noopener">https://github.com/MeandNi/Flutter_ZhiHu</a></p></li><li><p>å®‰è£…ä¾èµ–</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flutter packages get</span><br></pre></td></tr></table></figure></li></ol><h4 id="UI-å¤§è‡´ç»“æ„"><a href="#UI-å¤§è‡´ç»“æ„" class="headerlink" title="UI å¤§è‡´ç»“æ„"></a>UI å¤§è‡´ç»“æ„</h4><figure class="image-bubble">                <div class="img-lightbox">                    <div class="overlay"></div>                    <img src="/images/common.png" alt="" title="">                </div>                <div class="image-caption"></div>            </figure><p>é‡‡ç”¨ç±»ä¼¼ Android æ¨¡å—åŒ–æ€æƒ³ï¼Œå°†æ•´ä¸ª App çš„å†…å®¹åˆ†ä¸º5ä¸ªéƒ¨åˆ†.</p><figure class="image-bubble">                <div class="img-lightbox">                    <div class="overlay"></div>                    <img src="/images/common2.png" alt="" title="">                </div>                <div class="image-caption"></div>            </figure><h4 id="Ui-ç»†èŠ‚"><a href="#Ui-ç»†èŠ‚" class="headerlink" title="Ui ç»†èŠ‚"></a>Ui ç»†èŠ‚</h4><p>æš‚ä¸å™è¿°ï¼Œé¡¹ç›®ç›®å‰è¿˜åœ¨æ›´æ–°å®Œå–„ä¸­ï¼Œé¢„è®¡ä½¿ç”¨Reduxã€Sqlfliteç­‰æŠ€æœ¯æ ˆå¡«å……æ•°æ®éƒ¨åˆ†ï¼Œæœ¬é¡¹ç›®éƒ¨åˆ†ç•Œé¢åŠå·¥å…·ç±»æ¥è‡ª<a href="https://github.com/MeandNi/Flutter_CommonApp" target="_blank" rel="noopener">Flutter_CommonApp</a> ã€‚</p><h4 id="æ•°æ®ç»“æ„"><a href="#æ•°æ®ç»“æ„" class="headerlink" title="æ•°æ®ç»“æ„"></a>æ•°æ®ç»“æ„</h4><figure class="image-bubble">                <div class="img-lightbox">                    <div class="overlay"></div>                    <img src="/images/recommend.png" alt="" title="">                </div>                <div class="image-caption"></div>            </figure><figure class="image-bubble">                <div class="img-lightbox">                    <div class="overlay"></div>                    <img src="/images/idea.png" alt="" title="">                </div>                <div class="image-caption"></div>            </figure><figure class="image-bubble">                <div class="img-lightbox">                    <div class="overlay"></div>                    <img src="/images/question.png" alt="" title="">                </div>                <div class="image-caption"></div>            </figure><p>ç»“æ„å›¾å£•æ— ä¸“ä¸šæ€§å¯è¨€ï¼Œä»…ä¾›è§‚èµğŸ˜€ã€‚</p><h4 id="ç¬¬ä¸‰æ–¹æ¡†æ¶"><a href="#ç¬¬ä¸‰æ–¹æ¡†æ¶" class="headerlink" title="ç¬¬ä¸‰æ–¹æ¡†æ¶"></a>ç¬¬ä¸‰æ–¹æ¡†æ¶</h4><table><thead><tr><th>åº“</th><th>åŠŸèƒ½</th></tr></thead><tbody><tr><td><strong>dio</strong></td><td><strong>ç½‘ç»œæ¡†æ¶</strong></td></tr><tr><td><strong>carousel_slider</strong></td><td><strong>è½®æ’­å›¾</strong></td></tr><tr><td><strong>cached_network_image</strong></td><td><strong>å›¾ç‰‡åŠ è½½</strong></td></tr><tr><td><strong>share</strong></td><td><strong>é“¾æ¥åˆ†äº«</strong></td></tr><tr><td><strong>flutter_webview_plugin</strong></td><td><strong>WebView</strong></td></tr></tbody></table><h4 id="é¸£è°¢"><a href="#é¸£è°¢" class="headerlink" title="é¸£è°¢"></a>é¸£è°¢</h4><p>æ„Ÿè°¢é‚£äº›çƒ­çˆ±å¼€æºã€ä¸€èµ·å¥‹æ–—çš„æœ‹å‹ä»¬ã€‚</p><p>å€¼å¾—å­¦ä¹ è¯·Starå•Š^_^</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;Flutterå®è·µä¹‹çŸ¥ä¹App&quot;&gt;&lt;a href=&quot;#Flutterå®è·µä¹‹çŸ¥ä¹App&quot; class=&quot;headerlink&quot; title=&quot;Flutterå®è·µä¹‹çŸ¥ä¹App&quot;&gt;&lt;/a&gt;Flutterå®è·µä¹‹çŸ¥ä¹App&lt;/h2&gt;&lt;p&gt;é¢„è§ˆå›¾ï¼š&lt;/p&gt;
&lt;figure c
      
    
    </summary>
    
      <category term="åŸåˆ›" scheme="https://meandni.com/categories/%E5%8E%9F%E5%88%9B/"/>
    
    
      <category term="flutterå®æˆ˜" scheme="https://meandni.com/tags/flutter%E5%AE%9E%E6%88%98/"/>
    
  </entry>
  
  <entry>
    <title>Flutterè¿›é˜¶ï¼šåœ¨åº”ç”¨ä¸­å®ç° Hero(é£è¡Œ) åŠ¨ç”»</title>
    <link href="https://meandni.com/2019/01/27/flutter-hero/"/>
    <id>https://meandni.com/2019/01/27/flutter-hero/</id>
    <published>2019-01-27T12:12:07.000Z</published>
    <updated>2019-01-27T13:31:58.587Z</updated>
    
    <content type="html"><![CDATA[<figure class="image-bubble">                <div class="img-lightbox">                    <div class="overlay"></div>                    <img src="/images/hero.png" alt="" title="">                </div>                <div class="image-caption"></div>            </figure><table><thead><tr><th>æ ‡é¢˜</th><th>é“¾æ¥</th></tr></thead><tbody><tr><td>Flutterè¿›é˜¶ï¼šæ·±å…¥æ¢ç©¶ ListView å’Œ ScrollPhysics</td><td><a href="https://juejin.im/post/5c4c202df265da615064ce4b" target="_blank" rel="noopener">https://juejin.im/post/5c4c202df265da615064ce4b</a></td></tr><tr><td>Flutterè¿›é˜¶ï¼šæ·±å…¥æ¢ç©¶ TextField</td><td><a href="https://juejin.im/post/5c4c4e22f265da6174652fb4" target="_blank" rel="noopener">https://juejin.im/post/5c4c4e22f265da6174652fb4</a></td></tr></tbody></table><h2 id="hero-åŠ¨ç”»ä»‹ç»"><a href="#hero-åŠ¨ç”»ä»‹ç»" class="headerlink" title="hero åŠ¨ç”»ä»‹ç»"></a>hero åŠ¨ç”»ä»‹ç»</h2><p>Hero æŒ‡çš„æ˜¯å¯ä»¥åœ¨è·¯ç”±(é¡µé¢)ä¹‹é—´â€œé£è¡Œâ€çš„ widgetï¼Œä»ä¸€ä¸ªé¡µé¢æ‰“å¼€å¦ä¸€ä¸ªé¡µé¢æ—¶äº§ç”Ÿä¸€ä¸ªç®€å•çš„è¿‡æ¸¡åŠ¨ç”»ï¼Œçœ‹ä¸‹å›¾å®ä¾‹ï¼š</p><figure class="image-bubble">                <div class="img-lightbox">                    <div class="overlay"></div>                    <img src="/images/hero1.gif" alt="" title="">                </div>                <div class="image-caption"></div>            </figure><center><img width="384px" height="640" src="/images/hero2.gif"></center><p>Hero Animations é‡‡ç”¨ç±»ä¼¼å›¾æ ‡çš„ widget ï¼Œç§°ä¸ºâ€œheroâ€ï¼Œä¸€æ—¦è§¦å‘é¡µé¢è¿‡æ¸¡ï¼Œä¾‹å¦‚é€šè¿‡å•å‡»å›¾æ ‡ï¼Œhero å°†ä¼šâ€œé£â€åˆ°ä¸‹ä¸€é¡µã€‚ å½“ç”¨æˆ·å¯¼èˆªå›åˆ°ä¸Šä¸€é¡µé¢æ—¶ï¼Œä¹Ÿå°†å®ç°åŸè·¯è¿”å›çš„åŠ¨ç”»ã€‚</p><p>æ›´å¤šä»‹ç»ï¼Œè¯·çœ‹<a href="https://flutter.io/docs/development/ui/animations/hero-animations" target="_blank" rel="noopener">å®˜ç½‘</a>ã€‚</p><p>è¿™é‡Œæˆ‘ä»¬ä¸ä»…å­¦ä¹ å¦‚ä½•ä½¿ç”¨ hero åŠ¨ç”»ï¼Œä¹Ÿå°†ä¼šè‡ªå®šä¹‰ä¸€äº›æˆ‘ä»¬è‡ªå·±å®ç°çš„åŠ¨ç”»ã€‚</p><h2 id="æ„å»ºä¸€ä¸ªæ™®é€šçš„-hero-åŠ¨ç”»"><a href="#æ„å»ºä¸€ä¸ªæ™®é€šçš„-hero-åŠ¨ç”»" class="headerlink" title="æ„å»ºä¸€ä¸ªæ™®é€šçš„ hero åŠ¨ç”»"></a>æ„å»ºä¸€ä¸ªæ™®é€šçš„ hero åŠ¨ç”»</h2><p>hero åŠ¨ç”»å…è®¸æˆ‘ä»¬åœ¨ Flutter ä¸­ç”¨æœ€ç®€å•çš„æ–¹å¼å®ç°æ¼‚äº®åŠ¨ç”»ï¼Œæ— éœ€å¤ªå¤šè®¾ç½®ã€‚ åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ä¸¤ä¸ªé¡µé¢ä¸Šéƒ½å­˜åœ¨ç›¸åŒçš„å›¾æ ‡æˆ–è€…å›¾ç‰‡ã€‚ æˆ‘ä»¬éœ€è¦åšçš„åªæ˜¯ <strong>è®©è¿™ä¸¤è€…ä»¥æŸç§æ–¹å¼ç›¸å…³è”</strong>ã€‚</p><p>è¦å®ç°å®ƒï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡åœ¨ Hero ç»„ä»¶ä¸­åŒ…å«å›¾æ ‡ä¹‹ç±»çš„ç»„ä»¶ã€‚</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">Hero(</span><br><span class="line">  tag: <span class="string">"DemoTag"</span>,</span><br><span class="line">  child: Icon(</span><br><span class="line">    Icons.add,</span><br><span class="line">    size: <span class="number">70.0</span>,</span><br><span class="line">  ),</span><br><span class="line">),</span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬éœ€è¦è®¾ç½®äº†ä¸€ä¸ª tag å‚æ•°ï¼Œç»™è¿™ä¸ª  hero ä¸€ä¸ªç‹¬ç«‹çš„åå­—ï¼ˆç±»æ¯” Android ä¸­çš„ IDï¼‰ï¼Œå› ä¸ºå¦‚æœæˆ‘ä»¬åœ¨åŒä¸€é¡µé¢ä¸Šæœ‰å¤šä¸ª hero ï¼Œæ¯ä¸ª hero éƒ½éœ€è¦çŸ¥é“å®ƒä»¬å°†é£å¾€ä½•å¤„ä¸”åœ¨å„ä¸ç›¸åŒçš„åœ°æ–¹ã€‚</p><p>ç°åœ¨åº”ç”¨ç¨‹åºæœ‰ä¸€ä¸ª hero ç»„ä»¶æƒ³è¦é£åˆ°ä¸‹ä¸€é¡µã€‚æ¥ä¸‹æ¥å°±æ˜¯è¦å‘Šè¯‰å®ƒå°†è¦é£å‘ä½•å¤„ã€‚</p><p>æˆ‘ä»¬ä»…éœ€è¦åœ¨ç¬¬äºŒé¡µä¸Šæ·»åŠ å¸¦æœ‰ç›¸åŒæ ‡ç­¾çš„Heroå°éƒ¨ä»¶å°±å¯å®ç°è¿™ä¸ªæ•ˆæœã€‚</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">Hero(</span><br><span class="line">  tag: <span class="string">"DemoTag"</span>,</span><br><span class="line">  child: Icon(</span><br><span class="line">    Icons.add,</span><br><span class="line">    size: <span class="number">150.0</span>,</span><br><span class="line">  ),</span><br><span class="line">),</span><br></pre></td></tr></table></figure><p>å®ä¾‹å¦‚ä¸‹ï¼š</p><figure class="image-bubble">                <div class="img-lightbox">                    <div class="overlay"></div>                    <img src="/images/hero3.gif" alt="" title="">                </div>                <div class="image-caption"></div>            </figure><h2 id="è‡ªå®šä¹‰-hero-åŠ¨ç”»"><a href="#è‡ªå®šä¹‰-hero-åŠ¨ç”»" class="headerlink" title="è‡ªå®šä¹‰ hero åŠ¨ç”»"></a>è‡ªå®šä¹‰ hero åŠ¨ç”»</h2><p>Hero ç»„ä»¶å…è®¸æˆ‘ä»¬è‡ªå®šä¹‰å„ç§è¿‡æ¸¡æ•ˆæœã€‚ æœ‰ä»¥ä¸‹å‡ ç§æ–¹æ³•ã€‚</p><h3 id="æ·»åŠ å ä½ç¬¦"><a href="#æ·»åŠ å ä½ç¬¦" class="headerlink" title="æ·»åŠ å ä½ç¬¦"></a>æ·»åŠ å ä½ç¬¦</h3><p>åœ¨ç»„ä»¶é£ç¦»å®ƒæ›¾ç»å¤„äºçš„ä½ç½®å¹¶ä¸”åˆ°è¾¾ç›®æ ‡ä½ç½®ä¹‹å‰ï¼Œç›®æ ‡å¤„æœ‰ä¸€å¤„ç©ºçš„åœ°æ–¹ã€‚ æˆ‘ä»¬å¯ä»¥åœ¨æ­¤ä½ç½®æ·»åŠ <strong>å ä½ç¬¦</strong>ã€‚</p><p>æˆ‘ä»¬ç°åœ¨ä½¿ç”¨ CircularProgressIndicator ä½œä¸ºå ä½ç¬¦ã€‚</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">Hero(</span><br><span class="line">    tag: <span class="string">"DemoTag"</span>,</span><br><span class="line">    child: Icon(</span><br><span class="line">      Icons.add,</span><br><span class="line">      size: <span class="number">150.0</span>,</span><br><span class="line">    ),</span><br><span class="line">    placeholderBuilder: (context, widget) &#123;</span><br><span class="line">      <span class="keyword">return</span> Container(</span><br><span class="line">        height: <span class="number">150.0</span>,</span><br><span class="line">        width: <span class="number">150.0</span>,</span><br><span class="line">        child: CircularProgressIndicator(),</span><br><span class="line">      );</span><br><span class="line">    &#125;,</span><br><span class="line">  ),</span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬ä½¿ç”¨ placeholderBuilder æ¥æ„é€ å ä½ç¬¦å¹¶è¿”å›æˆ‘ä»¬å¸Œæœ›ä½œä¸ºå ä½ç¬¦çš„ç»„ä»¶ã€‚</p><p>ä½¿ç”¨å ä½ç¬¦ï¼š</p><figure class="image-bubble">                <div class="img-lightbox">                    <div class="overlay"></div>                    <img src="/images/hero4.gif" alt="" title="">                </div>                <div class="image-caption"></div>            </figure><h3 id="æ›´æ”¹-hero-ç»„ä»¶"><a href="#æ›´æ”¹-hero-ç»„ä»¶" class="headerlink" title="æ›´æ”¹ hero ç»„ä»¶"></a>æ›´æ”¹ hero ç»„ä»¶</h3><p>Flutter å…è®¸æˆ‘ä»¬æ›´æ”¹ä»ä¸€ä¸ªé¡µé¢é£åˆ°å¦ä¸€ä¸ªé¡µé¢è¿‡ç¨‹çš„ç»„ä»¶ï¼Œè€Œæ— éœ€æ›´æ”¹ä¸¤ä¸ªé¡µé¢ä¸Šçš„ç»„ä»¶ã€‚</p><p>è®©æˆ‘ä»¬<strong>åœ¨ä¸æ›´æ”¹ hero ç»„ä»¶çš„å­ç»„ä»¶çš„å‰æä¸‹</strong>ï¼Œä½¿ç”¨ç«ç®­å›¾æ ‡â€œé£â€è€Œä¸æ˜¯ â€œ+â€ å›¾æ ‡ ã€‚</p><figure class="image-bubble">                <div class="img-lightbox">                    <div class="overlay"></div>                    <img src="/images/hero5.gif" alt="" title="">                </div>                <div class="image-caption"></div>            </figure><p>æˆ‘ä»¬ä½¿ç”¨ <strong>flightShuttleBuilder</strong> å‚æ•°æ‰§è¡Œæ­¤æ“ä½œã€‚</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">Hero(</span><br><span class="line">  tag: <span class="string">"DemoTag"</span>,</span><br><span class="line">  child: Icon(</span><br><span class="line">    Icons.add,</span><br><span class="line">    size: <span class="number">150.0</span>,</span><br><span class="line">  ),</span><br><span class="line">  flightShuttleBuilder: (flightContext, animation, direction,</span><br><span class="line">      fromContext, toContext) &#123;</span><br><span class="line">    <span class="keyword">return</span> Icon(FontAwesomeIcons.rocket, size: <span class="number">150.0</span>,);</span><br><span class="line">  &#125;,</span><br><span class="line">),</span><br></pre></td></tr></table></figure><p>flightShuttleBuilder æœ‰5ä¸ªå‚æ•°ï¼Œç”¨æ¥è®¾ç½®åŠ¨ç”»ä»¥åŠåŠ¨ç”»çš„æ–¹å‘ã€‚</p><p>ç›®å‰ï¼Œä¸¤ä¸ªæ–¹å‘çš„ç«ç®­å›¾æ ‡å¤§å°éƒ½ä¿æŒåœ¨ 150.0 ã€‚ é€šè¿‡ä½¿ç”¨æ–¹æ³•çš„ direction å‚æ•°ï¼Œæˆ‘ä»¬å¯ä»¥ä¸ºæ¯ä¸ªæ–¹å‘é…ç½®ä¸åŒçš„é…ç½®ã€‚</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(direction == HeroFlightDirection.push) &#123;</span><br><span class="line">  <span class="keyword">return</span> Icon(</span><br><span class="line">    FontAwesomeIcons.rocket,</span><br><span class="line">    size: <span class="number">150.0</span>,</span><br><span class="line">  );</span><br><span class="line">&#125; <span class="keyword">else</span> <span class="keyword">if</span> (direction == HeroFlightDirection.pop)&#123;</span><br><span class="line">  <span class="keyword">return</span> Icon(</span><br><span class="line">    FontAwesomeIcons.rocket,</span><br><span class="line">    size: <span class="number">70.0</span>,</span><br><span class="line">  );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="image-bubble">                <div class="img-lightbox">                    <div class="overlay"></div>                    <img src="/images/hero6.gif" alt="" title="">                </div>                <div class="image-caption"></div>            </figure><h3 id="ä½¿-hero-åŠ¨ç”»å¯ä»¥æ”¯æŒ-iOS-è¿”å›æ»‘åŠ¨æ‰‹åŠ¿"><a href="#ä½¿-hero-åŠ¨ç”»å¯ä»¥æ”¯æŒ-iOS-è¿”å›æ»‘åŠ¨æ‰‹åŠ¿" class="headerlink" title="ä½¿ hero åŠ¨ç”»å¯ä»¥æ”¯æŒ iOS è¿”å›æ»‘åŠ¨æ‰‹åŠ¿"></a>ä½¿ hero åŠ¨ç”»å¯ä»¥æ”¯æŒ iOS è¿”å›æ»‘åŠ¨æ‰‹åŠ¿</h3><p>é»˜è®¤æƒ…å†µä¸‹ï¼Œå½“åœ¨ iOS ä¸ŠæŒ‰åé€€æŒ‰é’®æ—¶ï¼Œhero åŠ¨ç”»ä¼šæœ‰æ•ˆæœï¼Œä½†å®ƒä»¬åœ¨æ‰‹åŠ¿æ»‘åŠ¨æ—¶å¹¶æ²¡æœ‰ã€‚</p><p><strong>ä½¿ç”¨è¿”å›æŒ‰é’®ï¼š</strong></p><figure class="image-bubble">                <div class="img-lightbox">                    <div class="overlay"></div>                    <img src="/images/hero7.gif" alt="" title="">                </div>                <div class="image-caption"></div>            </figure><p><strong>ä½¿ç”¨æ»‘åŠ¨æ‰‹åŠ¿</strong></p><figure class="image-bubble">                <div class="img-lightbox">                    <div class="overlay"></div>                    <img src="/images/hero8.gif" alt="" title="">                </div>                <div class="image-caption"></div>            </figure><p>è¦è§£å†³æ­¤é—®é¢˜ï¼Œåªéœ€åœ¨ä¸¤ä¸ª Hero ç»„ä»¶ä¸Šå°† transitionOnUserGestures è®¾ç½®ä¸º true å³å¯ã€‚ é»˜è®¤æƒ…å†µä¸‹è¿™é‡Œæ˜¯ falseã€‚</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">Hero(</span><br><span class="line">  tag: <span class="string">"DemoTag"</span>,</span><br><span class="line">  child: Icon(</span><br><span class="line">    Icons.add,</span><br><span class="line">  ),</span><br><span class="line">  transitionOnUserGestures: <span class="keyword">true</span>,</span><br><span class="line">),</span><br></pre></td></tr></table></figure><p>æ•ˆæœå¦‚ä¸‹ï¼š</p><figure class="image-bubble">                <div class="img-lightbox">                    <div class="overlay"></div>                    <img src="/images/hero9.gif" alt="" title="">                </div>                <div class="image-caption"></div>            </figure><h2 id="æœ€å"><a href="#æœ€å" class="headerlink" title="æœ€å"></a>æœ€å</h2><p>åˆ©ç”¨æ—¶é—´æ•´ç†åˆ†æè‡ªå·±æ‰€å­¦çš„çŸ¥è¯†æ˜¯ä»¶éå¸¸æœ‰æ„ä¹‰çš„äº‹æƒ…ï¼Œå¸Œæœ›è¿™ä¹Ÿèƒ½å¸®åˆ°å…¶ä»–æ­£åœ¨å­¦ä¹ çš„åŒå­¦ã€‚åŒæ—¶æˆ‘ä¹Ÿæ­£åœ¨ç”¨Flutterå†™å‡ ä¸ªé¡¹ç›®ï¼Œå†™å¥½ä¹‹åå°±ä¼šå¼€æºç»™å¤§å®¶ã€‚</p><p>Githubï¼š<a href="https://github.com/MeandNi" target="_blank" rel="noopener">https://github.com/MeandNi</a></p><p>æ¬¢è¿ä¸€èµ·äº¤æµç§»åŠ¨å¼€å‘çš„æŠ€æœ¯ï¼</p><h2 id="å‚è€ƒèµ„æ–™ï¼š"><a href="#å‚è€ƒèµ„æ–™ï¼š" class="headerlink" title="å‚è€ƒèµ„æ–™ï¼š"></a>å‚è€ƒèµ„æ–™ï¼š</h2><p><a href="https://flutter.io/docs/development/ui/animations/hero-animations" target="_blank" rel="noopener">https://flutter.io/docs/development/ui/animations/hero-animations</a></p><p><a href="https://medium.com/flutter-community/a-deep-dive-into-hero-widgets-in-flutter-d34f441eb026" target="_blank" rel="noopener">https://medium.com/flutter-community/a-deep-dive-into-hero-widgets-in-flutter-d34f441eb026</a></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;figure class=&quot;image-bubble&quot;&gt;
                &lt;div class=&quot;img-lightbox&quot;&gt;
                    &lt;div class=&quot;overlay&quot;&gt;&lt;/div&gt;
                   
      
    
    </summary>
    
      <category term="æ•´ç†" scheme="https://meandni.com/categories/%E6%95%B4%E7%90%86/"/>
    
    
      <category term="flutterè¿›é˜¶" scheme="https://meandni.com/tags/flutter%E8%BF%9B%E9%98%B6/"/>
    
  </entry>
  
  <entry>
    <title>Flutterè¿›é˜¶ï¼šæ·±å…¥æ¢ç©¶ TextField</title>
    <link href="https://meandni.com/2019/01/26/flutter-exploring-textfield/"/>
    <id>https://meandni.com/2019/01/26/flutter-exploring-textfield/</id>
    <published>2019-01-26T07:34:32.000Z</published>
    <updated>2019-01-26T10:45:06.562Z</updated>
    
    <content type="html"><![CDATA[<figure class="image-bubble">                <div class="img-lightbox">                    <div class="overlay"></div>                    <img src="/images/textfield.png" alt="" title="">                </div>                <div class="image-caption"></div>            </figure><h2 id="TextField-ä»‹ç»"><a href="#TextField-ä»‹ç»" class="headerlink" title="TextField ä»‹ç»"></a>TextField ä»‹ç»</h2><p>TextField ç»„ä»¶å¯ä»¥è®©ç”¨æˆ·å¡«å†™ä¿¡æ¯ã€‚ TextField çš„ä»£ç éå¸¸ç®€å•ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">TextField()</span><br></pre></td></tr></table></figure><figure class="image-bubble">                <div class="img-lightbox">                    <div class="overlay"></div>                    <img src="/images/textfield1.png" alt="" title="">                </div>                <div class="image-caption"></div>            </figure><h2 id="ä»TextFieldä¸­æ£€ç´¢ä¿¡æ¯"><a href="#ä»TextFieldä¸­æ£€ç´¢ä¿¡æ¯" class="headerlink" title="ä»TextFieldä¸­æ£€ç´¢ä¿¡æ¯"></a>ä»TextFieldä¸­æ£€ç´¢ä¿¡æ¯</h2><p>ç”±äº TextFields ç»„ä»¶æ²¡æœ‰åƒ Android ä¸­é‚£æ ·çš„ IDï¼Œå› æ­¤æ— æ³•æ ¹æ®éœ€è¦æ£€ç´¢æ–‡æœ¬ï¼Œè€Œå¿…é¡»åœ¨æ›´æ”¹æ—¶å°†å…¶å­˜å‚¨åœ¨å˜é‡ä¸­æˆ–ä½¿ç”¨æ§åˆ¶å™¨ã€‚</p><ol><li><p>æœ€ç®€å•çš„æ–¹æ³•æ˜¯ä½¿ç”¨ onChanged æ–¹æ³•å¹¶å°†å½“å‰å€¼å­˜å‚¨åœ¨ä¸€ä¸ªå˜é‡ä¸­ã€‚ç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">String</span> value = <span class="string">""</span>;</span><br><span class="line">TextField(</span><br><span class="line">  onChanged: (text) &#123;</span><br><span class="line">    value = text;</span><br><span class="line">  &#125;,</span><br><span class="line">)</span><br></pre></td></tr></table></figure></li><li><p>ç¬¬äºŒç§æ–¹æ³•æ˜¯ä½¿ç”¨ TextEditingController ã€‚ æ§åˆ¶å™¨è¿æ¥åˆ° TextField ï¼Œè®©æˆ‘ä»¬ä¹Ÿå¯ä»¥ç›‘å¬å’Œæ§åˆ¶ TextField çš„å†…å®¹ã€‚</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">TextEditingController controller = TextEditingController();</span><br><span class="line">TextField(</span><br><span class="line">  controller: controller,</span><br><span class="line">)</span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬å¯ä»¥è¿™æ ·ç›‘å¬å˜åŒ–</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">controller.addListener(() &#123;</span><br><span class="line">  <span class="comment">// Do something here</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>è·å–ã€è®¾ç½®æ–‡æœ¬å†…å®¹ï¼š</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(controller.text); <span class="comment">// Print current value</span></span><br><span class="line">controller.text = <span class="string">"Demo Text"</span>; <span class="comment">// Set new value</span></span><br></pre></td></tr></table></figure></li></ol><h2 id="TextField-ä¸­å…¶ä»–çš„å›è°ƒ"><a href="#TextField-ä¸­å…¶ä»–çš„å›è°ƒ" class="headerlink" title="TextField ä¸­å…¶ä»–çš„å›è°ƒ"></a>TextField ä¸­å…¶ä»–çš„å›è°ƒ</h2><p>TextField ç»„ä»¶è¿˜æä¾›å…¶ä»–å›è°ƒï¼Œä¾‹å¦‚ï¼š</p><ol><li>onEditingCompleted</li><li>onSubmitted</li></ol><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">onEditingComplete: () &#123;&#125;,</span><br><span class="line">onSubmitted: (value) &#123;&#125;,</span><br></pre></td></tr></table></figure><p>è¿™äº›æ˜¯åœ¨ç”¨æˆ·å•å‡» iOS ä¸Šçš„â€œå®Œæˆâ€æŒ‰é’®æ—¶è°ƒç”¨çš„å›è°ƒã€‚</p><h2 id="åœ¨-TextField-ä¸­ä½¿ç”¨ç„¦ç‚¹"><a href="#åœ¨-TextField-ä¸­ä½¿ç”¨ç„¦ç‚¹" class="headerlink" title="åœ¨ TextField ä¸­ä½¿ç”¨ç„¦ç‚¹"></a>åœ¨ TextField ä¸­ä½¿ç”¨ç„¦ç‚¹</h2><p>åœ¨ TextField ä¸Šâ€œèšç„¦â€æ„å‘³ç€æ¿€æ´» TextField ï¼Œé”®ç›˜çš„ä»»ä½•è¾“å…¥éƒ½å°†å¯¼è‡´åœ¨èšç„¦çš„ TextField ä¸­è¾“å…¥æ•°æ®ã€‚</p><h3 id="1-ä½¿å…¶è‡ªåŠ¨èšç„¦"><a href="#1-ä½¿å…¶è‡ªåŠ¨èšç„¦" class="headerlink" title="1. ä½¿å…¶è‡ªåŠ¨èšç„¦"></a>1. ä½¿å…¶è‡ªåŠ¨èšç„¦</h3><p>è¦åœ¨åˆ›å»ºçª—å£æ—¶åœ¨ TextField ä¸Šè‡ªåŠ¨å¯¹ç„¦ï¼Œè¯·å°†è‡ªåŠ¨å¯¹ç„¦å­—æ®µè®¾ç½®ä¸º true ã€‚</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">TextField(</span><br><span class="line">  autofocus: <span class="keyword">true</span>,</span><br><span class="line">),</span><br></pre></td></tr></table></figure><p>é»˜è®¤æƒ…å†µä¸‹ï¼Œè¿™ä¼šå°†ç„¦ç‚¹è®¾ç½®åœ¨ TextField ä¸Šã€‚</p><figure class="image-bubble">                <div class="img-lightbox">                    <div class="overlay"></div>                    <img src="/images/textfield2.gif" alt="" title="">                </div>                <div class="image-caption"></div>            </figure><h3 id="2-è‡ªå®šä¹‰æ›´æ”¹ç„¦ç‚¹"><a href="#2-è‡ªå®šä¹‰æ›´æ”¹ç„¦ç‚¹" class="headerlink" title="2.è‡ªå®šä¹‰æ›´æ”¹ç„¦ç‚¹"></a>2.è‡ªå®šä¹‰æ›´æ”¹ç„¦ç‚¹</h3><p>å¦‚æœæˆ‘ä»¬æƒ³è¦æ”¹å˜ç„¦ç‚¹è€Œä¸ä»…ä»…æ˜¯è‡ªåŠ¨å¯¹ç„¦æ€ä¹ˆåŠï¼Ÿ çœ‹ä¸‹é¢ä»£ç  ï¼Œæˆ‘ä»¬å°† FocusNode é™„åŠ åˆ° TextField å¹¶ä½¿ç”¨å®ƒæ¥åˆ‡æ¢ç„¦ç‚¹ã€‚</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Initialise outside the build method</span></span><br><span class="line">FocusNode nodeOne = FocusNode();</span><br><span class="line">FocusNode nodeTwo = FocusNode();</span><br><span class="line"><span class="comment">// Do this inside the build method</span></span><br><span class="line">TextField(</span><br><span class="line">  focusNode: nodeOne,</span><br><span class="line">),</span><br><span class="line">TextField(</span><br><span class="line">  focusNode: nodeTwo,</span><br><span class="line">),</span><br><span class="line">RaisedButton(</span><br><span class="line">  onPressed: () &#123;</span><br><span class="line">    FocusScope.of(context).requestFocus(nodeTwo);</span><br><span class="line">  &#125;,</span><br><span class="line">  child: Text(<span class="string">"Next Field"</span>),</span><br><span class="line">),</span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬åˆ›å»ºä¸¤ä¸ªç„¦ç‚¹èŠ‚ç‚¹å¹¶å°†å®ƒä»¬é™„åŠ åˆ° TextFields ã€‚ æŒ‰ä¸‹æŒ‰é’®æ—¶ï¼Œæˆ‘ä»¬ä½¿ç”¨ FocusScope è¯·æ±‚ç„¦ç‚¹åˆ°ä¸‹ä¸€ä¸ªTextFieldã€‚</p><figure class="image-bubble">                <div class="img-lightbox">                    <div class="overlay"></div>                    <img src="/images/textfield3.gif" alt="" title="">                </div>                <div class="image-caption"></div>            </figure><h2 id="æ›´æ”¹-TextFields-çš„é”®ç›˜å±æ€§"><a href="#æ›´æ”¹-TextFields-çš„é”®ç›˜å±æ€§" class="headerlink" title="æ›´æ”¹ TextFields çš„é”®ç›˜å±æ€§"></a>æ›´æ”¹ TextFields çš„é”®ç›˜å±æ€§</h2><p>Flutter ä¸­çš„ TextField å…è®¸æˆ‘ä»¬è‡ªå®šä¹‰ä¸é”®ç›˜ç›¸å…³çš„å±æ€§ã€‚</p><h3 id="1-é”®ç›˜ç±»å‹"><a href="#1-é”®ç›˜ç±»å‹" class="headerlink" title="1.é”®ç›˜ç±»å‹"></a>1.é”®ç›˜ç±»å‹</h3><p>TextField å…è®¸æ‚¨è‡ªå®šä¹‰åœ¨ TextField æˆä¸ºç„¦ç‚¹æ—¶æ˜¾ç¤ºçš„é”®ç›˜ç±»å‹ã€‚ æˆ‘ä»¬æ›´æ”¹ keyboardType å±æ€§ã€‚</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">TextField(</span><br><span class="line">  keyboardType: TextInputType.number,</span><br><span class="line">),</span><br></pre></td></tr></table></figure><p>ç±»å‹æœ‰ï¼š</p><ol><li><strong>TextInputType.text</strong> (æ™®é€šå…¨é”®ç›˜)</li><li><strong>TextInputType.number</strong> (æ•°å­—é”®ç›˜)</li><li><strong>TextInputType.emailAddress</strong> (æ™®é€šé”®ç›˜ï¼Œå¸¦æœ‰â€œ@â€ç¬¦å·)</li><li><strong>TextInputType.datetime</strong> (æ•°å­—é”®ç›˜ï¼Œå¸¦æœ‰ â€œ/â€ å’Œ  â€œ:â€ ç¬¦å·)</li><li><strong>TextInputType.multiline</strong> (æ•°å­—é”®ç›˜ï¼Œå¸¦æœ‰å¯ç”¨æœ‰ç¬¦å·å’Œåè¿›åˆ¶æ¨¡å¼çš„é€‰é¡¹)</li></ol><h3 id="2-TextInputAction"><a href="#2-TextInputAction" class="headerlink" title="2.TextInputAction"></a>2.TextInputAction</h3><p>æ›´æ”¹ TextField çš„ textInputAction å¯ä»¥æ›´æ”¹é”®ç›˜æœ¬èº«çš„æ“ä½œæŒ‰é’®ã€‚</p><p>ä¾‹å¦‚ï¼š</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">TextField(</span><br><span class="line">  textInputAction: TextInputAction.continueAction,</span><br><span class="line">),</span><br></pre></td></tr></table></figure><p>è¿™ä¼šå¯¼è‡´ â€œDoneâ€ æŒ‰é’®è¢« â€œContinueâ€ æŒ‰é’®æ›¿æ¢ï¼š</p><figure class="image-bubble">                <div class="img-lightbox">                    <div class="overlay"></div>                    <img src="/images/textfield4.png" alt="" title="">                </div>                <div class="image-caption"></div>            </figure><p>æˆ–è€…ï¼š</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">TextField(</span><br><span class="line">  textInputAction: TextInputAction.send,</span><br><span class="line">),</span><br></pre></td></tr></table></figure><figure class="image-bubble">                <div class="img-lightbox">                    <div class="overlay"></div>                    <img src="/images/textfield5.png" alt="" title="">                </div>                <div class="image-caption"></div>            </figure><p>è¿˜æœ‰å¾ˆå¤šç±»å‹ï¼Œè¿™é‡Œä¸ä¸€ä¸€åˆ—ä¸¾ã€‚</p><h3 id="3-è‡ªåŠ¨æ›´æ­£"><a href="#3-è‡ªåŠ¨æ›´æ­£" class="headerlink" title="3.è‡ªåŠ¨æ›´æ­£"></a>3.è‡ªåŠ¨æ›´æ­£</h3><p>å¯ç”¨æˆ–ç¦ç”¨ç‰¹å®š TextField çš„è‡ªåŠ¨æ›´æ­£ã€‚ ä½¿ç”¨è‡ªåŠ¨æ›´æ­£å­—æ®µè¿›è¡Œå¦‚ä¸‹è®¾ç½®ã€‚</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">TextField(</span><br><span class="line">  autocorrect: <span class="keyword">false</span>,</span><br><span class="line">),</span><br></pre></td></tr></table></figure><p>è¿™å°†ç¦ç”¨æ›´æ­£ã€‚</p><h3 id="4-æ–‡æœ¬å¤§å†™"><a href="#4-æ–‡æœ¬å¤§å†™" class="headerlink" title="4.æ–‡æœ¬å¤§å†™"></a>4.æ–‡æœ¬å¤§å†™</h3><p>TextField æä¾›äº†ä¸€äº›æœ‰å…³å¦‚ä½•ä½¿ç”¨æˆ·è¾“å…¥ä¸­çš„å­—æ¯å¤§å†™çš„é€‰é¡¹ã€‚</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">TextField(</span><br><span class="line">  textCapitalization: TextCapitalization.sentences,</span><br><span class="line">),</span><br></pre></td></tr></table></figure><p>é€‰é¡¹æœ‰ï¼š</p><ol><li><p><strong>TextCapitalization.sentences</strong></p><p>è¿™å¯ä»¥ä½¿æ¯ä¸ªå¥å­çš„é¦–å­—æ¯å¤§å†™ã€‚</p><p><img src="/images/textfield6.png" alt=""></p></li><li><p><strong>TextCapitalization.characters</strong></p><p>å¤§å†™å¥å­ä¸­çš„æ‰€æœ‰å­—ç¬¦ã€‚</p><p><img src="/images/textfield7.png" alt=""></p></li><li><p><strong>TextCapitalization.words</strong></p><p>å¤§å†™æ¯ä¸ªå•è¯çš„é¦–å­—æ¯ã€‚</p><p><img src="/images/textfield8.png" alt=""></p><h2 id="Text-Style-Alignment-å’Œ-Cursor"><a href="#Text-Style-Alignment-å’Œ-Cursor" class="headerlink" title="Text Style, Alignment å’Œ Cursor"></a>Text Style, Alignment å’Œ Cursor</h2></li></ol><p>Flutter å…è®¸è‡ªå®šä¹‰ TextField å†…çš„æ–‡æœ¬æ ·å¼å’Œå¯¹é½æ–¹å¼ä»¥åŠ TextField å†…çš„å…‰æ ‡ã€‚</p><h3 id="TextField-å†…çš„æ–‡æœ¬å¯¹é½æ–¹å¼"><a href="#TextField-å†…çš„æ–‡æœ¬å¯¹é½æ–¹å¼" class="headerlink" title="TextField å†…çš„æ–‡æœ¬å¯¹é½æ–¹å¼"></a>TextField å†…çš„æ–‡æœ¬å¯¹é½æ–¹å¼</h3><p>ä½¿ç”¨ textAlign å±æ€§è°ƒæ•´ TextField ä¸­å…‰æ ‡çš„ä½ç½®ã€‚</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">TextField(</span><br><span class="line">  textAlign: TextAlign.center,</span><br><span class="line">),</span><br></pre></td></tr></table></figure><figure class="image-bubble">                <div class="img-lightbox">                    <div class="overlay"></div>                    <img src="/images/textfield9.png" alt="" title="">                </div>                <div class="image-caption"></div>            </figure><p>é€šå¸¸çš„å¯¹é½å±æ€§æœ‰ï¼š<strong>start, end, left, right, center, justify</strong>.</p><h3 id="åœ¨-TextField-ä¸­è®¾ç½®æ–‡æœ¬æ ·å¼"><a href="#åœ¨-TextField-ä¸­è®¾ç½®æ–‡æœ¬æ ·å¼" class="headerlink" title="åœ¨ TextField ä¸­è®¾ç½®æ–‡æœ¬æ ·å¼"></a>åœ¨ TextField ä¸­è®¾ç½®æ–‡æœ¬æ ·å¼</h3><p>æˆ‘ä»¬ä½¿ç”¨ style å±æ€§æ¥æ›´æ”¹ TextField å†…éƒ¨æ–‡æœ¬çš„æ ·å¼ã€‚ ä½¿ç”¨å®ƒæ¥æ›´æ”¹é¢œè‰²ï¼Œå­—ä½“å¤§å°ç­‰ã€‚è¿™ç±»ä¼¼äºæ–‡æœ¬ç»„ä»¶ä¸­çš„æ ·å¼å±æ€§ï¼Œè¿™é‡Œæˆ‘ä»¬ä¸å¤šåšä»‹ç»ã€‚</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">TextField(</span><br><span class="line">  style: TextStyle(color: Colors.red, fontWeight: FontWeight.w300),</span><br><span class="line">),</span><br></pre></td></tr></table></figure><figure class="image-bubble">                <div class="img-lightbox">                    <div class="overlay"></div>                    <img src="/images/textfield10.png" alt="" title="">                </div>                <div class="image-caption"></div>            </figure><h3 id="æ›´æ”¹-TextField-ä¸­çš„å…‰æ ‡"><a href="#æ›´æ”¹-TextField-ä¸­çš„å…‰æ ‡" class="headerlink" title="æ›´æ”¹ TextField ä¸­çš„å…‰æ ‡"></a>æ›´æ”¹ TextField ä¸­çš„å…‰æ ‡</h3><p>å¯ä»¥ç›´æ¥è‡ªå®šä¹‰ TextField ç»„ä»¶çš„å…‰æ ‡ã€‚</p><p>æ‚¨å¯ä»¥æ›´æ”¹å…‰æ ‡é¢œè‰²ï¼Œå®½åº¦å’ŒåŠå¾„ã€‚ ä¾‹å¦‚ï¼Œåœ¨è¿™é‡Œæˆ‘è‡ªå®šä¹‰äº†ä¸€ä¸ªåœ†å½¢çº¢è‰²å…‰æ ‡ã€‚</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">TextField(</span><br><span class="line">  cursorColor: Colors.red,</span><br><span class="line">  cursorRadius: Radius.circular(<span class="number">16.0</span>),</span><br><span class="line">  cursorWidth: <span class="number">16.0</span>,</span><br><span class="line">),</span><br></pre></td></tr></table></figure><figure class="image-bubble">                <div class="img-lightbox">                    <div class="overlay"></div>                    <img src="/images/textfield11.png" alt="" title="">                </div>                <div class="image-caption"></div>            </figure><h3 id="æ§åˆ¶-TextField-ä¸­çš„å¤§å°å’Œæœ€å¤§é•¿åº¦"><a href="#æ§åˆ¶-TextField-ä¸­çš„å¤§å°å’Œæœ€å¤§é•¿åº¦" class="headerlink" title="æ§åˆ¶ TextField ä¸­çš„å¤§å°å’Œæœ€å¤§é•¿åº¦"></a>æ§åˆ¶ TextField ä¸­çš„å¤§å°å’Œæœ€å¤§é•¿åº¦</h3><p>TextFields å¯ä»¥æ§åˆ¶å…¶ä¸­å†™å…¥çš„æœ€å¤§å­—ç¬¦æ•°ã€æœ€å¤§è¡Œæ•°å¹¶åœ¨é”®å…¥æ–‡æœ¬æ—¶å±•å¼€ã€‚</p><h4 id="æ§åˆ¶æœ€å¤§å­—ç¬¦æ•°"><a href="#æ§åˆ¶æœ€å¤§å­—ç¬¦æ•°" class="headerlink" title="æ§åˆ¶æœ€å¤§å­—ç¬¦æ•°"></a>æ§åˆ¶æœ€å¤§å­—ç¬¦æ•°</h4><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">TextField(</span><br><span class="line">  maxLength: <span class="number">4</span>,</span><br><span class="line">),</span><br></pre></td></tr></table></figure><figure class="image-bubble">                <div class="img-lightbox">                    <div class="overlay"></div>                    <img src="/images/textfield12.png" alt="" title="">                </div>                <div class="image-caption"></div>            </figure><p>é€šè¿‡è®¾ç½® maxLength å±æ€§ï¼Œå°†å¼ºåˆ¶æ‰§è¡Œæœ€å¤§é•¿åº¦ï¼Œå¹¶ä¸”é»˜è®¤æƒ…å†µä¸‹ä¼šå°†è®¡æ•°å™¨æ·»åŠ åˆ° TextField ã€‚</p><h4 id="åˆ¶ä½œå¯æ‰©å±•çš„TextField"><a href="#åˆ¶ä½œå¯æ‰©å±•çš„TextField" class="headerlink" title="åˆ¶ä½œå¯æ‰©å±•çš„TextField"></a>åˆ¶ä½œå¯æ‰©å±•çš„TextField</h4><p>æœ‰æ—¶ï¼Œæˆ‘ä»¬éœ€è¦ TextField å½“ä¸€è¡Œå®Œæˆæ—¶ä¼šæ‰©å±•ã€‚ åœ¨Flutterä¸­ï¼Œåšæ³•æœ‰ç‚¹å¥‡æ€ªï¼ˆä½†å¾ˆå®¹æ˜“ï¼‰ã€‚ æˆ‘ä»¬å°† maxLines è®¾ç½®ä¸º null ï¼Œé»˜è®¤ä¸º1ã€‚ </p><p><img src="/images/textfield13.png" alt=""></p><p><strong>æ³¨æ„ï¼šé»˜è®¤æƒ…å†µä¸‹ï¼Œå°† maxLines è®¾ç½®ä¸ºç›´æ¥å€¼ä¼šå°†å…¶è‡ªåŠ¨æ‰©å±•ä¸ºè¯¥è¡Œæ•°ã€‚</strong></p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">TextField(</span><br><span class="line">  maxLines: <span class="number">3</span>,</span><br><span class="line">)</span><br></pre></td></tr></table></figure><figure class="image-bubble">                <div class="img-lightbox">                    <div class="overlay"></div>                    <img src="/images/textfield14.png" alt="" title="">                </div>                <div class="image-caption"></div>            </figure><h4 id="æ¨¡ç³Šæ–‡å­—"><a href="#æ¨¡ç³Šæ–‡å­—" class="headerlink" title="æ¨¡ç³Šæ–‡å­—"></a>æ¨¡ç³Šæ–‡å­—</h4><p>è¦éšè— TextField ä¸­çš„æ–‡æœ¬ï¼Œè¯·å°† obscureText è®¾ç½®ä¸ºtrue ã€‚</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">TextField(</span><br><span class="line">  obscureText: <span class="keyword">true</span>,</span><br><span class="line">),</span><br></pre></td></tr></table></figure><figure class="image-bubble">                <div class="img-lightbox">                    <div class="overlay"></div>                    <img src="/images/textfield15.png" alt="" title="">                </div>                <div class="image-caption"></div>            </figure><h2 id="è£…é¥°-TextField"><a href="#è£…é¥°-TextField" class="headerlink" title="è£…é¥° TextField"></a>è£…é¥° TextField</h2><p>è‡³æ­¤ï¼Œæˆ‘ä»¬ä¸“æ³¨äº Flutter æä¾›çš„è¾“å…¥åŠŸèƒ½ã€‚ ç°åœ¨æˆ‘ä»¬æ¥å®é™…è®¾è®¡ä¸€ä¸ªæ¼‚äº®çš„ TextField ã€‚</p><p>ä¸ºäº†è£…é¥° TextFieldï¼Œæˆ‘ä»¬ä½¿ç”¨äº†å¸¦æœ‰ InputDecoration çš„ decoration å±æ€§ã€‚ ç”±äº InputDecoration ç±»éå¸¸åºå¤§ï¼Œæˆ‘ä»¬å¿«é€Ÿè¿‡ä¸€éå®ƒçš„é‡è¦å±æ€§ã€‚</p><h3 id="ä½¿ç”¨æç¤ºå’Œæ ‡ç­¾å±æ€§å‘ç”¨æˆ·æä¾›ä¿¡æ¯"><a href="#ä½¿ç”¨æç¤ºå’Œæ ‡ç­¾å±æ€§å‘ç”¨æˆ·æä¾›ä¿¡æ¯" class="headerlink" title="ä½¿ç”¨æç¤ºå’Œæ ‡ç­¾å±æ€§å‘ç”¨æˆ·æä¾›ä¿¡æ¯"></a>ä½¿ç”¨æç¤ºå’Œæ ‡ç­¾å±æ€§å‘ç”¨æˆ·æä¾›ä¿¡æ¯</h3><p>æç¤ºå’Œæ ‡ç­¾éƒ½æ˜¯å­—ç¬¦ä¸²ï¼Œå¯å¸®åŠ©ç”¨æˆ·ç†è§£è¦åœ¨ TextField ä¸­è¾“å…¥çš„ä¿¡æ¯ã€‚ ä¸åŒä¹‹å¤„åœ¨äºï¼Œå½“æ ‡ç­¾æµ®åŠ¨åœ¨ TextFieldä¸Šæ—¶ï¼Œä¸€æ—¦ç”¨æˆ·å¼€å§‹è¾“å…¥ï¼Œæç¤ºå°±ä¼šæ¶ˆå¤±ã€‚</p><figure class="image-bubble">                <div class="img-lightbox">                    <div class="overlay"></div>                    <img src="/images/textfield16.png" alt="Hint" title="">                </div>                <div class="image-caption">Hint</div>            </figure><figure class="image-bubble">                <div class="img-lightbox">                    <div class="overlay"></div>                    <img src="/images/textfield17.png" alt="Label" title="">                </div>                <div class="image-caption">Label</div>            </figure><h3 id="æ‚¨å¯ä»¥ä½¿ç”¨-â€œiconâ€ï¼Œâ€œprefixIconâ€-å’Œ-â€œsuffixIconâ€-æ·»åŠ å›¾æ ‡"><a href="#æ‚¨å¯ä»¥ä½¿ç”¨-â€œiconâ€ï¼Œâ€œprefixIconâ€-å’Œ-â€œsuffixIconâ€-æ·»åŠ å›¾æ ‡" class="headerlink" title="æ‚¨å¯ä»¥ä½¿ç”¨ â€œiconâ€ï¼Œâ€œprefixIconâ€ å’Œ â€œsuffixIconâ€ æ·»åŠ å›¾æ ‡"></a>æ‚¨å¯ä»¥ä½¿ç”¨ â€œiconâ€ï¼Œâ€œprefixIconâ€ å’Œ â€œsuffixIconâ€ æ·»åŠ å›¾æ ‡</h3><p>æ‚¨å¯ä»¥ç›´æ¥å‘ TextFields æ·»åŠ å›¾æ ‡ã€‚ æ‚¨ä¹Ÿå¯ä»¥ä½¿ç”¨ prefixText å’Œ suffixText ä»£æ›¿ Textã€‚</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">TextField(</span><br><span class="line">  decoration: InputDecoration(</span><br><span class="line">    icon: Icon(Icons.<span class="built_in">print</span>)</span><br><span class="line">  ),</span><br><span class="line">),</span><br></pre></td></tr></table></figure><figure class="image-bubble">                <div class="img-lightbox">                    <div class="overlay"></div>                    <img src="/images/textfield18.png" alt="" title="">                </div>                <div class="image-caption"></div>            </figure><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">TextField(</span><br><span class="line">  decoration: InputDecoration(</span><br><span class="line">    prefixIcon: Icon(Icons.<span class="built_in">print</span>)</span><br><span class="line">  ),</span><br><span class="line">),</span><br></pre></td></tr></table></figure><figure class="image-bubble">                <div class="img-lightbox">                    <div class="overlay"></div>                    <img src="/images/textfield19.png" alt="" title="">                </div>                <div class="image-caption"></div>            </figure><h3 id="å¯¹äºå…¶ä»–ä»»ä½•ç»„ä»¶ï¼Œä½¿ç”¨-â€œprefixâ€-è€Œä¸æ˜¯-â€œprefixIconâ€"><a href="#å¯¹äºå…¶ä»–ä»»ä½•ç»„ä»¶ï¼Œä½¿ç”¨-â€œprefixâ€-è€Œä¸æ˜¯-â€œprefixIconâ€" class="headerlink" title="å¯¹äºå…¶ä»–ä»»ä½•ç»„ä»¶ï¼Œä½¿ç”¨ â€œprefixâ€ è€Œä¸æ˜¯ â€œprefixIconâ€"></a>å¯¹äºå…¶ä»–ä»»ä½•ç»„ä»¶ï¼Œä½¿ç”¨ â€œprefixâ€ è€Œä¸æ˜¯ â€œprefixIconâ€</h3><p>è¦ä½¿ç”¨é€šç”¨ç»„ä»¶è€Œä¸æ˜¯ä»…ä»…ä¸€ä¸ªå›¾æ ‡ï¼Œè¯·ä½¿ç”¨ prefix field ã€‚è®©æˆ‘ä»¬åœ¨ TextField ä¸­æ·»åŠ ä¸€ä¸ªåœ†å½¢è¿›åº¦æ¡†ã€‚</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">TextField(</span><br><span class="line">  decoration: InputDecoration(</span><br><span class="line">    prefix: CircularProgressIndicator(),</span><br><span class="line">  ),</span><br><span class="line">),</span><br></pre></td></tr></table></figure><figure class="image-bubble">                <div class="img-lightbox">                    <div class="overlay"></div>                    <img src="/images/textfield20.png" alt="" title="">                </div>                <div class="image-caption"></div>            </figure><h3 id="åƒ-hint-ï¼Œlabel-ç­‰æ¯ä¸ªå±æ€§éƒ½æœ‰å„è‡ªçš„æ ·å¼å­—æ®µ"><a href="#åƒ-hint-ï¼Œlabel-ç­‰æ¯ä¸ªå±æ€§éƒ½æœ‰å„è‡ªçš„æ ·å¼å­—æ®µ" class="headerlink" title="åƒ hint ï¼Œlabel ç­‰æ¯ä¸ªå±æ€§éƒ½æœ‰å„è‡ªçš„æ ·å¼å­—æ®µ"></a>åƒ <strong>hint</strong> ï¼Œ<strong>label</strong> ç­‰æ¯ä¸ªå±æ€§éƒ½æœ‰å„è‡ªçš„æ ·å¼å­—æ®µ</h3><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">TextField(</span><br><span class="line">  decoration: InputDecoration(</span><br><span class="line">    hintText: <span class="string">"Demo Text"</span>,</span><br><span class="line">    hintStyle: TextStyle(fontWeight: FontWeight.w300, color: Colors.red)</span><br><span class="line">  ),</span><br><span class="line">),</span><br></pre></td></tr></table></figure><p><strong>æ³¨æ„ï¼šè™½ç„¶æˆ‘åœ¨æ­¤ç¤ºä¾‹ä¸­è¿™æ ·æ“ä½œï¼Œä½†é€šå¸¸ä¸ä¼šæ›´æ”¹æç¤ºé¢œè‰²ã€‚</strong></p><h3 id="å¦‚æœæ‚¨ä¸æƒ³è¦æ ‡ç­¾è€Œæƒ³è¦ä¸ºç”¨æˆ·æä¾›æŒä¹…æ¶ˆæ¯ï¼Œè¯·ä½¿ç”¨-â€œhelperTextâ€-ã€‚"><a href="#å¦‚æœæ‚¨ä¸æƒ³è¦æ ‡ç­¾è€Œæƒ³è¦ä¸ºç”¨æˆ·æä¾›æŒä¹…æ¶ˆæ¯ï¼Œè¯·ä½¿ç”¨-â€œhelperTextâ€-ã€‚" class="headerlink" title="å¦‚æœæ‚¨ä¸æƒ³è¦æ ‡ç­¾è€Œæƒ³è¦ä¸ºç”¨æˆ·æä¾›æŒä¹…æ¶ˆæ¯ï¼Œè¯·ä½¿ç”¨ â€œhelperTextâ€ ã€‚"></a>å¦‚æœæ‚¨ä¸æƒ³è¦æ ‡ç­¾è€Œæƒ³è¦ä¸ºç”¨æˆ·æä¾›æŒä¹…æ¶ˆæ¯ï¼Œè¯·ä½¿ç”¨ â€œhelperTextâ€ ã€‚</h3><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">TextField(</span><br><span class="line">  decoration: InputDecoration(</span><br><span class="line">    helperText: <span class="string">"Hello"</span></span><br><span class="line">  ),</span><br><span class="line">),</span><br></pre></td></tr></table></figure><figure class="image-bubble">                <div class="img-lightbox">                    <div class="overlay"></div>                    <img src="/images/textfield21.png" alt="" title="">                </div>                <div class="image-caption"></div>            </figure><h3 id="ä½¿ç”¨-â€œdecorationï¼šnullâ€-æˆ–-InputDecoration-collapsed-åˆ é™¤-TextField-ä¸Šçš„é»˜è®¤ä¸‹åˆ’çº¿"><a href="#ä½¿ç”¨-â€œdecorationï¼šnullâ€-æˆ–-InputDecoration-collapsed-åˆ é™¤-TextField-ä¸Šçš„é»˜è®¤ä¸‹åˆ’çº¿" class="headerlink" title="ä½¿ç”¨ â€œdecorationï¼šnullâ€ æˆ– InputDecoration.collapsed åˆ é™¤ TextField ä¸Šçš„é»˜è®¤ä¸‹åˆ’çº¿"></a>ä½¿ç”¨ â€œdecorationï¼šnullâ€ æˆ– InputDecoration.collapsed åˆ é™¤ TextField ä¸Šçš„é»˜è®¤ä¸‹åˆ’çº¿</h3><p>ä½¿ç”¨è¿™äº›åˆ é™¤ TextField ä¸Šçš„é»˜è®¤ä¸‹åˆ’çº¿ã€‚</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">TextField(</span><br><span class="line">  decoration: InputDecoration.collapsed(hintText: <span class="string">""</span>)</span><br><span class="line">),</span><br></pre></td></tr></table></figure><figure class="image-bubble">                <div class="img-lightbox">                    <div class="overlay"></div>                    <img src="/images/textfield22.png" alt="" title="">                </div>                <div class="image-caption"></div>            </figure><h3 id="ä½¿ç”¨-â€œborderâ€-ä¸º-TextField-è®¾ç½®è¾¹æ¡†"><a href="#ä½¿ç”¨-â€œborderâ€-ä¸º-TextField-è®¾ç½®è¾¹æ¡†" class="headerlink" title="ä½¿ç”¨ â€œborderâ€ ä¸º TextField è®¾ç½®è¾¹æ¡†"></a>ä½¿ç”¨ â€œborderâ€ ä¸º TextField è®¾ç½®è¾¹æ¡†</h3><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">TextField(</span><br><span class="line">  decoration: InputDecoration(</span><br><span class="line">    border: OutlineInputBorder()</span><br><span class="line">  )</span><br><span class="line">),</span><br></pre></td></tr></table></figure><figure class="image-bubble">                <div class="img-lightbox">                    <div class="overlay"></div>                    <img src="/images/textfield23.png" alt="" title="">                </div>                <div class="image-caption"></div>            </figure><p>æ‚¨å¯ä»¥è¿›ä¸€æ­¥åšå¤§é‡çš„è£…é¥°ï¼Œæˆ‘ä¸å¯èƒ½å°†æ‰€æœ‰ä½ éœ€è¦çš„æ ·å¼åšå‡ºæ¥ã€‚ ä½†æˆ‘å¸Œæœ›è¿™æˆ‘å·²ç»è®©ä½ çŸ¥é“æ€ä¹ˆå°†å®ƒåšå‡ºæ¥ï¼</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;figure class=&quot;image-bubble&quot;&gt;
                &lt;div class=&quot;img-lightbox&quot;&gt;
                    &lt;div class=&quot;overlay&quot;&gt;&lt;/div&gt;
                   
      
    
    </summary>
    
      <category term="æ•´ç†" scheme="https://meandni.com/categories/%E6%95%B4%E7%90%86/"/>
    
    
      <category term="flutterè¿›é˜¶" scheme="https://meandni.com/tags/flutter%E8%BF%9B%E9%98%B6/"/>
    
  </entry>
  
  <entry>
    <title>Flutterè¿›é˜¶ï¼šæ·±å…¥æ¢ç©¶ ListView å’Œ ScrollPhysics</title>
    <link href="https://meandni.com/2019/01/26/flutter-exploring-list/"/>
    <id>https://meandni.com/2019/01/26/flutter-exploring-list/</id>
    <published>2019-01-26T06:19:55.000Z</published>
    <updated>2019-01-26T09:04:26.322Z</updated>
    
    <content type="html"><![CDATA[<figure class="image-bubble">                <div class="img-lightbox">                    <div class="overlay"></div>                    <img src="/images/listview.png" alt="" title="">                </div>                <div class="image-caption"></div>            </figure><p>Flutter ä¸­çš„ ListView å¯ä»¥å¯¹æ¯” Android ä¸­çš„ ListView æˆ–è€… RecycleViewï¼ˆå½“ç„¶ä¹Ÿæœ‰ä¸åŒä¹‹å¤„ï¼‰ ï¼Œæ˜¯å¯æ»šåŠ¨é¡¹çš„çº¿æ€§åˆ—è¡¨ã€‚ æˆ‘ä»¬å¯ä»¥ç”¨å®ƒæ¥åˆ¶ä½œå¯æ»šåŠ¨é¡¹ç›®åˆ—è¡¨æˆ–é‡å¤é¡¹ç›®åˆ—è¡¨ã€‚</p><h2 id="æ¢ç©¶å„ç±»å‹çš„-ListView"><a href="#æ¢ç©¶å„ç±»å‹çš„-ListView" class="headerlink" title="æ¢ç©¶å„ç±»å‹çš„ ListView"></a>æ¢ç©¶å„ç±»å‹çš„ ListView</h2><p>æ„å»º ListView æœ‰ä»¥ä¸‹å‡ ç§æ–¹å¼ï¼š</p><ol><li><strong>ListView</strong></li><li><strong>ListView.builder</strong></li><li><strong>ListView.separated</strong></li><li><strong>ListView.custom</strong></li></ol><h3 id="ListView"><a href="#ListView" class="headerlink" title="ListView"></a>ListView</h3><p>è¿™æ˜¯ ListView ç±»çš„é»˜è®¤æ„é€ å‡½æ•°ã€‚ ListView å†…æœ‰ä»»æ„ä¸ªæ•°çš„å­å…ƒç´ éƒ½å¯ä½¿å…¶æ»šåŠ¨ã€‚</p><p>ä»£ç çš„æ ¼å¼ä¸ºï¼š</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">ListView(</span><br><span class="line">  children: &lt;Widget&gt;[</span><br><span class="line">    ItemOne(),</span><br><span class="line">    ItemTwo(),</span><br><span class="line">    ItemThree(),</span><br><span class="line">  ],</span><br><span class="line">),</span><br></pre></td></tr></table></figure><p>é€šå¸¸è¿™é‡Œåº”è¯¥æ”¾å°‘é‡çš„å­å…ƒç´ ï¼Œå› ä¸º ListView ä¹Ÿä¼šå°†å½“å‰ä¸å¯è§çš„å…ƒç´ æ„å»ºèµ·æ¥ï¼Œå› æ­¤å¤§é‡çš„å­å…ƒç´ å¯èƒ½ä½¿ App æ€§èƒ½é™ä½ã€‚</p><h3 id="ListView-builder"><a href="#ListView-builder" class="headerlink" title="ListView.builder()"></a>ListView.builder()</h3><p>builder() æ„é€ å‡½æ•°å¯ä»¥ç”¨æ¥æ„é€ é‡å¤çš„å­é¡¹åˆ—è¡¨ï¼Œè¿™é‡Œæˆ‘ä»¬å°±å¯ä»¥ç±»æ¯” Android ä¸­çš„ ListView ã€‚ è¿™ä¸ªæ„é€ å‡½æ•°æœ‰ä¸¤ä¸ªä¸»è¦å‚æ•°ï¼šåˆ—è¡¨ä¸­é¡¹ç›®æ•°çš„ itemCount å’Œæ„é€ æ¯ä¸ªåˆ—è¡¨å­é¡¹çš„ itemBuilderã€‚</p><figure class="image-bubble">                <div class="img-lightbox">                    <div class="overlay"></div>                    <img src="/images/listview2.gif" alt="/images/listview2.gif" title="">                </div>                <div class="image-caption">/images/listview2.gif</div>            </figure><p>ä»£ç çš„æ ¼å¼ä¸ºï¼š</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">ListView.builder(</span><br><span class="line">  itemCount: itemCount,</span><br><span class="line">  itemBuilder: (context, position) &#123;</span><br><span class="line">    <span class="keyword">return</span> listItem();</span><br><span class="line">  &#125;,</span><br><span class="line">),</span><br></pre></td></tr></table></figure><p>åˆ—è¡¨é¡¹æ˜¯<strong>æ‡’åŠ è½½</strong>çš„ï¼Œè¿™è¡¨æ˜ Flutter åªæ„é€ äº†ç‰¹å®šæ•°é‡çš„åˆ—è¡¨é¡¹ï¼Œå½“ç”¨æˆ·æ»šåŠ¨æ—¶ï¼Œæ—©æœŸçš„åˆ—è¡¨é¡¹è¢«é”€æ¯ã€‚</p><p><strong>æŠ€å·§</strong>ï¼šç”±äºå…ƒç´ æ˜¯æ‡’åŠ è½½çš„ï¼ŒåªåŠ è½½äº†æ‰€éœ€æ•°é‡çš„å…ƒç´ ï¼Œæˆ‘ä»¬å¹¶ä¸éœ€è¦å°† itemCount ä½œä¸ºå¿…éœ€å‚æ•°ï¼Œåˆ—è¡¨å¯ä»¥æ˜¯<strong>æ— é™é•¿</strong>çš„ã€‚</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">ListView.builder(</span><br><span class="line">  itemBuilder: (context, position) &#123;</span><br><span class="line">    <span class="keyword">return</span> Card(</span><br><span class="line">      child: Padding(</span><br><span class="line">        padding: <span class="keyword">const</span> EdgeInsets.all(<span class="number">16.0</span>),</span><br><span class="line">        child: Text(position.toString(), style: TextStyle(fontSize: <span class="number">22.0</span>),),</span><br><span class="line">      ),</span><br><span class="line">    );</span><br><span class="line">  &#125;,</span><br><span class="line">),</span><br></pre></td></tr></table></figure><figure class="image-bubble">                <div class="img-lightbox">                    <div class="overlay"></div>                    <img src="/images/listview3.gif" alt="/images/listview3.gif" title="">                </div>                <div class="image-caption">/images/listview3.gif</div>            </figure><h3 id="ListView-separated"><a href="#ListView-separated" class="headerlink" title="ListView.separated()"></a>ListView.separated()</h3><p>åœ¨ separate() çš„æ„é€ å‡½æ•°ä¸­ï¼Œæˆ‘ä»¬åŒæ ·ç”Ÿæˆä¸€ä¸ªåˆ—è¡¨ï¼Œä½†è¿™é‡Œæˆ‘ä»¬å¯ä»¥æŒ‡å®šæ¯ä¸ªé¡¹ä¹‹é—´çš„åˆ†éš”ç¬¦ã€‚</p><figure class="image-bubble">                <div class="img-lightbox">                    <div class="overlay"></div>                    <img src="/images/listview4.gif" alt="/images/listview4.gif" title="">                </div>                <div class="image-caption">/images/listview4.gif</div>            </figure><p>å®è´¨ä¸Šï¼Œè¿™é‡Œï¼Œ<strong>æˆ‘ä»¬æ„é€ äº†ä¸¤ä¸ªäº¤ç»‡åˆ—è¡¨</strong>ï¼šä¸€ä¸ªä½œä¸ºä¸»åˆ—è¡¨ï¼Œä¸€ä¸ªä½œä¸ºåˆ†éš”ç¬¦åˆ—è¡¨ã€‚</p><p>è¦æ³¨æ„çš„æ˜¯ï¼Œè¿™é‡Œä¸èƒ½åº”ç”¨å‰é¢æ„é€ å‡½æ•°ä¸­æ‰€è¯´çš„æ— é™é•¿åº¦ï¼Œå› ä¸ºæ­¤æ„é€ å‡½æ•°ä¼šå¼ºåˆ¶æ‰§è¡Œ itemCount ã€‚</p><p>ä»£ç çš„æ ¼å¼ä¸ºï¼š</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">ListView.separated(</span><br><span class="line">      itemBuilder: (context, position) &#123;</span><br><span class="line">        <span class="keyword">return</span> ListItem();</span><br><span class="line">      &#125;,</span><br><span class="line">      separatorBuilder: (context, position) &#123;</span><br><span class="line">        <span class="keyword">return</span> SeparatorItem();</span><br><span class="line">      &#125;,</span><br><span class="line">      itemCount: itemCount,</span><br><span class="line">),</span><br></pre></td></tr></table></figure><p>è¿™ç§ç±»å‹çš„åˆ—è¡¨å…è®¸æ‚¨åŠ¨æ€å®šä¹‰åˆ†éš”ç¬¦ï¼Œä¸ºä¸åŒç±»å‹çš„å­é¡¹åˆ†é…ä¸åŒç±»å‹çš„åˆ†éš”ç¬¦ï¼Œåœ¨éœ€è¦æ—¶æ·»åŠ æˆ–åˆ é™¤åˆ†éš”ç¬¦ç­‰ã€‚</p><p>è¯¥å®ç°è¿˜å¯ä»¥åœ¨åˆ—è¡¨ä¸­æ–¹ä¾¿åœ°æ’å…¥å…¶ä»–ç±»å‹çš„å­å…ƒç´ ï¼ˆä¾‹å¦‚å¹¿å‘Šï¼‰ï¼Œè€Œä¸éœ€è¦å¯¹åˆ—è¡¨é¡¹ä¸­çš„ä¸»åˆ—è¡¨è¿›è¡Œä»»ä½•ä¿®æ”¹ã€‚</p><figure class="image-bubble">                <div class="img-lightbox">                    <div class="overlay"></div>                    <img src="/images/listview5.png" alt="/images/listview5.png" title="">                </div>                <div class="image-caption">/images/listview5.png</div>            </figure><p><strong>æ³¨æ„ï¼š</strong>é€šå¸¸åˆ†éš”ç¬¦åˆ—è¡¨é•¿åº¦æ¯”é¡¹ç›®åˆ—è¡¨å° 1ï¼Œå› ä¸ºåœ¨æœ€åä¸€ä¸ªå…ƒç´ ä¹‹åä¸å­˜åœ¨åˆ†éš”ç¬¦ã€‚</p><h3 id="ListView-custom"><a href="#ListView-custom" class="headerlink" title="ListView.custom()"></a>ListView.custom()</h3><p>æ­£å¦‚å…¶åï¼Œcustom() æ„é€ å‡½æ•°å…è®¸æˆ‘ä»¬è‡ªå®šä¹‰æ„å»º ListViewsã€‚ éœ€è¦çš„ä¸»è¦å‚æ•°æ˜¯ SliverChildDelegate ï¼Œç”¨äºæ„å»ºå­é¡¹ã€‚ SliverChildDelegates çš„ç±»å‹æ˜¯ï¼š</p><ol><li><strong>verChildListDelegate</strong></li><li><strong>SliverChildBuilderDelegate</strong></li></ol><p>SliverChildListDelegate æ¥å—ä¸€ä¸ªå­é¡¹çš„ç›´æ¥åˆ—è¡¨ï¼Œè€Œ SliverChildBuiderDelegate æ¥å— IndexedWidgetBuilderï¼ˆæˆ‘ä»¬ä½¿ç”¨çš„æ„é€ å‡½æ•°ï¼‰ã€‚</p><p><strong>æ‚¨å¯ä»¥ä½¿ç”¨æˆ–å­ç±»åŒ–è¿™äº›æ¥æ„å»ºè‡ªå·±çš„å§”æ‰˜ã€‚</strong></p><p><strong>ListView é»˜è®¤æ„é€ å‡½æ•°çš„è¡Œä¸ºç±»ä¼¼äºå¸¦æœ‰ SliverChildListDelegate çš„ ListView.custom ã€‚</strong></p><p>æˆ‘ä»¬å·²ç»ä»‹ç»å®Œäº† ListViews çš„å„ç§ç±»å‹ï¼Œè®©æˆ‘ä»¬æ¥çœ‹çœ‹ ScrollPhysics ã€‚</p><h2 id="æ¢ç©¶-ScrollPhysics"><a href="#æ¢ç©¶-ScrollPhysics" class="headerlink" title="æ¢ç©¶ ScrollPhysics"></a>æ¢ç©¶ ScrollPhysics</h2><p>ä¸ºäº†æ§åˆ¶åˆ—è¡¨æ»šåŠ¨çš„å‘ç”Ÿæ–¹å¼ï¼Œæˆ‘ä»¬åœ¨ ListView çš„æ„é€ å‡½æ•°ä¸­é€šå¸¸éœ€è¦è®¾ç½® physics å‚æ•°ã€‚ å„ç§ç±»å‹çš„ physics å‚æ•°æœ‰ï¼š</p><h3 id="NeverScrollablePhysics"><a href="#NeverScrollablePhysics" class="headerlink" title="NeverScrollablePhysics"></a>NeverScrollablePhysics</h3><p>NeverScrollablePhysics è¡¨ç°ä¸ºä¸å¯æ»šåŠ¨çš„åˆ—è¡¨ã€‚ ä½¿ç”¨æ­¤é€‰é¡¹å¯ä»¥å®Œå…¨ç¦ç”¨ ListView çš„æ»šåŠ¨ã€‚</p><h3 id="BouncingScrollPhysics"><a href="#BouncingScrollPhysics" class="headerlink" title="BouncingScrollPhysics"></a>BouncingScrollPhysics</h3><p>BouncingScrollPhysics åœ¨åˆ—è¡¨ç»“æŸæ—¶<strong>é€€å›</strong>åˆ—è¡¨ã€‚ iOS ä¸­æœ‰ç±»ä¼¼çš„æ•ˆæœã€‚</p><figure class="image-bubble">                <div class="img-lightbox">                    <div class="overlay"></div>                    <img src="/images/listview6.gif" alt="/images/listview6.gif" title="">                </div>                <div class="image-caption">/images/listview6.gif</div>            </figure><h3 id="ClampingScrollPhysics"><a href="#ClampingScrollPhysics" class="headerlink" title="ClampingScrollPhysics"></a>ClampingScrollPhysics</h3><p>è¿™æ˜¯ Android ä¸Šä½¿ç”¨çš„é»˜è®¤æ»šåŠ¨æ–¹å¼ã€‚ åˆ—è¡¨åœ¨ç»“å°¾å¤„åœæ­¢å¹¶ç»™å‡ºä¸€å®šçš„æ•ˆæœã€‚</p><figure class="image-bubble">                <div class="img-lightbox">                    <div class="overlay"></div>                    <img src="/images/listview7.gif" alt="/images/listview7.gif" title="">                </div>                <div class="image-caption">/images/listview7.gif</div>            </figure><h3 id="FixedExtentScrollPhysics"><a href="#FixedExtentScrollPhysics" class="headerlink" title="FixedExtentScrollPhysics"></a>FixedExtentScrollPhysics</h3><p>è¯¥æ–¹æ³•ä¸å…¶ä»–æ–¹æ³•ç•¥æœ‰ä¸åŒï¼Œå› ä¸ºå®ƒä»…é€‚ç”¨äº FixedExtendScrollControllers å’Œä½¿ç”¨å®ƒä»¬çš„åˆ—è¡¨ã€‚ ä¸¾ä¸ªä¾‹å­ï¼Œæˆ‘ä»¬ç”¨ ListWheelScrollView æ¥åˆ¶ä½œç±»ä¼¼è½®å­çš„åˆ—è¡¨ã€‚</p><p>FixedExtentScrollPhysics ä»…æ»šåŠ¨åˆ°å­é¡¹è€Œä¸å­˜åœ¨ä»»ä½•åç§»ã€‚</p><figure class="image-bubble">                <div class="img-lightbox">                    <div class="overlay"></div>                    <img src="/images/listview8.gif" alt="/images/listview8.gif" title="">                </div>                <div class="image-caption">/images/listview8.gif</div>            </figure><p>æ ·ä¾‹ä»£ç éå¸¸ç®€å•ï¼š</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">FixedExtentScrollController fixedExtentScrollController =</span><br><span class="line">    <span class="keyword">new</span> FixedExtentScrollController();</span><br><span class="line">ListWheelScrollView(</span><br><span class="line">  controller: fixedExtentScrollController,</span><br><span class="line">  physics: FixedExtentScrollPhysics(),</span><br><span class="line">  children: monthsOfTheYear.map((month) &#123;</span><br><span class="line">    <span class="keyword">return</span> Card(</span><br><span class="line">        child: Row(</span><br><span class="line">      children: &lt;Widget&gt;[</span><br><span class="line">        Expanded(</span><br><span class="line">            child: Padding(</span><br><span class="line">          padding: <span class="keyword">const</span> EdgeInsets.all(<span class="number">8.0</span>),</span><br><span class="line">          child: Text(</span><br><span class="line">            month,</span><br><span class="line">            style: TextStyle(fontSize: <span class="number">18.0</span>),</span><br><span class="line">          ),</span><br><span class="line">        )),</span><br><span class="line">      ],</span><br><span class="line">    ));</span><br><span class="line">  &#125;).toList(),</span><br><span class="line">  itemExtent: <span class="number">60.0</span>,</span><br><span class="line">),</span><br></pre></td></tr></table></figure><h2 id="ä½ åº”å½“çŸ¥é“çš„å…¶ä»–äº‹æƒ…"><a href="#ä½ åº”å½“çŸ¥é“çš„å…¶ä»–äº‹æƒ…" class="headerlink" title="ä½ åº”å½“çŸ¥é“çš„å…¶ä»–äº‹æƒ…"></a>ä½ åº”å½“çŸ¥é“çš„å…¶ä»–äº‹æƒ…</h2><h3 id="å¦‚ä½•åœ¨åˆ—è¡¨ä¸­ä¿ç•™è¢«ç ´åçš„å…ƒç´ ï¼Ÿ"><a href="#å¦‚ä½•åœ¨åˆ—è¡¨ä¸­ä¿ç•™è¢«ç ´åçš„å…ƒç´ ï¼Ÿ" class="headerlink" title="å¦‚ä½•åœ¨åˆ—è¡¨ä¸­ä¿ç•™è¢«ç ´åçš„å…ƒç´ ï¼Ÿ"></a>å¦‚ä½•åœ¨åˆ—è¡¨ä¸­ä¿ç•™è¢«ç ´åçš„å…ƒç´ ï¼Ÿ</h3><p>Flutter æä¾›äº†ä¸€ä¸ª KeepAlive() å°ç»„ä»¶ï¼Œå®ƒå¯ä»¥ä½¿å­å…ƒç´ ä¿æŒæ´»è·ƒçŠ¶æ€ï¼Œå¦åˆ™ä¼šè¢«ç ´åã€‚ åœ¨åˆ—è¡¨ä¸­ï¼Œé»˜è®¤æƒ…å†µä¸‹ï¼Œå…ƒç´ åŒ…è£…åœ¨ AutomaticKeepAlive ä¸­ã€‚</p><figure class="image-bubble">                <div class="img-lightbox">                    <div class="overlay"></div>                    <img src="/images/listview9.png" alt="/images/listview9.png" title="">                </div>                <div class="image-caption">/images/listview9.png</div>            </figure><h3 id="ä¸ºä»€ä¹ˆæˆ‘çš„-ListView-åœ¨åˆ—è¡¨å’Œå¤–éƒ¨å°éƒ¨ä»¶ä¹‹é—´æœ‰ç©ºæ ¼ï¼Ÿ"><a href="#ä¸ºä»€ä¹ˆæˆ‘çš„-ListView-åœ¨åˆ—è¡¨å’Œå¤–éƒ¨å°éƒ¨ä»¶ä¹‹é—´æœ‰ç©ºæ ¼ï¼Ÿ" class="headerlink" title="ä¸ºä»€ä¹ˆæˆ‘çš„ ListView åœ¨åˆ—è¡¨å’Œå¤–éƒ¨å°éƒ¨ä»¶ä¹‹é—´æœ‰ç©ºæ ¼ï¼Ÿ"></a>ä¸ºä»€ä¹ˆæˆ‘çš„ ListView åœ¨åˆ—è¡¨å’Œå¤–éƒ¨å°éƒ¨ä»¶ä¹‹é—´æœ‰ç©ºæ ¼ï¼Ÿ</h3><p>ListView åœ¨å®ƒä¸å¤–éƒ¨çª—å£ç»„ä»¶ä¹‹é—´æœ‰é»˜è®¤å¡«å……ï¼Œå°†å¡«å……è®¾ç½®ä¸º EdgeInsets.all(0.0) å°±å¯ä»¥åˆ é™¤å®ƒã€‚</p><h2 id="æœ€å"><a href="#æœ€å" class="headerlink" title="æœ€å"></a>æœ€å</h2><p>åˆ©ç”¨æ—¶é—´æ•´ç†åˆ†æè‡ªå·±æ‰€å­¦çš„çŸ¥è¯†æ˜¯ä»¶éå¸¸æœ‰æ„ä¹‰çš„äº‹æƒ…ï¼Œå¸Œæœ›è¿™ä¹Ÿèƒ½å¸®åˆ°å…¶ä»–æ­£åœ¨å­¦ä¹ çš„åŒå­¦ã€‚åŒæ—¶æˆ‘ä¹Ÿæ­£åœ¨ç”¨Flutterå†™å‡ ä¸ªé¡¹ç›®ï¼Œå†™å¥½ä¹‹åå°±ä¼šå¼€æºç»™å¤§å®¶ã€‚</p><p>Githubï¼š<a href="https://github.com/MeandNi" target="_blank" rel="noopener">https://github.com/MeandNi</a></p><p>å¾®ä¿¡ï¼šyangjk128</p><p>åŸæ–‡åšå®¢ï¼š<a href="https://meandni.com/2019/01/26/1be6/">https://meandni.com/2019/01/26/1be6/</a></p><p>æ¬¢è¿ä¸€èµ·äº¤æµç§»åŠ¨å¼€å‘çš„æŠ€æœ¯ï¼</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;figure class=&quot;image-bubble&quot;&gt;
                &lt;div class=&quot;img-lightbox&quot;&gt;
                    &lt;div class=&quot;overlay&quot;&gt;&lt;/div&gt;
                   
      
    
    </summary>
    
      <category term="æ•´ç†" scheme="https://meandni.com/categories/%E6%95%B4%E7%90%86/"/>
    
    
      <category term="flutterè¿›é˜¶" scheme="https://meandni.com/tags/flutter%E8%BF%9B%E9%98%B6/"/>
    
  </entry>
  
  <entry>
    <title>ã€Šæ·±å…¥ç†è§£Javaè™šæ‹Ÿæœºã€‹ç¬”è®°6â€”â€”é«˜æ•ˆå¹¶å‘</title>
    <link href="https://meandni.com/2019/01/18/jvm_note6/"/>
    <id>https://meandni.com/2019/01/18/jvm_note6/</id>
    <published>2019-01-18T01:47:40.000Z</published>
    <updated>2019-02-22T03:24:31.944Z</updated>
    
    <content type="html"><![CDATA[<h1 id="ç¬¬äº”éƒ¨åˆ†-é«˜æ•ˆå¹¶å‘"><a href="#ç¬¬äº”éƒ¨åˆ†-é«˜æ•ˆå¹¶å‘" class="headerlink" title="ç¬¬äº”éƒ¨åˆ† é«˜æ•ˆå¹¶å‘"></a>ç¬¬äº”éƒ¨åˆ† é«˜æ•ˆå¹¶å‘</h1><h2 id="ç¬¬åäºŒç« -Javaå†…å­˜æ¨¡å‹ä¸çº¿ç¨‹"><a href="#ç¬¬åäºŒç« -Javaå†…å­˜æ¨¡å‹ä¸çº¿ç¨‹" class="headerlink" title="ç¬¬åäºŒç«  Javaå†…å­˜æ¨¡å‹ä¸çº¿ç¨‹"></a>ç¬¬åäºŒç«  Javaå†…å­˜æ¨¡å‹ä¸çº¿ç¨‹</h2><p>å¹¶å‘å¤„ç†çš„å¹¿æ³›åº”ç”¨æ˜¯ä½¿å¾—Amdahlå®šå¾‹ä»£æ›¿æ‘©å°”å®šå¾‹æˆä¸ºè®¡ç®—æœºæ€§èƒ½å‘å±•æºåŠ¨åŠ›çš„æ ¹æœ¬åŸå› ï¼Œä¹Ÿæ˜¯äººç±»â€œå‹æ¦¨â€è®¡ç®—æœºè¿ç®—èƒ½åŠ›çš„æœ€æœ‰åŠ›æ­¦å™¨ã€‚</p><h3 id="12-1-æ¦‚è¿°"><a href="#12-1-æ¦‚è¿°" class="headerlink" title="12.1 æ¦‚è¿°"></a>12.1 æ¦‚è¿°</h3><ul><li>å¤šä»»åŠ¡å¤„ç†åœ¨ç°ä»£è®¡ç®—æœºæ“ä½œç³»ç»Ÿä¸­å‡ ä¹å·²æ˜¯ä¸€é¡¹å¿…å¤‡çš„åŠŸèƒ½äº†ï¼›</li><li>é™¤äº†å……åˆ†åˆ©ç”¨è®¡ç®—æœºå¤„ç†å™¨çš„èƒ½åŠ›å¤–ï¼Œä¸€ä¸ªæœåŠ¡ç«¯åŒæ—¶å¯¹å¤šä¸ªå®¢æˆ·ç«¯æä¾›æœåŠ¡åˆ™æ˜¯å¦ä¸€ä¸ªæ›´å…·ä½“çš„å¹¶å‘åº”ç”¨åœºæ™¯ï¼›</li><li>æœåŠ¡ç«¯æ˜¯Javaè¯­è¨€æœ€æ“…é•¿çš„é¢†åŸŸä¹‹ä¸€ï¼Œä¸è¿‡å¦‚ä½•å†™å¥½å¹¶å‘åº”ç”¨ç¨‹åºå´åˆæ˜¯æœåŠ¡ç«¯ç¨‹åºå¼€å‘çš„éš¾ç‚¹ä¹‹ä¸€ï¼Œå¤„ç†å¥½å¹¶å‘æ–¹é¢çš„é—®é¢˜é€šå¸¸éœ€è¦æ›´å¤šçš„ç¼–ç ç»éªŒæ¥æ”¯æŒï¼Œå¹¸å¥½Javaè¯­è¨€å’Œè™šæ‹Ÿæœºæä¾›äº†è®¸å¤šå·¥å…·ï¼ŒæŠŠå¹¶å‘ç¼–ç çš„é—¨æ§›é™ä½äº†ä¸å°‘ï¼›</li></ul><h3 id="12-2-ç¡¬ä»¶çš„æ•ˆç‡ä¸ä¸€è‡´æ€§"><a href="#12-2-ç¡¬ä»¶çš„æ•ˆç‡ä¸ä¸€è‡´æ€§" class="headerlink" title="12.2 ç¡¬ä»¶çš„æ•ˆç‡ä¸ä¸€è‡´æ€§"></a>12.2 ç¡¬ä»¶çš„æ•ˆç‡ä¸ä¸€è‡´æ€§</h3><ul><li>ç»å¤§å¤šæ•°çš„è¿ç®—ä»»åŠ¡ä¸å¯èƒ½åªé å¤„ç†å™¨è®¡ç®—å°±èƒ½å®Œæˆï¼Œå¤„ç†å™¨è‡³å°‘è¦ä¸å†…å­˜äº¤äº’ï¼Œæ‰€ä»¥ç°ä»£è®¡ç®—æœºç³»ç»Ÿéƒ½ä¸å¾—ä¸åŠ å…¥ä¸€å±‚è¯»å†™é€Ÿåº¦å°½å¯èƒ½æ¥è¿‘å¤„ç†å™¨è¿ç®—é€Ÿåº¦çš„é«˜é€Ÿç¼“å­˜æ¥ä½œä¸ºå†…å­˜ä¸å¤„ç†å™¨ä¹‹é—´çš„ç¼“å†²ï¼šå°†è¿ç®—éœ€è¦ä½¿ç”¨åˆ°çš„æ•°æ®å¤åˆ¶åˆ°ç¼“å­˜ä¸­ï¼Œè®©è¿ç®—èƒ½å¿«é€Ÿè¿è¡Œï¼Œå½“è¿ç®—ç»“æŸåå†ä»ç¼“å­˜åŒæ­¥å›å†…å­˜ä¹‹ä¸­ï¼Œè¿™æ ·å¤„ç†å™¨å°±æ— é¡»ç­‰å¾…ç¼“æ…¢çš„å†…å­˜è¯»å†™äº†ï¼›</li><li>åŸºäºé«˜é€Ÿç¼“å­˜çš„å­˜å‚¨äº¤äº’å¾ˆå¥½åœ°è§£å†³äº†å¤„ç†å™¨ä¸å†…å­˜çš„é€Ÿåº¦çŸ›ç›¾ï¼Œä½†æ˜¯ä¹Ÿä¸ºè®¡ç®—æœºç³»ç»Ÿå¸¦æ¥æ›´é«˜çš„å¤æ‚åº¦ï¼Œå› ä¸ºå®ƒå¼•å…¥äº†ä¸€ä¸ªæ–°çš„é—®é¢˜ï¼šç¼“å­˜ä¸€è‡´æ€§ï¼›ä¸ºäº†è§£å†³ä¸€è‡´æ€§çš„é—®é¢˜ï¼Œéœ€è¦å„ä¸ªå¤„ç†å™¨è®¿é—®ç¼“å­˜æ—¶éƒ½éµå¾ªä¸€äº›åè®®ï¼Œåœ¨è¯»å†™æ—¶è¦æ ¹æ®åè®®æ¥è¿›è¡Œæ“ä½œï¼Œè¿™ç±»åè®®æœ‰MSIã€MESIã€MOSIã€Synapseã€FireflyåŠDragon Protocolç­‰ï¼›</li><li>æœ¬ç« å°†ä¼šå¤šæ¬¡æåˆ°å†…å­˜æ¨¡å‹ä¸€è¯ï¼Œå¯ä»¥ç†è§£åœ¨ç‰¹å®šçš„æ“ä½œåè®®ä¸‹ï¼Œå¯¹ç‰¹å®šçš„å†…å­˜æˆ–é«˜é€Ÿç¼“å­˜è¿›è¡Œè¯»å†™è®¿é—®çš„è¿‡ç¨‹æŠ½è±¡ï¼›ä¸åŒæ¶æ„çš„ç‰©ç†æœºå™¨å¯ä»¥æ‹¥æœ‰ä¸ä¸€æ ·çš„å†…å­˜æ¨¡å‹ï¼Œè€ŒJavaè™šæ‹Ÿæœºä¹Ÿæœ‰è‡ªå·±çš„å†…å­˜æ¨¡å‹ï¼Œå¹¶ä¸”è¿™é‡Œä»‹ç»çš„å†…å­˜è®¿é—®æ“ä½œä¸ç¡¬ä»¶çš„ç¼“å­˜è®¿é—®å…·æœ‰å¾ˆé«˜çš„å¯æ¯”æ€§ï¼›</li><li>é™¤äº†å¢åŠ é«˜é€Ÿç¼“å­˜ä¹‹å¤–ï¼Œä¸ºäº†ä½¿å¾—å¤„ç†å™¨å†…éƒ¨çš„è¿ç®—å•å…ƒèƒ½å°½é‡è¢«å……åˆ†åˆ©ç”¨ï¼Œå¤„ç†å™¨å¯èƒ½ä¼šå¯¹è¾“å…¥ä»£ç è¿›è¡Œä¹±åºæ‰§è¡Œä¼˜åŒ–ï¼Œå¤„ç†å™¨ä¼šåœ¨è®¡ç®—ä¹‹åå°†ä¹±åºæ‰§è¡Œçš„ç»“æœé‡ç»„ï¼Œä¿è¯è¯¥ç»“æœä¸é¡ºåºæ‰§è¡Œçš„ç»“æœæ˜¯ä¸€è‡´çš„ï¼›</li></ul><h3 id="12-3-Javaå†…å­˜æ¨¡å‹"><a href="#12-3-Javaå†…å­˜æ¨¡å‹" class="headerlink" title="12.3 Javaå†…å­˜æ¨¡å‹"></a>12.3 Javaå†…å­˜æ¨¡å‹</h3><p>Javaè™šæ‹Ÿæœºè§„èŒƒä¸­è§†å›¾å®šä¹‰ä¸€ç§Javaå†…å­˜æ¨¡å‹ï¼ˆJMMï¼‰æ¥å±è”½æ‰å„ç§ç¡¬ä»¶å’Œæ“ä½œç³»ç»Ÿçš„å†…å­˜è®¿é—®å·®å¼‚ï¼Œä»¥å®ç°è®©Javaç¨‹åºåœ¨å„ç§å¹³å°ä¸‹éƒ½èƒ½è¾¾åˆ°ä¸€è‡´çš„å†…å­˜è®¿é—®æ•ˆæœã€‚</p><h4 id="12-3-1-ä¸»å†…å­˜ä¸å·¥ä½œå†…å­˜"><a href="#12-3-1-ä¸»å†…å­˜ä¸å·¥ä½œå†…å­˜" class="headerlink" title="12.3.1 ä¸»å†…å­˜ä¸å·¥ä½œå†…å­˜"></a>12.3.1 ä¸»å†…å­˜ä¸å·¥ä½œå†…å­˜</h4><ul><li>Javaå†…å­˜æ¨¡å‹çš„ä¸»è¦ç›®æ ‡æ˜¯å®šä¹‰ç¨‹åºä¸­å„ä¸ªå˜é‡çš„è®¿é—®è§„åˆ™ï¼Œå³åœ¨è™šæ‹Ÿæœºä¸­å°†å˜é‡å­˜å‚¨åˆ°å†…å­˜å’Œä»å†…å­˜ä¸­å–å‡ºå˜é‡è¿™æ ·çš„åº•å±‚ç»†èŠ‚ï¼›æ­¤å¤„çš„å˜é‡ä¸Javaç¼–ç¨‹ä¸­æ‰€è¯´çš„å˜é‡æœ‰æ‰€åŒºåˆ«ï¼Œå®ƒåŒ…æ‹¬äº†å®ä¾‹å­—æ®µã€é™æ€å­—æ®µå’Œæ„æˆæ•°ç»„å¯¹è±¡çš„å…ƒç´ ï¼Œä½†ä¸åŒ…æ‹¬å±€éƒ¨å˜é‡ä¸æ–¹æ³•å‚æ•°ï¼Œå› ä¸ºåè€…æ˜¯çº¿ç¨‹ç§æœ‰çš„ï¼Œä¸ä¼šè¢«å…±äº«ï¼›</li><li>Javaå†…å­˜æ¨¡å‹è§„å®šäº†æ‰€æœ‰çš„å˜é‡éƒ½å­˜å‚¨åœ¨ä¸»å†…å­˜ä¸­ï¼Œæ¯ä¸ªçº¿ç¨‹è¿˜æœ‰è‡ªå·±çš„å·¥ä½œå†…å­˜ï¼Œçº¿ç¨‹çš„å·¥ä½œå†…å­˜ä¸­ä¿å­˜äº†è¢«è¯¥çº¿ç¨‹ä½¿ç”¨åˆ°çš„å˜é‡çš„ä¸»å†…å­˜å‰¯æœ¬æ‹·è´ï¼Œçº¿ç¨‹å¯¹å˜é‡çš„æ‰€æœ‰æ“ä½œéƒ½å¿…é¡»åœ¨å·¥ä½œå†…å­˜ä¸­è¿›è¡Œï¼Œè€Œä¸èƒ½ç›´æ¥è¯»å†™ä¸»å†…å­˜ä¸­çš„å˜é‡ï¼›</li><li>è¿™é‡Œæ‰€è®²çš„ä¸»å†…å­˜ã€å·¥ä½œå†…å­˜ä¸ç¬¬äºŒç« æ‰€è®²çš„Javaå†…å­˜åŒºåŸŸä¸­çš„Javaå †ã€æ ˆã€æ–¹æ³•åŒºç­‰å¹¶ä¸æ˜¯åŒä¸€ä¸ªå±‚æ¬¡çš„å†…å­˜åˆ’åˆ†ï¼Œè¿™ä¸¤è€…åŸºæœ¬ä¸Šæ˜¯æ²¡æœ‰å…³ç³»çš„ï¼›çº¿ç¨‹ã€ä¸»å†…å­˜å’Œå·¥ä½œå†…å­˜çš„å…³ç³»å¦‚ä¸‹æ‰€ç¤ºï¼š</li></ul><p><img src="https:////upload-images.jianshu.io/upload_images/3709321-01c9d97d757d8c1f.png" alt="çº¿ç¨‹ã€ä¸»å†…å­˜å’Œå·¥ä½œå†…å­˜çš„å…³ç³»"></p><h4 id="12-3-2-å†…å­˜é—´äº¤äº’æ“ä½œ"><a href="#12-3-2-å†…å­˜é—´äº¤äº’æ“ä½œ" class="headerlink" title="12.3.2 å†…å­˜é—´äº¤äº’æ“ä½œ"></a>12.3.2 å†…å­˜é—´äº¤äº’æ“ä½œ</h4><p>å…³äºä¸»å†…å­˜ä¸å·¥ä½œå†…å­˜ä¹‹é—´å…·ä½“çš„äº¤äº’åè®®ï¼Œå³ä¸€ä¸ªå˜é‡å¦‚ä½•ä»ä¸»å†…å­˜æ‹·è´åˆ°å·¥ä½œå†…å­˜ã€å¦‚ä½•ä»å·¥ä½œå†…å­˜åŒæ­¥å›ä¸»å†…å­˜ä¹‹ç±»çš„å®ç°ç»†èŠ‚ï¼ŒJavaå†…å­˜æ¨¡å‹ä¸­å®šä¹‰äº†ä»¥ä¸‹å…«ç§æ“ä½œæ¥å®Œæˆï¼Œè™šæ‹Ÿæœºå®ç°æ—¶å¿…é¡»ä¿è¯ä¸‹é¢æåŠçš„æ¯ä¸€ç§æ“ä½œéƒ½æ˜¯åŸå­çš„ã€ä¸å¯å†åˆ†çš„ï¼ˆå¯¹äºdoubleå’Œlongç±»å‹çš„å˜é‡çš„æŸäº›æ“ä½œåœ¨æŸäº›å¹³å°å…è®¸æœ‰ä¾‹å¤–ï¼‰ï¼š</p><ul><li>lock</li><li>unlock</li><li>read</li><li>load</li><li>use</li><li>assign</li><li>store</li><li>write</li></ul><p>åŸºäºç†è§£éš¾åº¦å’Œä¸¥è°¨æ€§è€ƒè™‘ï¼Œæœ€æ–°çš„JSR-133æ–‡æ¡£ä¸­ï¼Œå·²ç»æ”¾å¼ƒé‡‡ç”¨è¿™å…«ç§æ“ä½œå»å®šä¹‰Javaå†…å­˜æ¨¡å‹çš„è®¿é—®åè®®äº†ï¼Œåé¢å°†ä¼šä»‹ç»ä¸€ä¸ªç­‰æ•ˆåˆ¤æ–­åŸåˆ™ â€“ å…ˆè¡Œå‘ç”ŸåŸåˆ™ï¼Œç”¨æ¥ç¡®å®šä¸€ä¸ªè®¿é—®åœ¨å¹¶å‘ç¯å¢ƒä¸‹æ˜¯å¦å®‰å…¨ï¼›</p><h4 id="12-3-3-å¯¹äºvolatileå‹å˜é‡çš„ç‰¹æ®Šè§„åˆ™"><a href="#12-3-3-å¯¹äºvolatileå‹å˜é‡çš„ç‰¹æ®Šè§„åˆ™" class="headerlink" title="12.3.3 å¯¹äºvolatileå‹å˜é‡çš„ç‰¹æ®Šè§„åˆ™"></a>12.3.3 å¯¹äºvolatileå‹å˜é‡çš„ç‰¹æ®Šè§„åˆ™</h4><ul><li>å…³é”®å­—volatileå¯ä»¥è¯´æ˜¯Javaè™šæ‹Ÿæœºæä¾›çš„æœ€è½»é‡çº§çš„åŒæ­¥æœºåˆ¶ï¼›</li><li>å½“ä¸€ä¸ªå˜é‡å®šä¹‰ä¸ºvolatileä¹‹åï¼Œå®ƒå°†å…·å¤‡ä¸¤ç§ç‰¹æ€§ï¼šç¬¬ä¸€æ˜¯ä¿è¯æ­¤å˜é‡å¯¹æ‰€æœ‰çº¿ç¨‹çš„å¯è§æ€§ï¼Œè¿™é‡Œçš„å¯è§æ€§æ˜¯æŒ‡å½“ä¸€ä¸ªçº¿ç¨‹ä¿®æ”¹äº†è¿™ä¸ªå˜é‡çš„å€¼ï¼Œæ–°çš„å€¼å¯¹äºå…¶ä»–çº¿ç¨‹æ¥è¯´æ˜¯å¯ä»¥ç«‹å³å¾—çŸ¥çš„ï¼Œè€Œæ™®é€šçš„å˜é‡çš„å€¼åœ¨çº¿ç¨‹é—´ä¼ é€’å‡éœ€è¦é€šè¿‡ä¸»å†…å­˜æ¥å®Œæˆï¼›å¦å¤–ä¸€ä¸ªæ˜¯ç¦æ­¢æŒ‡ä»¤é‡æ’åºä¼˜åŒ–ï¼Œæ™®é€šçš„å˜é‡ä»…ä»…ä¼šä¿è¯åœ¨è¯¥æ–¹æ³•çš„æ‰§è¡Œè¿‡ç¨‹ä¸­æ‰€æœ‰ä¾èµ–èµ‹å€¼ç»“æœçš„åœ°æ–¹éƒ½èƒ½è·å–åˆ°æ­£ç¡®çš„ç»“æœï¼Œè€Œä¸èƒ½ä¿è¯å˜é‡èµ‹å€¼æ“ä½œçš„é¡ºåºä¸ç¨‹åºä»£ç ä¸­çš„æ‰§è¡Œé¡ºåºä¸€è‡´ï¼›</li><li>volatileå˜é‡åœ¨å„ä¸ªçº¿ç¨‹çš„å·¥ä½œå†…å­˜ä¸­ä¸å­˜åœ¨ä¸€è‡´æ€§é—®é¢˜ï¼Œä½†æ˜¯Javaé‡Œé¢çš„è¿ç®—å¹¶éåŸå­æ“ä½œï¼Œå¯¼è‡´volatileå˜é‡çš„è¿ç®—åœ¨å¹¶å‘ä¸‹ä¸€æ ·æ˜¯ä¸å®‰å…¨çš„ï¼›</li><li>åœ¨ä¸ç¬¦åˆä»¥ä¸‹ä¸¤æ¡è§„åˆ™çš„è¿ç®—åœºæ™¯ä¸­ï¼Œæˆ‘ä»¬ä»ç„¶è¦é€šè¿‡åŠ é”æ¥ä¿è¯åŸå­æ€§ï¼šè¿ç®—ç»“æœå¹¶ä¸ä¾èµ–å˜é‡çš„å½“å‰å€¼æˆ–è€…èƒ½å¤Ÿç¡®ä¿åªæœ‰å•ä¸€çš„çº¿ç¨‹ä¿®æ”¹å˜é‡çš„å€¼ã€å˜é‡ä¸éœ€è¦ä¸å…¶ä»–çš„çŠ¶æ€å˜é‡å…±åŒå‚ä¸ä¸å˜çº¦æŸï¼›</li><li>volatileå˜é‡è¯»æ“ä½œçš„æ€§èƒ½æ¶ˆè€—ä¸æ™®é€šå˜é‡å‡ ä¹æ²¡æœ‰ä»»ä½•å·®åˆ«ï¼Œä½†æ˜¯å†™æ“ä½œåˆ™å¯èƒ½ä¼šæ…¢ä¸€äº›ï¼›ä¸è¿‡å¤§å¤šæ•°åœºæ™¯ä¸‹volatileçš„æ€»å¼€é”€ä»ç„¶è¦æ¯”é”ä½ï¼Œæˆ‘ä»¬åœ¨volatileä¸é”ä¹‹ä¸­é€‰æ‹©çš„å”¯ä¸€ä¾æ®ä»…ä»…æ˜¯volatileçš„è¯­ä¹‰èƒ½å¦æ»¡è¶³ä½¿ç”¨åœºæ™¯çš„éœ€æ±‚ï¼›</li></ul><h4 id="12-3-4-å¯¹äºlongå’Œdoubleå‹å˜é‡çš„ç‰¹æ®Šè§„åˆ™"><a href="#12-3-4-å¯¹äºlongå’Œdoubleå‹å˜é‡çš„ç‰¹æ®Šè§„åˆ™" class="headerlink" title="12.3.4 å¯¹äºlongå’Œdoubleå‹å˜é‡çš„ç‰¹æ®Šè§„åˆ™"></a>12.3.4 å¯¹äºlongå’Œdoubleå‹å˜é‡çš„ç‰¹æ®Šè§„åˆ™</h4><ul><li>å…è®¸è™šæ‹Ÿæœºå°†æ²¡æœ‰è¢«volatileä¿®é¥°çš„64ä½æ•°æ®çš„è¯»å†™æ“ä½œåˆ’åˆ†ä¸ºä¸¤æ¬¡32ä½çš„æ“ä½œæ¥è¿›è¡Œï¼Œå³å…è®¸è™šæ‹Ÿæœºå®ç°é€‰æ‹©å¯ä»¥ä¸ä¿è¯64ä½æ•°æ®ç±»å‹çš„loadã€storeã€readå’Œwriteè¿™4ä¸ªæ“ä½œçš„åŸå­æ€§ï¼Œè¿™ç‚¹å°±æ˜¯æ‰€è°“çš„longå’Œdoubleçš„éåŸå­æ€§åå®šï¼›</li><li>ä½†å…è®¸è™šæ‹Ÿæœºé€‰æ‹©æŠŠè¿™äº›æ“ä½œå®ç°ä¸ºå…·æœ‰åŸå­æ€§çš„æ“ä½œï¼Œç›®å‰å„ç§å¹³å°ä¸‹çš„å•†ç”¨è™šæ‹Ÿæœºå‡ ä¹éƒ½é€‰æ‹©æŠŠ64ä½æ•°æ®çš„è¯»å†™æ“ä½œä½œä¸ºåŸå­æ“ä½œæ¥å¯¹å¾…ï¼›</li></ul><h4 id="12-3-5-åŸå­æ€§ã€å¯è§æ€§ä¸æœ‰åºæ€§"><a href="#12-3-5-åŸå­æ€§ã€å¯è§æ€§ä¸æœ‰åºæ€§" class="headerlink" title="12.3.5 åŸå­æ€§ã€å¯è§æ€§ä¸æœ‰åºæ€§"></a>12.3.5 åŸå­æ€§ã€å¯è§æ€§ä¸æœ‰åºæ€§</h4><ul><li>åŸå­æ€§ï¼ˆAtomicityï¼‰ï¼šç”±Javaå†…å­˜æ¨¡å‹æ¥ç›´æ¥ä¿è¯çš„åŸå­æ€§å˜é‡æ“ä½œåŒ…æ‹¬readã€loadã€assignã€useã€storeå’Œwriteï¼›åœ¨synchronizedå—ä¹‹é—´çš„æ“ä½œä¹Ÿå…·å¤‡åŸå­æ€§ï¼›</li><li>å¯è§æ€§ï¼ˆVisibilityï¼‰ï¼šæ˜¯æŒ‡å½“ä¸€ä¸ªçº¿ç¨‹ä¿®æ”¹äº†å…±äº«å˜é‡çš„å€¼ï¼Œå…¶ä»–çº¿ç¨‹èƒ½å¤Ÿç«‹å³å¾—çŸ¥è¿™ä¸ªä¿®æ”¹ï¼›é™¤äº†volatileä¹‹å¤–ï¼ŒJavaè¿˜æœ‰synchronizedå’Œfinalå…³é”®å­—èƒ½å®ç°å¯è§æ€§ï¼›</li><li>æœ‰åºæ€§ï¼ˆOrderingï¼‰ï¼šå¦‚æœåœ¨æœ¬çº¿ç¨‹å†…è§‚å¯Ÿï¼Œæ‰€æœ‰çš„æ“ä½œéƒ½æ˜¯æœ‰åºçš„ï¼›å¦‚æœåœ¨ä¸€ä¸ªçº¿ç¨‹ä¸­è§‚å¯Ÿå¦ä¸€ä¸ªçº¿ç¨‹ï¼Œæ‰€æœ‰çš„æ“ä½œéƒ½æ˜¯æ— åºçš„ï¼›Javaè¯­è¨€æä¾›äº†volatileå’Œsynchronizedä¸¤ä¸ªå…³é”®å­—æ¥ä¿è¯çº¿ç¨‹ä¹‹é—´æ“ä½œçš„æœ‰åºæ€§ï¼›</li></ul><h4 id="12-3-6-å…ˆè¡Œå‘ç”ŸåŸåˆ™"><a href="#12-3-6-å…ˆè¡Œå‘ç”ŸåŸåˆ™" class="headerlink" title="12.3.6 å…ˆè¡Œå‘ç”ŸåŸåˆ™"></a>12.3.6 å…ˆè¡Œå‘ç”ŸåŸåˆ™</h4><ul><li>å…ˆè¡Œå‘ç”Ÿæ˜¯Javaå†…å­˜æ¨¡å‹ä¸­å®šä¹‰çš„ä¸¤é¡¹æ“ä½œä¹‹é—´çš„ååºå…³ç³»ï¼Œå¦‚æœè¯´æ“ä½œAå…ˆè¡Œå‘ç”Ÿäºæ“ä½œBï¼Œå…¶å®å°±æ˜¯è¯´åœ¨å‘ç”Ÿæ“ä½œBä¹‹å‰ï¼Œæ“ä½œAäº§ç”Ÿçš„å½±å“èƒ½è¢«æ“ä½œBè§‚å¯Ÿåˆ°ï¼Œå½±å“åŒ…æ‹¬äº†ä¿®æ”¹äº†å†…å­˜ä¸­å…±äº«å˜é‡çš„å€¼ã€å‘é€äº†æ¶ˆæ¯ã€è°ƒç”¨äº†æ–¹æ³•ç­‰ï¼›</li><li>ä¸‹é¢æ˜¯Javaå†…å­˜æ¨¡å‹ä¸‹ä¸€äº›å¤©ç„¶çš„å…ˆè¡Œå‘ç”Ÿå…³ç³»ï¼šç¨‹åºæ¬¡åºè§„åˆ™ã€ç®¡ç¨‹é”å®šè§„åˆ™ã€volatileå˜é‡è§„åˆ™ã€çº¿ç¨‹å¯åŠ¨è§„åˆ™ã€çº¿ç¨‹ç»ˆæ­¢è§„åˆ™ã€çº¿ç¨‹ä¸­æ–­è§„åˆ™ã€å¯¹è±¡ç»ˆç»“è§„åˆ™ã€ä¼ é€’æ€§ï¼›</li><li>æ—¶é—´å…ˆåé¡ºåºä¸å…ˆè¡Œå‘ç”ŸåŸåˆ™ä¹‹é—´åŸºæœ¬æ²¡æœ‰å¤ªå¤§çš„å…³ç³»ï¼Œæ‰€ä»¥æˆ‘ä»¬è¡¡é‡å¹¶å‘å®‰å…¨é—®é¢˜çš„æ—¶å€™ä¸è¦å—åˆ°æ—¶é—´é¡ºåºçš„å¹²æ‰°ï¼Œä¸€åˆ‡å¿…é¡»ä»¥å…ˆè¡Œå‘ç”ŸåŸåˆ™ä¸ºå‡†ï¼›</li></ul><h3 id="12-4-Javaä¸çº¿ç¨‹"><a href="#12-4-Javaä¸çº¿ç¨‹" class="headerlink" title="12.4 Javaä¸çº¿ç¨‹"></a>12.4 Javaä¸çº¿ç¨‹</h3><h4 id="12-4-1-çº¿ç¨‹çš„å®ç°"><a href="#12-4-1-çº¿ç¨‹çš„å®ç°" class="headerlink" title="12.4.1 çº¿ç¨‹çš„å®ç°"></a>12.4.1 çº¿ç¨‹çš„å®ç°</h4><ul><li>çº¿ç¨‹æ˜¯æ¯”è¿›ç¨‹æ›´è½»é‡çº§çš„è°ƒåº¦æ‰§è¡Œå•ä½ï¼Œçº¿ç¨‹çš„å¼•å…¥å¯ä»¥æŠŠä¸€ä¸ªè¿›ç¨‹çš„èµ„æºåˆ†é…å’Œæ‰§è¡Œè°ƒåº¦åˆ†å¼€ï¼Œå„ä¸ªçº¿ç¨‹æ—¢å¯ä»¥å…±äº«è¿›ç¨‹èµ„æºåˆå¯ä»¥ç‹¬ç«‹è°ƒåº¦ï¼›</li><li>Threadç±»ä¸å¤§éƒ¨åˆ†çš„Java APIæœ‰æ˜¾è‘—çš„å·®åˆ«ï¼Œå®ƒçš„æ‰€æœ‰å…³é”®æ–¹æ³•éƒ½æ˜¯å£°æ˜ä¸ºNativeçš„ï¼›</li><li>å®ç°çº¿ç¨‹ä¸»è¦æœ‰ä¸‰ç§æ–¹å¼ï¼šä½¿ç”¨å†…æ ¸çº¿ç¨‹å®ç°ï¼ˆç³»ç»Ÿè°ƒç”¨ä»£ä»·ç›¸å¯¹è¾ƒé«˜ã€ä¸€ä¸ªç³»ç»Ÿæ”¯æŒè½»é‡çº§è¿›ç¨‹çš„æ•°é‡æ˜¯æœ‰é™çš„ï¼‰ã€ä½¿ç”¨ç”¨æˆ·çº¿ç¨‹å®ç°ï¼ˆä¼˜åŠ¿åœ¨äºä¸éœ€è¦ç³»ç»Ÿå†…æ ¸æ”¯æ´ï¼ŒåŠ£åŠ¿åœ¨äºæ‰€æœ‰çº¿ç¨‹æ“ä½œéƒ½éœ€è¦ç”¨æˆ·ç¨‹åºè‡ªå·±å¤„ç†ï¼‰å’Œä½¿ç”¨ç”¨æˆ·çº¿ç¨‹åŠ è½»é‡çº§è¿›ç¨‹æ··åˆå®ç°ï¼ˆç”¨æˆ·çº¿ç¨‹æ˜¯å®Œå…¨å»ºç«‹åœ¨ç”¨æˆ·ç©ºé—´ä¸­ï¼Œå› æ­¤ç”¨æˆ·çº¿ç¨‹çš„åˆ›å»ºã€åˆ‡æ¢ç­‰æ“ä½œä¾ç„¶å»‰ä»·ï¼Œå¹¶ä¸”å¯ä»¥æ”¯æŒå¤§è§„æ¨¡çš„ç”¨æˆ·çº¿ç¨‹å¹¶å‘ï¼›è€Œæ“ä½œç³»ç»Ÿæä¾›æ”¯æŒçš„è½»é‡çº§è¿›ç¨‹åˆ™ä½œä¸ºç”¨æˆ·çº¿ç¨‹å’Œå†…æ ¸çº¿ç¨‹ä¹‹é—´çš„æ¡¥æ¢ï¼Œè¿™æ ·å¯ä»¥ä½¿ç”¨å†…æ ¸æä¾›çš„çº¿ç¨‹è°ƒåº¦åŠŸèƒ½åŠå¤„ç†å™¨æ˜ å°„ï¼Œå¹¶ä¸”ç”¨æˆ·çº¿ç¨‹çš„ç³»ç»Ÿè°ƒç”¨è¦é€šè¿‡è½»é‡çº§çº¿ç¨‹æ¥å®Œæˆï¼Œå¤§å¤§é™ä½äº†æ•´ä¸ªè¿›ç¨‹è¢«å®Œå…¨é˜»å¡çš„é£é™©ï¼‰ï¼›</li><li>å¯¹äºSun JDKæ¥è¯´ï¼Œå®ƒçš„Windowsç‰ˆä¸Linuxç‰ˆéƒ½æ˜¯ä½¿ç”¨ä¸€å¯¹ä¸€çš„çº¿ç¨‹æ¨¡å‹å®ç°çš„ï¼Œä¸€æ¡Javaçº¿ç¨‹å°±æ˜ å°„åˆ°ä¸€æ¡è½»é‡çº§è¿›ç¨‹ä¹‹ä¸­ï¼Œå› ä¸ºWindowså’ŒLinuxç³»ç»Ÿæä¾›çš„çº¿ç¨‹æ¨¡å¼å°±æ˜¯ä¸€å¯¹ä¸€çš„ï¼›</li></ul><h4 id="12-4-2-Javaçº¿ç¨‹è°ƒåº¦"><a href="#12-4-2-Javaçº¿ç¨‹è°ƒåº¦" class="headerlink" title="12.4.2 Javaçº¿ç¨‹è°ƒåº¦"></a>12.4.2 Javaçº¿ç¨‹è°ƒåº¦</h4><ul><li>çº¿ç¨‹è°ƒåº¦æ˜¯æŒ‡ç³»ç»Ÿä¸ºçº¿ç¨‹åˆ†é…å¤„ç†å™¨ä½¿ç”¨æƒçš„è¿‡ç¨‹ï¼Œä¸»è¦è°ƒåº¦æ–¹å¼æœ‰ä¸¤ç§ï¼Œåˆ†åˆ«æ˜¯ååŒå¼çº¿ç¨‹è°ƒåº¦ï¼ˆçº¿ç¨‹çš„æ‰§è¡Œæ—¶é—´ç”±çº¿ç¨‹æœ¬èº«æ¥æ§åˆ¶ï¼‰å’ŒæŠ¢å å¼çº¿ç¨‹è°ƒåº¦ï¼ˆçº¿ç¨‹ç”±ç³»ç»Ÿæ¥åˆ†é…æ‰§è¡Œæ—¶é—´ï¼Œçº¿ç¨‹çš„åˆ‡æ¢ä¸ç”±çº¿ç¨‹æœ¬èº«æ¥å†³å®šï¼‰ï¼›</li><li>Javaè¯­è¨€ä¸€å…±è®¾ç½®äº†10ä¸ªçº§åˆ«çš„çº¿ç¨‹ä¼˜å…ˆçº§ï¼Œä¸è¿‡çº¿ç¨‹ä¼˜å…ˆçº§å¹¶ä¸æ˜¯å¤ªé è°±ï¼ŒåŸå› å°±æ˜¯æ“ä½œç³»ç»Ÿçš„çº¿ç¨‹ä¼˜å…ˆçº§ä¸è§å¾—æ€»æ˜¯ä¸Javaçº¿ç¨‹çš„ä¼˜å…ˆçº§ä¸€ä¸€å¯¹åº”ï¼Œå¦å¤–ä¼˜å…ˆçº§è¿˜å¯èƒ½è¢«ç³»ç»Ÿè‡ªè¡Œæ”¹å˜ï¼›</li></ul><h4 id="12-4-3-çŠ¶æ€è½¬æ¢"><a href="#12-4-3-çŠ¶æ€è½¬æ¢" class="headerlink" title="12.4.3 çŠ¶æ€è½¬æ¢"></a>12.4.3 çŠ¶æ€è½¬æ¢</h4><ul><li>Javaè¯­è¨€å®šä¹‰äº†äº”ç§çº¿ç¨‹çŠ¶æ€ï¼Œåœ¨ä»»æ„ä¸€ä¸ªæ—¶é—´ç‚¹ï¼Œä¸€ä¸ªçº¿ç¨‹åªèƒ½æœ‰ä¸”åªæœ‰å…¶ä¸­ä¸€ç§çŠ¶æ€ï¼Œåˆ†åˆ«æ˜¯æ–°å»ºï¼ˆNewï¼‰ã€è¿è¡Œï¼ˆRunnableï¼‰ã€æ— é™æœŸç­‰å¾…ï¼ˆWaitingï¼‰ã€é™æœŸç­‰å¾…ï¼ˆTimed Waitingï¼‰ã€é˜»å¡ï¼ˆBlocledï¼‰ã€ç»“æŸï¼ˆTerminatedï¼‰ã€‚å®ƒä»¬ä¹‹é—´ç›¸äº’çš„è½¬æ¢å…³ç³»å¦‚ä¸‹æ‰€ç¤ºï¼š</li></ul><figure class="image-bubble">                <div class="img-lightbox">                    <div class="overlay"></div>                    <img src="https:////upload-images.jianshu.io/upload_images/3709321-68f2cc99d1439039.png" alt="çº¿ç¨‹çŠ¶æ€è½¬æ¢å…³ç³»" title="">                </div>                <div class="image-caption">çº¿ç¨‹çŠ¶æ€è½¬æ¢å…³ç³»</div>            </figure><h3 id="12-5-æœ¬ç« å°ç»“"><a href="#12-5-æœ¬ç« å°ç»“" class="headerlink" title="12.5 æœ¬ç« å°ç»“"></a>12.5 æœ¬ç« å°ç»“</h3><p>æœ¬ç« æˆ‘ä»¬é¦–å…ˆäº†è§£äº†è™šæ‹ŸæœºJavaå†…å­˜æ¨¡å‹çš„ç»“æ„åŠæ“ä½œï¼Œç„¶åè®²è§£äº†åŸå­æ€§ã€å¯è§æ€§ã€æœ‰åºæ€§åœ¨Javaå†…å­˜æ¨¡å‹ä¸­çš„ä½“ç°ï¼Œæœ€åä»‹ç»äº†å…ˆè¡Œå‘ç”ŸåŸåˆ™çš„è§„åˆ™åŠä½¿ç”¨ã€‚å¦å¤–ï¼Œæˆ‘ä»¬è¿˜äº†è§£äº†çº¿ç¨‹åœ¨Javaè¯­è¨€ä¹‹ä¸­æ˜¯å¦‚ä½•å®ç°çš„ã€‚</p><p>åœ¨æœ¬ç« ä¸»è¦ä»‹ç»äº†è™šæ‹Ÿæœºå¦‚ä½•å®ç°å¹¶å‘ï¼Œè€Œåœ¨ä¸‹ä¸€ç« æˆ‘ä»¬ä¸»è¦å…³æ³¨ç‚¹å°†æ˜¯è™šæ‹Ÿæœºå¦‚ä½•å®ç°é«˜æ•ˆï¼Œä»¥åŠè™šæ‹Ÿæœºå¯¹æˆ‘ä»¬ç¼–å†™çš„å¹¶å‘ä»£ç æä¾›äº†ä»€ä¹ˆæ ·çš„ä¼˜åŒ–æ‰‹æ®µã€‚</p><h2 id="ç¬¬åä¸‰ç« -çº¿ç¨‹å®‰å…¨ä¸é”ä¼˜åŒ–"><a href="#ç¬¬åä¸‰ç« -çº¿ç¨‹å®‰å…¨ä¸é”ä¼˜åŒ–" class="headerlink" title="ç¬¬åä¸‰ç«  çº¿ç¨‹å®‰å…¨ä¸é”ä¼˜åŒ–"></a>ç¬¬åä¸‰ç«  çº¿ç¨‹å®‰å…¨ä¸é”ä¼˜åŒ–</h2><h3 id="13-1-æ¦‚è¿°"><a href="#13-1-æ¦‚è¿°" class="headerlink" title="13.1 æ¦‚è¿°"></a>13.1 æ¦‚è¿°</h3><ul><li>é¦–å…ˆéœ€è¦ä¿è¯å¹¶å‘çš„æ­£ç¡®æ€§ï¼Œç„¶ååœ¨æ­¤åŸºç¡€ä¸Šå®ç°é«˜æ•ˆï¼›</li></ul><h3 id="13-2-çº¿ç¨‹å®‰å…¨"><a href="#13-2-çº¿ç¨‹å®‰å…¨" class="headerlink" title="13.2 çº¿ç¨‹å®‰å…¨"></a>13.2 çº¿ç¨‹å®‰å…¨</h3><p>Brian Goetzå¯¹çº¿ç¨‹å®‰å…¨æœ‰ä¸€ä¸ªæ¯”è¾ƒæ°å½“çš„å®šä¹‰ï¼šå½“å¤šä¸ªçº¿ç¨‹è®¿é—®ä¸€ä¸ªå¯¹è±¡æ—¶ï¼Œå¦‚æœä¸ç”¨è€ƒè™‘è¿™äº›çº¿ç¨‹åœ¨è¿è¡Œæ—¶ç¯å¢ƒä¸‹çš„è°ƒåº¦å’Œäº¤æ›¿æ‰§è¡Œï¼Œä¹Ÿä¸éœ€è¦è¿›è¡Œé¢å¤–çš„åŒæ­¥ï¼Œæˆ–è€…åœ¨è°ƒç”¨æ–¹è¿›è¡Œä»»ä½•å…¶ä»–çš„åè°ƒæ“ä½œï¼Œè°ƒç”¨è¿™ä¸ªå¯¹è±¡çš„è¡Œä¸ºéƒ½å¯ä»¥è·å¾—æ­£ç¡®çš„ç»“æœï¼Œé‚£è¿™ä¸ªå¯¹è±¡æ˜¯çº¿ç¨‹å®‰å…¨çš„ã€‚</p><h4 id="13-2-1-Javaè¯­è¨€ä¸­çš„çº¿ç¨‹å®‰å…¨"><a href="#13-2-1-Javaè¯­è¨€ä¸­çš„çº¿ç¨‹å®‰å…¨" class="headerlink" title="13.2.1 Javaè¯­è¨€ä¸­çš„çº¿ç¨‹å®‰å…¨"></a>13.2.1 Javaè¯­è¨€ä¸­çš„çº¿ç¨‹å®‰å…¨</h4><ul><li>æˆ‘ä»¬å¯ä»¥å°†Javaè¯­è¨€ä¸­å„ä¸ªæ“ä½œå…±äº«çš„æ•°æ®åˆ†ä¸ºä»¥ä¸‹äº”ç±»ï¼šä¸å¯å˜ã€ç»å¯¹çº¿ç¨‹å®‰å…¨ã€ç›¸å¯¹çº¿ç¨‹å®‰å…¨ã€çº¿ç¨‹å…¼å®¹å’Œçº¿ç¨‹å¯¹ç«‹ï¼›</li><li>ä¸å¯å˜ï¼šä¸å¯å˜å¸¦æ¥çš„å®‰å…¨æ€§æ˜¯æœ€ç®€å•å’Œæœ€çº¯ç²¹çš„ï¼Œå¦‚finalçš„åŸºæœ¬æ•°æ®ç±»å‹ï¼›å¦‚æœå…±äº«çš„æ•°æ®æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œé‚£å°±éœ€è¦ä¿è¯å¯¹è±¡çš„è¡Œä¸ºä¸ä¼šå¯¹å…¶çŠ¶æ€äº§ç”Ÿä»»ä½•å½±å“æ‰è¡Œï¼Œæ¯”å¦‚Stringç±»çš„substringã€replaceæ–¹æ³•ï¼›Numberç±»å‹çš„å¤§éƒ¨åˆ†å­ç±»éƒ½ç¬¦åˆä¸å¯å˜è¦æ±‚çš„ç±»å‹ï¼Œä½†æ˜¯AtomicIntegerå’ŒAtomicLongåˆ™å¹¶éä¸å¯å˜çš„ï¼›</li><li>çº¿ç¨‹ç»å¯¹å®‰å…¨ï¼šJava APIä¸­æ ‡æ³¨è‡ªå·±æ˜¯çº¿ç¨‹å®‰å…¨çš„ç±»ï¼Œå¤§å¤šæ•°éƒ½ä¸æ˜¯ç»å¯¹çš„çº¿ç¨‹å®‰å…¨ï¼›æ¯”å¦‚java.util.Vectorï¼Œä¸æ„å‘³ç€è°ƒç”¨å®ƒçš„æ˜¯æ—¶å€™æ°¸è¿œéƒ½ä¸å†éœ€è¦åŒæ­¥æ‰‹æ®µäº†ï¼›</li><li>çº¿ç¨‹ç›¸å¯¹å®‰å…¨ï¼šæ˜¯æˆ‘ä»¬é€šå¸¸æ„ä¹‰ä¸Šæ‰€è®²çš„çº¿ç¨‹å®‰å…¨ï¼Œåœ¨Javaè¯­è¨€ä¸­ï¼Œå¤§éƒ¨åˆ†çš„çº¿ç¨‹å®‰å…¨ç±»éƒ½å±äºè¿™ç§ç±»å‹ï¼›</li><li>çº¿ç¨‹å…¼å®¹ï¼šæŒ‡å¯¹è±¡æœ¬èº«å¹¶ä¸æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Œä½†æ˜¯å¯ä»¥é€šè¿‡åœ¨è°ƒç”¨ç«¯æ­£ç¡®åœ°ä½¿ç”¨åŒæ­¥æ‰‹æ®µæ¥ä¿è¯å¯¹è±¡åœ¨å¹¶å‘ç¯å¢ƒä¸­å¯ä»¥å®‰å…¨åœ°ä½¿ç”¨ï¼›æˆ‘ä»¬è¯´ä¸€ä¸ªç±»ä¸æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Œç»å¤§å¤šæ•°æ—¶å€™æŒ‡çš„æ˜¯è¿™ä¸€ç§æƒ…å†µï¼›</li><li>çº¿ç¨‹å¯¹ç«‹ï¼šæ— è®ºè°ƒç”¨ç«¯æ˜¯å¦é‡‡å–äº†åŒæ­¥æªæ–½ï¼Œéƒ½æ— æ³•åœ¨å¤šçº¿ç¨‹ç¯å¢ƒä¸­å¹¶å‘ä½¿ç”¨çš„ä»£ç ï¼ŒJavaè¯­è¨€ä¸­å¾ˆå°‘å‡ºç°ï¼›</li></ul><h4 id="13-2-2-çº¿ç¨‹å®‰å…¨çš„å®ç°æ–¹æ³•"><a href="#13-2-2-çº¿ç¨‹å®‰å…¨çš„å®ç°æ–¹æ³•" class="headerlink" title="13.2.2 çº¿ç¨‹å®‰å…¨çš„å®ç°æ–¹æ³•"></a>13.2.2 çº¿ç¨‹å®‰å…¨çš„å®ç°æ–¹æ³•</h4><ul><li>äº’æ–¥åŒæ­¥ï¼šåŒæ­¥æ˜¯æŒ‡åœ¨å¤šä¸ªçº¿ç¨‹å¹¶å‘è®¿é—®å…±äº«æ•°æ®æ—¶ï¼Œä¿è¯å…±äº«æ•°æ®åœ¨åŒä¸€ä¸ªæ—¶åˆ»åªè¢«ä¸€ä¸ªçº¿ç¨‹ä½¿ç”¨ï¼Œè€Œäº’æ–¥æ˜¯å®ç°åŒæ­¥çš„ä¸€ç§æ‰‹æ®µï¼Œä¸´ç•ŒåŒºã€äº’æ–¥é‡å’Œä¿¡å·é‡éƒ½æ˜¯ä¸»è¦çš„äº’æ–¥å®ç°æ–¹å¼ï¼›Javaä¸­æœ€åŸºæœ¬çš„äº’æ–¥åŒæ­¥æ‰‹æ®µå°±æ˜¯synchronizedå…³é”®å­—ï¼Œå®ƒå¯¹åŒä¸€ä¸ªçº¿ç¨‹æ¥è¯´æ˜¯å¯é‡å…¥çš„ä¸”ä¼šé˜»å¡åé¢å…¶ä»–çº¿ç¨‹çš„è¿›å…¥ï¼›å¦å¤–è¿˜å¯ä»¥ä½¿ç”¨java.util.concurrentåŒ…ä¸­çš„é‡å…¥é”ï¼ˆReentrantLockï¼‰æ¥å®ç°åŒæ­¥ï¼Œç›¸æ¯”synchronizedå…³é”®å­—ReentrantLockå¢åŠ äº†ä¸€äº›é«˜çº§åŠŸèƒ½ï¼šç­‰å¾…å¯ä¸­æ–­ã€å¯å®ç°å…¬å¹³é”ä»¥åŠé”å¯ä»¥ç»‘å®šå¤šä¸ªæ¡ä»¶ï¼›</li><li>éé˜»å¡åŒæ­¥ï¼šäº’æ–¥åŒæ­¥æœ€ä¸»è¦çš„é—®é¢˜å°±æ˜¯è¿›è¡Œçº¿ç¨‹é˜»å¡å’Œå”¤é†’å¸¦æ¥çš„æ€§èƒ½é—®é¢˜ï¼Œå…¶å±äºä¸€ç§æ‚²è§‚çš„å¹¶å‘ç­–ç•¥ï¼›éšç€ç¡¬ä»¶æŒ‡ä»¤é›†çš„å‘å±•ï¼Œæˆ‘ä»¬æœ‰äº†å¦å¤–ä¸€ä¸ªé€‰æ‹©å³åŸºäºå†²çªæ£€æµ‹çš„ä¹è§‚å¹¶å‘ç­–ç•¥ï¼Œå°±æ˜¯å…ˆè¿›è¡Œæ“ä½œï¼Œå¦‚æœæ²¡æœ‰å…¶ä»–çº¿ç¨‹äº‰ç”¨å…±äº«æ•°æ®é‚£å°±æ“ä½œæˆåŠŸäº†ï¼Œå¦‚æœæœ‰äº‰ç”¨äº§ç”Ÿäº†å†²çªï¼Œé‚£å°±å†é‡‡å–å…¶ä»–çš„è¡¥å¿æªæ–½ï¼ˆæœ€å¸¸è§çš„å°±æ˜¯ä¸æ–­é‡è¯•ç›´è‡³æˆåŠŸï¼‰ï¼Œè¿™ç§åŒæ­¥æ“ä½œç§°ä¸ºéé˜»å¡åŒæ­¥ï¼›Javaå¹¶å‘åŒ…çš„æ•´æ•°åŸå­ç±»ï¼Œå…¶ä¸­çš„compareAndSetå’ŒgetAndIncrementç­‰æ–¹æ³•éƒ½ä½¿ç”¨äº†Unsafeç±»çš„CASæ“ä½œï¼›</li><li>æ— åŒæ­¥æ–¹æ¡ˆï¼šè¦ä¿è¯çº¿ç¨‹å®‰å…¨ï¼Œå¹¶ä¸æ˜¯ä¸€å®šå°±è¦è¿›è¡ŒåŒæ­¥ï¼›æœ‰ä¸€äº›ä»£ç å¤©ç”Ÿå°±æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Œæ¯”å¦‚å¯é‡å…¥ä»£ç å’Œçº¿ç¨‹æœ¬åœ°å­˜å‚¨çš„ä»£ç ï¼›</li></ul><h3 id="13-3-é”ä¼˜åŒ–"><a href="#13-3-é”ä¼˜åŒ–" class="headerlink" title="13.3 é”ä¼˜åŒ–"></a>13.3 é”ä¼˜åŒ–</h3><h4 id="13-3-1-è‡ªæ—‹é”ä¸è‡ªé€‚åº”è‡ªæ—‹"><a href="#13-3-1-è‡ªæ—‹é”ä¸è‡ªé€‚åº”è‡ªæ—‹" class="headerlink" title="13.3.1 è‡ªæ—‹é”ä¸è‡ªé€‚åº”è‡ªæ—‹"></a>13.3.1 è‡ªæ—‹é”ä¸è‡ªé€‚åº”è‡ªæ—‹</h4><ul><li>äº’æ–¥åŒæ­¥å¯¹æ€§èƒ½æœ€å¤§çš„å½±å“æ˜¯é˜»å¡çš„å®ç°ï¼ŒæŒ‚èµ·çº¿ç¨‹å’Œæ¢å¤çº¿ç¨‹çš„æ“ä½œéƒ½éœ€è¦è½¬å…¥å†…æ ¸æ€ä¸­å®Œæˆï¼Œè¿™äº›æ“ä½œç»™ç³»ç»Ÿçš„å¹¶å‘æ€§èƒ½å¸¦æ¥äº†å¾ˆå¤§çš„å‹åŠ›ï¼›å¦å¤–åœ¨å…±äº«æ•°æ®çš„é”å®šçŠ¶æ€åªä¼šæŒç»­å¾ˆçŸ­çš„ä¸€æ®µæ—¶é—´ï¼Œä¸ºäº†è¿™æ®µæ—¶é—´å»æŒ‚èµ·å’Œæ¢å¤çº¿ç¨‹å¹¶ä¸å€¼å¾—ï¼Œå¦‚æœè®©ä¸¤ä¸ªæˆ–ä»¥ä¸Šçš„çº¿ç¨‹åŒæ—¶å¹¶è¡Œæ‰§è¡Œï¼Œè®©åé¢è¯·æ±‚é”çš„é‚£ä¸ªçº¿ç¨‹ç¨ç­‰ä¸€ä¸‹ï¼Œä½†ä¸æ”¾å¼ƒå¤„ç†å™¨çš„æ‰§è¡Œæ—¶é—´ï¼Œçœ‹çœ‹æŒæœ‰é”çš„çº¿ç¨‹æ˜¯å¦å¾ˆå¿«å°±ä¼šé‡Šæ”¾é”ï¼›ä¸ºäº†è®©çº¿ç¨‹ç­‰å¾…ï¼Œæˆ‘ä»¬åªéœ€è®©çº¿ç¨‹æ‰§è¡Œä¸€ä¸ªå¿™å¾ªç¯ï¼Œè¿™äº›æŠ€æœ¯å°±æ˜¯æ‰€è°“çš„è‡ªæ—‹é”ï¼›</li><li>åœ¨JDK 1.6å·²ç»é»˜è®¤å¼€å¯è‡ªæ—‹é”ï¼›å¦‚æœé”è¢«å ç”¨çš„æ—¶é—´å¾ˆçŸ­è‡ªæ—‹ç­‰å¾…çš„æ•ˆæœå°±ä¼šéå¸¸å¥½ï¼Œåä¹‹åˆ™ä¼šç™½ç™½æ¶ˆè€—å¤„ç†å™¨èµ„æºï¼›</li><li>åœ¨JDK 1.6ä¸­å¼•å…¥äº†è‡ªé€‚åº”çš„è‡ªæ—‹é”ï¼Œè¿™æ„å‘³ç€è‡ªæ—‹çš„æ—¶é—´ä¸å†å›ºå®šï¼Œè€Œæ˜¯ç”±å‰ä¸€æ¬¡åœ¨åŒä¸€ä¸ªé”ä¸Šçš„è‡ªæ—‹æ—¶é—´åŠé”çš„æ‹¥æœ‰è€…çš„çŠ¶æ€æ¥å†³å®šï¼›</li></ul><h4 id="13-3-2-é”æ¶ˆé™¤"><a href="#13-3-2-é”æ¶ˆé™¤" class="headerlink" title="13.3.2 é”æ¶ˆé™¤"></a>13.3.2 é”æ¶ˆé™¤</h4><ul><li>é”æ¶ˆé™¤æ˜¯æŒ‡è™šæ‹Ÿæœºå³æ—¶ç¼–è¯‘å™¨åœ¨è¿è¡Œæ—¶ï¼Œå¯¹ä¸€äº›ä»£ç ä¸Šè¦æ±‚åŒæ­¥ï¼Œä½†æ˜¯è¢«æ£€æµ‹åˆ°ä¸å¯èƒ½å­˜åœ¨å…±äº«æ•°æ®ç«äº‰çš„é”è¿›è¡Œæ¶ˆé™¤ï¼›</li><li>é”æ¶ˆé™¤çš„ä¸»è¦åˆ¤æ–­ä¾æ®æ¥æºäºé€ƒé€¸åˆ†æçš„æ•°æ®æ”¯æŒï¼›</li></ul><h4 id="13-3-3-é”ç²—åŒ–"><a href="#13-3-3-é”ç²—åŒ–" class="headerlink" title="13.3.3 é”ç²—åŒ–"></a>13.3.3 é”ç²—åŒ–</h4><ul><li>åŸåˆ™ä¸Šæ€»æ˜¯æ¨èå°†åŒæ­¥å—çš„ä½œç”¨èŒƒå›´é™åˆ¶å¾—å°½é‡å° â€“ åªæœ‰åœ¨å…±äº«æ•°æ®çš„å®é™…ä½œç”¨åŸŸä¸­æ‰è¿›è¡ŒåŒæ­¥ï¼Œè¿™æ ·æ˜¯ä¸ºäº†ä½¿å¾—éœ€è¦åŒæ­¥çš„æ“ä½œæ•°é‡å°½å¯èƒ½å˜å°ï¼Œå¦‚æœå­˜åœ¨é”ç«äº‰ï¼Œé‚£ç­‰å¾…é”çš„çº¿ç¨‹ä¹Ÿèƒ½å°½å¿«æ‹¿åˆ°é”ï¼›</li><li>ä½†æ˜¯å¦‚æœä¸€ç³»åˆ—çš„è¿ç»­æ“ä½œéƒ½å¯¹åŒä¸€ä¸ªå¯¹è±¡åå¤åŠ é”å’Œè§£é”ï¼Œç”šè‡³åŠ é”æ“ä½œæ˜¯å‡ºç°åœ¨å¾ªç¯ä½“ä¸­çš„ï¼Œé‚£å³ä½¿æ²¡æœ‰çº¿ç¨‹ç«äº‰ï¼Œé¢‘ç¹åœ°è¿›è¡Œäº’æ–¥åŒæ­¥æ“ä½œä¹Ÿä¼šå¯¼è‡´ä¸å¿…è¦çš„æ€§èƒ½æŸè€—ï¼›</li></ul><h4 id="13-3-4-è½»é‡çº§é”"><a href="#13-3-4-è½»é‡çº§é”" class="headerlink" title="13.3.4 è½»é‡çº§é”"></a>13.3.4 è½»é‡çº§é”</h4><ul><li>è½»é‡çº§é”æ˜¯JDK 1.6ä¹‹ä¸­åŠ å…¥çš„æ–°å‹é”æœºåˆ¶ï¼Œå®ƒæ˜¯ç›¸å¯¹äºä½¿ç”¨æ“ä½œç³»ç»Ÿäº’æ–¥é‡æ¥å®ç°çš„ä¼ ç»Ÿé”è€Œè¨€çš„ï¼›å®ƒå¹¶ä¸æ˜¯ç”¨æ¥ä»£æ›¿é‡é‡çº§é”çš„ï¼Œå®ƒçš„æœ¬æ„æ˜¯åœ¨æ²¡æœ‰å¤šçº¿ç¨‹ç«äº‰çš„å‰æä¸‹ï¼Œå‡å°‘ä¼ ç»Ÿçš„é‡é‡çº§é”ä½¿ç”¨æ“ä½œç³»ç»Ÿäº’æ–¥é‡äº§ç”Ÿçš„æ€§èƒ½æ¶ˆè€—ï¼›</li><li>è¦ç†è§£è½»é‡çº§é”ï¼Œä»¥åŠåé¢ä¼šè®²åˆ°çš„åå‘é”çš„åŸç†å’Œè¿ä½œè¿‡ç¨‹ï¼Œå¿…é¡»ä»HotSpotè™šæ‹Ÿæœºçš„å¯¹è±¡çš„å†…å­˜å¸ƒå±€å¼€å§‹ä»‹ç»ï¼›HotSpotè™šæ‹Ÿæœºçš„å¯¹è±¡å¤´åˆ†ä¸ºä¸¤éƒ¨åˆ†ä¿¡æ¯ï¼šç¬¬ä¸€éƒ¨åˆ†ç”¨äºå­˜å‚¨å¯¹è±¡è‡ªèº«çš„è¿è¡Œæ—¶æ•°æ®ï¼Œå¦‚å“ˆå¸Œç ã€GCåˆ†ä»£å¹´é¾„ç­‰ï¼Œè¿™éƒ¨åˆ†å®˜æ–¹ç§°ä¹‹ä¸ºMark Wordï¼Œæ˜¯å®ç°è½»é‡çº§é”å’Œåå‘é”çš„å…³é”®ï¼Œå¦å¤–ä¸€éƒ¨åˆ†ç”¨äºå­˜å‚¨æŒ‡å‘æ–¹æ³•åŒºå¯¹è±¡ç±»å‹æ•°æ®çš„æŒ‡é’ˆï¼› Mark Wordè¢«è®¾è®¡æˆä¸€ä¸ªéå›ºå®šçš„æ•°æ®ç»“æ„ä»¥ä¾¿åœ¨æå°çš„ç©ºé—´å­˜å‚¨å°½é‡å¤šçš„ä¿¡æ¯ï¼Œåœ¨32ä½çš„HotSpotè™šæ‹Ÿæœºä¸­å¯¹è±¡æœªè¢«é”å®šçš„çŠ¶æ€ä¸‹ï¼Œ25bitç”¨äºå­˜å‚¨å¯¹è±¡å“ˆå¸Œç ï¼Œ4bitç”¨äºå­˜å‚¨å¯¹è±¡åˆ†ä»£å¹´é¾„ï¼Œ2bitç”¨äºå­˜å‚¨é”æ ‡å¿—ä½ï¼Œ1bitå›ºå®šä¸º0ï¼›åœ¨å…¶ä»–çŠ¶æ€ï¼ˆè½»é‡çº§é”å®šã€é‡é‡çº§é”å®šã€GCæ ‡å¿—ã€å¯åå‘ï¼‰ä¸‹å¯¹è±¡çš„å­˜å‚¨å†…å®¹å¦‚ä¸‹ï¼š</li></ul><p><img src="https:////upload-images.jianshu.io/upload_images/3709321-5ab1ae52e69821c1.png" alt="HotSpotè™šæ‹Ÿæœºå¯¹è±¡å¤´"></p><ul><li>åœ¨ä»£ç è¿›å…¥åŒæ­¥å—çš„æ—¶å€™ï¼Œå¦‚æœæ­¤åŒæ­¥å¯¹è±¡æ²¡æœ‰è¢«é”å®šï¼Œè™šæ‹Ÿæœºé¦–å…ˆå°†åœ¨å½“å‰çº¿ç¨‹çš„æ ˆå¸§ä¸­å»ºç«‹ä¸€ä¸ªåä¸ºé”è®°å½•ï¼ˆLock Recordï¼‰çš„ç©ºé—´ï¼Œç”¨äºå­˜å‚¨å¯¹è±¡ç›®å‰çš„Mark Wordçš„æ‹·è´ï¼ˆå®˜æ–¹ç§°ä¹‹ä¸ºDisplaced Mark Wordï¼‰ï¼›ç„¶åè™šæ‹Ÿæœºå°†ä½¿ç”¨CASæ“ä½œå°è¯•å°†å¯¹è±¡çš„Mark Wordæ›´æ–°ä¸ºæŒ‡å‘Lock Recordçš„æŒ‡é’ˆï¼Œå¦‚æœæ›´æ–°æˆåŠŸäº†é‚£ä¹ˆè¿™ä¸ªçº¿ç¨‹å°±æ‹¥æœ‰äº†è¯¥å¯¹è±¡çš„é”ï¼Œå¹¶ä¸”å¯¹è±¡Mark Wordçš„é”æ ‡å¿—ä½å°†è½¬å˜ä¸ºâ€œ00â€ï¼Œå³è¡¨ç¤ºæ­¤å¯¹è±¡å¤„äºè½»é‡çº§é”å®šçŠ¶æ€ï¼›å¦‚æœè¿™ä¸ªæ›´æ–°æ“ä½œå¤±è´¥äº†ï¼Œè™šæ‹Ÿæœºé¦–å…ˆä¼šæ£€æŸ¥å¯¹è±¡çš„Mark Wordæ˜¯å¦æŒ‡å‘å½“å‰çº¿ç¨‹çš„æ ˆå¸§ï¼Œå¦‚æœæ˜¯å°±å¯ä»¥ç›´æ¥è¿›å…¥åŒæ­¥å—ç»§ç»­æ‰§è¡Œï¼Œå¦åˆ™è¯´æ˜è¿™ä¸ªé”å¯¹è±¡å·²ç»è¢«å…¶ä»–çº¿ç¨‹æŠ¢å äº†ï¼›å¦‚æœæœ‰ä¸¤æ¡ä»¥ä¸Šçš„çº¿ç¨‹äº‰ç”¨åŒä¸€ä¸ªé”ï¼Œé‚£è½»é‡çº§é”å°±ä¸å†æœ‰æ•ˆï¼Œè¦è†¨èƒ€ä¸ºé‡é‡çº§é”ï¼Œé”æ ‡å¿—çš„çŠ¶æ€å€¼å˜ä¸ºâ€œ10â€ï¼ŒMark Wordä¸­å­˜å‚¨çš„å°±æ˜¯æŒ‡å‘é‡é‡çº§é”çš„æŒ‡é’ˆï¼Œåé¢ç­‰å¾…é”çš„çº¿ç¨‹ä¹Ÿè¦è¿›è¡Œé˜»å¡çŠ¶æ€ï¼›</li><li>è½»é‡çº§é”èƒ½æå‡ç¨‹åºåŒæ­¥æ€§èƒ½çš„ä¾æ®æ˜¯â€œå¯¹äºç»å¤§éƒ¨åˆ†çš„é”ï¼Œåœ¨æ•´ä¸ªåŒæ­¥å‘¨æœŸå†…éƒ½æ˜¯ä¸å­˜åœ¨ç«äº‰çš„â€ï¼Œè¿™æ˜¯ä¸€ä¸ªç»éªŒæ•°æ®ï¼›</li></ul><h4 id="13-3-5-åå‘é”"><a href="#13-3-5-åå‘é”" class="headerlink" title="13.3.5 åå‘é”"></a>13.3.5 åå‘é”</h4><ul><li>åå‘é”ä¹Ÿæ˜¯JDK 1.6ä¸­å¼•å…¥çš„ä¸€é¡¹é”ä¼˜åŒ–ï¼Œå®ƒçš„ç›®çš„æ˜¯æ¶ˆé™¤æ•°æ®åœ¨æ— ç«äº‰æƒ…å†µä¸‹çš„åŒæ­¥åŸè¯­ï¼Œè¿›ä¸€æ­¥æé«˜ç¨‹åºçš„è¿è¡Œæ€§èƒ½ï¼›å¦‚æœè¯´è½»é‡çº§é”æ˜¯åœ¨æ— ç«äº‰çš„æƒ…å†µä¸‹ä½¿ç”¨CASæ“ä½œå»æ¶ˆé™¤åŒæ­¥ä½¿ç”¨çš„äº’æ–¥é‡ï¼Œé‚£åå‘é”å°±æ˜¯åœ¨æ— ç«äº‰çš„æƒ…å†µä¸‹æŠŠæ•´ä¸ªåŒæ­¥éƒ½æ¶ˆé™¤æ‰ï¼Œè¿CASæ“ä½œéƒ½ä¸åšäº†ï¼›</li><li>åå‘é”ä¼šåå‘äºç¬¬ä¸€ä¸ªè·å¾—å®ƒçš„çº¿ç¨‹ï¼Œå¦‚æœåœ¨æ¥ä¸‹æ¥çš„æ‰§è¡Œè¿‡ç¨‹ä¸­ï¼Œè¯¥é”æ²¡æœ‰è¢«å…¶ä»–çš„çº¿ç¨‹è·å–ï¼Œåˆ™æŒæœ‰åå‘é”çš„çº¿ç¨‹å°†æ°¸è¿œä¸éœ€è¦å†è¿›è¡ŒåŒæ­¥ï¼›</li><li>å‡è®¾å½“å‰è™šæ‹Ÿæœºå¯åŠ¨äº†åå‘é”ï¼Œé‚£ä¹ˆå½“é”å¯¹è±¡ç¬¬ä¸€æ¬¡è¢«çº¿ç¨‹è·å–çš„æ—¶å€™ï¼Œè™šæ‹Ÿæœºå°†ä¼šæŠŠå¯¹è±¡å¤´ä¸­çš„æ ‡å¿—ä½è®¾ä¸ºâ€œ01â€ï¼Œå³åå‘æ¨¡å¼ï¼›åŒæ—¶ä½¿ç”¨CASæ“ä½œæŠŠè·å–åˆ°è¿™ä¸ªé”çš„çº¿ç¨‹IDè®°å½•åœ¨å¯¹è±¡çš„Mark Wordä¹‹ä¸­ï¼›å¦‚æœCASæ“ä½œæˆåŠŸï¼ŒæŒæœ‰åå‘é”çš„çº¿ç¨‹ä»¥åæ¯æ¬¡è¿›å…¥è¿™ä¸ªé”ç›¸å…³çš„åŒæ­¥å—æ—¶ï¼Œè™šæ‹Ÿæœºéƒ½å¯ä»¥ä¸å†è¿›è¡Œä»»ä½•åŒæ­¥æ“ä½œï¼›å½“æœ‰å¦å¤–ä¸€ä¸ªçº¿ç¨‹å»å°è¯•è·å–è¿™ä¸ªé”æ—¶ï¼Œåå‘æ¨¡å¼å°±å®£å‘Šç»“æŸï¼Œæ ¹æ®é”å¯¹è±¡ç›®å‰æ˜¯å¦è¢«é”å®šçš„çŠ¶æ€ï¼Œæ’¤é”€åå‘åæ¢å¤åˆ°æœªé”å®šæˆ–è½»é‡çº§é”å®šçš„çŠ¶æ€ï¼Œåç»­çš„åŒæ­¥æ“ä½œå°±å¦‚ä¸Šé¢ä»‹ç»çš„è½»é‡çº§é”é‚£æ ·æ‰§è¡Œï¼›åå‘é”ã€è½»é‡çº§é”çš„çŠ¶æ€è½¬åŒ–ä»¥åŠå¯¹è±¡Mark Workçš„å…³ç³»å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</li></ul><p><img src="https:////upload-images.jianshu.io/upload_images/3709321-2501d5d148f80a2d.png" alt="åå‘é”ã€è½»é‡çº§é”çš„çŠ¶æ€è½¬åŒ–"></p><ul><li>åå‘é”å¯ä»¥æé«˜å¸¦æœ‰åŒæ­¥ä½†æ— ç«äº‰çš„ç¨‹åºæ€§èƒ½ï¼Œå®ƒåŒæ ·æ˜¯ä¸€ä¸ªå¸¦æœ‰æ•ˆç›Šæƒè¡¡æ€§è´¨çš„ä¼˜åŒ–ï¼›</li></ul><h3 id="æœ¬ç« å°ç»“"><a href="#æœ¬ç« å°ç»“" class="headerlink" title="æœ¬ç« å°ç»“"></a>æœ¬ç« å°ç»“</h3><p>æœ¬ç« ä»‹ç»äº†çº¿ç¨‹å®‰å…¨æ‰€æ¶‰åŠçš„æ¦‚å¿µå’Œåˆ†ç±»ã€åŒæ­¥å®ç°çš„æ–¹å¼åŠè™šæ‹Ÿæœºçš„åº•å±‚è¿è¡ŒåŸç†ï¼Œå¹¶ä¸”ä»‹ç»äº†è™šæ‹Ÿæœºä¸ºäº†å®ç°é«˜æ•ˆå¹¶å‘æ‰€é‡‡å–çš„ä¸€ç³»åˆ—é”ä¼˜åŒ–æªæ–½ã€‚</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;ç¬¬äº”éƒ¨åˆ†-é«˜æ•ˆå¹¶å‘&quot;&gt;&lt;a href=&quot;#ç¬¬äº”éƒ¨åˆ†-é«˜æ•ˆå¹¶å‘&quot; class=&quot;headerlink&quot; title=&quot;ç¬¬äº”éƒ¨åˆ† é«˜æ•ˆå¹¶å‘&quot;&gt;&lt;/a&gt;ç¬¬äº”éƒ¨åˆ† é«˜æ•ˆå¹¶å‘&lt;/h1&gt;&lt;h2 id=&quot;ç¬¬åäºŒç« -Javaå†…å­˜æ¨¡å‹ä¸çº¿ç¨‹&quot;&gt;&lt;a href=&quot;#ç¬¬åäºŒç« -Java
      
    
    </summary>
    
      <category term="æ•´ç†" scheme="https://meandni.com/categories/%E6%95%B4%E7%90%86/"/>
    
    
      <category term="è¯»ä¹¦" scheme="https://meandni.com/tags/%E8%AF%BB%E4%B9%A6/"/>
    
      <category term="jvm" scheme="https://meandni.com/tags/jvm/"/>
    
  </entry>
  
  <entry>
    <title>ã€Šæ·±å…¥ç†è§£Javaè™šæ‹Ÿæœºã€‹ç¬”è®°5â€”â€”ç±»åŠ è½½æœºåˆ¶ä¸å­—èŠ‚ç æ‰§è¡Œå¼•æ“</title>
    <link href="https://meandni.com/2019/01/15/jvm_note5/"/>
    <id>https://meandni.com/2019/01/15/jvm_note5/</id>
    <published>2019-01-15T04:12:44.000Z</published>
    <updated>2019-01-15T05:12:17.120Z</updated>
    
    <content type="html"><![CDATA[<h2 id="ç¬¬ä¸ƒç« -è™šæ‹Ÿæœºç±»åŠ è½½æœºåˆ¶"><a href="#ç¬¬ä¸ƒç« -è™šæ‹Ÿæœºç±»åŠ è½½æœºåˆ¶" class="headerlink" title="ç¬¬ä¸ƒç«  è™šæ‹Ÿæœºç±»åŠ è½½æœºåˆ¶"></a>ç¬¬ä¸ƒç«  è™šæ‹Ÿæœºç±»åŠ è½½æœºåˆ¶</h2><h3 id="7-1-æ¦‚è¿°"><a href="#7-1-æ¦‚è¿°" class="headerlink" title="7.1 æ¦‚è¿°"></a>7.1 æ¦‚è¿°</h3><ul><li>è™šæ‹ŸæœºæŠŠæè¿°ç±»çš„æ•°æ®ä»Classæ–‡ä»¶åŠ è½½åˆ°å†…å­˜ï¼Œå¹¶å¯¹æ•°æ®è¿›è¡Œæ ¡éªŒã€è½¬æ¢è§£æå’Œåˆå§‹åŒ–ï¼Œæœ€ç»ˆå½¢æˆå¯ä»¥è¢«è™šæ‹Ÿæœºç›´æ¥ä½¿ç”¨çš„Javaç±»å‹ï¼Œè¿™å°±æ˜¯è™šæ‹Ÿæœºçš„ç±»åŠ è½½æœºåˆ¶ã€‚</li><li>åœ¨Javaè¯­è¨€é‡Œé¢ï¼Œç±»å‹çš„åŠ è½½ã€è¿æ¥å’Œåˆå§‹åŒ–è¿‡ç¨‹éƒ½æ˜¯åœ¨ç¨‹åºè¿è¡ŒæœŸé—´å®Œæˆï¼Œè¿™è™½ç„¶å¢é‡ä¸€äº›æ€§èƒ½å¼€é”€ï¼Œä½†æ˜¯ä¼šä¸ºJavaåº”ç”¨ç¨‹åºæä¾›é«˜åº¦çš„çµæ´»æ€§ã€‚</li></ul><h3 id="7-2-ç±»åŠ è½½çš„æ—¶æœº"><a href="#7-2-ç±»åŠ è½½çš„æ—¶æœº" class="headerlink" title="7.2 ç±»åŠ è½½çš„æ—¶æœº"></a>7.2 ç±»åŠ è½½çš„æ—¶æœº</h3><ul><li>ç±»çš„æ•´ä¸ªç”Ÿå‘½å‘¨æœŸï¼šåŠ è½½ã€éªŒè¯ã€å‡†å¤‡ã€è§£æã€åˆå§‹åŒ–ã€ä½¿ç”¨å’Œå¸è½½ï¼›å…¶ä¸­éªŒè¯ã€å‡†å¤‡å’Œè§£æç»Ÿç§°ä¸ºè¿æ¥ï¼›</li><li>è™šæ‹Ÿæœºè§„èŒƒæ²¡æœ‰å¼ºåˆ¶çº¦æŸç±»åŠ è½½çš„æ—¶æœºï¼Œä½†ä¸¥æ ¼è§„å®šäº†æœ‰ä¸”åªæœ‰5ç§æƒ…å†µå¿…é¡»ç«‹å³å¯¹ç±»è¿›è¡Œåˆå§‹åŒ–ï¼šé‡åˆ°newã€getstaticã€putstaticå’ŒinvokestaticæŒ‡ä»¤ï¼›å¯¹ç±»è¿›è¡Œåå°„è°ƒç”¨æ—¶å¦‚æœç±»æ²¡æœ‰è¿›è¡Œè¿‡åˆå§‹åŒ–ï¼›åˆå§‹åŒ–æ—¶å‘ç°çˆ¶ç±»è¿˜æ²¡æœ‰è¿›è¡Œåˆå§‹åŒ–ï¼›è™šæ‹Ÿæœºå¯åŠ¨æŒ‡å®šçš„ä¸»ç±»ï¼›åŠ¨æ€è¯­è¨€ä¸­MethodHandleå®ä¾‹æœ€åè§£æç»“æœREF_getStaticç­‰çš„æ–¹æ³•å¥æŸ„å¯¹åº”çš„ç±»æ²¡æœ‰åˆå§‹åŒ–æ—¶ï¼›</li></ul><h3 id="7-3-ç±»åŠ è½½çš„è¿‡ç¨‹"><a href="#7-3-ç±»åŠ è½½çš„è¿‡ç¨‹" class="headerlink" title="7.3 ç±»åŠ è½½çš„è¿‡ç¨‹"></a>7.3 ç±»åŠ è½½çš„è¿‡ç¨‹</h3><h4 id="7-3-1-åŠ è½½"><a href="#7-3-1-åŠ è½½" class="headerlink" title="7.3.1 åŠ è½½"></a>7.3.1 åŠ è½½</h4><ul><li>é€šè¿‡ä¸€ä¸ªç±»çš„å…¨é™å®šåæ¥è·å–å®šä¹‰æ­¤ç±»çš„äºŒè¿›åˆ¶å­—èŠ‚æµï¼›</li><li>å°†è¿™ä¸ªå­—èŠ‚æµæ‰€ä»£è¡¨çš„é™æ€å­˜å‚¨ç»“æ„è½¬åŒ–ä¸ºæ–¹æ³•åŒºçš„è¿è¡Œæ—¶æ•°æ®ç»“æ„ï¼›</li><li>åœ¨å†…å­˜ä¸­ç”Ÿæˆä¸€ä¸ªä»£è¡¨è¿™ä¸ªç±»çš„java.lang.Classå¯¹è±¡ï¼Œä½œä¸ºæ–¹æ³•åŒºè¿™ä¸ªç±»çš„å„ç§æ•°æ®çš„è®¿é—®å…¥å£ï¼›</li></ul><h4 id="7-3-2-éªŒè¯"><a href="#7-3-2-éªŒè¯" class="headerlink" title="7.3.2 éªŒè¯"></a>7.3.2 éªŒè¯</h4><ul><li>éªŒè¯æ˜¯è¿æ¥é˜¶æ®µçš„ç¬¬ä¸€æ­¥ï¼Œå…¶ç›®çš„æ˜¯ç¡®ä¿Classæ–‡ä»¶çš„å­—èŠ‚æµä¸­åŒ…å«çš„ä¿¡æ¯ç¬¦åˆå½“å‰è™šæ‹Ÿæœºçš„è¦æ±‚ï¼Œå¹¶ä¸”ä¸ä¼šå±å®³è™šæ‹Ÿæœºè‡ªèº«çš„å®‰å…¨ï¼›</li><li>éªŒè¯é˜¶æ®µæ˜¯éå¸¸é‡è¦çš„ï¼Œè¿™ä¸ªé˜¶æ®µæ˜¯å¦ä¸¥è°¨å†³å®šäº†Javaè™šæ‹Ÿæœºæ˜¯å¦èƒ½æ‰¿å—æ¶æ„ä»£ç çš„æ”»å‡»ï¼›</li><li>æ ¡éªŒåŠ¨ä½œï¼šæ–‡ä»¶æ ¼å¼éªŒè¯ï¼ˆåŸºäºäºŒè¿›åˆ¶å­—èŠ‚æµï¼‰ã€å…ƒæ•°æ®éªŒè¯ï¼ˆå¯¹ç±»çš„å…ƒæ•°æ®è¯­ä¹‰åˆ†æï¼‰ã€å­—èŠ‚ç éªŒè¯ï¼ˆå¯¹æ–¹æ³•ä½“è¯­ä¹‰åˆ†æï¼‰ã€ç¬¦å·å¼•ç”¨éªŒè¯ï¼ˆå¯¹ç±»è‡ªèº«ä»¥å¤–çš„ä¿¡æ¯è¿›è¡ŒåŒ¹é…æ€§æ ¡éªŒï¼‰ï¼›</li></ul><h4 id="7-3-3-å‡†å¤‡"><a href="#7-3-3-å‡†å¤‡" class="headerlink" title="7.3.3 å‡†å¤‡"></a>7.3.3 å‡†å¤‡</h4><ul><li>æ­£å¼ä¸ºå˜é‡åˆ†é…å†…å­˜å¹¶è®¾ç½®ç±»å˜é‡åˆå§‹å€¼çš„é˜¶æ®µï¼Œè¿™äº›å˜é‡æ‰€ä½¿ç”¨çš„å†…å­˜éƒ½å°†åœ¨è¿™ä¸ªæ–¹æ³•åŒºä¸­è¿›è¡Œåˆ†é…ï¼›</li><li>éœ€è¦å¼ºè°ƒä¸¤ç‚¹ï¼šè¿™æ—¶å€™å†…å­˜åˆ†é…çš„ä»…åŒ…æ‹¬ç±»å˜é‡ï¼Œè€Œä¸åŒ…æ‹¬ç±»å®ä¾‹å˜é‡ï¼›è¿™é‡Œæ‰€è¯´çš„åˆå§‹åŒ–é€šå¸¸æƒ…å†µä¸‹æ˜¯æ•°æ®ç±»å‹çš„é›¶å€¼ï¼ŒçœŸæ­£çš„èµ‹å€¼æ˜¯åœ¨åˆå§‹åŒ–é˜¶æ®µï¼Œ<strong>å¦‚æœæ˜¯static finalçš„åˆ™æ˜¯ç›´æ¥èµ‹å€¼</strong>ï¼›</li></ul><h4 id="7-3-4-è§£æ"><a href="#7-3-4-è§£æ" class="headerlink" title="7.3.4 è§£æ"></a>7.3.4 è§£æ</h4><ul><li>è§£æé˜¶æ®µæ˜¯è™šæ‹Ÿæœºå°†å¸¸é‡æ± å†…çš„ç¬¦å·å¼•ç”¨ï¼ˆå¦‚CONSTANT_Class_infoã€CONSTANT_Fieldref_infoã€CONSTANT_Methodref_infoç­‰7ç§ï¼‰æ›¿æ¢ä¸ºç›´æ¥å¼•ç”¨çš„è¿‡ç¨‹ï¼›</li><li>ç¬¦å·å¼•ç”¨å¯ä»¥æ˜¯ä»»ä½•å½¢å¼çš„å­—é¢é‡ï¼Œä¸è™šæ‹Ÿæœºå®ç°çš„å†…å­˜å¸ƒå±€æ— å…³ï¼Œå¼•ç”¨çš„ç›®æ ‡å¹¶ä¸ä¸€å®šå·²ç»åŠ è½½åˆ°å†…å­˜ä¸­ï¼›è€Œç›´æ¥å¼•ç”¨æ˜¯ç›´æ¥æŒ‡å‘ç›®æ ‡çš„æŒ‡é’ˆã€ç›¸å¯¹åç§»é‡æˆ–æ˜¯ä¸€ä¸ªèƒ½é—´æ¥å®šä½åˆ°ç›®æ ‡çš„å¥æŸ„ï¼Œå®ƒå’Œè™šæ‹Ÿæœºå®ç°çš„å†…å­˜å¸ƒå±€ç›¸å…³ï¼Œå¼•ç”¨çš„ç›®æ ‡å¿…å®šä»¥åŠåœ¨å†…å­˜ä¸­å­˜åœ¨ï¼›</li><li>å¯¹åŒä¸€ä¸ªç¬¦å·å¼•ç”¨è¿›è¡Œå¤šæ¬¡è§£æè¯·æ±‚æ˜¯å¾ˆå¸¸è§çš„äº‹æƒ…ï¼Œè™šæ‹Ÿæœºå®ç°å¯ä»¥å¯¹ç¬¬ä¸€æ¬¡è§£æçš„ç»“æœè¿›è¡Œç¼“å­˜ï¼›</li></ul><h4 id="7-3-5-åˆå§‹åŒ–"><a href="#7-3-5-åˆå§‹åŒ–" class="headerlink" title="7.3.5 åˆå§‹åŒ–"></a>7.3.5 åˆå§‹åŒ–</h4><ul><li>æ˜¯ç±»åŠ è½½è¿‡ç¨‹çš„æœ€åä¸€æ­¥ï¼ŒçœŸæ­£å¼€å§‹æ‰§è¡Œç±»ä¸­å®šä¹‰çš„Javaç¨‹åºä»£ç ï¼ˆæˆ–è€…è¯´æ˜¯å­—èŠ‚ç ï¼‰ï¼›</li><li>åˆå§‹åŒ–é˜¶æ®µæ˜¯æ‰§è¡Œç±»æ„é€ å™¨<clinit>æ–¹æ³•çš„è¿‡ç¨‹ï¼Œè¯¥æ–¹æ³•æ˜¯ç”±ç¼–è¯‘å™¨è‡ªåŠ¨æ”¶é›†ç±»ä¸­çš„æ‰€æœ‰ç±»å˜é‡çš„èµ‹å€¼åŠ¨ä½œå’Œé™æ€è¯­å¥å—ä¸­çš„è¯­å¥åˆå¹¶äº§ç”Ÿçš„ï¼›</clinit></li><li><clinit>æ–¹æ³•ä¸ç±»çš„æ„é€ å‡½æ•°ï¼ˆæˆ–è€…è¯´æ˜¯å®ä¾‹æ„é€ å™¨<init>æ–¹æ³•ï¼‰ä¸åŒï¼Œå®ƒä¸éœ€è¦æ˜¾å¼åœ°è°ƒç”¨çˆ¶ç±»æ„é€ å™¨ï¼Œè™šæ‹Ÿæœºä¼šä¿è¯åœ¨å­ç±»çš„<clinit>æ–¹æ³•æ‰§è¡Œä¹‹å‰ï¼Œçˆ¶ç±»çš„<clinit>æ–¹æ³•å·²æ‰§è¡Œå®Œæ¯•ï¼›</clinit></clinit></init></clinit></li><li>æ‰§è¡Œæ¥å£çš„<clinit>æ–¹æ³•ä¸éœ€è¦å…ˆæ‰§è¡Œçˆ¶æ¥å£çš„<clinit>æ–¹æ³•ï¼Œåªæœ‰å½“çˆ¶æ¥å£ä¸­å®šä¹‰çš„å˜é‡ä½¿ç”¨æ—¶çˆ¶æ¥å£æ‰ä¼šåˆå§‹åŒ–ï¼Œæ¥å£çš„å®ç°ç±»åœ¨åˆå§‹åŒ–æ—¶ä¹Ÿä¸€æ ·ä¸ä¼šæ‰§è¡Œæ¥å£çš„<clinit>æ–¹æ³•ï¼›</clinit></clinit></clinit></li><li><clinit>æ–¹æ³•åˆå§‹åŒ–æ˜¯åŠ é”é˜»å¡ç­‰å¾…çš„ï¼Œåº”å½“é¿å…åœ¨<clinit>æ–¹æ³•ä¸­æœ‰è€—æ—¶å¾ˆé•¿çš„æ“ä½œï¼›</clinit></clinit></li></ul><h3 id="7-4-ç±»åŠ è½½å™¨"><a href="#7-4-ç±»åŠ è½½å™¨" class="headerlink" title="7.4 ç±»åŠ è½½å™¨"></a>7.4 ç±»åŠ è½½å™¨</h3><ul><li>è™šæ‹Ÿæœºè®¾è®¡å›¢é˜ŸæŠŠç±»åŠ è½½é˜¶æ®µçš„â€œé€šè¿‡ä¸€ä¸ªç±»çš„å…¨é™å®šåæ¥è·å–æè¿°æ­¤ç±»çš„äºŒè¿›åˆ¶å­—èŠ‚æµâ€è¿™ä¸ªåŠ¨ä½œæ”¾åˆ°è™šæ‹Ÿæœºå¤–éƒ¨å»å®ç°ï¼Œå®ç°è¿™ä¸ªåŠ¨ä½œçš„ä»£ç æ¨¡å—ç§°ä¸ºç±»åŠ è½½å™¨ï¼›</li><li>è¿™æ—¶Javaè¯­è¨€çš„ä¸€é¡¹åˆ›æ–°ï¼Œä¹Ÿæ˜¯Javaè¯­è¨€æµè¡Œçš„é‡è¦åŸå› ï¼Œåœ¨ç±»å±‚æ¬¡åˆ’åˆ†ã€OSGIã€çƒ­éƒ¨ç½²ã€ä»£ç åŠ å¯†ç­‰é¢†åŸŸå¤§æ”¾å¼‚å½©ï¼›</li></ul><h4 id="7-4-1-ç±»ä¸ç±»åŠ è½½å™¨"><a href="#7-4-1-ç±»ä¸ç±»åŠ è½½å™¨" class="headerlink" title="7.4.1 ç±»ä¸ç±»åŠ è½½å™¨"></a>7.4.1 ç±»ä¸ç±»åŠ è½½å™¨</h4><ul><li>å¯¹äºä»»æ„ä¸€ä¸ªç±»ï¼Œéƒ½éœ€è¦ç”±åŠ è½½å®ƒçš„ç±»åŠ è½½å™¨å’Œè¿™ä¸ªç±»æœ¬èº«ä¸€åŒç¡®ç«‹å…¶åœ¨Javaè™šæ‹Ÿæœºçš„å”¯ä¸€æ€§ï¼Œæ¯ä¸€ä¸ªç±»åŠ è½½å™¨éƒ½æ‹¥æœ‰ä¸€ä¸ªç‹¬ç«‹çš„ç±»åç§°ç©ºé—´ï¼›</li><li>æ¯”è¾ƒä¸¤ä¸ªç±»æ˜¯å¦ç›¸ç­‰ï¼ˆå¦‚Classå¯¹è±¡çš„equalsæ–¹æ³•ã€isAssignableFromæ–¹æ³•ã€isInstanceæ–¹æ³•ï¼‰ï¼Œåªæœ‰åœ¨è¿™ä¸¤ä¸ªç±»æ˜¯ç”±åŒä¸€ä¸ªç±»åŠ è½½å™¨åŠ è½½çš„å‰æä¸‹æ‰æœ‰æ„ä¹‰ï¼›</li></ul><h4 id="7-4-2-åŒäº²å§”æ´¾æ¨¡å‹"><a href="#7-4-2-åŒäº²å§”æ´¾æ¨¡å‹" class="headerlink" title="7.4.2 åŒäº²å§”æ´¾æ¨¡å‹"></a>7.4.2 åŒäº²å§”æ´¾æ¨¡å‹</h4><p><img src="https:////upload-images.jianshu.io/upload_images/3709321-4e150bb5176ab73d.png" alt="åŒäº²å§”æ´¾æ¨¡å‹"></p><ul><li>ä¸‰ç§ç³»ç»Ÿæä¾›çš„ç±»åŠ è½½å™¨ï¼šå¯åŠ¨ç±»åŠ è½½å™¨ï¼ˆBootstrap ClassLoaderï¼‰ã€æ‰©å±•ç±»åŠ è½½å™¨ï¼ˆExtension ClassLoaderï¼‰ã€åº”ç”¨ç¨‹åºç±»åŠ è½½å™¨ï¼ˆApplication ClassLoaderï¼‰ï¼›</li><li>åŒäº²å§”æ´¾æ¨¡å‹è¦æ±‚é™¤äº†é¡¶å±‚çš„å¯åŠ¨ç±»åŠ è½½å™¨å¤–ï¼Œå…¶ä»–çš„ç±»åŠ è½½å™¨éƒ½åº”å½“æœ‰è‡ªå·±çš„çˆ¶ç±»åŠ è½½å™¨ï¼Œè¿™é‡Œä¸€èˆ¬ä¸ä¼šä»¥ç»§æ‰¿çš„å…³ç³»æ¥å®ç°ï¼Œè€Œæ˜¯ä½¿ç”¨ç»„åˆçš„å…³ç³»æ¥å¤ç”¨çˆ¶åŠ è½½å™¨çš„ä»£ç ï¼›</li><li>å…¶å·¥ä½œè¿‡ç¨‹æ˜¯ï¼šå¦‚æœä¸€ä¸ªç±»åŠ è½½å™¨æ”¶åˆ°äº†ç±»åŠ è½½çš„è¯·æ±‚ï¼Œå®ƒé¦–å…ˆä¸ä¼šè‡ªå·±å»å°è¯•åŠ è½½è¿™ä¸ªç±»ï¼Œè€Œæ˜¯æŠŠè¿™ä¸ªè¯·æ±‚å§”æ´¾ç»™çˆ¶ç±»åŠ è½½å™¨å»å®Œæˆï¼Œåªæœ‰çˆ¶ç±»åŠ è½½å™¨åé¦ˆè‡ªå·±æ— æ³•å®Œæˆè¿™ä¸ªåŠ è½½è¯·æ±‚æ—¶ï¼ˆå®ƒçš„æœç´¢èŒƒå›´ä¸­æ²¡æœ‰æ‰¾åˆ°æ‰€éœ€çš„ç±»ï¼‰ï¼Œå­åŠ è½½å™¨æ‰ä¼šå°è¯•è‡ªå·±å»åŠ è½½ï¼›</li><li>è¿™æ ·çš„å¥½å¤„æ˜¯Javaç±»éšç€å®ƒçš„ç±»åŠ è½½å™¨å…·å¤‡äº†ä¸€ç§å¸¦æœ‰ä¼˜å…ˆçº§çš„å±‚æ¬¡å…³ç³»ï¼Œå¯¹ä¿è¯Javaç¨‹åºçš„ç¨³å®šè¿ä½œå¾ˆé‡è¦ï¼›</li><li>å®ç°åŒäº²å§”æ´¾çš„ä»£ç éƒ½é›†ä¸­åœ¨java.lang.ClassLoaderçš„loadClassæ–¹æ³•ä¸­ï¼Œé€»è¾‘æ¸…æ™°æ˜“æ‡‚ï¼›</li></ul><h4 id="7-4-3-ç ´ååŒäº²å§”æ´¾æ¨¡å‹"><a href="#7-4-3-ç ´ååŒäº²å§”æ´¾æ¨¡å‹" class="headerlink" title="7.4.3 ç ´ååŒäº²å§”æ´¾æ¨¡å‹"></a>7.4.3 ç ´ååŒäº²å§”æ´¾æ¨¡å‹</h4><ul><li>ä¸Šä¸€å°èŠ‚çš„åŒäº²å§”æ´¾æ¨¡å‹æ˜¯Javaè®¾è®¡è€…æ¨èç»™å¼€å‘è€…çš„ç±»åŠ è½½å™¨å®ç°æ–¹æ³•ï¼Œä½†ä¸æ˜¯ä¸€ä¸ªå¼ºåˆ¶æ€§çš„çº¦æŸæ¨¡å‹ï¼›</li><li>å…¸å‹çš„ä¸¤ç§æƒ…å†µï¼šä¸ºäº†è§£å†³JNIæ¥å£æä¾›è€…ï¼ˆSPIï¼‰å¼•å…¥çš„çº¿ç¨‹ä¸Šä¸‹æ–‡ç±»åŠ è½½å™¨ï¼›ä¸ºäº†ç¨‹åºåŠ¨æ€æ€§åŠ å¼ºçš„OSGIçš„Bundleç±»åŠ è½½å™¨ï¼›</li></ul><h3 id="7-5-æœ¬ç« å°ç»“"><a href="#7-5-æœ¬ç« å°ç»“" class="headerlink" title="7.5 æœ¬ç« å°ç»“"></a>7.5 æœ¬ç« å°ç»“</h3><p>æœ¬ç« ä»‹ç»äº†ç±»åŠ è½½è¿‡ç¨‹çš„åŠ è½½ã€éªŒè¯ã€å‡†å¤‡ã€è§£æå’Œåˆå§‹åŒ–äº”ä¸ªé˜¶æ®µä¸­è™šæ‹Ÿæœºè¿›è¡Œäº†å“ªäº›åŠ¨ä½œï¼Œè¿˜ä»‹ç»äº†ç±»åŠ è½½å™¨çš„å·¥ä½œåŸç†åŠå…¶å¯¹è™šæ‹Ÿæœºçš„æ„ä¹‰ã€‚ä¸‹ä¸€ç« å°†ä¸€èµ·çœ‹çœ‹è™šæ‹Ÿæœºå¦‚æœæ‰§è¡Œå®šä¹‰åœ¨Classæ–‡ä»¶é‡Œçš„å­—èŠ‚ç ã€‚</p><h2 id="ç¬¬å…«ç« -è™šæ‹Ÿæœºå­—èŠ‚ç æ‰§è¡Œå¼•æ“"><a href="#ç¬¬å…«ç« -è™šæ‹Ÿæœºå­—èŠ‚ç æ‰§è¡Œå¼•æ“" class="headerlink" title="ç¬¬å…«ç«  è™šæ‹Ÿæœºå­—èŠ‚ç æ‰§è¡Œå¼•æ“"></a>ç¬¬å…«ç«  è™šæ‹Ÿæœºå­—èŠ‚ç æ‰§è¡Œå¼•æ“</h2><h3 id="8-1-æ¦‚è¿°"><a href="#8-1-æ¦‚è¿°" class="headerlink" title="8.1 æ¦‚è¿°"></a>8.1 æ¦‚è¿°</h3><ul><li>æ‰§è¡Œå¼•æ“æ˜¯Javaè™šæ‹Ÿæœºæœ€æ ¸å¿ƒçš„ç»„æˆéƒ¨åˆ†ä¹‹ä¸€ï¼ŒåŒºåˆ«äºç‰©ç†æœºçš„æ‰§è¡Œå¼•æ“æ˜¯ç›´æ¥å»ºç«‹åœ¨å¤„ç†å™¨ã€ç¡¬ä»¶ã€æŒ‡ä»¤é›†å’Œæ“ä½œç³»ç»Ÿå±‚é¢ä¸Šçš„ï¼Œè™šæ‹Ÿæœºçš„æ‰§è¡Œå¼•æ“æ˜¯è‡ªå·±å®ç°çš„ï¼Œå¯ä»¥è‡ªè¡Œåˆ¶å®šæŒ‡ä»¤é›†ä¸æ‰§è¡Œå¼•æ“çš„ç»“æ„ä½“ç³»ï¼Œå¹¶ä¸”èƒ½å¤Ÿæ‰§è¡Œé‚£äº›ä¸è¢«ç¡¬ä»¶ç›´æ¥æ”¯æŒçš„æŒ‡ä»¤é›†æ ¼å¼ï¼›</li><li>åœ¨è™šæ‹Ÿæœºè§„èŒƒä¸­åˆ¶å®šäº†è™šæ‹Ÿæœºå­—èŠ‚ç æ‰§è¡Œå¼•æ“çš„æ¦‚å¿µæ¨¡å‹ï¼Œè¯¥æ¨¡å‹æˆä¸ºå„ç§è™šæ‹Ÿæœºæ‰§è¡Œå¼•æ“çš„ç»Ÿä¸€å¤–è§‚ï¼›</li><li>åœ¨ä¸åŒçš„è™šæ‹Ÿæœºå®ç°é‡Œé¢ï¼Œæ‰§è¡Œå¼•æ“åœ¨æ‰§è¡ŒJavaä»£ç æ—¶å¯èƒ½ä¼šæœ‰è§£é‡Šæ‰§è¡Œå’Œç¼–è¯‘æ‰§è¡Œä¸¤ç§é€‰æ‹©ï¼Œä¹Ÿå¯èƒ½ä¸¤è€…å…¼å¤‡ï¼Œç”šè‡³è¿˜å¯èƒ½ä¼šåŒ…å«å‡ ä¸ªä¸åŒçº§åˆ«çš„ç¼–è¯‘å™¨æ‰§è¡Œå¼•æ“ï¼Œä½†ä»å¤–è§‚æ¥è¯´æ˜¯ä¸€è‡´çš„ï¼šè¾“å…¥çš„éƒ½æ˜¯å­—èŠ‚ç æ–‡ä»¶ï¼Œå¤„ç†è¿‡ç¨‹æ˜¯å­—èŠ‚ç è§£æçš„ç­‰æ•ˆè¿‡ç¨‹ï¼Œè¾“å‡ºçš„æ˜¯æ‰§è¡Œç»“æœã€‚</li></ul><h3 id="8-2-è¿è¡Œæ—¶æ ˆå¸§ç»“æ„"><a href="#8-2-è¿è¡Œæ—¶æ ˆå¸§ç»“æ„" class="headerlink" title="8.2 è¿è¡Œæ—¶æ ˆå¸§ç»“æ„"></a>8.2 è¿è¡Œæ—¶æ ˆå¸§ç»“æ„</h3><figure class="image-bubble">                <div class="img-lightbox">                    <div class="overlay"></div>                    <img src="https:////upload-images.jianshu.io/upload_images/3709321-009d0f0efe9f528e.png" alt="è¿è¡Œæ—¶æ ˆå¸§ç»“æ„" title="">                </div>                <div class="image-caption">è¿è¡Œæ—¶æ ˆå¸§ç»“æ„</div>            </figure><ul><li>æ ˆå¸§æ˜¯ç”¨äºæ”¯æŒè™šæ‹Ÿæœºè¿›è¡Œæ–¹æ³•è°ƒç”¨å’Œæ–¹æ³•æ‰§è¡Œçš„æ•°æ®ç»“æ„ï¼Œå®ƒæ˜¯è™šæ‹Ÿæœºè¿è¡Œæ—¶æ•°æ®åŒºä¸­çš„è™šæ‹Ÿæœºæ ˆçš„æ ˆå…ƒç´ ï¼›</li><li>æ ˆå¸§å­˜å‚¨äº†æ–¹æ³•çš„å±€éƒ¨å˜é‡è¡¨ã€æ“ä½œæ•°æ ˆã€åŠ¨æ€è¿æ¥å’Œæ–¹æ³•è¿”å›åœ°å€ç­‰ä¿¡æ¯ï¼Œæ¯ä¸€ä¸ªæ–¹æ³•ä»è°ƒç”¨å¼€å§‹è‡³æ‰§è¡Œå®Œæˆçš„è¿‡ç¨‹ï¼Œéƒ½å¯¹åº”ç€ä¸€ä¸ªæ ˆå¸§åœ¨è™šæ‹Ÿæœºé‡Œé¢ä»å…¥æ ˆåˆ°å‡ºæ ˆçš„è¿‡ç¨‹ï¼›</li><li>æ ˆå¸§éœ€è¦åˆ†é…å¤šå°‘å†…å­˜åœ¨ç¼–è¯‘æ—¶å°±å®Œå…¨ç¡®å®šå¹¶å†™å…¥åˆ°æ–¹æ³•è¡¨çš„Codeå±æ€§ä¹‹ä¸­äº†ï¼Œä¸ä¼šå—åˆ°ç¨‹åºè¿è¡ŒæœŸå˜é‡æ•°æ®çš„å½±å“ï¼›</li><li>å¯¹äºæ‰§è¡Œå¼•æ“æ¥è¯´ï¼Œåœ¨æ´»åŠ¨çº¿ç¨‹ä¸­åªæœ‰ä½äºæ ˆé¡¶çš„æ ˆå¸§æ‰ç®—æœ‰æ•ˆçš„ï¼Œç§°ä¸ºå½“å‰æ ˆå¸§ï¼Œä¸è¿™ä¸ªæ ˆå¸§ç›¸å…³è”çš„æ–¹æ³•ç§°ä¸ºå½“å‰æ–¹æ³•ï¼Œæ‰§è¡Œå¼•æ“è¿è¡Œçš„æ‰€æœ‰å­—èŠ‚ç æŒ‡ä»¤éƒ½åªé’ˆå¯¹å½“å‰æ ˆå¸§è¿›è¡Œæ“ä½œã€‚</li></ul><h4 id="8-2-1-å±€éƒ¨å˜é‡è¡¨"><a href="#8-2-1-å±€éƒ¨å˜é‡è¡¨" class="headerlink" title="8.2.1 å±€éƒ¨å˜é‡è¡¨"></a>8.2.1 å±€éƒ¨å˜é‡è¡¨</h4><ul><li>æ˜¯ä¸€ç»„å˜é‡å€¼å­˜å‚¨ç©ºé—´ï¼Œç”¨äºå­˜æ”¾æ–¹æ³•å‚æ•°å’Œæ–¹æ³•å†…éƒ¨å®šä¹‰çš„å±€éƒ¨å˜é‡ï¼ŒCodeå±æ€§çš„max_localsç¡®å®šäº†è¯¥æ–¹æ³•æ‰€éœ€è¦åˆ†é…çš„å±€éƒ¨å˜é‡è¡¨çš„æœ€å¤§å®¹é‡ï¼›</li><li>å…¶å®¹é‡ä»¥å˜é‡æ§½ï¼ˆVariable Slotï¼‰ä¸ºæœ€å°å•ä½ï¼Œè™šæ‹Ÿæœºè§„èŒƒå…è®¸Slotçš„é•¿åº¦éšå¤„ç†å™¨ã€æ“ä½œç³»ç»Ÿæˆ–è™šæ‹Ÿæœºçš„ä¸åŒè€Œå‘ç”Ÿå˜åŒ–ï¼›</li><li>ä¸€ä¸ªSlotå¯ä»¥å­˜æ”¾ä¸€ä¸ª32ä½ä»¥å†…çš„æ•°æ®ç±»å‹ï¼ŒåŒ…æ‹¬booleanã€byteã€charã€‚shortã€intã€floatã€referenceå’ŒreturnAddressè¿™å…«ç§ç±»å‹ï¼›å¯¹äº64ä½çš„æ•°æ®ç±»å‹ï¼ˆlongå’Œdoubleï¼‰ï¼Œè™šæ‹Ÿæœºä¼šä»¥é«˜ä½å¯¹é½çš„æ–¹å¼ä¸ºå…¶åˆ†é…ä¸¤ä¸ªè¿ç»­çš„Slotç©ºé—´ï¼›</li></ul><h4 id="8-2-2-æ“ä½œæ•°æ ˆ"><a href="#8-2-2-æ“ä½œæ•°æ ˆ" class="headerlink" title="8.2.2 æ“ä½œæ•°æ ˆ"></a>8.2.2 æ“ä½œæ•°æ ˆ</h4><ul><li>ä¹Ÿå¸¸ç§°ä¸ºæ“ä½œæ ˆï¼Œå®ƒæ˜¯ä¸€ä¸ªåå…¥å…ˆå‡ºæ ˆï¼›Codeå±æ€§çš„max_stacksç¡®å®šäº†å…¶æœ€å¤§æ·±åº¦ï¼›</li><li>æ¯”å¦‚æ•´æ•°åŠ æ³•çš„å­—èŠ‚ç æŒ‡ä»¤iaddåœ¨è¿è¡Œçš„æ—¶å€™æ“ä½œæ•°æ ˆä¸­æœ€æ¥è¿‘æ ˆé¡¶çš„ä¸¤ä¸ªå…ƒç´ å·²ç»å­˜å…¥äº†ä¸¤ä¸ªintå‹çš„æ•°å€¼ï¼Œå½“æ‰§è¡Œè¿™ä¸ªæŒ‡ä»¤æ—¶ï¼Œä¼šå°†è¿™ä¸¤ä¸ªintå€¼å‡ºæ ˆå¹¶ç›¸åŠ ï¼Œç„¶åå°†ç›¸åŠ çš„ç»“æœå…¥æ ˆï¼›</li><li>æ“ä½œæ•°æ ˆä¸­å…ƒç´ çš„ç±»å‹å¿…é¡»ä¸å­—èŠ‚ç æŒ‡ä»¤çš„åºåˆ—ä¸¥æ ¼åŒ¹é…ï¼›</li><li>Javaè™šæ‹Ÿæœºçš„è§£é‡Šæ‰§è¡Œå¼•æ“ç§°ä¸ºâ€œåŸºäºæ ˆçš„æ‰§è¡Œå¼•æ“â€ï¼Œå…¶ä¸­æ‰€æŒ‡çš„æ ˆå°±æ˜¯æ“ä½œæ•°æ ˆï¼›</li></ul><h4 id="8-2-3-åŠ¨æ€è¿æ¥"><a href="#8-2-3-åŠ¨æ€è¿æ¥" class="headerlink" title="8.2.3 åŠ¨æ€è¿æ¥"></a>8.2.3 åŠ¨æ€è¿æ¥</h4><ul><li>æ¯ä¸ªæ ˆå¸§éƒ½åŒ…å«ä¸€ä¸ªæ‰§è¡Œè¿è¡Œæ—¶å¸¸é‡æ± ä¸­è¯¥æ ˆå¸§æ‰€å±æ–¹æ³•å¼•ç”¨ï¼ŒæŒæœ‰è¿™ä¸ªå¼•ç”¨æ˜¯ä¸ºäº†æ”¯æŒæ–¹æ³•è°ƒç”¨è¿‡ç¨‹ä¸­çš„åŠ¨æ€è¿æ¥ï¼ˆDynamic Linkingï¼‰ï¼›</li><li>Classæ–‡ä»¶çš„å¸¸é‡æ± çš„ç¬¦å·å¼•ç”¨ï¼Œæœ‰ä¸€éƒ¨åˆ†åœ¨ç±»åŠ è½½é˜¶æ®µæˆ–è€…ç¬¬ä¸€æ¬¡ä½¿ç”¨æ—¶å°±è½¬æ¢ä¸ºç›´æ¥å¼•ç”¨ï¼Œè¿™ç§ç§°ä¸ºé™æ€è§£æï¼Œè€Œå¦å¤–ä¸€éƒ¨åˆ†åœ¨æ¯ä¸€æ¬¡è¿è¡ŒæœŸé—´è½¬æ¢ä¸ºç›´æ¥å¼•ç”¨ï¼Œè¿™éƒ¨åˆ†ç§°ä¸ºåŠ¨æ€è¿æ¥ï¼›</li></ul><h4 id="8-2-4-æ–¹æ³•è¿”å›åœ°å€"><a href="#8-2-4-æ–¹æ³•è¿”å›åœ°å€" class="headerlink" title="8.2.4 æ–¹æ³•è¿”å›åœ°å€"></a>8.2.4 æ–¹æ³•è¿”å›åœ°å€</h4><ul><li>é€€å‡ºæ–¹æ³•çš„æ–¹å¼ï¼šæ­£å¸¸å®Œæˆå‡ºå£å’Œå¼‚å¸¸å®Œæˆå‡ºå£ï¼›</li><li>æ–¹æ³•é€€å‡ºçš„è¿‡ç¨‹å®é™…ä¸Šå°±ç­‰åŒäºæŠŠå½“å‰æ ˆå¸§å‡ºæ ˆï¼Œå› æ­¤é€€å‡ºæ—¶å¯èƒ½åªéœ€çš„æ“ä½œæœ‰ï¼šæ¢å¤ä¸Šå±‚æ–¹æ³•çš„å±€éƒ¨å˜é‡è¡¨å’Œæ“ä½œæ•°æ ˆï¼ŒæŠŠè¿”å›å€¼å‹å…¥è°ƒç”¨è€…æ ˆå¸§çš„æ“ä½œæ•°ä¸­ï¼Œè°ƒæ•´PCè®¡æ•°å™¨çš„å€¼ä»¥åªéœ€æ–¹æ³•è°ƒç”¨æŒ‡ä»¤åé¢çš„ä¸€å¥—æŒ‡ä»¤ç­‰ï¼›</li></ul><h4 id="8-2-5-é™„åŠ ä¿¡æ¯"><a href="#8-2-5-é™„åŠ ä¿¡æ¯" class="headerlink" title="8.2.5 é™„åŠ ä¿¡æ¯"></a>8.2.5 é™„åŠ ä¿¡æ¯</h4><ul><li>è™šæ‹Ÿæœºè§„èŒƒå…è®¸å…·ä½“çš„è™šæ‹Ÿæœºå®ç°å¢åŠ ä¸€äº›è§„èŒƒé‡Œæ²¡æœ‰æè¿°çš„ä¿¡æ¯åˆ°æ ˆå¸§ä¸­ï¼Œä¾‹å¦‚ä¸è°ƒè¯•ç›¸å…³çš„ä¿¡æ¯ï¼Œè¿™éƒ¨åˆ†å®Œæˆå–å†³äºå…·ä½“çš„è™šæ‹Ÿæœºå®ç°ï¼›</li></ul><h3 id="æ–¹æ³•è°ƒç”¨"><a href="#æ–¹æ³•è°ƒç”¨" class="headerlink" title="æ–¹æ³•è°ƒç”¨"></a>æ–¹æ³•è°ƒç”¨</h3><ul><li>æ–¹æ³•è°ƒç”¨å¹¶ä¸ç­‰åŒäºæ–¹æ³•æ‰§è¡Œï¼Œæ–¹æ³•è°ƒç”¨é˜¶æ®µå”¯ä¸€çš„ä»»åŠ¡å°±æ˜¯ç¡®å®šè¢«è°ƒç”¨æ–¹æ³•çš„ç‰ˆæœ¬å³è°ƒç”¨å“ªä¸€ä¸ªæ–¹æ³•ï¼Œæš‚æ—¶è¿˜ä¸æ¶‰åŠæ–¹æ³•å†…éƒ¨çš„å…·ä½“è¿è¡Œè¿‡ç¨‹ï¼›</li><li>Classæ–‡ä»¶çš„ç¼–è¯‘è¿‡ç¨‹ä¸­ä¸æŠ¥è­¦ä¼ ç»Ÿç¼–è¯‘çš„è¿æ¥æ­¥éª¤ï¼Œä¸€åˆ‡æ–¹æ³•è°ƒç”¨åœ¨Classæ–‡ä»¶é‡Œé¢å­˜å‚¨çš„éƒ½åªæ˜¯ç¬¦å·å¼•ç”¨ï¼Œè€Œä¸æ˜¯æ–¹æ³•åœ¨å®é™…è¿è¡Œæ—¶å†…å­˜å¸ƒå±€çš„å…¥å£åœ°å€ã€‚è¿™ä¸ªç‰¹æ€§ç»™Javaå¸¦æ¥äº†æ›´å¼ºå¤§çš„åŠ¨æ€æ‰©å±•èƒ½åŠ›ï¼Œä½†ä¹Ÿä½¿å¾—Javaæ–¹æ³•è°ƒç”¨è¿‡ç¨‹å˜å¾—ç›¸å¯¹å¤æ‚ï¼›</li></ul><h4 id="8-3-1-è§£æ"><a href="#8-3-1-è§£æ" class="headerlink" title="8.3.1 è§£æ"></a>8.3.1 è§£æ</h4><ul><li>æ–¹æ³•åœ¨ç¨‹åºçœŸæ­£è¿è¡Œä¹‹å‰å°±æœ‰ä¸€ä¸ªå¯ç¡®å®šçš„è°ƒç”¨ç‰ˆæœ¬ï¼Œå¹¶ä¸”è¿™ä¸ªæ–¹æ³•çš„è°ƒç”¨ç‰ˆæœ¬åœ¨è¿è¡ŒæœŸæ˜¯ä¸å¯æ”¹å˜çš„ï¼Œè¿™ç±»æ–¹æ³•çš„è°ƒç”¨ç§°ä¸ºè§£æï¼›</li><li>åœ¨Javaè¯­è¨€ä¸­ç¬¦åˆç¼–è¯‘å™¨å¯çŸ¥ã€è¿è¡ŒæœŸä¸å¯å˜è¿™ä¸ªè¦æ±‚çš„æ–¹æ³•ï¼Œä¸»è¦åŒ…æ‹¬é™æ€æ–¹æ³•å’Œç§æœ‰æ–¹æ³•ä¸¤å¤§ç±»ï¼›</li><li>äº”æ¡æ–¹æ³•è°ƒç”¨å­—èŠ‚ç æŒ‡ä»¤ï¼šinvokestaticã€invokespecialã€invokevirtualã€invokeinterfaceã€invokedynamicï¼›</li><li>è§£æè°ƒç”¨æ˜¯ä¸€ä¸ªé™æ€çš„è¿‡ç¨‹ï¼Œåœ¨ç¼–è¯‘æœŸé—´å°±å®Œå…¨ç¡®å®šï¼Œåœ¨ç±»åŠ è½½çš„è§£æé˜¶æ®µå°±ä¼šæŠŠæ¶‰åŠçš„ç¬¦å·å¼•ç”¨å…¨éƒ¨è½¬å˜ä¸ºå¯ç¡®å®šçš„ç›´æ¥å¼•ç”¨ï¼›è€Œåˆ†æ´¾è°ƒç”¨åˆ™å¯èƒ½æ˜¯é™æ€çš„ä¹Ÿå¯èƒ½æ˜¯åŠ¨æ€çš„ï¼›</li></ul><h4 id="8-3-2-åˆ†æ´¾"><a href="#8-3-2-åˆ†æ´¾" class="headerlink" title="8.3.2 åˆ†æ´¾"></a>8.3.2 åˆ†æ´¾</h4><ul><li>é™æ€åˆ†æ´¾ï¼šâ€œHuman man = new Man();â€è¯­å¥ä¸­Humanç§°ä¸ºå˜é‡çš„é™æ€ç±»å‹ï¼Œåé¢çš„Manç§°ä¸ºå˜é‡çš„å®é™…ç±»å‹ï¼›é™æ€ç±»å‹å’Œå®é™…ç±»å‹åœ¨ç¨‹åºä¸­éƒ½å¯ä»¥å‘ç”Ÿä¸€äº›å˜åŒ–ï¼ŒåŒºåˆ«æ˜¯é™æ€ç±»å‹çš„å˜åŒ–ä»…ä»…åœ¨ä½¿ç”¨æ—¶å‘ç”Ÿï¼Œå˜é‡æœ¬èº«çš„é™æ€ç±»å‹ä¸ä¼šè¢«æ”¹å˜ï¼Œå¹¶ä¸”æœ€ç»ˆçš„é™æ€ç±»å‹æ˜¯åœ¨ç¼–è¯‘å™¨å¯çŸ¥çš„ï¼›è€Œå®é™…ç±»å‹çš„å˜åŒ–åœ¨è¿è¡ŒæœŸæ‰ç¡®å®šï¼Œç¼–è¯‘å™¨åœ¨ç¼–è¯‘ç¨‹åºçš„æ—¶å€™å¹¶ä¸çŸ¥é“ä¸€ä¸ªå¯¹è±¡çš„å®é™…ç±»å‹æ˜¯ä»€ä¹ˆï¼›ç¼–è¯‘å™¨åœ¨é‡è½½æ—¶æ˜¯é€šè¿‡å‚æ•°çš„é™æ€ç±»å‹è€Œä¸æ˜¯å®é™…ç±»å‹ä½œä¸ºåˆ¤å®šä¾æ®çš„ï¼›æ‰€æœ‰æ ¹æ®é™æ€ç±»å‹æ¥å®šä½æ–¹æ³•æ‰§è¡Œç‰ˆæœ¬çš„åˆ†æ´¾åŠ¨ä½œç§°ä¸ºé™æ€åˆ†æ´¾ï¼Œå…¶å…¸å‹åº”ç”¨æ˜¯æ–¹æ³•é‡è½½ï¼›</li><li>åŠ¨æ€åˆ†æ´¾ï¼šinvokevirtualæŒ‡ä»¤æ‰§è¡Œçš„ç¬¬ä¸€æ­¥å°±æ˜¯åœ¨è¿è¡ŒæœŸé—´ç¡®å®šæ¥æ”¶è€…çš„å®é™…ç±»å‹ï¼Œæ‰€ä»¥ä¸¤æ¬¡è°ƒç”¨ä¸­invokevirtualæŒ‡ä»¤æŠŠå¸¸é‡æ± ä¸­çš„ç±»æ–¹æ³•ç¬¦å·å¼•ç”¨è§£æåˆ°äº†ä¸åŒçš„ç›´æ¥å¼•ç”¨ä¸Šï¼Œè¿™ä¸ªè¿‡ç¨‹å°±æ˜¯Javaè¯­è¨€ä¸­æ–¹æ³•é‡å†™çš„æœ¬è´¨ï¼›æˆ‘ä»¬æŠŠè¿™ç§åœ¨è¿è¡ŒæœŸæ ¹æ®å®é™…ç±»å‹ç¡®å®šæ–¹æ³•æ‰§è¡Œç‰ˆæœ¬çš„åˆ†æ´¾è¿‡ç¨‹ç§°ä¸ºåŠ¨æ€åˆ†æ´¾ï¼›</li><li>å•åˆ†æ´¾ä¸å¤šåˆ†æ´¾ï¼šæ–¹æ³•çš„æ¥æ”¶è€…ä¸æ–¹æ³•çš„å‚æ•°ç»Ÿç§°ä¸ºæ–¹æ³•çš„å®—é‡ï¼Œæ ¹æ®åˆ†æ´¾åŸºäºå¤šå°‘ç§å®—é‡ï¼Œå¯ä»¥å°†åˆ†æ´¾åˆ†ä¸ºå•åˆ†æ´¾ï¼ˆæ ¹æ®ä¸€ä¸ªå®—é‡å¯¹ç›®æ ‡æ–¹æ³•è¿›è¡Œé€‰æ‹©ï¼‰ä¸å¤šåˆ†æ´¾ï¼ˆæ ¹æ®å¤šäºä¸€ä¸ªå®—é‡å¯¹ç›®æ ‡æ–¹æ³•è¿›è¡Œé€‰æ‹©ï¼‰ä¸¤ç§ï¼›ä»Šå¤©çš„Javaè¯­è¨€æ˜¯ä¸€é—¨é™æ€å¤šåˆ†æ´¾ã€åŠ¨æ€å•åˆ†æ´¾çš„è¯­è¨€ï¼›</li><li>è™šæ‹ŸæœºåŠ¨æ€åˆ†æ´¾çš„å®ç°ï¼šåœ¨æ–¹æ³•åŒºä¸­å»ºç«‹ä¸€ä¸ªè™šæ–¹æ³•è¡¨ï¼ˆVirtual Method Tableï¼‰ï¼Œä½¿ç”¨è™šæ–¹æ³•è¡¨ç´¢å¼•æ¥ä»£æ›¿å…ƒæ•°æ®æŸ¥æ‰¾ä»¥æé«˜æ€§èƒ½ï¼›æ–¹æ³•è¡¨ä¸€èˆ¬åœ¨ç±»åŠ è½½çš„è¿æ¥é˜¶æ®µè¿›è¡Œåˆå§‹åŒ–ï¼Œå‡†å¤‡äº†ç±»çš„å˜é‡åˆå§‹åŒ–å€¼åï¼Œè™šæ‹Ÿæœºä¼šæŠŠè¯¥ç±»çš„æ–¹æ³•è¡¨ä¹Ÿåˆå§‹åŒ–å®Œæ¯•ï¼›</li></ul><h4 id="8-3-3-åŠ¨æ€ç±»å‹è¯­è¨€æ”¯æŒ"><a href="#8-3-3-åŠ¨æ€ç±»å‹è¯­è¨€æ”¯æŒ" class="headerlink" title="8.3.3 åŠ¨æ€ç±»å‹è¯­è¨€æ”¯æŒ"></a>8.3.3 åŠ¨æ€ç±»å‹è¯­è¨€æ”¯æŒ</h4><ul><li>JDK 1.7å‘å¸ƒå¢åŠ çš„invokedynamicæŒ‡ä»¤å®ç°äº†â€œåŠ¨æ€ç±»å‹è¯­è¨€â€æ”¯æŒï¼Œä¹Ÿæ˜¯ä¸ºJDK 1.8é¡ºåˆ©å®ç°Lambdaè¡¨è¾¾å¼åšæŠ€æœ¯å‡†å¤‡ï¼›</li><li>åŠ¨æ€ç±»å‹è¯­è¨€çš„å…³é”®ç‰¹å¾æ˜¯å®ƒçš„ç±»å‹æ£€æŸ¥çš„ä¸»ä½“è¿‡ç¨‹æ˜¯åœ¨è¿è¡ŒæœŸè€Œä¸æ˜¯ç¼–è¯‘å™¨ï¼Œæ¯”å¦‚JavaScriptã€Pythonç­‰ï¼›</li><li>Javaè¯­è¨€åœ¨ç¼–è¯‘æœŸé—´å°±å°†æ–¹æ³•å®Œæ•´çš„ç¬¦å·å¼•ç”¨ç”Ÿæˆå‡ºæ¥ï¼Œä½œä¸ºæ–¹æ³•è°ƒç”¨æŒ‡ä»¤çš„å‚æ•°å­˜å‚¨åˆ°Classæ–‡ä»¶ä¸­ï¼›è¿™ä¸ªç¬¦å·å¼•ç”¨åŒ…å«äº†æ­¤æ–¹æ³•å®šä¹‰åœ¨å“ªä¸ªå…·ä½“ç±»å‹ä¹‹ä¸­ã€æ–¹æ³•çš„åå­—ä»¥åŠå‚æ•°é¡ºåºã€å‚æ•°ç±»å‹å’Œæ–¹æ³•è¿”å›å€¼ç­‰ä¿¡æ¯ï¼›è€Œåœ¨ECMAScriptç­‰åŠ¨æ€è¯­è¨€ä¸­ï¼Œå˜é‡æœ¬èº«æ˜¯æ²¡æœ‰ç±»å‹çš„ï¼Œå˜é‡çš„å€¼æ‰å…·æœ‰ç±»å‹ï¼Œç¼–è¯‘æ—¶æœ€å¤šåªèƒ½ç¡®å®šæ–¹æ³•åç§°ã€å‚æ•°ã€è¿”å›å€¼è¿™äº›ä¿¡æ¯ï¼Œè€Œä¸ä¼šå»ç¡®å®šæ–¹æ³•æ‰€åœ¨çš„å…·ä½“ç±»å‹ï¼›å˜é‡æ— ç±»å‹è€Œå˜é‡å€¼æ‰æœ‰ç±»å‹ï¼Œè¿™ä¸ªç‰¹ç‚¹ä¹Ÿæ˜¯åŠ¨æ€ç±»å‹è¯­è¨€çš„ä¸€ä¸ªé‡è¦ç‰¹å¾ï¼›</li><li>JDK 1.7å®ç°äº†JSR-292ï¼Œæ–°åŠ å…¥çš„java.lang.invokeåŒ…çš„ä¸»è¦ç›®çš„æ˜¯åœ¨ä¹‹å‰å•çº¯ä¾é ç¬¦å·å¼•ç”¨æ¥ç¡®å®šè°ƒç”¨çš„ç›®æ ‡æ–¹æ³•å¤–ï¼Œæä¾›ä¸€ç§æ–°çš„åŠ¨æ€ç¡®å®šç›®æ ‡æ–¹æ³•çš„æœºåˆ¶ï¼Œç§°ä¸ºMethodHandleï¼›</li><li>ä»æœ¬è´¨ä¸Šè®²ï¼ŒReflectionï¼ˆåå°„ï¼‰å’ŒMethodHandleæœºåˆ¶éƒ½æ˜¯åœ¨æ¨¡æ‹Ÿæ–¹æ³•è°ƒç”¨ï¼Œä½†Reflectionæ˜¯åœ¨æ¨¡æ‹ŸJavaä»£ç å±‚æ¬¡çš„æ–¹æ³•è°ƒç”¨ï¼Œè€ŒMethodHandleæ˜¯åœ¨æ¨¡æ‹Ÿå­—èŠ‚ç å±‚æ¬¡çš„æ–¹æ³•è°ƒç”¨ï¼Œå‰è€…æ˜¯é‡é‡çº§ï¼Œè€Œåè€…æ˜¯è½»é‡çº§ï¼›å¦å¤–å‰è€…åªä¸ºJavaè¯­è¨€æœåŠ¡ï¼Œåè€…å¯æœåŠ¡äºæ‰€æœ‰Javaè™šæ‹Ÿæœºä¹‹ä¸Šçš„è¯­è¨€ï¼›</li><li>æ¯ä¸€å¤„å«æœ‰invokedynamicæŒ‡ä»¤çš„ä½ç½®éƒ½ç§°ä¸ºâ€œåŠ¨æ€è°ƒç”¨ç‚¹(Dynamic Call Site)â€ï¼Œè¿™æ¡æŒ‡ä»¤çš„ç¬¬ä¸€ä¸ªå‚æ•°ä¸å†æ˜¯ä»£è¡¨ç¬¦å·å¼•ç”¨çš„CONSTANT_Methodref_infoå¸¸é‡ï¼Œè€Œæ˜¯CONSTANT_InvokeDynamic_infoå¸¸é‡ï¼ˆå¯ä»¥å¾—åˆ°å¼•å¯¼æ–¹æ³•ã€æ–¹æ³•ç±»å‹å’Œåç§°ï¼‰ï¼›</li><li>invokedynamicæŒ‡ä»¤ä¸å…¶ä»–invokeæŒ‡ä»¤çš„æœ€å¤§å·®åˆ«å°±æ˜¯å®ƒçš„åˆ†æ´¾é€»è¾‘ä¸æ˜¯ç”±è™šæ‹Ÿæœºå†³å®šçš„ï¼Œè€Œæ˜¯ç”±ç¨‹åºå‘˜å†³å®šçš„ï¼›</li></ul><h3 id="8-4-åŸºäºæ ˆçš„å­—èŠ‚ç è§£é‡Šæ‰§è¡Œå¼•æ“"><a href="#8-4-åŸºäºæ ˆçš„å­—èŠ‚ç è§£é‡Šæ‰§è¡Œå¼•æ“" class="headerlink" title="8.4 åŸºäºæ ˆçš„å­—èŠ‚ç è§£é‡Šæ‰§è¡Œå¼•æ“"></a>8.4 åŸºäºæ ˆçš„å­—èŠ‚ç è§£é‡Šæ‰§è¡Œå¼•æ“</h3><p>ä¸ŠèŠ‚ä¸»è¦è®²è™šæ‹Ÿæœºæ˜¯å¦‚ä½•è°ƒç”¨æ–¹æ³•çš„ï¼Œè¿™èŠ‚æ¢è®¨è™šæ‹Ÿæœºæ˜¯å¦‚ä½•æ‰§è¡Œæ–¹æ³•ä¸­çš„å­—èŠ‚ç æŒ‡ä»¤çš„ã€‚</p><h4 id="8-4-1-è§£é‡Šæ‰§è¡Œ"><a href="#8-4-1-è§£é‡Šæ‰§è¡Œ" class="headerlink" title="8.4.1 è§£é‡Šæ‰§è¡Œ"></a>8.4.1 è§£é‡Šæ‰§è¡Œ</h4><ul><li>åªæœ‰ç¡®å®šäº†è°ˆè®ºå¯¹è±¡æ˜¯æŸç§å…·ä½“çš„Javaå®ç°ç‰ˆæœ¬å’Œæ‰§è¡Œå¼•æ“è¿è¡Œæ¨¡å¼æ—¶ï¼Œè°ˆè§£é‡Šæ‰§è¡Œè¿˜æ˜¯ç¼–è¯‘æ‰§è¡Œæ‰æ¯”è¾ƒç¡®åˆ‡ï¼›</li><li>Javaè¯­è¨€ä¸­ï¼Œjavacç¼–è¯‘å™¨å®Œæˆäº†ç¨‹åºä»£ç ç»è¿‡è¯æ³•åˆ†æã€è¯­æ³•åˆ†æåˆ°æŠ½è±¡è¯­æ³•æ ‘ï¼Œå†éå†è¯­æ³•æ ‘ç”Ÿæˆçº¿æ€§çš„å­—èŠ‚ç æŒ‡ä»¤æµçš„è¿‡ç¨‹ï¼›å› ä¸ºè¿™ä¸€éƒ¨åˆ†åŠ¨ä½œæ˜¯åœ¨Javaè™šæ‹Ÿæœºä¹‹å¤–è¿›è¡Œçš„ï¼Œè€Œè§£é‡Šå™¨åœ¨è™šæ‹Ÿæœºçš„å†…éƒ¨ï¼Œæ‰€ä»¥Javaç¨‹åºçš„ç¼–è¯‘å°±æ˜¯åŠç‹¬ç«‹çš„å®ç°ï¼›</li></ul><h4 id="8-4-2-åŸºäºæ ˆçš„æŒ‡ä»¤é›†ä¸åŸºäºå¯„å­˜å™¨çš„æŒ‡ä»¤é›†"><a href="#8-4-2-åŸºäºæ ˆçš„æŒ‡ä»¤é›†ä¸åŸºäºå¯„å­˜å™¨çš„æŒ‡ä»¤é›†" class="headerlink" title="8.4.2 åŸºäºæ ˆçš„æŒ‡ä»¤é›†ä¸åŸºäºå¯„å­˜å™¨çš„æŒ‡ä»¤é›†"></a>8.4.2 åŸºäºæ ˆçš„æŒ‡ä»¤é›†ä¸åŸºäºå¯„å­˜å™¨çš„æŒ‡ä»¤é›†</h4><ul><li>Javaç¼–è¯‘å™¨è¾“å‡ºçš„æŒ‡ä»¤é›†ï¼ŒåŸºæœ¬ä¸Šæ˜¯ä¸€ç§åŸºäºæ ˆçš„æŒ‡ä»¤é›†æ¶æ„ï¼ŒæŒ‡ä»¤æµä¸­çš„æŒ‡ä»¤å¤§éƒ¨åˆ†æ˜¯é›¶åœ°å€æŒ‡ä»¤ï¼Œå®ƒä»¬ä¾èµ–æ“ä½œæ•°æ ˆè¿›è¡Œå·¥ä½œï¼›</li><li>åŸºäºæ ˆçš„æŒ‡ä»¤é›†ä¸»è¦çš„ä¼˜ç‚¹æ˜¯å¯ç§»æ¤æ€§ï¼Œå¯„å­˜å™¨ç”±ç¡¬ä»¶ç›´æ¥æä¾›ï¼Œç¨‹åºç›´æ¥ä¾èµ–è¿™äº›ç¡¬ä»¶å¯„å­˜å™¨åˆ™ä¸å¯é¿å…åœ°è¦å—åˆ°ç¡¬ä»¶çš„çº¦æŸï¼›ä¸»è¦ç¼ºç‚¹æ˜¯æ‰§è¡Œé€Ÿåº¦ç›¸å¯¹æ¥è¯´ä¼šç¨æ…¢ä¸€ç‚¹ï¼›</li></ul><h4 id="8-4-3-åŸºäºæ ˆçš„è§£é‡Šå™¨æ‰§è¡Œè¿‡ç¨‹"><a href="#8-4-3-åŸºäºæ ˆçš„è§£é‡Šå™¨æ‰§è¡Œè¿‡ç¨‹" class="headerlink" title="8.4.3 åŸºäºæ ˆçš„è§£é‡Šå™¨æ‰§è¡Œè¿‡ç¨‹"></a>8.4.3 åŸºäºæ ˆçš„è§£é‡Šå™¨æ‰§è¡Œè¿‡ç¨‹</h4><p>ä¸€æ®µç®€å•çš„ç®—æ³•ä»£ç </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">public int calc()&#123;</span><br><span class="line">    int a = 100;</span><br><span class="line">    int b = 200;</span><br><span class="line">    int c = 300;</span><br><span class="line">    return (a + b) * c;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸Šè¿°ä»£ç çš„å­—èŠ‚ç è¡¨ç¤º</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">public int calc();</span><br><span class="line">Code:</span><br><span class="line">Stack=2, Locals=4, Args_size=1</span><br><span class="line">0:bipush 100</span><br><span class="line">2:istore_1</span><br><span class="line">3:sipush 200</span><br><span class="line">6:istore_2</span><br><span class="line">7:sipush 300</span><br><span class="line">10:istore_3</span><br><span class="line">11:iload_1</span><br><span class="line">12:iload_2</span><br><span class="line">13:iadd</span><br><span class="line">14:iload_3</span><br><span class="line">15:imul</span><br><span class="line">16:ireturn</span><br></pre></td></tr></table></figure><p>javapæç¤ºè¿™æ®µä»£ç éœ€è¦æ·±åº¦ä¸º2çš„æ“ä½œæ•°æ ˆå’Œ4ä¸ªSlotçš„å±€éƒ¨å˜é‡ç©ºé—´ï¼Œä½œè€…æ ¹æ®è¿™äº›ä¿¡æ¯ç”»äº†ç¤ºæ„å›¾æ¥è¯´æ˜æ‰§è¡Œè¿‡ç¨‹ä¸­çš„å˜åŒ–æƒ…å†µï¼š</p><p>æ‰§è¡Œåç§»åœ°å€ä¸º0çš„æŒ‡ä»¤</p><figure class="image-bubble">                <div class="img-lightbox">                    <div class="overlay"></div>                    <img src="https:////upload-images.jianshu.io/upload_images/3709321-ae7f979f896ae750.png" alt="æ‰§è¡Œåç§»åœ°å€ä¸º0çš„æŒ‡ä»¤" title="">                </div>                <div class="image-caption">æ‰§è¡Œåç§»åœ°å€ä¸º0çš„æŒ‡ä»¤</div>            </figure><p>æ‰§è¡Œåç§»åœ°å€ä¸º2çš„æŒ‡ä»¤</p><figure class="image-bubble">                <div class="img-lightbox">                    <div class="overlay"></div>                    <img src="https:////upload-images.jianshu.io/upload_images/3709321-4cc3955b129175a3.png" alt="æ‰§è¡Œåç§»åœ°å€ä¸º2çš„æŒ‡ä»¤" title="">                </div>                <div class="image-caption">æ‰§è¡Œåç§»åœ°å€ä¸º2çš„æŒ‡ä»¤</div>            </figure><p>æ‰§è¡Œåç§»åœ°å€ä¸º11çš„æŒ‡ä»¤</p><figure class="image-bubble">                <div class="img-lightbox">                    <div class="overlay"></div>                    <img src="https:////upload-images.jianshu.io/upload_images/3709321-b640506135b2ccd3.png" alt="æ‰§è¡Œåç§»åœ°å€ä¸º11çš„æŒ‡ä»¤" title="">                </div>                <div class="image-caption">æ‰§è¡Œåç§»åœ°å€ä¸º11çš„æŒ‡ä»¤</div>            </figure><p>æ‰§è¡Œåç§»åœ°å€ä¸º12çš„æŒ‡ä»¤</p><figure class="image-bubble">                <div class="img-lightbox">                    <div class="overlay"></div>                    <img src="https:////upload-images.jianshu.io/upload_images/3709321-ddf83219167aca0f.png" alt="img" title="">                </div>                <div class="image-caption">img</div>            </figure><p>æ‰§è¡Œåç§»åœ°å€ä¸º13çš„æŒ‡ä»¤</p><figure class="image-bubble">                <div class="img-lightbox">                    <div class="overlay"></div>                    <img src="https:////upload-images.jianshu.io/upload_images/3709321-8d58d9d3f21a08e2.png" alt="æ‰§è¡Œåç§»åœ°å€ä¸º13çš„æŒ‡ä»¤" title="">                </div>                <div class="image-caption">æ‰§è¡Œåç§»åœ°å€ä¸º13çš„æŒ‡ä»¤</div>            </figure><p>æ‰§è¡Œåç§»åœ°å€ä¸º14çš„æŒ‡ä»¤</p><figure class="image-bubble">                <div class="img-lightbox">                    <div class="overlay"></div>                    <img src="https:////upload-images.jianshu.io/upload_images/3709321-ede2baf8e9d01bc6.png" alt="æ‰§è¡Œåç§»åœ°å€ä¸º14çš„æŒ‡ä»¤" title="">                </div>                <div class="image-caption">æ‰§è¡Œåç§»åœ°å€ä¸º14çš„æŒ‡ä»¤</div>            </figure><p>æ‰§è¡Œåç§»åœ°å€ä¸º16çš„æŒ‡ä»¤</p><p><img src="https:////upload-images.jianshu.io/upload_images/3709321-3ddc95e842532183.png" alt="æ‰§è¡Œåç§»åœ°å€ä¸º16çš„æŒ‡ä»¤"></p><p>æ³¨ï¼šä¸Šé¢çš„æ‰§è¡Œè¿‡ç¨‹ä»…ä»…æ˜¯ä¸€ç§æ¦‚å¿µæ¨¡å‹ï¼Œè™šæ‹Ÿæœºä¸­è§£æå™¨å’Œå³æ—¶ç¼–è¯‘å™¨ä¼šå¯¹è¾“å…¥çš„å­—èŠ‚ç è¿›è¡Œä¼˜åŒ–ã€‚</p><h3 id="8-5-æœ¬ç« å°ç»“"><a href="#8-5-æœ¬ç« å°ç»“" class="headerlink" title="8.5 æœ¬ç« å°ç»“"></a>8.5 æœ¬ç« å°ç»“</h3><p>æœ¬ç« åˆ†æäº†è™šæ‹Ÿæœºåœ¨æ‰§è¡Œä»£ç æ—¶ï¼Œå¦‚ä½•æ‰¾åˆ°æ­£ç¡®çš„æ–¹æ³•ã€å¦‚ä½•æ‰§è¡Œæ–¹æ³•å†…çš„å­—èŠ‚ç ä»¥åŠæ‰§è¡Œä»£ç æ—¶æ¶‰åŠçš„å†…å­˜ç»“æ„ã€‚è¿™ç¬¬å…­ã€ä¸ƒã€å…«ä¸‰ç« ä¸­ï¼Œæˆ‘ä»¬é’ˆå¯¹Javaç¨‹åºæ˜¯å¦‚ä½•å­˜å‚¨çš„ã€å¦‚ä½•è½½å…¥çš„ä»¥åŠå¦‚ä½•æ‰§è¡Œçš„é—®é¢˜è¿›è¡Œäº†è®²è§£ï¼Œä¸‹ä¸€ç« ä¸€èµ·çœ‹çœ‹è¿™äº›ç†è®ºçŸ¥è¯†åœ¨å…·ä½“å¼€å‘ä¸­çš„ç»å…¸åº”ç”¨ã€‚</p><h2 id="ç¬¬ä¹ç« -ç±»åŠ è½½åŠæ‰§è¡Œå­ç³»ç»Ÿçš„æ¡ˆä¾‹ä¸å®æˆ˜"><a href="#ç¬¬ä¹ç« -ç±»åŠ è½½åŠæ‰§è¡Œå­ç³»ç»Ÿçš„æ¡ˆä¾‹ä¸å®æˆ˜" class="headerlink" title="ç¬¬ä¹ç«  ç±»åŠ è½½åŠæ‰§è¡Œå­ç³»ç»Ÿçš„æ¡ˆä¾‹ä¸å®æˆ˜"></a>ç¬¬ä¹ç«  ç±»åŠ è½½åŠæ‰§è¡Œå­ç³»ç»Ÿçš„æ¡ˆä¾‹ä¸å®æˆ˜</h2><h3 id="9-1-æ¦‚è¿°"><a href="#9-1-æ¦‚è¿°" class="headerlink" title="9.1 æ¦‚è¿°"></a>9.1 æ¦‚è¿°</h3><ul><li>åœ¨Classæ–‡ä»¶æ ¼å¼ä¸æ‰§è¡Œå¼•æ“è¿™éƒ¨åˆ†ä¸­ï¼Œç”¨æˆ·çš„ç¨‹åºèƒ½ç›´æ¥å½±å“çš„å†…å®¹å¹¶ä¸å¤šï¼›</li><li>èƒ½é€šè¿‡ç¨‹åºè¿›è¡Œæ“ä½œçš„ï¼Œä¸»è¦æ˜¯å­—èŠ‚ç ç”Ÿæˆä¸ç±»åŠ è½½å™¨è¿™ä¸¤éƒ¨åˆ†çš„åŠŸèƒ½ï¼Œä½†ä»…ä»…åœ¨å¦‚ä½•å¤„ç†è¿™ä¸¤ç‚¹ä¸Šï¼Œå°±å·²ç»å‡ºç°äº†è®¸å¤šå€¼å¾—æ¬£èµå’Œå€Ÿé‰´çš„æ€è·¯ï¼›</li></ul><h3 id="9-2-æ¡ˆä¾‹åˆ†æ"><a href="#9-2-æ¡ˆä¾‹åˆ†æ" class="headerlink" title="9.2 æ¡ˆä¾‹åˆ†æ"></a>9.2 æ¡ˆä¾‹åˆ†æ</h3><h4 id="9-2-1-Tomcatï¼šæ­£ç»Ÿçš„ç±»åŠ è½½å™¨æ¶æ„"><a href="#9-2-1-Tomcatï¼šæ­£ç»Ÿçš„ç±»åŠ è½½å™¨æ¶æ„" class="headerlink" title="9.2.1 Tomcatï¼šæ­£ç»Ÿçš„ç±»åŠ è½½å™¨æ¶æ„"></a>9.2.1 Tomcatï¼šæ­£ç»Ÿçš„ç±»åŠ è½½å™¨æ¶æ„</h4><p><img src="https:////upload-images.jianshu.io/upload_images/3709321-6a33f07ebfd24e1e.png" alt="TomcatæœåŠ¡å™¨çš„ç±»åŠ è½½æ¶æ„"></p><ul><li>Java WebæœåŠ¡å™¨ï¼šéƒ¨ç½²åœ¨åŒä¸€ä¸ªæœåŠ¡å™¨ä¸Šçš„ä¸¤ä¸ªWebåº”ç”¨ç¨‹åºæ‰€ä½¿ç”¨çš„Javaç±»åº“å¯ä»¥å®ç°ç›¸äº’éš”ç¦»åˆè¦å¯ä»¥äº’ç›¸å…±äº«ï¼›å°½å¯èƒ½ä¿è¯è‡ªèº«çš„å®‰å…¨ä¸å—éƒ¨ç½²çš„Webåº”ç”¨ç¨‹åºå½±å“ï¼›è¦æ”¯æŒJSPç”Ÿæˆç±»çš„çƒ­æ›¿æ¢ï¼›</li><li>ä¸Šå›¾ä¸­ï¼Œç°è‰²èƒŒæ™¯çš„ä¸‰ä¸ªç±»åŠ è½½å™¨æ˜¯JDKé»˜è®¤æä¾›çš„ç±»åŠ è½½å™¨ï¼Œè€ŒCommonClassLoaderã€CatalinaClassLoaderã€SharedClassLoaderå’ŒWebappClassLoaderæ˜¯Tomcatè‡ªå·±å®šä¹‰çš„ç±»åŠ è½½å™¨ï¼Œåˆ†åˆ«åŠ è½½/common/<em>ï¼ˆå¯è¢«Tomcatå’ŒWebåº”ç”¨å…±ç”¨ï¼‰ã€/server/</em>ï¼ˆå¯è¢«Tomcatä½¿ç”¨ï¼‰ã€/shared/<em>ï¼ˆå¯è¢«Webåº”ç”¨ä½¿ç”¨ï¼‰å’Œ/WebApp/WEB-INF/</em>ï¼ˆå¯è¢«å½“å‰Webåº”ç”¨ä½¿ç”¨ï¼‰ä¸­çš„Javaç±»åº“ï¼ŒTomcat 6.xæŠŠå‰é¢ä¸‰ä¸ªç›®å½•é»˜è®¤åˆå¹¶åˆ°ä¸€èµ·å˜æˆä¸€ä¸ª/libç›®å½•ï¼ˆä½œç”¨åŒåŸå…ˆçš„commonç›®å½•ï¼‰ï¼›</li></ul><h4 id="9-2-2-OSGIï¼šçµæ´»çš„ç±»åŠ è½½æ¶æ„"><a href="#9-2-2-OSGIï¼šçµæ´»çš„ç±»åŠ è½½æ¶æ„" class="headerlink" title="9.2.2 OSGIï¼šçµæ´»çš„ç±»åŠ è½½æ¶æ„"></a>9.2.2 OSGIï¼šçµæ´»çš„ç±»åŠ è½½æ¶æ„</h4><p><img src="https:////upload-images.jianshu.io/upload_images/3709321-5c270d4c6018cee3.png" alt="OSGIçš„ç±»åŠ è½½æ¶æ„"></p><ul><li>OSGIçš„æ¯ä¸ªæ¨¡å—ç§°ä¸ºBundleï¼Œå¯ä»¥å£°æ˜å®ƒæ‰€ä¾èµ–çš„Java Packageï¼ˆé€šè¿‡Import-Packageæè¿°ï¼‰ï¼Œä¹Ÿå¯ä»¥å£°æ˜å®ƒå…è®¸å¯¼å‡ºå‘å¸ƒçš„Java Packageï¼ˆé€šè¿‡Export-Packageæè¿°ï¼‰ï¼›</li><li>é™¤äº†æ›´ç²¾ç¡®çš„æ¨¡å—åˆ’åˆ†å’Œå¯è§æ€§æ§åˆ¶å¤–ï¼Œå¼•å…¥OSGIçš„å¦å¤–ä¸€ä¸ªé‡è¦ç†ç”±æ˜¯åŸºäºOSGIçš„ç¨‹åºå¾ˆå¯èƒ½å¯ä»¥å®ç°æ¨¡å—çº§çš„çƒ­æ’æ‹”åŠŸèƒ½ï¼›</li><li>OSGIçš„ç±»åŠ è½½å™¨ä¹‹é—´åªæœ‰è§„åˆ™ï¼Œæ²¡æœ‰å›ºå®šçš„å§”æ´¾å…³ç³»ï¼›åŠ è½½å™¨ä¹‹é—´çš„å…³ç³»æ›´ä¸ºå¤æ‚ã€è¿è¡Œæ—¶æ‰èƒ½ç¡®å®šçš„ç½‘çŠ¶ç»“æ„ï¼Œæä¾›çµæ´»æ€§çš„åŒæ—¶ï¼Œå¯èƒ½ä¼šäº§ç”Ÿè®¸å¤šçš„éšæ‚£ï¼›</li></ul><h4 id="9-2-3-å­—èŠ‚ç ç”ŸæˆæŠ€æœ¯ä¸åŠ¨æ€ä»£ç†çš„å®ç°"><a href="#9-2-3-å­—èŠ‚ç ç”ŸæˆæŠ€æœ¯ä¸åŠ¨æ€ä»£ç†çš„å®ç°" class="headerlink" title="9.2.3 å­—èŠ‚ç ç”ŸæˆæŠ€æœ¯ä¸åŠ¨æ€ä»£ç†çš„å®ç°"></a>9.2.3 å­—èŠ‚ç ç”ŸæˆæŠ€æœ¯ä¸åŠ¨æ€ä»£ç†çš„å®ç°</h4><ul><li>åœ¨Javaé‡Œé¢é™¤äº†javacå’Œå­—èŠ‚ç ç±»åº“å¤–ï¼Œä½¿ç”¨å­—èŠ‚ç ç”Ÿæˆçš„ä¾‹å­è¿˜æœ‰WebæœåŠ¡å™¨ä¸­çš„JSPç¼–è¯‘å™¨ã€ç¼–è¯‘æ—¶æ¤å…¥çš„AOPæ¡†æ¶å’Œå¾ˆå¸¸ç”¨çš„åŠ¨æ€ä»£ç†æŠ€æœ¯ç­‰ï¼Œè¿™é‡Œé€‰æ‹©å…¶ä¸­ç›¸å¯¹ç®€å•çš„åŠ¨æ€ä»£ç†æ¥çœ‹çœ‹å­—èŠ‚ç ç”ŸæˆæŠ€æœ¯æ˜¯å¦‚ä½•å½±å“ç¨‹åºè¿ä½œçš„ï¼›</li><li>åŠ¨æ€ä»£ç†çš„ä¼˜åŠ¿åœ¨äºå®ç°äº†åœ¨åŸå§‹ç±»å’Œæ¥å£è¿˜æœªçŸ¥çš„æ—¶å€™å°±ç¡®å®šç±»çš„ä»£ç†è¡Œä¸ºï¼Œå¯ä»¥å¾ˆçµæ´»åœ°é‡ç”¨äºä¸åŒçš„åº”ç”¨åœºæ™¯ä¹‹ä¸­ï¼›</li><li>ä»¥ä¸‹çš„ä¾‹å­ä¸­ç”Ÿæˆçš„ä»£ç†ç±»â€œ$Proxy0.classâ€æ–‡ä»¶å¯ä»¥çœ‹åˆ°ä»£ç†ä¸ºä¼ å…¥æ¥å£çš„æ¯ä¸€ä¸ªæ–¹æ³•ç»Ÿä¸€è°ƒç”¨äº†InvocationHandlerå¯¹è±¡çš„invokeæ–¹æ³•ï¼›å…¶ç”Ÿæˆä»£ç†ç±»çš„å­—èŠ‚ç å¤§è‡´è¿‡ç¨‹å…¶å®å°±æ˜¯æ ¹æ®Classæ–‡ä»¶çš„æ ¼å¼è§„èŒƒå»æ‹¼æ¥å­—èŠ‚ç ï¼›</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">public class DynamicProxyTest &#123;</span><br><span class="line"></span><br><span class="line">    interface IHello &#123;</span><br><span class="line">        void sayHello();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    static class Hello implements IHello &#123;</span><br><span class="line">        @Override</span><br><span class="line">        public void sayHello() &#123;</span><br><span class="line">            System.out.println(&quot;Hello world&quot;);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    static class DynamicProxy implements InvocationHandler &#123;</span><br><span class="line">        Object originalObj;</span><br><span class="line"></span><br><span class="line">        Object bind(Object originalObj) &#123;</span><br><span class="line">            this.originalObj = originalObj;</span><br><span class="line">            return Proxy.newProxyInstance(originalObj.getClass().getClassLoader(), originalObj.getClass().getInterfaces(), this);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        @Override</span><br><span class="line">        public Object invoke(Object proxy, Method method, Object[] args) throws Throwable &#123;</span><br><span class="line">            System.out.println(&quot;Welcome&quot;);</span><br><span class="line">            return method.invoke(originalObj, args);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public static void main(String[] args) &#123;</span><br><span class="line">        // add this property to generate proxy class file</span><br><span class="line">        System.getProperties().put(&quot;sun.misc.ProxyGenerator.saveGeneratedFiles&quot;, &quot;true&quot;);</span><br><span class="line"></span><br><span class="line">        IHello hello = (IHello) new DynamicProxy().bind(new Hello());</span><br><span class="line">        hello.sayHello();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="9-2-4-Retrotranslatorï¼šè·¨è¶ŠJDKç‰ˆæœ¬"><a href="#9-2-4-Retrotranslatorï¼šè·¨è¶ŠJDKç‰ˆæœ¬" class="headerlink" title="9.2.4 Retrotranslatorï¼šè·¨è¶ŠJDKç‰ˆæœ¬"></a>9.2.4 Retrotranslatorï¼šè·¨è¶ŠJDKç‰ˆæœ¬</h4><ul><li>Retrotranslatorçš„ä½œç”¨æ˜¯å°†JDK 1.5ç¼–è¯‘å‡ºæ¥çš„Classæ–‡ä»¶è½¬å˜ä¸ºå¯ä»¥åœ¨JDK 1.4æˆ–JDK 1.3éƒ¨ç½²çš„ç‰ˆæœ¬ï¼Œå®ƒå¯ä»¥å¾ˆå¥½åœ°æ”¯æŒè‡ªåŠ¨è£…ç®±ã€æ³›å‹ã€åŠ¨æ€æ³¨è§£ã€æšä¸¾ã€å˜é•¿å‚æ•°ã€éå†å¾ªç¯ã€é™æ€å¯¼å…¥è¿™äº›è¯­æ³•ç‰¹æ€§ï¼Œç”šè‡³è¿˜å¯ä»¥æ”¯æŒJDK 1.5ä¸­æ–°å¢çš„é›†åˆæ”¹è¿›ã€å¹¶å‘åŒ…ä»¥åŠå¯¹æ³›å‹ã€æ³¨è§£ç­‰çš„åå°„æ“ä½œï¼›</li><li>JDKå‡çº§é€šå¸¸åŒ…æ‹¬å››ç§ç±»å‹ï¼šç¼–è¯‘å™¨å±‚é¢çš„åšçš„æ”¹è¿›ã€Java APIçš„ä»£ç å¢å¼ºã€éœ€è¦å†å­—èŠ‚ç ä¸­è¿›è¡Œæ”¯æŒçš„æ´»åŠ¨ä»¥åŠè™šæ‹Ÿæœºå†…éƒ¨çš„æ”¹è¿›ï¼ŒRetrotranslatoråªèƒ½æ¨¡æ‹Ÿå‰ä¸¤ç±»ï¼Œç¬¬äºŒç±»é€šè¿‡ç‹¬ç«‹ç±»åº“å®ç°ï¼Œç¬¬ä¸€ç±»åˆ™é€šè¿‡ASMæ¡†æ¶ç›´æ¥å¯¹å­—èŠ‚ç è¿›è¡Œå¤„ç†ï¼›</li></ul><h3 id="9-3-å®æˆ˜ï¼šè‡ªå·±åŠ¨æ‰‹å®ç°è¿œç¨‹æ‰§è¡ŒåŠŸèƒ½"><a href="#9-3-å®æˆ˜ï¼šè‡ªå·±åŠ¨æ‰‹å®ç°è¿œç¨‹æ‰§è¡ŒåŠŸèƒ½" class="headerlink" title="9.3 å®æˆ˜ï¼šè‡ªå·±åŠ¨æ‰‹å®ç°è¿œç¨‹æ‰§è¡ŒåŠŸèƒ½"></a>9.3 å®æˆ˜ï¼šè‡ªå·±åŠ¨æ‰‹å®ç°è¿œç¨‹æ‰§è¡ŒåŠŸèƒ½</h3><ul><li>ç›®æ ‡ï¼šä¸ä¾èµ–JDKç‰ˆæœ¬ã€ä¸æ”¹å˜åŸæœ‰æœåŠ¡ç«¯ç¨‹åºçš„éƒ¨ç½²ï¼Œä¸ä¾èµ–ä»»ä½•ç¬¬ä¸‰æ–¹ç±»åº“ã€ä¸ä¾µå…¥åŸæœ‰ç¨‹åºã€ä¸´æ—¶ä»£ç çš„æ‰§è¡Œç»“æœèƒ½è¿”å›åˆ°å®¢æˆ·ç«¯ï¼›</li><li>æ€è·¯ï¼šå¦‚ä½•ç¼–è¯‘æäº¤åˆ°æœåŠ¡å™¨çš„Javaä»£ç ï¼ˆå®¢æˆ·ç«¯ç¼–è¯‘å¥½ä¸Šä¼ Classæ–‡ä»¶è€Œä¸æ˜¯Javaä»£ç ï¼‰ã€å¦‚ä½•æ‰§è¡Œç¼–è¯‘ä¹‹åçš„Javaä»£ç ï¼ˆè¦èƒ½è®¿é—®å…¶ä»–ç±»åº“ï¼Œè¦èƒ½å¸è½½ï¼‰ã€å¦‚ä½•æ”¶é›†Javaä»£ç çš„æ‰§è¡Œç»“æœï¼ˆåœ¨æ‰§è¡Œçš„ç±»ä¸­æŠŠSystem.outçš„ç¬¦å·å¼•ç”¨æ›¿æ¢ä¸ºæˆ‘ä»¬å‡†å¤‡çš„PrintStreamçš„ç¬¦å·å¼•ç”¨ï¼‰ï¼›</li><li>å…·ä½“å®ç°ï¼šHotSwapClassLoaderç”¨äºå®ç°åŒä¸€ä¸ªç±»çš„ä»£ç å¯ä»¥è¢«å¤šæ¬¡åŠ è½½ï¼Œé€šè¿‡å…¬å¼€çˆ¶ç±»ClassLoaderçš„defineClasså®ç°ï¼›HackSystemæ˜¯ä¸ºäº†æ›¿æ¢java.lang.Systemï¼Œå®ƒç›´æ¥ä¿®æ”¹Classæ–‡ä»¶æ ¼å¼çš„byte[]æ•°ç»„ä¸­çš„å¸¸é‡æ± éƒ¨åˆ†ï¼Œå°†å¸¸é‡æ± ä¸­æŒ‡å®šå†…å®¹çš„CONSTANT_Utf8_infoå¸¸é‡æ›¿æ¢ä¸ºæ–°çš„å­—ç¬¦ä¸²ï¼›ClassModifieræ¶‰åŠå¯¹byte[]æ•°ç»„æ“ä½œçš„éƒ¨åˆ†ï¼Œä¸»è¦æ˜¯å°†byte[]ä¸intå’ŒStringäº’ç›¸è½¬æ¢ï¼Œä»¥åŠæŠŠå¯¹byte[]æ•°æ®çš„æ›¿æ¢æ“ä½œå°è£…åœ¨ByteUtilsç±»ä¸­ï¼›ç»è¿‡ClassModifierå¤„ç†è¿‡çš„byte[]æ•°ç»„æ‰ä¼šä¼ ç»™HotSwapClassLoader.loadByteæ–¹æ³•è¿›è¡Œç±»åŠ è½½ï¼›è€ŒJavaClassExecutoræ˜¯æä¾›ç»™å¤–éƒ¨è°ƒç”¨çš„å…¥å£ï¼›</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">public class JavaClassExecutor &#123;</span><br><span class="line"></span><br><span class="line">    public static String execute(byte[] classByte) &#123;</span><br><span class="line">        HackSystem.clearBuffer();</span><br><span class="line">        ClassModifier cm = new ClassModifier(classByte);</span><br><span class="line">        byte[] modifiedBytes = cm.modifyUTF8Constant(&quot;java/lang/System&quot;, &quot;org/fenixsoft/classloading/execute/HackSystem&quot;);</span><br><span class="line">        HotSwapClassLoader hotSwapClassLoader = new HotSwapClassLoader();</span><br><span class="line">        Class clazz = hotSwapClassLoader.loadByte(modifiedBytes);</span><br><span class="line">        try &#123;</span><br><span class="line">            Method method = clazz.getMethod(&quot;main&quot;, new Class[]&#123;String[].class&#125;);</span><br><span class="line">            method.invoke(null, new String[]&#123;null&#125;);</span><br><span class="line">        &#125; catch (Throwable t) &#123;</span><br><span class="line">            t.printStackTrace(HackSystem.out);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        return HackSystem.getBufferString();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç”¨äºæµ‹è¯•çš„JSP</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@page import=&quot;java.lang.*&quot; %&gt;</span><br><span class="line">&lt;%@page import=&quot;java.io.*&quot; %&gt;</span><br><span class="line">&lt;%@page import=&quot;org.fenixsoft.classloading.execute.*&quot; %&gt;</span><br><span class="line"></span><br><span class="line">&lt;%</span><br><span class="line">InputStream is = new FileInputStream(&quot;c:/TestClass.class&quot;);</span><br><span class="line">byte[] b = new byte[is.available()];</span><br><span class="line">is.read(b);</span><br><span class="line">is.close();</span><br><span class="line"></span><br><span class="line">out.println(JavaClassExecutor.execute(b));</span><br><span class="line"></span><br><span class="line">%&gt;</span><br></pre></td></tr></table></figure><h3 id="9-4-æœ¬ç« å°ç»“"><a href="#9-4-æœ¬ç« å°ç»“" class="headerlink" title="9.4 æœ¬ç« å°ç»“"></a>9.4 æœ¬ç« å°ç»“</h3><p>åªæœ‰äº†è§£è™šæ‹Ÿæœºå¦‚ä½•æ‰§è¡Œç¨‹åºï¼Œæ‰èƒ½æ›´å¥½åœ°ç†è§£æ€æ ·å†™å‡ºä¼˜ç§€çš„ä»£ç ã€‚</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;ç¬¬ä¸ƒç« -è™šæ‹Ÿæœºç±»åŠ è½½æœºåˆ¶&quot;&gt;&lt;a href=&quot;#ç¬¬ä¸ƒç« -è™šæ‹Ÿæœºç±»åŠ è½½æœºåˆ¶&quot; class=&quot;headerlink&quot; title=&quot;ç¬¬ä¸ƒç«  è™šæ‹Ÿæœºç±»åŠ è½½æœºåˆ¶&quot;&gt;&lt;/a&gt;ç¬¬ä¸ƒç«  è™šæ‹Ÿæœºç±»åŠ è½½æœºåˆ¶&lt;/h2&gt;&lt;h3 id=&quot;7-1-æ¦‚è¿°&quot;&gt;&lt;a href=&quot;#7-1-æ¦‚è¿°&quot;
      
    
    </summary>
    
      <category term="æ•´ç†" scheme="https://meandni.com/categories/%E6%95%B4%E7%90%86/"/>
    
    
      <category term="è¯»ä¹¦" scheme="https://meandni.com/tags/%E8%AF%BB%E4%B9%A6/"/>
    
      <category term="jvm" scheme="https://meandni.com/tags/jvm/"/>
    
  </entry>
  
  <entry>
    <title>ã€Šæ·±å…¥ç†è§£Javaè™šæ‹Ÿæœºã€‹ç¬”è®°4â€”â€”ç±»æ–‡ä»¶ç»“æ„</title>
    <link href="https://meandni.com/2019/01/14/jvm_note4/"/>
    <id>https://meandni.com/2019/01/14/jvm_note4/</id>
    <published>2019-01-14T07:24:44.000Z</published>
    <updated>2019-02-22T04:08:15.891Z</updated>
    
    <content type="html"><![CDATA[<p>ä»£ç ç¼–è¯‘çš„ç»“æœä»æœ¬åœ°æœºå™¨ç è½¬å˜ä¸ºå­—èŠ‚ç ï¼Œæ˜¯å­˜å‚¨æ ¼å¼å‘å±•çš„ä¸€å°æ­¥ï¼Œå´æ˜¯ç¼–ç¨‹è¯­è¨€å‘å±•çš„ä¸€å¤§æ­¥ã€‚</p><p>ç”±äºæœ€è¿‘åå¹´å†…è™šæ‹Ÿæœºä»¥åŠå¤§é‡å»ºç«‹åœ¨è™šæ‹Ÿæœºä¹‹ä¸Šçš„ç¨‹åºè¯­è¨€å¦‚é›¨åæ˜¥ç¬‹èˆ¬å‡ºç°å¹¶è“¬å‹ƒå‘å±•ï¼Œå°†æˆ‘ä»¬ç¼–å†™çš„ç¨‹åºç¼–è¯‘æˆäºŒè¿›åˆ¶æœ¬åœ°æœºå™¨ç ï¼ˆNative Codeï¼‰å·²ä¸å†æ˜¯å”¯ä¸€çš„é€‰æ‹©ï¼Œè¶Šæ¥è¶Šå¤šçš„ç¨‹åºè¯­è¨€é€‰æ‹©äº†æ“ä½œç³»ç»Ÿå’Œæœºå™¨æŒ‡ä»¤é›†æ— å…³çš„ã€å¹³å°ä¸­ç«‹çš„æ ¼å¼ä½œä¸ºç¨‹åºç¼–è¯‘åçš„å­˜å‚¨æ ¼å¼ã€‚</p><h1 id="æ— å…³æ€§çš„åŸºçŸ³"><a href="#æ— å…³æ€§çš„åŸºçŸ³" class="headerlink" title="æ— å…³æ€§çš„åŸºçŸ³"></a>æ— å…³æ€§çš„åŸºçŸ³</h1><ul><li>Javaåˆšè¯ç”Ÿçš„å®£ä¼ å£å·ï¼šä¸€æ¬¡ç¼–å†™ï¼Œåˆ°å¤„è¿è¡Œï¼ˆWrite Once, Run Anywhereï¼‰ã€‚å…¶æœ€ç»ˆå®ç°åœ¨æ“ä½œç³»ç»Ÿçš„åº”ç”¨å±‚ï¼šSunå…¬å¸ä»¥åŠå…¶ä»–è™šæ‹Ÿæœºæä¾›å•†å‘å¸ƒäº†è®¸å¤šå¯ä»¥è¿è¡Œåœ¨å„ç§ä¸åŒå¹³å°çš„è™šæ‹Ÿæœºï¼Œè¿™äº›è™šæ‹Ÿæœºéƒ½å¯ä»¥è½½å…¥å’Œæ‰§è¡ŒåŒä¸€ç§å¹³å°æ— å…³çš„å­—èŠ‚ç ã€‚</li><li>å­—èŠ‚ç ï¼ˆByteCodeï¼‰æ˜¯æ„æˆå¹³å°æ— å…³çš„åŸºçŸ³ï¼›</li><li>å¦å¤–è™šæ‹Ÿæœºçš„è¯­è¨€æ— å…³æ€§ä¹Ÿè¶Šæ¥è¶Šè¢«å¼€å‘è€…æ‰€é‡è§†ï¼ŒJVMè®¾è®¡è€…åœ¨æœ€åˆå°±è€ƒè™‘è¿‡å®ç°è®©å…¶ä»–è¯­è¨€è¿è¡Œåœ¨Javaè™šæ‹Ÿæœºä¹‹ä¸Šçš„å¯èƒ½æ€§ï¼Œå¦‚ä»Šå·²å‘å±•å‡ºä¸€å¤§æ‰¹åœ¨JVMä¸Šè¿è¡Œçš„è¯­è¨€ï¼Œæ¯”å¦‚Clojureã€Groovyã€JRubyã€Jythonã€Scalaï¼›</li><li>å®ç°è¯­è¨€æ— å…³æ€§çš„åŸºç¡€ä»æ˜¯è™šæ‹Ÿæœºå’Œå­—èŠ‚ç å­˜å‚¨æ ¼å¼ï¼ŒJavaè™šæ‹Ÿæœºä¸å’ŒåŒ…æ‹¬Javaåœ¨å†…çš„ä»»ä½•è¯­è¨€ç»‘å®šï¼Œå®ƒåªä¸Classæ–‡ä»¶è¿™ç§ç‰¹å®šçš„äºŒè¿›åˆ¶æ–‡ä»¶æ ¼å¼æ‰€å…³è”ï¼Œè¿™ä½¿å¾—ä»»ä½•è¯­è¨€çš„éƒ½å¯ä»¥ä½¿ç”¨ç‰¹å®šçš„ç¼–è¯‘å™¨å°†å…¶æºç ç¼–è¯‘æˆClassæ–‡ä»¶ï¼Œä»è€Œåœ¨è™šæ‹Ÿæœºä¸Šè¿è¡Œã€‚</li></ul><p><div align="center"> <img src="http://pic.yupoo.com/meandni/b630efe6/16c836f2.png" width=""> </div><br></p><p>Javaè™šæ‹Ÿæœºæä¾›çš„è¯­è¨€æ— å…³æ€§</p><h1 id="Classç±»æ–‡ä»¶çš„ç»“æ„"><a href="#Classç±»æ–‡ä»¶çš„ç»“æ„" class="headerlink" title="Classç±»æ–‡ä»¶çš„ç»“æ„"></a>Classç±»æ–‡ä»¶çš„ç»“æ„</h1><ul><li>Classæ–‡ä»¶æ˜¯ä¸€ç»„ä»¥8ä¸ªå­—èŠ‚ä¸ºåŸºç¡€å•ä½çš„äºŒè¿›åˆ¶æµï¼ˆå¯èƒ½æ˜¯ç£ç›˜æ–‡ä»¶ï¼Œä¹Ÿå¯èƒ½æ˜¯ç±»åŠ è½½å™¨ç›´æ¥ç”Ÿæˆçš„ï¼‰ï¼Œå„ä¸ªæ•°æ®é¡¹ç›®ä¸¥æ ¼æŒ‰ç…§é¡ºåºç´§å‡‘åœ°æ’åˆ—ï¼Œä¸­é—´æ²¡æœ‰ä»»ä½•åˆ†éš”ç¬¦ï¼›</li><li>Classæ–‡ä»¶æ ¼å¼é‡‡ç”¨ä¸€ç§ç±»ä¼¼äºCè¯­è¨€ç»“æ„ä½“çš„ä¼ªç»“æ„æ¥å­˜å‚¨æ•°æ®ï¼Œå…¶ä¸­åªæœ‰ä¸¤ç§æ•°æ®ç±»å‹ï¼šæ— ç¬¦å·æ•°å’Œè¡¨ï¼›</li><li>æ— ç¬¦å·æ•°å±äºåŸºæœ¬çš„æ•°æ®ç±»å‹ï¼Œä»¥u1ã€u2ã€u4å’Œu8æ¥åˆ†åˆ«ä»£è¡¨1ä¸ªå­—èŠ‚ã€2ä¸ªå­—èŠ‚ã€4ä¸ªå­—èŠ‚å’Œ8ä¸ªå­—èŠ‚çš„æ— ç¬¦å·æ•°ï¼Œå¯ä»¥ç”¨æ¥æè¿°æ•°å­—ã€ç´¢å¼•å¼•ç”¨ã€æ•°é‡å€¼æˆ–è€…æŒ‰ç…§UTF-8ç¼–ç æ„æˆå­—ç¬¦ä¸²å€¼ï¼›</li><li>è¡¨æ˜¯ç”±å¤šä¸ªæ— ç¬¦å·æ•°è·å–å…¶ä»–è¡¨ä½œä¸ºæ•°æ®é¡¹æ„æˆçš„å¤åˆæ•°æ®ç±»å‹ï¼Œä¹ æƒ¯ä»¥â€œ_infoâ€ç»“å°¾ï¼›</li><li>æ— è®ºæ˜¯æ— ç¬¦å·æ•°è¿˜æ˜¯è¡¨ï¼Œå½“éœ€è¦æè¿°åŒä¸€ä¸ªç±»å‹ä½†æ•°é‡ä¸å®šçš„å¤šä¸ªæ•°æ®æ—¶ï¼Œç»å¸¸ä¼šä½¿ç”¨ä¸€ä¸ªå‰ç½®çš„å®¹é‡è®¡æ•°å™¨åŠ è‹¥å¹²ä¸ªè¿ç»­çš„æ•°æ®é¡¹çš„å½¢å¼ï¼Œè¿™æ—¶ç§°è¿™ä¸€ç³»åˆ—è¿ç»­çš„æŸä¸€ç±»å‹çš„æ•°æ®æœªæŸä¸€ç±»å‹çš„é›†åˆã€‚</li></ul><p><div align="center"> <img src="http://pic.yupoo.com/meandni/0afa8e94/1aaadf08.png" width=""> </div><br></p><p>ä¸‹é¢æˆ‘ä»¥è‡ªå·±æœ¬æœºå†™çš„ä¸€ä¸ªç®€å•çš„Javaæ–‡ä»¶æ¥å­¦ä¹ å…¶ä¸­å„ä¸ªéƒ¨åˆ†çš„å«ä¹‰ï¼š</p><p><div align="center"> <img src="http://pic.yupoo.com/meandni/65326165/8b3cad31.png" width=""> </div><br>ä½¿ç”¨javacç¼–è¯‘æˆTestClass.classæ–‡ä»¶ï¼Œä½¿ç”¨16è¿›åˆ¶æ‰“å¼€ï¼š</p><p><div align="center"> <img src="http://pic.yupoo.com/meandni/4b862df8/2676ca8a.png" width=""> </div><br></p><p>ä½¿ç”¨javapå‘½ä»¤è¾“å‡ºClassæ–‡ä»¶ä¿¡æ¯ï¼š</p><p><div align="center"> <img src="http://pic.yupoo.com/meandni/05bb5ca8/4bcf1947.png" width=""> </div><br></p><h4 id="é­”æ•°å’Œç‰ˆæœ¬ï¼ˆmagicã€versionï¼‰"><a href="#é­”æ•°å’Œç‰ˆæœ¬ï¼ˆmagicã€versionï¼‰" class="headerlink" title="é­”æ•°å’Œç‰ˆæœ¬ï¼ˆmagicã€versionï¼‰"></a>é­”æ•°å’Œç‰ˆæœ¬ï¼ˆmagicã€versionï¼‰</h4><ul><li>Classæ–‡ä»¶çš„å¤´4ä¸ªå­—èŠ‚ï¼Œå”¯ä¸€ä½œç”¨æ˜¯ç¡®å®šæ–‡ä»¶æ˜¯å¦ä¸ºä¸€ä¸ªå¯è¢«è™šæ‹Ÿæœºæ¥å—çš„Classæ–‡ä»¶ï¼Œå›ºå®šä¸ºâ€œ0xCAFEBABEâ€ã€‚</li><li>ç¬¬5å’Œç¬¬6ä¸ªå­—èŠ‚æ˜¯æ¬¡ç‰ˆæœ¬å·ï¼Œç¬¬7å’Œç¬¬8ä¸ªå­—èŠ‚æ˜¯ä¸»ç‰ˆæœ¬å·ï¼ˆ0x0034ä¸º52ï¼Œå¯¹åº”JDKç‰ˆæœ¬1.8ï¼‰ï¼›èƒ½å‘ä¸‹å…¼å®¹ä¹‹å‰çš„ç‰ˆæœ¬ï¼Œæ— æ³•è¿è¡Œåç»­çš„ç‰ˆæœ¬ï¼›</li></ul><h4 id="å¸¸é‡æ± ï¼ˆconstant-poolï¼‰"><a href="#å¸¸é‡æ± ï¼ˆconstant-poolï¼‰" class="headerlink" title="å¸¸é‡æ± ï¼ˆconstant_poolï¼‰"></a>å¸¸é‡æ± ï¼ˆconstant_poolï¼‰</h4><ul><li>å¸¸é‡æ± å¯ä»¥ç†è§£ä¸ºClassæ–‡ä»¶ä¹‹ä¸­çš„èµ„æºä»“åº“ï¼Œæ˜¯Classæ–‡ä»¶ç»“æ„ä¸­ä¸å…¶ä»–é¡¹ç›®å…³è”æœ€å¤šçš„æ•°æ®ç±»å‹ï¼Œä¹Ÿæ˜¯å ç”¨Classæ–‡ä»¶ç©ºé—´æœ€å¤§çš„æ•°æ®é¡¹ä¹‹ä¸€ï¼›</li><li>ç”±äºå¸¸é‡æ± ä¸­çš„å¸¸é‡æ•°é‡ä¸å›ºå®šï¼Œå› æ­¤éœ€è¦åœ¨å¸¸é‡æ± å‰æ”¾ç½®ä¸€é¡¹u2ç±»å‹çš„æ•°æ®æ¥è¡¨ç¤ºå®¹é‡ï¼Œè¯¥å€¼æ˜¯ä»1å¼€å§‹çš„ï¼Œä¸Šå›¾çš„0x0013ä¸ºåè¿›åˆ¶çš„19ï¼Œä»£è¡¨å¸¸é‡æ± ä¸­æœ‰18é¡¹å¸¸é‡ï¼Œç´¢å¼•å€¼èŒƒå›´ä¸º1~18ï¼›</li><li>å¸¸é‡æ± ä¸»è¦å­˜æ”¾ä¸¤å¤§ç±»å¸¸é‡ï¼šå­—é¢é‡ï¼ˆLiteralï¼Œæ¯”è¾ƒæ¥è¿‘Javaçš„å¸¸é‡æ¦‚å¿µï¼Œæ¯”å¦‚æ–‡æœ¬å­—ç¬¦ä¸²å’Œfinalå¸¸é‡ç­‰ï¼‰å’Œç¬¦å·å¼•ç”¨ï¼ˆSymbolic Referencesï¼Œä¸»è¦åŒ…æ‹¬ç±»å’Œæ¥å£çš„å…¨é™å®šåã€å­—æ®µçš„åç§°å’Œæè¿°ç¬¦ã€æ–¹æ³•çš„åç§°å’Œæè¿°ç¬¦ï¼‰ï¼›</li><li>Javaä»£ç åœ¨javacç¼–è¯‘æ—¶ä¸ä¼šæœ‰â€œè¿æ¥â€è¿™ä¸€æ­¥éª¤ï¼Œè€Œæ˜¯åœ¨è™šæ‹ŸæœºåŠ è½½Classæ–‡ä»¶çš„æ—¶å€™è¿›è¡ŒåŠ¨æ€è¿æ¥ï¼›æ‰€ä»¥åœ¨Classæ–‡ä»¶ä¸ä¼šä¿å­˜å„ä¸ªæ–¹æ³•ã€å­—æ®µå’Œæœ€ç»ˆå†…å­˜å¸ƒå±€ä¿¡æ¯ï¼›å½“è™šæ‹Ÿæœºè¿è¡Œæ—¶éœ€è¦ä»å¸¸é‡æ± è·å–å¯¹åº”çš„ç¬¦å·å¼•ç”¨ï¼Œå†åœ¨ç±»åˆ›å»ºæ—¶æˆ–è¿è¡Œæ—¶è§£æã€ç¿»è¯‘åˆ°å…·ä½“çš„å†…å­˜åœ°å€ä¸­ï¼›</li><li>JDK 1.7ä¸­å¸¸é‡æ± å…±æœ‰14ç§ä¸åŒçš„è¡¨ç»“æ„æ•°æ®ï¼Œè¿™äº›è¡¨ç»“æ„å¼€å§‹çš„ç¬¬ä¸€ä½æ˜¯ä¸€ä¸ªu1ç±»å‹çš„æ ‡å¿—ä½ï¼Œä»£è¡¨å½“å‰å¸¸é‡çš„ç±»å‹ï¼Œå…·ä½“å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</li></ul><p><div align="center"> <img src="http://pic.yupoo.com/meandni/81488f7b/0de93189.png" width=""> </div><br></p><ul><li>ä¹‹æ‰€ä»¥è¯´å¸¸é‡æ± æ˜¯æœ€ç¹ççš„æ•°æ®å°±æ˜¯å› ä¸ºè¿™14ç§å¸¸é‡ç±»å‹éƒ½æœ‰è‡ªå·±çš„ç»“ç»“æ„ã€‚å¯ä»¥ç»“åˆä¸‹å›¾ä¸­å„ä¸ªè¡¨ç»“æ„çš„è¯´æ˜å’Œä¹‹å‰ä½¿ç”¨javapè§£æçš„æ–‡ä»¶å†…å®¹ä¸€èµ·çœ‹ã€‚</li></ul><p><div align="center"> <img src="http://pic.yupoo.com/meandni/ecd4f473/607e8836.png" width=""> </div><br></p><p><div align="center"> <img src="http://pic.yupoo.com/meandni/d7e0e573/94dbf52c.png" width=""> </div><br></p><ul><li>ç¬¬1é¡¹ï¼š0x0Aï¼ˆ15æ ‡å¿—ä¸ºæ–¹æ³•å¥æŸ„ï¼‰ï¼Œ0x0004ï¼ˆæŒ‡å‘ç¬¬4é¡¹çš„ç±»æè¿°ç¬¦ï¼‰ï¼Œ0x000Fï¼ˆæŒ‡å‘ç¬¬15é¡¹çš„åç§°åŠç±»å‹æè¿°ç¬¦ï¼‰ï¼›</li><li>ç¬¬2é¡¹ï¼š0x09ï¼ˆ9æ ‡å¿—ä¸ºå­—æ®µç¬¦å·å¼•ç”¨ï¼‰ï¼Œ0x0003ï¼ˆæŒ‡å‘ç¬¬3é¡¹ç±»æè¿°ç¬¦ï¼‰ï¼Œ0x0010ï¼ˆæŒ‡å‘ç¬¬16é¡¹çš„åç§°åŠç±»å‹æè¿°ç¬¦ï¼‰ï¼›</li><li>ç¬¬3é¡¹ï¼š0x07ï¼ˆ7æ ‡å¿—ä¸ºç±»ç¬¦å·å¼•ç”¨ï¼‰ï¼Œ0x0011ï¼ˆæŒ‡å‘ç¬¬17é¡¹å…¨é™å®šåå¸¸é‡é¡¹ï¼‰ï¼›</li><li>ç¬¬4é¡¹ï¼š0x07ï¼ˆ7æ ‡å¿—ä¸ºç±»ç¬¦å·å¼•ç”¨ï¼‰ï¼Œ0x0012ï¼ˆæŒ‡å‘ç¬¬18é¡¹å…¨é™å®šåå¸¸é‡é¡¹ï¼‰ï¼›</li><li>ç¬¬5é¡¹ï¼š0x01ï¼ˆ1æ ‡å¿—ä¸ºUTF-å­—ç¬¦ä¸²å¸¸é‡ï¼‰ï¼Œ0x0001ï¼ˆå­—ç¬¦ä¸²å ç”¨1ä¸ªå­—èŠ‚ï¼‰ï¼Œ6Dï¼ˆå­—ç¬¦â€œmâ€ï¼‰ï¼›</li><li>ç¬¬6é¡¹ï¼š0x01ï¼ˆ1æ ‡å¿—ä¸ºUTF-å­—ç¬¦ä¸²å¸¸é‡ï¼‰ï¼Œ0x0001ï¼ˆå­—ç¬¦ä¸²å ç”¨1ä¸ªå­—èŠ‚ï¼‰ï¼Œ49ï¼ˆå­—ç¬¦â€œIâ€ï¼‰ï¼›</li><li>ç¬¬7é¡¹ï¼š0x01ï¼ˆ1æ ‡å¿—ä¸ºUTF-å­—ç¬¦ä¸²å¸¸é‡ï¼‰ï¼Œ0x0006ï¼ˆå­—ç¬¦ä¸²å ç”¨6ä¸ªå­—èŠ‚ï¼‰ï¼Œ3C 69 6E 69 74 3Eï¼ˆå­—ç¬¦â€œ<init>â€ï¼‰ï¼›</init></li><li>ç¬¬8é¡¹ï¼š0x01ï¼ˆ1æ ‡å¿—ä¸ºUTF-å­—ç¬¦ä¸²å¸¸é‡ï¼‰ï¼Œ0x0003ï¼ˆå­—ç¬¦ä¸²å ç”¨3ä¸ªå­—èŠ‚ï¼‰ï¼Œ28 29 56ï¼ˆå­—ç¬¦â€œ()Vâ€ï¼‰ï¼›</li><li>ç¬¬9é¡¹ï¼š0x01ï¼ˆ1æ ‡å¿—ä¸ºUTF-å­—ç¬¦ä¸²å¸¸é‡ï¼‰ï¼Œ0x0004ï¼ˆå­—ç¬¦ä¸²å ç”¨4ä¸ªå­—èŠ‚ï¼‰ï¼Œ43 6F 64 65ï¼ˆå­—ç¬¦â€œCodeâ€ï¼‰ï¼›</li><li>ç¬¬10é¡¹ï¼š0x01ï¼ˆ1æ ‡å¿—ä¸ºUTF-å­—ç¬¦ä¸²å¸¸é‡ï¼‰ï¼Œ0x000Fï¼ˆå­—ç¬¦ä¸²å ç”¨15ä¸ªå­—èŠ‚ï¼‰ï¼Œ4C 69 6E 65 4E 75 6D 62 65 72 54 61 62 6C 65ï¼ˆå­—ç¬¦â€œLineNumberTableâ€ï¼‰ï¼›</li><li>ç¬¬11é¡¹ï¼š0x01ï¼ˆ1æ ‡å¿—ä¸ºUTF-å­—ç¬¦ä¸²å¸¸é‡ï¼‰ï¼Œ0x0003ï¼ˆå­—ç¬¦ä¸²å ç”¨3ä¸ªå­—èŠ‚ï¼‰ï¼Œ69 6E 63ï¼ˆå­—ç¬¦â€œincâ€ï¼‰ï¼›</li><li>ç¬¬12é¡¹ï¼š0x01ï¼ˆ1æ ‡å¿—ä¸ºUTF-å­—ç¬¦ä¸²å¸¸é‡ï¼‰ï¼Œ0x0003ï¼ˆå­—ç¬¦ä¸²å ç”¨3ä¸ªå­—èŠ‚ï¼‰ï¼Œ28 29 49ï¼ˆå­—ç¬¦â€œ()Iâ€ï¼‰ï¼›</li><li>ç¬¬13é¡¹ï¼š0x01ï¼ˆ1æ ‡å¿—ä¸ºUTF-å­—ç¬¦ä¸²å¸¸é‡ï¼‰ï¼Œ0x000Aï¼ˆå­—ç¬¦ä¸²å ç”¨10ä¸ªå­—èŠ‚ï¼‰ï¼Œ53 6F 75 72 63 65 46 69 6C 65ï¼ˆå­—ç¬¦â€œSourceFileâ€ï¼‰ï¼›</li><li>ç¬¬14é¡¹ï¼š0x01ï¼ˆ1æ ‡å¿—ä¸ºUTF-å­—ç¬¦ä¸²å¸¸é‡ï¼‰ï¼Œ0x000Eï¼ˆå­—ç¬¦ä¸²å ç”¨14ä¸ªå­—èŠ‚ï¼‰ï¼Œ54 65 73 74 43 6C 61 73 73 2E 6A 61 76 61ï¼ˆå­—ç¬¦â€œTestClass.javaâ€ï¼‰ï¼›</li><li>ç¬¬15é¡¹ï¼š0x0Cï¼ˆ12æ ‡å¿—ä¸ºåç§°å’Œç±»å‹ç¬¦å·å¼•ç”¨ï¼‰ï¼Œ0x0007ï¼ˆæŒ‡å‘ç¬¬7é¡¹åç§°å¸¸é‡é¡¹ï¼‰ï¼Œ 0x0008ï¼ˆæŒ‡å‘ç¬¬8é¡¹æè¿°ç¬¦å¸¸é‡é¡¹ï¼‰ï¼›</li><li>ç¬¬16é¡¹ï¼š0x0Cï¼ˆ12æ ‡å¿—ä¸ºåç§°å’Œç±»å‹ç¬¦å·å¼•ç”¨ï¼‰ï¼Œ0x0005ï¼ˆæŒ‡å‘ç¬¬5é¡¹åç§°å¸¸é‡é¡¹ï¼‰ï¼Œ 0x0006ï¼ˆæŒ‡å‘ç¬¬6é¡¹æè¿°ç¬¦å¸¸é‡é¡¹ï¼‰ï¼›</li><li>ç¬¬17é¡¹ï¼š0x01ï¼ˆ1æ ‡å¿—ä¸ºUTF-å­—ç¬¦ä¸²å¸¸é‡ï¼‰ï¼Œ0x001Fï¼ˆå­—ç¬¦ä¸²å ç”¨31ä¸ªå­—èŠ‚ï¼‰ï¼Œ63 6F 6D 2F 67 69 6E 6F 62 65 66 75 6E 6E 79 2F 63 6C 61 7A 7A 2F 54 65 73 74 43 6C 61 73 73ï¼ˆå­—ç¬¦â€œcom/ginobefunny/clazz/TestClasâ€ï¼‰ï¼›</li><li>ç¬¬18é¡¹ï¼š0x01ï¼ˆ1æ ‡å¿—ä¸ºUTF-å­—ç¬¦ä¸²å¸¸é‡ï¼‰ï¼Œ0x0010ï¼ˆå­—ç¬¦ä¸²å ç”¨16ä¸ªå­—èŠ‚ï¼‰ï¼Œ6A 61 76 61 2F 6C 61 6E 67 2F 4F 62 6A 65 63 74ï¼ˆå­—ç¬¦â€œjava/lang/Objectâ€ï¼‰ï¼›</li></ul><h4 id="è®¿é—®æ ‡å¿—"><a href="#è®¿é—®æ ‡å¿—" class="headerlink" title="è®¿é—®æ ‡å¿—"></a>è®¿é—®æ ‡å¿—</h4><ul><li>ç´§æ¥åœ¨å¸¸é‡æ± åé¢çš„æ˜¯ä¸¤ä¸ªå­—èŠ‚çš„è®¿é—®æ ‡å¿—ï¼Œç”¨äºæ ‡è¯†ç±»æˆ–æ¥å£çš„è®¿é—®ä¿¡æ¯ï¼›</li><li>è®¿é—®æ ‡å¿—ä¸€ä¸ªæœ‰16ä¸ªæ ‡å¿—ä½ï¼Œä½†ç›®å‰åªé‡‡ç”¨äº†å…¶ä¸­8ä½ï¼Œæœ¬ä¾‹å­ä¸­çš„0x0021æ ‡è¯†ä¸ºä¸€ä¸ªpublicçš„æ™®é€šç±»ï¼›</li></ul><h4 id="ç±»ç´¢å¼•ã€çˆ¶ç±»ç´¢å¼•ä¸æ¥å£ç´¢å¼•é›†åˆ"><a href="#ç±»ç´¢å¼•ã€çˆ¶ç±»ç´¢å¼•ä¸æ¥å£ç´¢å¼•é›†åˆ" class="headerlink" title="ç±»ç´¢å¼•ã€çˆ¶ç±»ç´¢å¼•ä¸æ¥å£ç´¢å¼•é›†åˆ"></a>ç±»ç´¢å¼•ã€çˆ¶ç±»ç´¢å¼•ä¸æ¥å£ç´¢å¼•é›†åˆ</h4><ul><li>ç±»ç´¢å¼•ï¼šu2ç±»å‹çš„æ•°æ®ï¼Œç”¨äºç¡®å®šç±»çš„å…¨é™å®šåã€‚æœ¬ä¾‹å­ä¸­ä¸º0x0003ï¼ŒæŒ‡å‘å¸¸é‡æ± ä¸­ç¬¬3é¡¹ï¼›</li><li>çˆ¶ç±»ç´¢å¼•ï¼šu2ç±»å‹çš„æ•°æ®ï¼Œç”¨äºç¡®å®šçˆ¶ç±»çš„å…¨é™å®šåã€‚æœ¬ä¾‹å­ä¸­ä¸º0x0004ï¼ŒæŒ‡å‘å¸¸é‡æ± ä¸­ç¬¬4é¡¹ï¼›</li><li>æ¥å£ç´¢å¼•è®¡ç®—å™¨ï¼šu2ç±»å‹çš„æ•°æ®ï¼Œç”¨äºè¡¨ç¤ºç´¢å¼•é›†åˆçš„å®¹é‡ã€‚æœ¬ä¾‹å­ä¸­ä¸º0x0000ï¼Œè¯´æ˜æ²¡æœ‰å®ç°æ¥å£ï¼›</li><li>æ¥å£ç´¢å¼•é›†åˆï¼šä¸€ç»„u2ç±»å‹çš„æ•°æ®çš„é›†åˆï¼Œç”¨äºç¡®å®šå®ç°çš„æ¥å£ï¼ˆå¯¹äºæ¥å£æ¥è¯´å°±æ˜¯extendçš„æ¥å£ï¼‰ã€‚æœ¬ä¾‹å­ä¸å­˜åœ¨ã€‚</li></ul><h4 id="å­—æ®µè¡¨é›†åˆ"><a href="#å­—æ®µè¡¨é›†åˆ" class="headerlink" title="å­—æ®µè¡¨é›†åˆ"></a>å­—æ®µè¡¨é›†åˆ</h4><p><div align="center"> <img src="http://pic.yupoo.com/meandni/57c3e621/bd0f2fcb.png" width=""> </div><br></p><ul><li>ç”¨äºæè¿°æ¥å£æˆ–è€…ç±»ä¸­å£°æ˜çš„å˜é‡ï¼ŒåŒ…æ‹¬ç±»çº§å˜é‡å’Œå®ä¾‹çº§å˜é‡ï¼Œä½†ä¸åŒ…æ‹¬æ–¹æ³•å†…éƒ¨å£°æ˜çš„å±€éƒ¨å˜é‡ï¼›å®ƒä¸ä¼šåˆ—å‡ºä»çˆ¶ç±»å’Œè¶…ç±»ç»§æ‰¿è€Œæ¥çš„å­—æ®µï¼›</li><li>0x0001è¡¨ç¤ºè¿™ä¸ªç±»åªæœ‰ä¸€ä¸ªå­—æ®µè¡¨æ•°æ®ï¼›</li><li>å­—æ®µä¿®é¥°ç¬¦æ”¾åœ¨access_flagä¸­ï¼Œæ˜¯ä¸€ä¸ªu2çš„æ•°æ®ç±»å‹ï¼Œ0x0002è¡¨ç¤ºä¸ºprivateçš„å±æ€§ï¼›</li><li>å­—æ®µåç§°name_indexï¼Œæ˜¯ä¸€ä¸ªu2çš„æ•°æ®ç±»å‹ï¼Œ0x0005è¡¨ç¤ºè¯¥å±æ€§çš„åç§°ä¸ºå¸¸é‡æ± çš„ç¬¬5é¡¹ï¼›</li><li>å­—æ®µæè¿°ç¬¦descriptor_indexï¼Œæ˜¯ä¸€ä¸ªu2çš„æ•°æ®ç±»å‹ï¼Œ0x0006è¡¨ç¤ºè¯¥å±æ€§çš„æè¿°ç¬¦ä¸ºå¸¸é‡æ± çš„ç¬¬6é¡¹ï¼Œå…¶å€¼â€œIâ€è¡¨ç¤ºç±»å‹ä¸ºæ•´å½¢ï¼›</li><li>å­—æ®µå±æ€§è®¡ç®—å™¨å’Œå±æ€§é›†åˆï¼š0x0000è¡¨ç¤ºè¯¥ä¾‹å­ä¸­ä¸å­˜åœ¨ï¼›</li></ul><h4 id="æ–¹æ³•è¡¨é›†åˆ"><a href="#æ–¹æ³•è¡¨é›†åˆ" class="headerlink" title="æ–¹æ³•è¡¨é›†åˆ"></a>æ–¹æ³•è¡¨é›†åˆ</h4><ul><li>å’Œå­—æ®µè¡¨é›†åˆçš„æ–¹å¼å‡ ä¹ä¸€æ ·ï¼›</li><li>æ–¹æ³•é‡Œé¢çš„ä»£ç ç»è¿‡ç¼–è¯‘å™¨ç¼–è¯‘æˆå­—èŠ‚ç æŒ‡ä»¤åï¼Œå­˜æ”¾åœ¨æ–¹æ³•å±æ€§è¡¨é›†åˆä¸­ä¸€ä¸ªåä¸ºCodeçš„å±æ€§é‡Œé¢ï¼›</li><li>0x0002è¡¨ç¤ºè¿™ä¸ªç±»æœ‰ä¸¤ä¸ªæ–¹æ³•è¡¨æ•°æ®ï¼Œåˆ†åˆ«æ˜¯ç¼–è¯‘å™¨æ·»åŠ çš„å®ä¾‹æ„é€ å™¨<init>å’Œæºç ä¸­çš„æ–¹å¼inc()ï¼›</init></li><li>ç¬¬ä¸€ä¸ªæ–¹æ³•çš„è®¿é—®æ ‡å¿—æ˜¯0x0001ï¼ˆpublicæ–¹æ³•ï¼‰ï¼Œåç§°ç´¢å¼•å€¼ä¸º0x0007ï¼ˆå¸¸é‡æ± ç¬¬7é¡¹ï¼Œâ€œ<init>â€ï¼‰ï¼Œæè¿°ç¬¦ç´¢å¼•å€¼ä¸º0x0008ï¼ˆå¸¸é‡æ± ç¬¬8é¡¹ï¼Œâ€œ()Vâ€ï¼‰ï¼Œå±æ€§è¡¨è®¡ç®—å™¨ä¸º0x0001ï¼ˆæœ‰ä¸€é¡¹å±æ€§ï¼‰ï¼Œå±æ€§åç§°ç´¢å¼•ä¸º0x0009ï¼ˆå¸¸é‡æ± ç¬¬9é¡¹ï¼Œâ€œCodeâ€ï¼‰ï¼›</init></li><li>æ ¹æ®â€œ6.3.7.1 Codeå±æ€§â€è¯´æ˜ï¼Œå±æ€§å€¼çš„é•¿åº¦ä¸º23ï¼ˆ0x0000001Dè¡¨ç¤º29ï¼Œä½†éœ€è¦å‡å»å±æ€§åç§°ç´¢å¼•å’Œå±æ€§é•¿åº¦å›ºå®šçš„6ä¸ªå­—èŠ‚é•¿åº¦ï¼‰ï¼Œæ“ä½œæ•°æ ˆæ·±åº¦çš„æœ€å¤§å€¼ä¸º1ï¼ˆ0x0001ï¼Œè™šæ‹Ÿæœºè¿è¡Œæ—¶æ ¹æ®è¿™ä¸ªå€¼æ¥åˆ†é…æ ˆå¸§ä¸­æ“ä½œæ ˆæ·±åº¦ï¼‰ï¼Œå±€éƒ¨å˜é‡è¡¨æ‰€éœ€è¦çš„å­˜å‚¨ç©ºé—´ä¸º1ä¸ªSlotï¼ˆ0x0001ï¼ŒSlotæ˜¯å†…å­˜åˆ†é…çš„æœ€å°å•ä½ï¼‰ï¼Œå­—èŠ‚ç é•¿åº¦ä¸º5ï¼ˆ0x00000005ï¼‰ï¼Œåˆ†åˆ«ä¸º2Aï¼ˆaload_0ï¼Œå°†ç¬¬0ä¸ªSlotä¸­ä¸ºreferenceç±»å‹çš„æœ¬åœ°å˜é‡æ¨é€åˆ°æ“ä½œæ•°æ ˆé¡¶ï¼‰ã€B7ï¼ˆinvokespecialï¼Œä»¥æ ˆé¡¶çš„referenceç±»å‹çš„æ•°æ®æ‰€æŒ‡å‘çš„å¯¹è±¡ä½œä¸ºæ–¹æ³•æ¥æ”¶è€…ï¼Œè°ƒç”¨æ­¤å¯¹è±¡çš„å®ä¾‹æ„é€ å™¨æ–¹æ³•ã€privateæ–¹æ³•æˆ–è€…å®ƒçˆ¶ç±»çš„æ–¹æ³•ï¼Œåé¢æ¥ç€ä¸€ä¸ªu2çš„å‚æ•°æŒ‡å‘å¸¸é‡æ± çš„æ–¹æ³•å¼•ç”¨ï¼‰ã€0x0001ï¼ˆè¡¨ç¤ºå¸¸é‡æ± çš„ç¬¬1é¡¹ï¼Œå³Objectç±»çš„<init>æ–¹æ³•ï¼‰ã€B1ï¼ˆå¯¹åº”çš„æŒ‡ä»¤ä¸ºreturnï¼Œè¿”å›å€¼ä¸ºvoidï¼‰ï¼›æ˜¾å¼å¼‚å¸¸è¡¨ä¸ºç©ºï¼ˆ0x0000ï¼Œè®¡æ•°å™¨ä¸º0ï¼‰ï¼›è¯¥Codeå±æ€§è¿˜å†…åµŒ1ä¸ªå±æ€§ï¼ˆ0x0001ï¼‰ï¼Œå±æ€§çš„åç§°ç´¢å¼•ä¸º0x000Aï¼ˆå³â€œLineNumberTableâ€å±æ€§ï¼Œç”¨äºè®°å½•å¯¹åº”çš„ä»£ç è¡Œæ•°ï¼‰ï¼Œè¯¥å†…åµŒå±æ€§çš„é•¿åº¦ä¸º6ï¼ˆ0x00000006ï¼‰ï¼Œå¯¹åº”çš„è¡Œæ•°ä¿¡æ¯ä¸ºæºç çš„ç¬¬3è¡Œï¼ˆ0x000100000003ï¼‰ï¼›</init></li><li>ç¬¬äºŒä¸ªæ–¹æ³•çš„è®¿é—®æ ‡å¿—æ˜¯0x0001ï¼ˆpublicæ–¹æ³•ï¼‰ï¼Œåç§°ç´¢å¼•å€¼ä¸º0x000Bï¼ˆå¸¸é‡æ± ç¬¬11é¡¹ï¼Œâ€œincâ€ï¼‰ï¼Œæè¿°ç¬¦ç´¢å¼•å€¼ä¸º0x000Cï¼ˆå¸¸é‡æ± ç¬¬12é¡¹ï¼Œâ€œ()Iâ€ï¼‰ï¼Œå±æ€§è¡¨è®¡ç®—å™¨ä¸º0x0001ï¼ˆæœ‰ä¸€é¡¹å±æ€§ï¼‰ï¼Œå±æ€§åç§°ç´¢å¼•ä¸º0x0009ï¼ˆå¸¸é‡æ± ç¬¬9é¡¹ï¼Œâ€œCodeâ€ï¼‰ï¼›</li><li>æ ¹æ®â€œ6.3.7.1 Codeå±æ€§â€è¯´æ˜ï¼Œå±æ€§å€¼çš„é•¿åº¦ä¸º25ï¼ˆ0x0000001Fè¡¨ç¤º31ï¼Œä½†éœ€è¦å‡å»å±æ€§åç§°ç´¢å¼•å’Œå±æ€§é•¿åº¦å›ºå®šçš„6ä¸ªå­—èŠ‚é•¿åº¦ï¼‰ï¼Œæ“ä½œæ•°æ ˆæ·±åº¦çš„æœ€å¤§å€¼ä¸º2ï¼ˆ0x0002ï¼‰ï¼Œå±€éƒ¨å˜é‡è¡¨æ‰€éœ€è¦çš„å­˜å‚¨ç©ºé—´ä¸º1ä¸ªSlotï¼ˆ0x0001ï¼‰ï¼Œå­—èŠ‚ç é•¿åº¦ä¸º7ï¼ˆ0x00000007ï¼‰ï¼Œåˆ†åˆ«ä¸º2Aï¼ˆaload_0ï¼‰ã€B4ï¼ˆgetfieldï¼Œåé¢æ¥ç€ä¸€ä¸ªu2çš„å‚æ•°æŒ‡å‘å¸¸é‡æ± çš„å±æ€§å¼•ç”¨ï¼‰ã€0x0002ï¼ˆè¡¨ç¤ºå¸¸é‡æ± çš„ç¬¬2é¡¹ï¼Œå³TestClassç±»çš„må±æ€§ï¼‰ã€04ï¼ˆå¯¹åº”çš„æŒ‡ä»¤ä¸ºiconst_1ï¼‰ã€60ï¼ˆå¯¹åº”çš„æŒ‡ä»¤ä¸ºiaddï¼Œæ•´å½¢æ±‚å’Œï¼‰ã€ACï¼ˆå¯¹åº”çš„æŒ‡ä»¤ä¸ºireturnï¼Œè¿”å›å€¼ä¸ºæ•´å½¢ï¼‰ï¼›æ˜¾å¼å¼‚å¸¸è¡¨ä¸ºç©ºï¼ˆ0x0000ï¼Œè®¡æ•°å™¨ä¸º0ï¼‰ï¼›è¯¥Codeå±æ€§è¿˜å†…åµŒ1ä¸ªå±æ€§ï¼ˆ0x0001ï¼‰ï¼Œå±æ€§çš„åç§°ç´¢å¼•ä¸º0x000Aï¼ˆå³â€œLineNumberTableâ€å±æ€§ï¼Œç”¨äºè®°å½•å¯¹åº”çš„ä»£ç è¡Œæ•°ï¼‰ï¼Œè¯¥å†…åµŒå±æ€§çš„é•¿åº¦ä¸º6ï¼ˆ0x00000006ï¼‰ï¼Œå¯¹åº”çš„è¡Œæ•°ä¿¡æ¯ä¸ºæºç çš„ç¬¬8è¡Œï¼ˆ0x000100000008ï¼‰ï¼›</li></ul><h4 id="å±æ€§è¡¨é›†åˆ"><a href="#å±æ€§è¡¨é›†åˆ" class="headerlink" title="å±æ€§è¡¨é›†åˆ"></a>å±æ€§è¡¨é›†åˆ</h4><ul><li>åœ¨Classæ–‡ä»¶ã€å­—æ®µè¡¨ã€æ–¹æ³•è¡¨éƒ½å¯ä»¥æºå¸¦è‡ªå·±çš„å±æ€§è¡¨é›†åˆï¼›</li><li>å±æ€§è¡¨é›†åˆçš„é™åˆ¶è¾ƒä¸ºå®½æ¾ï¼Œä¸å†è¦æ±‚ä¸¥æ ¼çš„é¡ºåºï¼Œåªè¦å±æ€§åä¸é‡å¤å³å¯ï¼›</li><li>ä»¥ä¸‹æ˜¯Javaè™šæ‹Ÿæœºè§„èŒƒé‡Œé¢„å®šä¹‰çš„è™šæ‹Ÿæœºå®ç°åº”å½“èƒ½è¯†åˆ«çš„å±æ€§ï¼š</li></ul><p><div align="center"> <img src="http://pic.yupoo.com/meandni/8f0a69c4/90a97e5a.png" width=""> </div><br></p><p><div align="center"> <img src="http://pic.yupoo.com/meandni/4faf2ec0/e70f3e68.png" width=""> </div><br></p><p>è™šæ‹Ÿæœºè§„èŒƒé¢„å®šä¹‰çš„å±æ€§2</p><ul><li>æ¥ç€æˆ‘ä»¬çš„ä¾‹å­çš„Classæ–‡ä»¶è¿˜æœ‰æœ€åä¸€æ®µï¼š0x0001è¡¨ç¤ºè¯¥Classæœ‰ä¸€ä¸ªå±æ€§ï¼Œ0x000Dè¡¨ç¤ºå±æ€§åç´¢å¼•ä¸ºç¬¬13é¡¹ï¼ˆå¯¹åº”â€œSourceFileâ€ï¼‰ï¼Œ0x00000002è¡¨ç¤ºè¯¥å±æ€§é•¿åº¦ä¸º2ï¼Œ0x000Eè¡¨ç¤ºè¯¥ç±»çš„SourceFileåç§°ä¸ºç¬¬14é¡¹ï¼ˆå¯¹åº”â€œTestClass.javaâ€ï¼‰ã€‚</li></ul><h5 id="Codeå±æ€§"><a href="#Codeå±æ€§" class="headerlink" title="Codeå±æ€§"></a>Codeå±æ€§</h5><p>Javaç¨‹åºæ–¹æ³•ä½“ä¸­çš„ä»£ç ç»è¿‡javacç¼–è¯‘åï¼Œå­—èŠ‚ç æŒ‡ä»¤å­˜æ”¾åœ¨Codeå±æ€§ï¼Œå…¶å±æ€§è¡¨ç»“æ„å¦‚ä¸‹ï¼š</p><p><div align="center"> <img src="http://pic.yupoo.com/meandni/c7da9cd4/f4e72867.png" width=""> </div><br></p><h5 id="Exceptionså±æ€§"><a href="#Exceptionså±æ€§" class="headerlink" title="Exceptionså±æ€§"></a>Exceptionså±æ€§</h5><p>æ–¹æ³•æè¿°æ—¶throwså…³é”®å­—åé¢åˆ—ä¸¾çš„å¼‚å¸¸ï¼Œå’ŒCodeå±æ€§é‡Œçš„å¼‚å¸¸è¡¨ä¸åŒã€‚å…¶å±æ€§è¡¨ç»“æ„å¦‚ä¸‹ï¼š</p><p><div align="center"> <img src="http://pic.yupoo.com/meandni/c92bfd15/ce2d3cf7.png" width=""> </div><br></p><h5 id="LineNumberTableå±æ€§"><a href="#LineNumberTableå±æ€§" class="headerlink" title="LineNumberTableå±æ€§"></a>LineNumberTableå±æ€§</h5><p>ç”¨äºæè¿°Javaæºç è¡Œå·ä¸å­—èŠ‚ç è¡Œå·ä¹‹é—´çš„å¯¹åº”å…³ç³»ï¼Œå®ƒä¸æ˜¯å¿…é¡»çš„ï¼Œå¯ä»¥é€šè¿‡javac -g:noneå–æ¶ˆè¯¥ä¿¡æ¯ã€‚æ²¡æœ‰è¯¥ä¿¡æ¯çš„å½±å“æ˜¯è¿è¡Œæ—¶æŠ›å¼‚å¸¸ä¸ä¼šæ˜¾ç¤ºå‡ºé”™çš„è¡Œå·ï¼Œåœ¨ä»£ç è°ƒè¯•æ—¶æ— æ³•æŒ‰ç…§æºç è¡Œæ¥è®¾ç½®æ–­ç‚¹ã€‚</p><p><div align="center"> <img src="http://pic.yupoo.com/meandni/63fd6dbe/c879e713.png" width=""> </div><br></p><h5 id="LocalVariableTableå±æ€§"><a href="#LocalVariableTableå±æ€§" class="headerlink" title="LocalVariableTableå±æ€§"></a>LocalVariableTableå±æ€§</h5><p>ç”¨äºæè¿°æ ˆå¸§ä¸­å±€éƒ¨å˜é‡ä¸Javaæºç ä¸­å®šä¹‰çš„å˜é‡ä¹‹é—´çš„å…³ç³»ï¼Œå®ƒä¸æ˜¯è¿è¡Œæ—¶å¿…é¡»çš„ï¼Œå¯ä»¥é€šè¿‡javac -g:noneå–æ¶ˆè¯¥ä¿¡æ¯ã€‚å¦‚æœæ²¡æœ‰è¿™ä¸ªå±æ€§ï¼Œæ‰€æœ‰çš„å‚æ•°åç§°éƒ½ä¼šä¸¢å¤±ï¼Œå–ä¹‹ä»¥arg0ã€arg1è¿™æ ·çš„å ä½ç¬¦æ¥æ›¿ä»£ã€‚</p><p><div align="center"> <img src="http://pic.yupoo.com/meandni/547e1b38/aa184bbf.png" width=""> </div><br></p><p>å…¶ä¸­local_variable_infoé¡¹ä»£è¡¨äº†ä¸€ä¸ªæ ˆå¸§ä¸æºç ä¸­å±€éƒ¨å˜é‡çš„å…³è”ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p><figure class="image-bubble">                <div class="img-lightbox">                    <div class="overlay"></div>                    <img src="https://upload-images.jianshu.io/upload_images/3709321-ff864df8cdb95d59.png?imageMogr2/auto-orient/" alt="img" title="">                </div>                <div class="image-caption">img</div>            </figure><h5 id="SourceFileå±æ€§"><a href="#SourceFileå±æ€§" class="headerlink" title="SourceFileå±æ€§"></a>SourceFileå±æ€§</h5><p>ç”¨äºè®°å½•ç”Ÿæˆè¿™ä¸ªClassçš„æºç æ–‡ä»¶åç§°ï¼Œè¿™ä¸ªå±æ€§ä¹Ÿæ˜¯å¯é€‰çš„ã€‚</p><p><img src="https:////upload-images.jianshu.io/upload_images/3709321-0433c421ea6631bd.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/888/format/webp" alt="img"></p><h5 id="ConstantValueå±æ€§"><a href="#ConstantValueå±æ€§" class="headerlink" title="ConstantValueå±æ€§"></a>ConstantValueå±æ€§</h5><p>ä½œç”¨æ˜¯é€šçŸ¥è™šæ‹Ÿæœºè‡ªåŠ¨ä¸ºé™æ€å˜é‡èµ‹å€¼ï¼Œåªæœ‰è¢«staticå…³é”®å­—ä¿®é¥°çš„å˜é‡æ‰å¯ä»¥ç”¨è¿™ä¸ªå±æ€§ã€‚å¯¹äºéstaticç±»å‹çš„å˜é‡çš„èµ‹å€¼æ˜¯åœ¨å®ä¾‹æ„é€ å™¨<init>æ–¹æ³•ä¸­è¿›è¡Œçš„ï¼›è€Œå¯¹äºç±»å˜é‡æœ‰ä¸¤ç§æ–¹å¼ï¼šåœ¨ç±»æ„é€ å™¨<clinit>æ–¹æ³•ä¸­æˆ–è€…ä½¿ç”¨ConstantValueå±æ€§ã€‚ç›®å‰Sun javacç¼–è¯‘å™¨çš„é€‰æ‹©æ˜¯ï¼šåŒæ—¶ä½¿ç”¨finalå’Œstaticä¿®é¥°çš„å˜é‡ä¸”ä¸ºåŸºæœ¬æ•°æ®ç±»å‹æˆ–Stringç±»å‹ä½¿ç”¨ConstantValueå±æ€§åˆå§‹åŒ–ï¼Œå¦åˆ™ä½¿ç”¨<clinit>åˆå§‹åŒ–ã€‚</clinit></clinit></init></p><figure class="image-bubble">                <div class="img-lightbox">                    <div class="overlay"></div>                    <img src="https://upload-images.jianshu.io/upload_images/3709321-0433c421ea6631bd.png?imageMogr2/auto-orient/" alt="ConstantValueå±æ€§" title="">                </div>                <div class="image-caption">ConstantValueå±æ€§</div>            </figure><h5 id="InnerClasså±æ€§"><a href="#InnerClasså±æ€§" class="headerlink" title="InnerClasså±æ€§"></a>InnerClasså±æ€§</h5><p>ç”¨äºè®°å½•å†…éƒ¨ç±»ä¸å®¿ä¸»ç±»ä¹‹é—´çš„å…³è”ã€‚</p><figure class="image-bubble">                <div class="img-lightbox">                    <div class="overlay"></div>                    <img src="https://upload-images.jianshu.io/upload_images/3709321-084cd6c878ad90e3.png?imageMogr2/auto-orient/" alt="InnerClasså±æ€§" title="">                </div>                <div class="image-caption">InnerClasså±æ€§</div>            </figure><p>å…¶ä¸­number_of_classä»£è¡¨éœ€è¦è®°å½•å¤šå°‘ä¸ªå†…éƒ¨ç±»ä¿¡æ¯ï¼Œæ¯ä¸ªå†…éƒ¨ç±»çš„ä¿¡æ¯éƒ½ç”±ä¸€ä¸ªinner_class_infoè¡¨è¿›è¡Œæè¿°ã€‚</p><figure class="image-bubble">                <div class="img-lightbox">                    <div class="overlay"></div>                    <img src="https:////upload-images.jianshu.io/upload_images/3709321-e4ed4191050b93ae.png" alt="inner_class_infoè¡¨çš„ç»“æ„" title="">                </div>                <div class="image-caption">inner_class_infoè¡¨çš„ç»“æ„</div>            </figure><h5 id="DeprecatedåŠSyntheticå±æ€§"><a href="#DeprecatedåŠSyntheticå±æ€§" class="headerlink" title="DeprecatedåŠSyntheticå±æ€§"></a>DeprecatedåŠSyntheticå±æ€§</h5><p>Deprecatedï¼ˆä¸æ¨èä½¿ç”¨ï¼‰å’ŒSyntheticï¼ˆä¸æ˜¯ç”±Javaæºç ç›´æ¥äº§ç”Ÿç¼–è¯‘å™¨è‡ªè¡Œæ·»åŠ çš„ï¼Œæœ‰ä¸¤ä¸ªä¾‹å¤–æ˜¯å®ä¾‹æ„é€ å™¨<init>å’Œç±»æ„é€ å™¨<clinit>ï¼‰è¿™ä¸¤ä¸ªå±æ€§éƒ½å±äºå¸ƒå°”å±æ€§ï¼Œåªå­˜åœ¨æœ‰å’Œæ²¡æœ‰çš„åŒºåˆ«ï¼Œæ²¡æœ‰å±æ€§å€¼çš„æ¦‚å¿µã€‚åœ¨å±æ€§ç»“æ„ä¸­attribute_lengthçš„æ•°æ®å€¼å¿…é¡»ä¸º0x00000000ã€‚</clinit></init></p><p><img src="https:////upload-images.jianshu.io/upload_images/3709321-7eee2ac1a903c987.png" alt="DeprecatedåŠSyntheticå±æ€§"></p><h5 id="StackMapTableå±æ€§"><a href="#StackMapTableå±æ€§" class="headerlink" title="StackMapTableå±æ€§"></a>StackMapTableå±æ€§</h5><p>è¿™æ˜¯ä¸€ä¸ªå¤æ‚çš„å˜é•¿å±æ€§ï¼Œä½äºCodeå±æ€§çš„å±æ€§è¡¨ä¸­ã€‚è¿™ä¸ªå±æ€§ä¼šåœ¨è™šæ‹Ÿæœºç±»åŠ è½½çš„å­—èŠ‚ç éªŒè¯é˜¶æ®µè¢«æ–°ç±»å‹æ£€æŸ¥éªŒè¯å™¨ä½¿ç”¨ï¼Œç›®çš„åœ¨äºä»£æ›¿ä»¥å‰æ¯”è¾ƒæ¶ˆè€—æ€§èƒ½çš„åŸºäºæ•°æ®æµåˆ†æçš„ç±»å‹æ¨å¯¼éªŒè¯å™¨ã€‚</p><p><img src="https:////upload-images.jianshu.io/upload_images/3709321-ffb7cc6ecb3d041b.png" alt="StackMapTableå±æ€§"></p><h5 id="Signatureå±æ€§"><a href="#Signatureå±æ€§" class="headerlink" title="Signatureå±æ€§"></a>Signatureå±æ€§</h5><p>ä¸€ä¸ªå¯é€‰çš„å®šé•¿å±æ€§ï¼Œåœ¨JDK 1.5å‘å¸ƒåå¢åŠ çš„ï¼Œä»»ä½•ç±»ã€æ¥å£ã€åˆå§‹åŒ–æ–¹æ³•æˆ–æˆå‘˜çš„æ³›å‹ç­¾åå¦‚æœåŒ…å«äº†ç±»å‹å˜é‡æˆ–å‚æ•°åŒ–ç±»å‹ï¼Œåˆ™Signatureå±æ€§ä¼šä¸ºå®ƒè®°å½•æ³›å‹ç­¾åä¿¡æ¯ã€‚è¿™ä¸»è¦æ˜¯å› ä¸ºJavaçš„æ³›å‹é‡‡ç”¨çš„æ˜¯æ“¦é™¤æ³•å®ç°çš„ä¼ªæ³›å‹ï¼Œåœ¨å­—èŠ‚ç ä¸­æ³›å‹ä¿¡æ¯ç¼–è¯‘ä¹‹åç»Ÿç»Ÿè¢«æ“¦é™¤ï¼Œåœ¨è¿è¡ŒæœŸæ— æ³•å°†æ³›å‹ç±»å‹ä¸ç”¨æˆ·å®šä¹‰çš„æ™®é€šç±»å‹åŒç­‰å¯¹å¾…ã€‚é€šè¿‡Signatureå±æ€§ï¼ŒJavaçš„åå°„APIèƒ½å¤Ÿè·å–æ³›å‹ç±»å‹ã€‚</p><figure class="image-bubble">                <div class="img-lightbox">                    <div class="overlay"></div>                    <img src="https:////upload-images.jianshu.io/upload_images/3709321-1412b798df574705.png" alt="Signatureå±æ€§" title="">                </div>                <div class="image-caption">Signatureå±æ€§</div>            </figure><h5 id="BootstrapMethodså±æ€§"><a href="#BootstrapMethodså±æ€§" class="headerlink" title="BootstrapMethodså±æ€§"></a>BootstrapMethodså±æ€§</h5><p>ä¸€ä¸ªå¤æ‚çš„å˜é•¿å±æ€§ï¼Œä½äºç±»æ–‡ä»¶çš„å±æ€§è¡¨ä¸­ï¼Œç”¨äºä¿å­˜invokedynamicæŒ‡ä»¤å¼•ç”¨çš„å¼•å¯¼æ–¹æ³•é™å®šç¬¦ã€‚</p><h1 id="å­—èŠ‚ç æŒ‡ä»¤ç®€ä»‹"><a href="#å­—èŠ‚ç æŒ‡ä»¤ç®€ä»‹" class="headerlink" title="å­—èŠ‚ç æŒ‡ä»¤ç®€ä»‹"></a>å­—èŠ‚ç æŒ‡ä»¤ç®€ä»‹</h1><p>Javaè™šæ‹Ÿæœºçš„æŒ‡ä»¤ç”±ä¸€ä¸ªå­—èŠ‚é•¿åº¦çš„ã€ä»£è¡¨ç€ç‰¹å®šæ“ä½œå«ä¹‰çš„æ•°å­—ï¼ˆæ“ä½œç ï¼‰ä»¥åŠè·Ÿéšå…¶åçš„é›¶è‡³å¤šä¸ªä»£è¡¨æ­¤æ“ä½œæ‰€éœ€å‚æ•°ï¼ˆç§°ä¸ºæ“ä½œæ•°ï¼‰è€Œæ„æˆã€‚ç”±äºJavaè™šæ‹Ÿæœºé‡‡ç”¨é¢å‘æ“ä½œæ•°æ ˆè€Œä¸æ˜¯å¯„å­˜å™¨çš„æ¶æ„ï¼Œæ‰€ä»¥å¤§å¤šæ•°çš„æŒ‡ä»¤éƒ½ä¸åŒ…å«æ“ä½œæ•°ï¼Œåªæœ‰ä¸€ä¸ªæ“ä½œç ã€‚</p><p>åœ¨æŒ‡ä»¤é›†ä¸­å¤§å¤šæ•°çš„æŒ‡ä»¤éƒ½åŒ…å«äº†å…¶æ“ä½œæ‰€å¯¹åº”çš„æ•°æ®ç±»å‹ä¿¡æ¯ï¼Œå¦‚iloadæŒ‡ä»¤ç”¨äºä»å±€éƒ¨å˜é‡è¡¨ä¸­åŠ è½½intç±»å‹çš„æ•°æ®åˆ°æ“ä½œæ•°æ ˆä¸­ã€‚</p><ul><li>åŠ è½½å’Œå­˜å‚¨æŒ‡ä»¤ï¼šiload/iload_<n>ç­‰ï¼ˆåŠ è½½å±€éƒ¨å˜é‡åˆ°æ“ä½œæ ˆï¼‰ã€istore/istore_<n>ç­‰ï¼ˆä»æ“ä½œæ•°æ ˆå­˜å‚¨åˆ°å±€éƒ¨å˜é‡è¡¨ï¼‰ã€bipush/sipush/ldc/iconst_<n>ï¼ˆåŠ è½½å¸¸é‡åˆ°æ“ä½œæ•°æ ˆï¼‰ã€wideï¼ˆæ‰©å……å±€éƒ¨å˜é‡è¡¨è®¿é—®ç´¢å¼•ï¼‰ï¼›</n></n></n></li><li>è¿ç®—æŒ‡ä»¤ï¼šæ²¡æœ‰ç›´æ¥æ”¯æŒbyteã€shortã€charå’Œbooleanç±»å‹çš„ç®—æœ¯æŒ‡ä»¤è€Œé‡‡ç”¨intä»£æ›¿ï¼›iadd/isub/imul/idivåŠ å‡ä¹˜é™¤ã€iremæ±‚ä½™ã€inegå–åã€ishl/ishrä½ç§»ã€ioræŒ‰ä½æˆ–ã€iandæŒ‰ä½ä¸ã€ixoræŒ‰ä½å¼‚æˆ–ã€iincå±€éƒ¨å˜é‡è‡ªå¢ã€dcmpg/dcmplæ¯”è¾ƒï¼›</li><li>ç±»å‹è½¬æ¢æŒ‡ä»¤ï¼ši2b/i2c/i2s/l2i/f2i/f2l/d2i/d2l/d2fï¼›</li><li>å¯¹è±¡åˆ›å»ºä¸è®¿é—®æŒ‡ä»¤ï¼šnewåˆ›å»ºç±»å®ä¾‹ã€newarray/anewarray/multianewarrayåˆ›å»ºæ•°ç»„ã€getfield/putfield/getstatic/putstaticè®¿é—®ç±»å­—æ®µæˆ–å®ä¾‹å­—æ®µã€baload/iaload/aaloadæŠŠä¸€ä¸ªæ•°ç»„å…ƒç´ åŠ è½½åˆ°æ“ä½œæ•°æ ˆã€bastore/iastore/aastoreå°†ä¸€ä¸ªæ“ä½œæ•°æ ˆçš„å€¼å­˜å‚¨åˆ°æ•°ç»„å…ƒç´ ä¸­ã€arraylengthå–æ•°ç»„é•¿åº¦ã€instanceof/checkcastæ£€æŸ¥ç±»å®ä¾‹ç±»å‹ï¼›</li><li>æ“ä½œæ•°æ ˆç®¡ç†æŒ‡ä»¤ï¼špop/pop2ä¸€ä¸ªæˆ–ä¸¤ä¸ªå…ƒç´ å‡ºæ ˆã€dup/dup2å¤åˆ¶æ ˆé¡¶ä¸€ä¸ªæˆ–ä¸¤ä¸ªæ•°ç»„å¹¶å°†å¤åˆ¶å€¼æˆ–åŒä»½å¤åˆ¶å€¼é‡æ–°å‹åŠ›æ ˆé¡¶ã€swapäº¤äº’æ ˆé¡¶ä¸¤ä¸ªæ•°å€¼ï¼›</li><li>æ§åˆ¶è½¬ç§»æŒ‡ä»¤ï¼šifeq/iflt/ifnullæ¡ä»¶åˆ†æ”¯ã€tableswitch/lookupswitchå¤åˆæ¡ä»¶åˆ†æ”¯ã€goto/jsr/retæ— æ¡ä»¶åˆ†æ”¯ï¼›</li><li>æ–¹æ³•è°ƒç”¨å’Œè¿”å›æŒ‡ä»¤ï¼šinvokevirtual/invokeinterface/invokespecial/invokestatic/invokedynamicæ–¹æ³•è°ƒç”¨ã€ireturn/lreturn/areturn/returnæ–¹æ³•è¿”å›ï¼›</li><li>å¼‚å¸¸å¤„ç†æŒ‡ä»¤ï¼šathrow</li><li>åŒæ­¥æŒ‡ä»¤ï¼šmonitorenter/monitorexit</li></ul><h1 id="å…¬æœ‰è®¾è®¡å’Œç§æœ‰å®ç°"><a href="#å…¬æœ‰è®¾è®¡å’Œç§æœ‰å®ç°" class="headerlink" title="å…¬æœ‰è®¾è®¡å’Œç§æœ‰å®ç°"></a>å…¬æœ‰è®¾è®¡å’Œç§æœ‰å®ç°</h1><ul><li>Javaè™šæ‹Ÿæœºçš„å®ç°å¿…é¡»èƒ½å¤Ÿè¯»å–Classæ–‡ä»¶å¹¶ç²¾ç¡®å®ç°åŒ…å«åœ¨å…¶ä¸­çš„Javaè™šæ‹Ÿæœºä»£ç çš„å«ä¹‰ï¼›</li><li>ä½†ä¸€ä¸ªä¼˜ç§€çš„è™šæ‹Ÿæœºå®ç°ï¼Œé€šå¸¸ä¼šåœ¨æ»¡è¶³è™šæ‹Ÿæœºè§„èŒƒçš„çº¦æŸä¸‹å…·ä½“å®ç°åšå‡ºä¿®æ”¹å’Œä¼˜åŒ–ï¼›</li><li>è™šæ‹Ÿæœºå®ç°çš„æ–¹å¼ä¸»è¦æœ‰ä¸¤ç§ï¼šå°†è¾“å…¥çš„Javaè™šæ‹Ÿæœºä»£ç åœ¨åŠ è½½æˆ–æ‰§è¡Œæ—¶ç¿»è¯‘æˆå¦å¤–ä¸€ç§è™šæ‹Ÿæœºçš„æŒ‡ä»¤é›†æˆ–å®¿ä¸»ä¸»æœºCPUçš„æœ¬åœ°æŒ‡ä»¤é›†ã€‚</li></ul><h1 id="Classæ–‡ä»¶ç»“æ„çš„å‘å±•"><a href="#Classæ–‡ä»¶ç»“æ„çš„å‘å±•" class="headerlink" title="Classæ–‡ä»¶ç»“æ„çš„å‘å±•"></a>Classæ–‡ä»¶ç»“æ„çš„å‘å±•</h1><ul><li>Classæ–‡ä»¶ç»“æ„ä¸€ç›´æ¯”è¾ƒç¨³å®šï¼Œä¸»è¦çš„æ”¹è¿›é›†ä¸­å‘è®¿é—®æ ‡å¿—ã€å±æ€§è¡¨è¿™äº›å¯æ‰©å±•çš„æ•°æ®ç»“æ„ä¸­æ·»åŠ å†…å®¹ï¼›</li><li>Classæ–‡ä»¶æ ¼å¼æ‰€å…·å¤‡çš„å¹³å°ä¸­ç«‹ã€ç´§å‡‘ã€ç¨³å®šå’Œå¯æ‰©å±•çš„ç‰¹ç‚¹ï¼Œæ˜¯JavaæŠ€æœ¯ä½“ç³»å®ç°å¹³å°æ— å…³ã€è¯­è¨€æ— å…³ä¸¤é¡¹ç‰¹æ€§çš„é‡è¦æ”¯æŸ±ï¼›</li></ul><h1 id="æœ¬ç« å°ç»“"><a href="#æœ¬ç« å°ç»“" class="headerlink" title="æœ¬ç« å°ç»“"></a>æœ¬ç« å°ç»“</h1><p>æœ¬ç« è¯¦ç»†è®²è§£äº†Classæ–‡ä»¶ç»“æ„çš„å„ä¸ªéƒ¨åˆ†ï¼Œé€šè¿‡ä¸€ä¸ªå®ä¾‹æ¼”ç¤ºäº†Classçš„æ•°æ®æ˜¯å¦‚ä½•å­˜å‚¨å’Œè®¿é—®çš„ï¼Œåé¢çš„ç« èŠ‚å°†ä»¥åŠ¨æ€çš„ã€è¿è¡Œæ—¶çš„è§’åº¦å»çœ‹çœ‹å­—èŠ‚ç åœ¨è™šæ‹Ÿæœºæ‰§è¡Œå¼•æ“æ˜¯æ€æ ·è¢«è§£ææ‰§è¡Œçš„ã€‚</p><h1 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h1><ul><li><a href="https://book.douban.com/subject/24722612/" target="_blank" rel="noopener">ã€Šæ·±å…¥ç†è§£Javaè™šæ‹Ÿæœºâ€”â€”JVMé«˜çº§ç‰¹æ€§ä¸æœ€ä½³å®è·µã€‹ï¼å‘¨å¿—æ˜</a></li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;ä»£ç ç¼–è¯‘çš„ç»“æœä»æœ¬åœ°æœºå™¨ç è½¬å˜ä¸ºå­—èŠ‚ç ï¼Œæ˜¯å­˜å‚¨æ ¼å¼å‘å±•çš„ä¸€å°æ­¥ï¼Œå´æ˜¯ç¼–ç¨‹è¯­è¨€å‘å±•çš„ä¸€å¤§æ­¥ã€‚&lt;/p&gt;
&lt;p&gt;ç”±äºæœ€è¿‘åå¹´å†…è™šæ‹Ÿæœºä»¥åŠå¤§é‡å»ºç«‹åœ¨è™šæ‹Ÿæœºä¹‹ä¸Šçš„ç¨‹åºè¯­è¨€å¦‚é›¨åæ˜¥ç¬‹èˆ¬å‡ºç°å¹¶è“¬å‹ƒå‘å±•ï¼Œå°†æˆ‘ä»¬ç¼–å†™çš„ç¨‹åºç¼–è¯‘æˆäºŒè¿›åˆ¶æœ¬åœ°æœºå™¨ç ï¼ˆNative Codeï¼‰å·²ä¸å†æ˜¯å”¯ä¸€çš„é€‰æ‹©ï¼Œè¶Š
      
    
    </summary>
    
      <category term="æ•´ç†" scheme="https://meandni.com/categories/%E6%95%B4%E7%90%86/"/>
    
    
      <category term="è¯»ä¹¦" scheme="https://meandni.com/tags/%E8%AF%BB%E4%B9%A6/"/>
    
      <category term="jvm" scheme="https://meandni.com/tags/jvm/"/>
    
  </entry>
  
  <entry>
    <title>å®æˆ˜ä¸­å­¦ä¹ Flutter2ï¼šæ‰“é€ ä¸€æ¬¾é€šç”¨çš„APPUIç»“æ„ï¼Œä»æ­¤èµ°ä¸Šäººç”Ÿå·…å³°ï¼</title>
    <link href="https://meandni.com/2019/01/12/flutter-practice2/"/>
    <id>https://meandni.com/2019/01/12/flutter-practice2/</id>
    <published>2019-01-12T13:43:40.000Z</published>
    <updated>2019-01-18T02:00:43.179Z</updated>
    
    <content type="html"><![CDATA[<p>æ‰“é€ ä¸€æ¬¾é€šç”¨çš„AppUIç»“æ„ï¼ŒåŒ…æ‹¬ç™»å½•ã€æ³¨å†Œã€é¦–é¡µåŠå„ä¸­å…±ç”¨éƒ¨åˆ†ï¼Œæœ€åèƒ½å¤Ÿæ„æˆä¸€æ¬¾å®Œæ•´çš„APPï¼Œç›®å‰è¿˜åœ¨å®Œå–„ï¼Œå¸Œæœ›å¤§å®¶ä¸€èµ·åŠ å…¥ã€‚</p><p>å¼•ç”¨æˆ‘åœ¨<a href="https://github.com/MeandNi/AndroidEfficientBaseUtils" target="_blank" rel="noopener">AndroidEfficientBaseUtils</a>è¯´è¿‡çš„è¯ï¼Œç›¸å½“äºç»™ä½ ä¸€ä¸ªå®Œå®Œæ•´æ•´åœ°æ¼‚äº®çš„ç›’å­ï¼Œä½ åªéœ€æŠŠè‡ªå·±éœ€è¦çš„ä¸œè¥¿æ”¾è¿›å»å°±å¥½ã€‚è€Œä¸”è¿™æ˜¯è·¨å¹³å°çš„å‘€ã€‚</p><figure class="image-bubble">                <div class="img-lightbox">                    <div class="overlay"></div>                    <img src="https://github.com/MeandNi/flutter_commonApp/raw/master/show/appshow.jpg" alt="" title="">                </div>                <div class="image-caption"></div>            </figure><h2 id="ç»“æ„æ¸…å•"><a href="#ç»“æ„æ¸…å•" class="headerlink" title="ç»“æ„æ¸…å•"></a>ç»“æ„æ¸…å•</h2><ul><li style="list-style: none"><input type="checkbox" checked> Welcome - é¦–é¡µ</li><li style="list-style: none"><input type="checkbox" checked> Login - ç™»å½•</li><li style="list-style: none"><input type="checkbox"> Register - æ³¨å†Œ</li><li style="list-style: none"><input type="checkbox" checked> Home - é¦–é¡µ</li><li style="list-style: none"><input type="checkbox"> Personal information - ä¸ªäººä¿¡æ¯</li><li style="list-style: none"><input type="checkbox"> â€¦.</li></ul><h2 id="ä½œè€…"><a href="#ä½œè€…" class="headerlink" title="ä½œè€…"></a>ä½œè€…</h2><ul><li>Yangjiakang, <a href="https://github.com/MeandNi/flutter_commonApp" target="_blank" rel="noopener"><strong>MeandNi</strong></a></li><li><p>â€¦.</p></li><li><p>ç›¸ä¿¡è¿™ä¸€å¥—ç»“æ„å¯ä»¥é€‚ç”¨äºå¤§éƒ¨åˆ†Appï¼ˆå½“ç„¶è‡ªå·±è¦æ ¹æ®éœ€æ±‚ä¿®æ”¹ã€‚ï¼‰ï¼Œè¿™é‡Œè¿½æ±‚çš„æ˜¯é€šç”¨è€Œä¸æ˜¯èŠ±å“¨çš„æ•ˆæœã€‚</p></li></ul><h2 id="å®Œæ•´ä»£ç "><a href="#å®Œæ•´ä»£ç " class="headerlink" title="å®Œæ•´ä»£ç "></a>å®Œæ•´ä»£ç </h2><p><a href="https://github.com/MeandNi/flutter_commonApp" target="_blank" rel="noopener">ä»£ç </a></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;æ‰“é€ ä¸€æ¬¾é€šç”¨çš„AppUIç»“æ„ï¼ŒåŒ…æ‹¬ç™»å½•ã€æ³¨å†Œã€é¦–é¡µåŠå„ä¸­å…±ç”¨éƒ¨åˆ†ï¼Œæœ€åèƒ½å¤Ÿæ„æˆä¸€æ¬¾å®Œæ•´çš„APPï¼Œç›®å‰è¿˜åœ¨å®Œå–„ï¼Œå¸Œæœ›å¤§å®¶ä¸€èµ·åŠ å…¥ã€‚&lt;/p&gt;
&lt;p&gt;å¼•ç”¨æˆ‘åœ¨&lt;a href=&quot;https://github.com/MeandNi/AndroidEfficientBaseUtils
      
    
    </summary>
    
      <category term="åŸåˆ›" scheme="https://meandni.com/categories/%E5%8E%9F%E5%88%9B/"/>
    
    
      <category term="è‡ªå­¦" scheme="https://meandni.com/tags/%E8%87%AA%E5%AD%A6/"/>
    
      <category term="flutter" scheme="https://meandni.com/tags/flutter/"/>
    
  </entry>
  
  <entry>
    <title>ã€Šæ·±å…¥ç†è§£Javaè™šæ‹Ÿæœºã€‹ç¬”è®°3â€”â€”7ç§åƒåœ¾æ”¶é›†å™¨</title>
    <link href="https://meandni.com/2019/01/11/jvm_note3/"/>
    <id>https://meandni.com/2019/01/11/jvm_note3/</id>
    <published>2019-01-11T03:50:40.000Z</published>
    <updated>2019-01-14T07:45:49.751Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p><a href="https://meandni.com/2019/01/05/winter_vacation/">2019å¤§ä¸‰çš„å¯’å‡è®¡åˆ’</a>â€”â€”åˆ©ç”¨åœ¨å…¬å¸æ¯å¤©æ—©èµ·çš„æ—¶é—´è¯»ä¹¦ï¼Œç¬¬ä¸€æœ¬æ˜¯å‘¨å¿—æ˜è€å¸ˆçš„ã€Šæ·±å…¥ç†è§£Javaè™šæ‹Ÿæœºâ€”â€”JVMé«˜çº§ç‰¹æ€§ä¸æœ€ä½³å®è·µã€‹ï¼Œè¿™ä¸€ç³»åˆ—æ˜¯é€šè¿‡å¯¹åŸæ–‡çš„æ‹œè¯»ä¸è‡ªå·±ç†è§£åŠ ä¸Šç½‘ç»œä¸Šçš„èµ„æ–™æ–‡ç« æ•´ç†å‡ºçš„è¯»ä¹¦ç¬”è®°ã€‚</p></blockquote><p>å¦‚æœè¯´æ”¶é›†ç®—æ³•æ˜¯å†…å­˜å›æ”¶çš„æ–¹æ³•è®ºï¼Œé‚£ä¹ˆåƒåœ¾æ”¶é›†å™¨å°±æ˜¯å†…å­˜å›æ”¶çš„å…·ä½“å®ç°ã€‚**Javaè™šæ‹Ÿæœºè§„èŒƒä¸­å¯¹åƒåœ¾æ”¶é›†å™¨åº”è¯¥å¦‚ä½•å®ç°å¹¶æ²¡æœ‰ä»»ä½•è§„å®šï¼Œå› æ­¤ä¸åŒçš„å‚å•†ã€ç‰ˆæœ¬çš„è™šæ‹Ÿæœºæ‰€æä¾›çš„åƒåœ¾æ”¶é›†å™¨éƒ½å¯èƒ½ä¼šæœ‰å¾ˆå¤§å·®åˆ«ï¼Œå¹¶ä¸”ä¸€èˆ¬éƒ½ä¼šæä¾›å‚æ•°ä¾›ç”¨æˆ·æ ¹æ®è‡ªå·±çš„åº”ç”¨ç‰¹ç‚¹å’Œè¦æ±‚ç»„åˆå‡ºå„ä¸ªå¹´ä»£æ‰€ä½¿ç”¨çš„æ”¶é›†å™¨ã€‚æ¥ä¸‹æ¥è®¨è®ºçš„æ”¶é›†å™¨åŸºäºJDK1.7 Update 14 ä¹‹åçš„HotSpotè™šæ‹Ÿæœºï¼ˆåœ¨æ­¤ç‰ˆæœ¬ä¸­æ­£å¼æä¾›äº†å•†ç”¨çš„G1æ”¶é›†å™¨ï¼Œä¹‹å‰G1ä»å¤„äºå®éªŒçŠ¶æ€ï¼‰ï¼Œè¯¥è™šæ‹ŸæœºåŒ…å«çš„æ‰€æœ‰æ”¶é›†å™¨å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><p><div align="center"> <img src="http://pic.yupoo.com/meandni/e8793494/27df7474.jpg" width=""> </div><br></p><p>ä»¥ä¸Šæ˜¯ HotSpot è™šæ‹Ÿæœºä¸­çš„ 7 ä¸ªåƒåœ¾æ”¶é›†å™¨ï¼Œè¿çº¿è¡¨ç¤ºåƒåœ¾æ”¶é›†å™¨å¯ä»¥é…åˆä½¿ç”¨ã€‚</p><ul><li>å•çº¿ç¨‹ä¸å¤šçº¿ç¨‹ï¼šå•çº¿ç¨‹æŒ‡çš„æ˜¯åƒåœ¾æ”¶é›†å™¨åªä½¿ç”¨ä¸€ä¸ªçº¿ç¨‹è¿›è¡Œæ”¶é›†ï¼Œè€Œå¤šçº¿ç¨‹ä½¿ç”¨å¤šä¸ªçº¿ç¨‹ï¼›</li><li>ä¸²è¡Œä¸å¹¶è¡Œï¼šä¸²è¡ŒæŒ‡çš„æ˜¯åƒåœ¾æ”¶é›†å™¨ä¸ç”¨æˆ·ç¨‹åºäº¤æ›¿æ‰§è¡Œï¼Œè¿™æ„å‘³ç€åœ¨æ‰§è¡Œåƒåœ¾æ”¶é›†çš„æ—¶å€™éœ€è¦åœé¡¿ç”¨æˆ·ç¨‹åºï¼›å¹¶è¡ŒæŒ‡çš„æ˜¯åƒåœ¾æ”¶é›†å™¨å’Œç”¨æˆ·ç¨‹åºåŒæ—¶æ‰§è¡Œã€‚é™¤äº† CMS å’Œ G1 ä¹‹å¤–ï¼Œå…¶å®ƒåƒåœ¾æ”¶é›†å™¨éƒ½æ˜¯ä»¥ä¸²è¡Œçš„æ–¹å¼æ‰§è¡Œã€‚</li></ul><h1 id="ç›¸å…³æ¦‚å¿µ"><a href="#ç›¸å…³æ¦‚å¿µ" class="headerlink" title="ç›¸å…³æ¦‚å¿µ"></a>ç›¸å…³æ¦‚å¿µ</h1><h4 id="å¹¶è¡Œå’Œå¹¶å‘"><a href="#å¹¶è¡Œå’Œå¹¶å‘" class="headerlink" title="å¹¶è¡Œå’Œå¹¶å‘"></a>å¹¶è¡Œå’Œå¹¶å‘</h4><ul><li><strong>å¹¶è¡Œï¼ˆParallelï¼‰</strong>ï¼šæŒ‡å¤šæ¡åƒåœ¾æ”¶é›†çº¿ç¨‹å¹¶è¡Œå·¥ä½œï¼Œä½†æ­¤æ—¶ç”¨æˆ·çº¿ç¨‹ä»ç„¶å¤„äºç­‰å¾…çŠ¶æ€ã€‚</li><li><strong>å¹¶å‘ï¼ˆConcurrentï¼‰</strong>ï¼šæŒ‡ç”¨æˆ·çº¿ç¨‹ä¸åƒåœ¾æ”¶é›†çº¿ç¨‹åŒæ—¶æ‰§è¡Œï¼ˆä½†ä¸ä¸€å®šæ˜¯å¹¶è¡Œçš„ï¼Œå¯èƒ½ä¼šäº¤æ›¿æ‰§è¡Œï¼‰ï¼Œç”¨æˆ·ç¨‹åºåœ¨ç»§ç»­è¿è¡Œã€‚è€Œåƒåœ¾æ”¶é›†ç¨‹åºè¿è¡Œåœ¨å¦ä¸€ä¸ªCPUä¸Šã€‚</li></ul><h4 id="ååé‡ï¼ˆThroughputï¼‰"><a href="#ååé‡ï¼ˆThroughputï¼‰" class="headerlink" title="ååé‡ï¼ˆThroughputï¼‰"></a>ååé‡ï¼ˆThroughputï¼‰</h4><p>ååé‡å°±æ˜¯<strong>CPUç”¨äºè¿è¡Œç”¨æˆ·ä»£ç çš„æ—¶é—´</strong>ä¸<strong>CPUæ€»æ¶ˆè€—æ—¶é—´</strong>çš„æ¯”å€¼ï¼Œå³</p><p><strong>ååé‡ = è¿è¡Œç”¨æˆ·ä»£ç æ—¶é—´ /ï¼ˆè¿è¡Œç”¨æˆ·ä»£ç æ—¶é—´ + åƒåœ¾æ”¶é›†æ—¶é—´ï¼‰ã€‚</strong></p><p>å‡è®¾è™šæ‹Ÿæœºæ€»å…±è¿è¡Œäº†100åˆ†é’Ÿï¼Œå…¶ä¸­åƒåœ¾æ”¶é›†èŠ±æ‰1åˆ†é’Ÿï¼Œé‚£ååé‡å°±æ˜¯99%ã€‚</p><h4 id="Minor-GC-å’Œ-Full-GC"><a href="#Minor-GC-å’Œ-Full-GC" class="headerlink" title="Minor GC å’Œ Full GC"></a>Minor GC å’Œ Full GC</h4><ul><li><strong>æ–°ç”Ÿä»£GCï¼ˆMinor GCï¼‰</strong>ï¼šæŒ‡å‘ç”Ÿåœ¨æ–°ç”Ÿä»£çš„åƒåœ¾æ”¶é›†åŠ¨ä½œï¼Œå› ä¸ºJavaå¯¹è±¡å¤§å¤šéƒ½å…·å¤‡æœç”Ÿå¤•ç­çš„ç‰¹æ€§ï¼Œæ‰€ä»¥Minor GCéå¸¸é¢‘ç¹ï¼Œä¸€èˆ¬å›æ”¶é€Ÿåº¦ä¹Ÿæ¯”è¾ƒå¿«ã€‚å…·ä½“åŸç†è§ä¸Šä¸€ç¯‡æ–‡ç« ã€‚</li><li><strong>è€å¹´ä»£GCï¼ˆMajor GC / Full GCï¼‰</strong>ï¼šæŒ‡å‘ç”Ÿåœ¨è€å¹´ä»£çš„GCï¼Œå‡ºç°äº†Major GCï¼Œç»å¸¸ä¼šä¼´éšè‡³å°‘ä¸€æ¬¡çš„Minor GCï¼ˆä½†éç»å¯¹çš„ï¼Œåœ¨Parallel Scavengeæ”¶é›†å™¨çš„æ”¶é›†ç­–ç•¥é‡Œå°±æœ‰ç›´æ¥è¿›è¡ŒMajor GCçš„ç­–ç•¥é€‰æ‹©è¿‡ç¨‹ï¼‰ã€‚Major GCçš„é€Ÿåº¦ä¸€èˆ¬ä¼šæ¯”Minor GCæ…¢10å€ä»¥ä¸Šã€‚</li></ul><h1 id="å„æ”¶é›†å™¨é˜è¿°"><a href="#å„æ”¶é›†å™¨é˜è¿°" class="headerlink" title="å„æ”¶é›†å™¨é˜è¿°"></a>å„æ”¶é›†å™¨é˜è¿°</h1><h4 id="1-Serial-æ”¶é›†å™¨"><a href="#1-Serial-æ”¶é›†å™¨" class="headerlink" title="1. Serial æ”¶é›†å™¨"></a>1. Serial æ”¶é›†å™¨</h4><p><div align="center"> <img src="http://pic.yupoo.com/meandni/5c861f07/b1ac068e.jpg" width=""> </div><br></p><p>Serial ç¿»è¯‘ä¸ºä¸²è¡Œï¼Œä¹Ÿå°±æ˜¯è¯´å®ƒä»¥ä¸²è¡Œçš„æ–¹å¼æ‰§è¡Œã€‚</p><p>å®ƒæ˜¯å•çº¿ç¨‹çš„æ”¶é›†å™¨ï¼Œåªä¼šä½¿ç”¨ä¸€ä¸ªçº¿ç¨‹è¿›è¡Œåƒåœ¾æ”¶é›†å·¥ä½œã€‚</p><p>å®ƒçš„ä¼˜ç‚¹æ˜¯ç®€å•é«˜æ•ˆï¼Œå¯¹äºå•ä¸ª CPU ç¯å¢ƒæ¥è¯´ï¼Œç”±äºæ²¡æœ‰çº¿ç¨‹äº¤äº’çš„å¼€é”€ï¼Œå› æ­¤æ‹¥æœ‰æœ€é«˜çš„å•çº¿ç¨‹æ”¶é›†æ•ˆç‡ã€‚</p><p>å®ƒæ˜¯ Client æ¨¡å¼ä¸‹çš„é»˜è®¤æ–°ç”Ÿä»£æ”¶é›†å™¨ï¼Œå› ä¸ºåœ¨è¯¥åº”ç”¨åœºæ™¯ä¸‹ï¼Œåˆ†é…ç»™è™šæ‹Ÿæœºç®¡ç†çš„å†…å­˜ä¸€èˆ¬æ¥è¯´ä¸ä¼šå¾ˆå¤§ã€‚Serial æ”¶é›†å™¨æ”¶é›†å‡ åå…†ç”šè‡³ä¸€ä¸¤ç™¾å…†çš„æ–°ç”Ÿä»£åœé¡¿æ—¶é—´å¯ä»¥æ§åˆ¶åœ¨ä¸€ç™¾å¤šæ¯«ç§’ä»¥å†…ï¼Œåªè¦ä¸æ˜¯å¤ªé¢‘ç¹ï¼Œè¿™ç‚¹åœé¡¿æ˜¯å¯ä»¥æ¥å—çš„ã€‚</p><h4 id="2-ParNew-æ”¶é›†å™¨"><a href="#2-ParNew-æ”¶é›†å™¨" class="headerlink" title="2. ParNew æ”¶é›†å™¨"></a>2. ParNew æ”¶é›†å™¨</h4><p><div align="center"> <img src="http://pic.yupoo.com/meandni/a5c6e277/481e1ca1.jpg" width=""> </div><br></p><p>å®ƒæ˜¯ Serial æ”¶é›†å™¨çš„å¤šçº¿ç¨‹ç‰ˆæœ¬ã€‚</p><p>æ˜¯ Server æ¨¡å¼ä¸‹çš„è™šæ‹Ÿæœºé¦–é€‰æ–°ç”Ÿä»£æ”¶é›†å™¨ï¼Œé™¤äº†æ€§èƒ½åŸå› å¤–ï¼Œä¸»è¦æ˜¯å› ä¸ºé™¤äº† Serial æ”¶é›†å™¨ï¼Œåªæœ‰å®ƒèƒ½ä¸ CMS æ”¶é›†å™¨é…åˆå·¥ä½œã€‚</p><p>é»˜è®¤å¼€å¯çš„çº¿ç¨‹æ•°é‡ä¸ CPU æ•°é‡ç›¸åŒï¼Œå¯ä»¥ä½¿ç”¨ -XX:ParallelGCThreads å‚æ•°æ¥è®¾ç½®çº¿ç¨‹æ•°ã€‚</p><h4 id="3-Parallel-Scavenge-æ”¶é›†å™¨"><a href="#3-Parallel-Scavenge-æ”¶é›†å™¨" class="headerlink" title="3. Parallel Scavenge æ”¶é›†å™¨"></a>3. Parallel Scavenge æ”¶é›†å™¨</h4><p>ä¸ ParNew ä¸€æ ·æ˜¯å¤šçº¿ç¨‹æ”¶é›†å™¨ã€‚</p><p>å…¶å®ƒæ”¶é›†å™¨å…³æ³¨ç‚¹æ˜¯å°½å¯èƒ½ç¼©çŸ­åƒåœ¾æ”¶é›†æ—¶ç”¨æˆ·çº¿ç¨‹çš„åœé¡¿æ—¶é—´ï¼Œè€Œå®ƒçš„ç›®æ ‡æ˜¯è¾¾åˆ°ä¸€ä¸ªå¯æ§åˆ¶çš„ååé‡ï¼Œå®ƒè¢«ç§°ä¸ºâ€œååé‡ä¼˜å…ˆâ€æ”¶é›†å™¨ã€‚è¿™é‡Œçš„ååé‡æŒ‡ CPU ç”¨äºè¿è¡Œç”¨æˆ·ä»£ç çš„æ—¶é—´å æ€»æ—¶é—´çš„æ¯”å€¼ã€‚</p><p>åœé¡¿æ—¶é—´è¶ŠçŸ­å°±è¶Šé€‚åˆéœ€è¦ä¸ç”¨æˆ·äº¤äº’çš„ç¨‹åºï¼Œè‰¯å¥½çš„å“åº”é€Ÿåº¦èƒ½æå‡ç”¨æˆ·ä½“éªŒã€‚è€Œé«˜ååé‡åˆ™å¯ä»¥é«˜æ•ˆç‡åœ°åˆ©ç”¨ CPU æ—¶é—´ï¼Œå°½å¿«å®Œæˆç¨‹åºçš„è¿ç®—ä»»åŠ¡ï¼Œé€‚åˆåœ¨åå°è¿ç®—è€Œä¸éœ€è¦å¤ªå¤šäº¤äº’çš„ä»»åŠ¡ã€‚</p><p>ç¼©çŸ­åœé¡¿æ—¶é—´æ˜¯ä»¥ç‰ºç‰²ååé‡å’Œæ–°ç”Ÿä»£ç©ºé—´æ¥æ¢å–çš„ï¼šæ–°ç”Ÿä»£ç©ºé—´å˜å°ï¼Œåƒåœ¾å›æ”¶å˜å¾—é¢‘ç¹ï¼Œå¯¼è‡´ååé‡ä¸‹é™ã€‚</p><p>å¯ä»¥é€šè¿‡ä¸€ä¸ªå¼€å…³å‚æ•°æ‰“å¼€ GC è‡ªé€‚åº”çš„è°ƒèŠ‚ç­–ç•¥ï¼ˆGC Ergonomicsï¼‰ï¼Œå°±ä¸éœ€è¦æ‰‹å·¥æŒ‡å®šæ–°ç”Ÿä»£çš„å¤§å°ï¼ˆ-Xmnï¼‰ã€Eden å’Œ Survivor åŒºçš„æ¯”ä¾‹ã€æ™‹å‡è€å¹´ä»£å¯¹è±¡å¹´é¾„ç­‰ç»†èŠ‚å‚æ•°äº†ã€‚è™šæ‹Ÿæœºä¼šæ ¹æ®å½“å‰ç³»ç»Ÿçš„è¿è¡Œæƒ…å†µæ”¶é›†æ€§èƒ½ç›‘æ§ä¿¡æ¯ï¼ŒåŠ¨æ€è°ƒæ•´è¿™äº›å‚æ•°ä»¥æä¾›æœ€åˆé€‚çš„åœé¡¿æ—¶é—´æˆ–è€…æœ€å¤§çš„ååé‡ã€‚</p><h4 id="4-Serial-Old-æ”¶é›†å™¨"><a href="#4-Serial-Old-æ”¶é›†å™¨" class="headerlink" title="4. Serial Old æ”¶é›†å™¨"></a>4. Serial Old æ”¶é›†å™¨</h4><p><div align="center"> <img src="http://pic.yupoo.com/meandni/14f72c5c/367020d3.jpg" width=""> </div><br></p><p>æ˜¯ Serial æ”¶é›†å™¨çš„è€å¹´ä»£ç‰ˆæœ¬ï¼Œä¹Ÿæ˜¯ç»™ Client æ¨¡å¼ä¸‹çš„è™šæ‹Ÿæœºä½¿ç”¨ã€‚å¦‚æœç”¨åœ¨ Server æ¨¡å¼ä¸‹ï¼Œå®ƒæœ‰ä¸¤å¤§ç”¨é€”ï¼š</p><ul><li>åœ¨ JDK 1.5 ä»¥åŠä¹‹å‰ç‰ˆæœ¬ï¼ˆParallel Old è¯ç”Ÿä»¥å‰ï¼‰ä¸­ä¸ Parallel Scavenge æ”¶é›†å™¨æ­é…ä½¿ç”¨ã€‚</li><li>ä½œä¸º CMS æ”¶é›†å™¨çš„åå¤‡é¢„æ¡ˆï¼Œåœ¨å¹¶å‘æ”¶é›†å‘ç”Ÿ Concurrent Mode Failure æ—¶ä½¿ç”¨ã€‚</li></ul><h4 id="5-Parallel-Old-æ”¶é›†å™¨"><a href="#5-Parallel-Old-æ”¶é›†å™¨" class="headerlink" title="5. Parallel Old æ”¶é›†å™¨"></a>5. Parallel Old æ”¶é›†å™¨</h4><p><div align="center"> <img src="http://pic.yupoo.com/meandni/2d1989e5/6e965e83.jpg" width=""> </div><br></p><p>æ˜¯ Parallel Scavenge æ”¶é›†å™¨çš„è€å¹´ä»£ç‰ˆæœ¬ã€‚</p><p>åœ¨æ³¨é‡ååé‡ä»¥åŠ CPU èµ„æºæ•æ„Ÿçš„åœºåˆï¼Œéƒ½å¯ä»¥ä¼˜å…ˆè€ƒè™‘ Parallel Scavenge åŠ  Parallel Old æ”¶é›†å™¨ã€‚</p><h4 id="6-CMS-æ”¶é›†å™¨"><a href="#6-CMS-æ”¶é›†å™¨" class="headerlink" title="6. CMS æ”¶é›†å™¨"></a>6. CMS æ”¶é›†å™¨</h4><p><div align="center"> <img src="http://pic.yupoo.com/meandni/14f72c5c/367020d3.jpg" width=""> </div><br></p><p>CMSï¼ˆConcurrent Mark Sweepï¼‰ï¼ŒMark Sweep æŒ‡çš„æ˜¯æ ‡è®° - æ¸…é™¤ç®—æ³•ã€‚</p><p>åˆ†ä¸ºä»¥ä¸‹å››ä¸ªæµç¨‹ï¼š</p><ul><li>åˆå§‹æ ‡è®°ï¼šä»…ä»…åªæ˜¯æ ‡è®°ä¸€ä¸‹ GC Roots èƒ½ç›´æ¥å…³è”åˆ°çš„å¯¹è±¡ï¼Œé€Ÿåº¦å¾ˆå¿«ï¼Œéœ€è¦åœé¡¿ã€‚</li><li>å¹¶å‘æ ‡è®°ï¼šè¿›è¡Œ GC Roots Tracing çš„è¿‡ç¨‹ï¼Œå®ƒåœ¨æ•´ä¸ªå›æ”¶è¿‡ç¨‹ä¸­è€—æ—¶æœ€é•¿ï¼Œä¸éœ€è¦åœé¡¿ã€‚</li><li>é‡æ–°æ ‡è®°ï¼šä¸ºäº†ä¿®æ­£å¹¶å‘æ ‡è®°æœŸé—´å› ç”¨æˆ·ç¨‹åºç»§ç»­è¿ä½œè€Œå¯¼è‡´æ ‡è®°äº§ç”Ÿå˜åŠ¨çš„é‚£ä¸€éƒ¨åˆ†å¯¹è±¡çš„æ ‡è®°è®°å½•ï¼Œéœ€è¦åœé¡¿ã€‚</li><li>å¹¶å‘æ¸…é™¤ï¼šä¸éœ€è¦åœé¡¿ã€‚</li></ul><p>åœ¨æ•´ä¸ªè¿‡ç¨‹ä¸­è€—æ—¶æœ€é•¿çš„å¹¶å‘æ ‡è®°å’Œå¹¶å‘æ¸…é™¤è¿‡ç¨‹ä¸­ï¼Œæ”¶é›†å™¨çº¿ç¨‹éƒ½å¯ä»¥ä¸ç”¨æˆ·çº¿ç¨‹ä¸€èµ·å·¥ä½œï¼Œä¸éœ€è¦è¿›è¡Œåœé¡¿ã€‚</p><p>å…·æœ‰ä»¥ä¸‹ç¼ºç‚¹ï¼š</p><ul><li>ååé‡ä½ï¼šä½åœé¡¿æ—¶é—´æ˜¯ä»¥ç‰ºç‰²ååé‡ä¸ºä»£ä»·çš„ï¼Œå¯¼è‡´ CPU åˆ©ç”¨ç‡ä¸å¤Ÿé«˜ã€‚</li><li>æ— æ³•å¤„ç†æµ®åŠ¨åƒåœ¾ï¼Œå¯èƒ½å‡ºç° Concurrent Mode Failureã€‚æµ®åŠ¨åƒåœ¾æ˜¯æŒ‡å¹¶å‘æ¸…é™¤é˜¶æ®µç”±äºç”¨æˆ·çº¿ç¨‹ç»§ç»­è¿è¡Œè€Œäº§ç”Ÿçš„åƒåœ¾ï¼Œè¿™éƒ¨åˆ†åƒåœ¾åªèƒ½åˆ°ä¸‹ä¸€æ¬¡ GC æ—¶æ‰èƒ½è¿›è¡Œå›æ”¶ã€‚ç”±äºæµ®åŠ¨åƒåœ¾çš„å­˜åœ¨ï¼Œå› æ­¤éœ€è¦é¢„ç•™å‡ºä¸€éƒ¨åˆ†å†…å­˜ï¼Œæ„å‘³ç€ CMS æ”¶é›†ä¸èƒ½åƒå…¶å®ƒæ”¶é›†å™¨é‚£æ ·ç­‰å¾…è€å¹´ä»£å¿«æ»¡çš„æ—¶å€™å†å›æ”¶ã€‚å¦‚æœé¢„ç•™çš„å†…å­˜ä¸å¤Ÿå­˜æ”¾æµ®åŠ¨åƒåœ¾ï¼Œå°±ä¼šå‡ºç° Concurrent Mode Failureï¼Œè¿™æ—¶è™šæ‹Ÿæœºå°†ä¸´æ—¶å¯ç”¨ Serial Old æ¥æ›¿ä»£ CMSã€‚</li><li>æ ‡è®° - æ¸…é™¤ç®—æ³•å¯¼è‡´çš„ç©ºé—´ç¢ç‰‡ï¼Œå¾€å¾€å‡ºç°è€å¹´ä»£ç©ºé—´å‰©ä½™ï¼Œä½†æ— æ³•æ‰¾åˆ°è¶³å¤Ÿå¤§è¿ç»­ç©ºé—´æ¥åˆ†é…å½“å‰å¯¹è±¡ï¼Œä¸å¾—ä¸æå‰è§¦å‘ä¸€æ¬¡ Full GCã€‚</li></ul><h4 id="7-G1-æ”¶é›†å™¨"><a href="#7-G1-æ”¶é›†å™¨" class="headerlink" title="7. G1 æ”¶é›†å™¨"></a>7. G1 æ”¶é›†å™¨</h4><p>G1ï¼ˆGarbage-Firstï¼‰ï¼Œå®ƒæ˜¯ä¸€æ¬¾é¢å‘æœåŠ¡ç«¯åº”ç”¨çš„åƒåœ¾æ”¶é›†å™¨ï¼Œåœ¨å¤š CPU å’Œå¤§å†…å­˜çš„åœºæ™¯ä¸‹æœ‰å¾ˆå¥½çš„æ€§èƒ½ã€‚HotSpot å¼€å‘å›¢é˜Ÿèµ‹äºˆå®ƒçš„ä½¿å‘½æ˜¯æœªæ¥å¯ä»¥æ›¿æ¢æ‰ CMS æ”¶é›†å™¨ã€‚</p><p>å †è¢«åˆ†ä¸ºæ–°ç”Ÿä»£å’Œè€å¹´ä»£ï¼Œå…¶å®ƒæ”¶é›†å™¨è¿›è¡Œæ”¶é›†çš„èŒƒå›´éƒ½æ˜¯æ•´ä¸ªæ–°ç”Ÿä»£æˆ–è€…è€å¹´ä»£ï¼Œè€Œ G1 å¯ä»¥ç›´æ¥å¯¹æ–°ç”Ÿä»£å’Œè€å¹´ä»£ä¸€èµ·å›æ”¶ã€‚</p><p><div align="center"> <img src="http://pic.yupoo.com/meandni/400d294e/1d022e13.png" width="600"> </div><br></p><p>G1 æŠŠå †åˆ’åˆ†æˆå¤šä¸ªå¤§å°ç›¸ç­‰çš„ç‹¬ç«‹åŒºåŸŸï¼ˆRegionï¼‰ï¼Œæ–°ç”Ÿä»£å’Œè€å¹´ä»£ä¸å†ç‰©ç†éš”ç¦»ã€‚</p><p><div align="center"> <img src="http://pic.yupoo.com/meandni/5393369d/5f8cbd42.png" width="600"> </div><br></p><p>é€šè¿‡å¼•å…¥ Region çš„æ¦‚å¿µï¼Œä»è€Œå°†åŸæ¥çš„ä¸€æ•´å—å†…å­˜ç©ºé—´åˆ’åˆ†æˆå¤šä¸ªçš„å°ç©ºé—´ï¼Œä½¿å¾—æ¯ä¸ªå°ç©ºé—´å¯ä»¥å•ç‹¬è¿›è¡Œåƒåœ¾å›æ”¶ã€‚è¿™ç§åˆ’åˆ†æ–¹æ³•å¸¦æ¥äº†å¾ˆå¤§çš„çµæ´»æ€§ï¼Œä½¿å¾—å¯é¢„æµ‹çš„åœé¡¿æ—¶é—´æ¨¡å‹æˆä¸ºå¯èƒ½ã€‚é€šè¿‡è®°å½•æ¯ä¸ª Region åƒåœ¾å›æ”¶æ—¶é—´ä»¥åŠå›æ”¶æ‰€è·å¾—çš„ç©ºé—´ï¼ˆè¿™ä¸¤ä¸ªå€¼æ˜¯é€šè¿‡è¿‡å»å›æ”¶çš„ç»éªŒè·å¾—ï¼‰ï¼Œå¹¶ç»´æŠ¤ä¸€ä¸ªä¼˜å…ˆåˆ—è¡¨ï¼Œæ¯æ¬¡æ ¹æ®å…è®¸çš„æ”¶é›†æ—¶é—´ï¼Œä¼˜å…ˆå›æ”¶ä»·å€¼æœ€å¤§çš„ Regionã€‚</p><p>æ¯ä¸ª Region éƒ½æœ‰ä¸€ä¸ª Remembered Setï¼Œç”¨æ¥è®°å½•è¯¥ Region å¯¹è±¡çš„å¼•ç”¨å¯¹è±¡æ‰€åœ¨çš„ Regionã€‚é€šè¿‡ä½¿ç”¨ Remembered Setï¼Œåœ¨åšå¯è¾¾æ€§åˆ†æçš„æ—¶å€™å°±å¯ä»¥é¿å…å…¨å †æ‰«æã€‚</p><p><div align="center"> <img src="http://pic.yupoo.com/meandni/ce8ef9fc/10c8999f.jpg" width=""> </div><br></p><p>å¦‚æœä¸è®¡ç®—ç»´æŠ¤ Remembered Set çš„æ“ä½œï¼ŒG1 æ”¶é›†å™¨çš„è¿ä½œå¤§è‡´å¯åˆ’åˆ†ä¸ºä»¥ä¸‹å‡ ä¸ªæ­¥éª¤ï¼š</p><ul><li>åˆå§‹æ ‡è®°</li><li>å¹¶å‘æ ‡è®°</li><li>æœ€ç»ˆæ ‡è®°ï¼šä¸ºäº†ä¿®æ­£åœ¨å¹¶å‘æ ‡è®°æœŸé—´å› ç”¨æˆ·ç¨‹åºç»§ç»­è¿ä½œè€Œå¯¼è‡´æ ‡è®°äº§ç”Ÿå˜åŠ¨çš„é‚£ä¸€éƒ¨åˆ†æ ‡è®°è®°å½•ï¼Œè™šæ‹Ÿæœºå°†è¿™æ®µæ—¶é—´å¯¹è±¡å˜åŒ–è®°å½•åœ¨çº¿ç¨‹çš„ Remembered Set Logs é‡Œé¢ï¼Œæœ€ç»ˆæ ‡è®°é˜¶æ®µéœ€è¦æŠŠ Remembered Set Logs çš„æ•°æ®åˆå¹¶åˆ° Remembered Set ä¸­ã€‚è¿™é˜¶æ®µéœ€è¦åœé¡¿çº¿ç¨‹ï¼Œä½†æ˜¯å¯å¹¶è¡Œæ‰§è¡Œã€‚</li><li>ç­›é€‰å›æ”¶ï¼šé¦–å…ˆå¯¹å„ä¸ª Region ä¸­çš„å›æ”¶ä»·å€¼å’Œæˆæœ¬è¿›è¡Œæ’åºï¼Œæ ¹æ®ç”¨æˆ·æ‰€æœŸæœ›çš„ GC åœé¡¿æ—¶é—´æ¥åˆ¶å®šå›æ”¶è®¡åˆ’ã€‚æ­¤é˜¶æ®µå…¶å®ä¹Ÿå¯ä»¥åšåˆ°ä¸ç”¨æˆ·ç¨‹åºä¸€èµ·å¹¶å‘æ‰§è¡Œï¼Œä½†æ˜¯å› ä¸ºåªå›æ”¶ä¸€éƒ¨åˆ† Regionï¼Œæ—¶é—´æ˜¯ç”¨æˆ·å¯æ§åˆ¶çš„ï¼Œè€Œä¸”åœé¡¿ç”¨æˆ·çº¿ç¨‹å°†å¤§å¹…åº¦æé«˜æ”¶é›†æ•ˆç‡ã€‚</li></ul><p>å…·å¤‡å¦‚ä¸‹ç‰¹ç‚¹ï¼š</p><ul><li>ç©ºé—´æ•´åˆï¼šæ•´ä½“æ¥çœ‹æ˜¯åŸºäºâ€œæ ‡è®° - æ•´ç†â€ç®—æ³•å®ç°çš„æ”¶é›†å™¨ï¼Œä»å±€éƒ¨ï¼ˆä¸¤ä¸ª Region ä¹‹é—´ï¼‰ä¸Šæ¥çœ‹æ˜¯åŸºäºâ€œå¤åˆ¶â€ç®—æ³•å®ç°çš„ï¼Œè¿™æ„å‘³ç€è¿è¡ŒæœŸé—´ä¸ä¼šäº§ç”Ÿå†…å­˜ç©ºé—´ç¢ç‰‡ã€‚</li><li>å¯é¢„æµ‹çš„åœé¡¿ï¼šèƒ½è®©ä½¿ç”¨è€…æ˜ç¡®æŒ‡å®šåœ¨ä¸€ä¸ªé•¿åº¦ä¸º M æ¯«ç§’çš„æ—¶é—´ç‰‡æ®µå†…ï¼Œæ¶ˆè€—åœ¨ GC ä¸Šçš„æ—¶é—´ä¸å¾—è¶…è¿‡ N æ¯«ç§’ã€‚</li></ul><h1 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h1><table><thead><tr><th style="text-align:center"></th><th style="text-align:center">æ”¶é›†å™¨</th><th style="text-align:center">ä¸²è¡Œã€å¹¶è¡Œorå¹¶å‘</th><th style="text-align:center">æ–°ç”Ÿä»£/è€å¹´ä»£</th><th style="text-align:center">ç®—æ³•</th><th style="text-align:center">ç›®æ ‡</th><th>é€‚ç”¨åœºæ™¯</th></tr></thead><tbody><tr><td style="text-align:center"></td><td style="text-align:center"><strong>Serial</strong></td><td style="text-align:center">ä¸²è¡Œ</td><td style="text-align:center">æ–°ç”Ÿä»£</td><td style="text-align:center">å¤åˆ¶ç®—æ³•</td><td style="text-align:center">å“åº”é€Ÿåº¦ä¼˜å…ˆ</td><td>å•CPUç¯å¢ƒä¸‹çš„Clientæ¨¡å¼</td><td></td></tr><tr><td style="text-align:center"></td><td style="text-align:center"><strong>Serial Old</strong></td><td style="text-align:center">ä¸²è¡Œ</td><td style="text-align:center">è€å¹´ä»£</td><td style="text-align:center">æ ‡è®°-æ•´ç†</td><td style="text-align:center">å“åº”é€Ÿåº¦ä¼˜å…ˆ</td><td>å•CPUç¯å¢ƒä¸‹çš„Clientæ¨¡å¼ã€CMSçš„åå¤‡é¢„æ¡ˆ</td><td></td></tr><tr><td style="text-align:center"></td><td style="text-align:center"><strong>ParNew</strong></td><td style="text-align:center">å¹¶è¡Œ</td><td style="text-align:center">æ–°ç”Ÿä»£</td><td style="text-align:center">å¤åˆ¶ç®—æ³•</td><td style="text-align:center">å“åº”é€Ÿåº¦ä¼˜å…ˆ</td><td>å¤šCPUç¯å¢ƒæ—¶åœ¨Serveræ¨¡å¼ä¸‹ä¸CMSé…åˆ</td><td></td></tr><tr><td style="text-align:center"></td><td style="text-align:center"><strong>Parallel Scavenge</strong></td><td style="text-align:center">å¹¶è¡Œ</td><td style="text-align:center">æ–°ç”Ÿä»£</td><td style="text-align:center">å¤åˆ¶ç®—æ³•</td><td style="text-align:center">ååé‡ä¼˜å…ˆ</td><td>åœ¨åå°è¿ç®—è€Œä¸éœ€è¦å¤ªå¤šäº¤äº’çš„ä»»åŠ¡</td><td></td></tr><tr><td style="text-align:center"></td><td style="text-align:center"><strong>Parallel Old</strong></td><td style="text-align:center">å¹¶è¡Œ</td><td style="text-align:center">è€å¹´ä»£</td><td style="text-align:center">æ ‡è®°-æ•´ç†</td><td style="text-align:center">ååé‡ä¼˜å…ˆ</td><td>åœ¨åå°è¿ç®—è€Œä¸éœ€è¦å¤ªå¤šäº¤äº’çš„ä»»åŠ¡</td><td></td></tr><tr><td style="text-align:center"></td><td style="text-align:center"><strong>CMS</strong></td><td style="text-align:center">å¹¶å‘</td><td style="text-align:center">è€å¹´ä»£</td><td style="text-align:center">æ ‡è®°-æ¸…é™¤</td><td style="text-align:center">å“åº”é€Ÿåº¦ä¼˜å…ˆ</td><td>é›†ä¸­åœ¨äº’è”ç½‘ç«™æˆ–B/Sç³»ç»ŸæœåŠ¡ç«¯ä¸Šçš„Javaåº”ç”¨</td><td></td></tr><tr><td style="text-align:center"></td><td style="text-align:center"><strong>G1</strong></td><td style="text-align:center">å¹¶å‘</td><td style="text-align:center">both</td><td style="text-align:center">æ ‡è®°-æ•´ç†+å¤åˆ¶ç®—æ³•</td><td style="text-align:center">å“åº”é€Ÿåº¦ä¼˜å…ˆ</td><td>é¢å‘æœåŠ¡ç«¯åº”ç”¨ï¼Œå°†æ¥æ›¿æ¢CMS</td><td></td></tr></tbody></table><h1 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h1><ul><li><a href="https://book.douban.com/subject/24722612/" target="_blank" rel="noopener">ã€Šæ·±å…¥ç†è§£Javaè™šæ‹Ÿæœºâ€”â€”JVMé«˜çº§ç‰¹æ€§ä¸æœ€ä½³å®è·µã€‹ï¼å‘¨å¿—æ˜</a></li><li><a href="https://github.com/CyC2018/CS-Notes/blob/master/docs/notes/Java%20%E8%99%9A%E6%8B%9F%E6%9C%BA.md" target="_blank" rel="noopener">CS-Noteâ€”â€”Javaï¼šjavaè™šæ‹Ÿæœº</a></li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;blockquote&gt;
&lt;p&gt;&lt;a href=&quot;https://meandni.com/2019/01/05/winter_vacation/&quot;&gt;2019å¤§ä¸‰çš„å¯’å‡è®¡åˆ’&lt;/a&gt;â€”â€”åˆ©ç”¨åœ¨å…¬å¸æ¯å¤©æ—©èµ·çš„æ—¶é—´è¯»ä¹¦ï¼Œç¬¬ä¸€æœ¬æ˜¯å‘¨å¿—æ˜è€å¸ˆçš„ã€Šæ·±å…¥ç†è§£Javaè™šæ‹Ÿæœºâ€”â€”JVMé«˜çº§ç‰¹æ€§ä¸æœ€ä½³
      
    
    </summary>
    
      <category term="æ•´ç†" scheme="https://meandni.com/categories/%E6%95%B4%E7%90%86/"/>
    
    
      <category term="è¯»ä¹¦" scheme="https://meandni.com/tags/%E8%AF%BB%E4%B9%A6/"/>
    
      <category term="jvm" scheme="https://meandni.com/tags/jvm/"/>
    
  </entry>
  
  <entry>
    <title>ã€Šæ·±å…¥ç†è§£javaè™šæ‹Ÿæœºã€‹ç¬”è®°2â€”â€”GCç®—æ³•ä¸å†…å­˜åˆ†é…ç­–ç•¥</title>
    <link href="https://meandni.com/2019/01/11/jvm_note2/"/>
    <id>https://meandni.com/2019/01/11/jvm_note2/</id>
    <published>2019-01-11T03:16:01.000Z</published>
    <updated>2019-02-22T03:50:47.691Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p><a href="https://meandni.com/2019/01/05/winter_vacation/">2019å¤§ä¸‰çš„å¯’å‡è®¡åˆ’</a>â€”â€”åˆ©ç”¨åœ¨å…¬å¸æ¯å¤©æ—©èµ·çš„æ—¶é—´è¯»ä¹¦ï¼Œç¬¬ä¸€æœ¬æ˜¯å‘¨å¿—æ˜è€å¸ˆçš„ã€Šæ·±å…¥ç†è§£Javaè™šæ‹Ÿæœºâ€”â€”JVMé«˜çº§ç‰¹æ€§ä¸æœ€ä½³å®è·µã€‹ï¼Œè¿™ä¸€ç³»åˆ—æ˜¯é€šè¿‡å¯¹åŸæ–‡çš„æ‹œè¯»ä¸è‡ªå·±ç†è§£åŠ ä¸Šç½‘ç»œä¸Šçš„èµ„æ–™æ–‡ç« æ•´ç†å‡ºçš„è¯»ä¹¦ç¬”è®°ã€‚</p></blockquote><p>è¯´èµ·<strong>åƒåœ¾æ”¶é›†ï¼ˆGarbage Collection, GCï¼‰</strong>ï¼Œæƒ³å¿…å¤§å®¶éƒ½ä¸é™Œç”Ÿï¼Œå®ƒæ˜¯JVMå®ç°é‡Œéå¸¸é‡è¦çš„ä¸€ç¯ï¼ŒJVMæˆç†Ÿçš„å†…å­˜åŠ¨æ€åˆ†é…ä¸å›æ”¶æŠ€æœ¯ä½¿Javaï¼ˆå½“ç„¶è¿˜æœ‰å…¶ä»–è¿è¡Œåœ¨JVMä¸Šçš„è¯­è¨€ï¼Œå¦‚Scalaç­‰ï¼‰ç¨‹åºå‘˜åœ¨æå‡å¼€å‘æ•ˆç‡ä¸Šè·å¾—äº†æƒŠäººçš„ä¾¿åˆ©ã€‚ç†è§£GCï¼Œå¯¹äºç†è§£JVMå’ŒJavaè¯­è¨€æœ‰ç€éå¸¸é‡è¦çš„ä½œç”¨ã€‚å¹¶ä¸”å½“æˆ‘ä»¬éœ€è¦æ’æŸ¥å„ç§å†…å­˜æº¢å‡ºã€å†…å­˜æ³„æ¼é—®é¢˜æ—¶ï¼Œå½“åƒåœ¾æ”¶é›†ç§°ä¸ºç³»ç»Ÿè¾¾åˆ°æ›´é«˜å¹¶å‘é‡çš„ç“¶é¢ˆæ—¶ï¼Œåªæœ‰æ·±å…¥ç†è§£GCå’Œå†…å­˜åˆ†é…ï¼Œæ‰èƒ½å¯¹è¿™äº›â€œè‡ªåŠ¨åŒ–â€çš„æŠ€æœ¯å®æ–½å¿…è¦çš„ç›‘æ§å’Œè°ƒèŠ‚ã€‚</p><p>åœ¨Javaçš„è¿è¡Œæ—¶æ•°æ®åŒºä¸­ï¼Œç¨‹åºè®¡æ•°å™¨ã€è™šæ‹Ÿæœºæ ˆã€æœ¬åœ°æ–¹æ³•æ ˆä¸‰ä¸ªåŒºåŸŸéƒ½æ˜¯çº¿ç¨‹ç§æœ‰çš„ï¼Œéšçº¿ç¨‹è€Œç”Ÿï¼Œéšçº¿ç¨‹è€Œç­ï¼Œåœ¨æ–¹æ³•ç»“æŸæˆ–çº¿ç¨‹ç»“æŸæ—¶ï¼Œå†…å­˜è‡ªç„¶å°±è·Ÿç€å›æ”¶äº†ï¼Œä¸éœ€è¦è¿‡å¤šè€ƒè™‘å›æ”¶çš„é—®é¢˜ã€‚è€Œ<strong>Javaå †</strong>å’Œ<strong>æ–¹æ³•åŒº</strong>åˆ™ä¸ä¸€æ ·ï¼Œä¸€ä¸ªæ¥å£ä¸­çš„å¤šä¸ªå®ç°ç±»éœ€è¦çš„å†…å­˜å¯èƒ½ä¸ä¸€æ ·ï¼Œä¸€ä¸ªæ–¹æ³•ä¸­çš„å¤šä¸ªåˆ†æ”¯éœ€è¦çš„å†…å­˜ä¹Ÿå¯èƒ½ä¸ä¸€æ ·ï¼Œæˆ‘ä»¬åªæœ‰åœ¨ç¨‹åºå¤„äºè¿è¡ŒæœŸé—´æ‰èƒ½çŸ¥é“ä¼šåˆ›å»ºå“ªäº›å¯¹è±¡ï¼Œè¿™éƒ¨åˆ†å†…å­˜çš„åˆ†é…å’Œå›æ”¶éƒ½æ˜¯åŠ¨æ€çš„ï¼Œåƒåœ¾å›æ”¶å™¨å…³æ³¨çš„æ˜¯è¿™éƒ¨åˆ†å†…å­˜ï¼Œåç»­è®¨è®ºçš„â€œå†…å­˜â€åˆ†é…å›æ”¶ä¹Ÿæ˜¯æŒ‡è¿™ä¸€å—ï¼Œå°¤å…¶éœ€è¦æ³¨æ„ã€‚</p><p>GCä¸»è¦å›ç­”äº†ä»¥ä¸‹ä¸‰ä¸ªé—®é¢˜ï¼š</p><ul><li>å“ªäº›å†…å­˜éœ€è¦å›æ”¶ï¼Ÿ</li><li>ä»€ä¹ˆæ—¶å€™å›æ”¶ï¼Ÿ</li><li>å¦‚ä½•å›æ”¶ï¼Ÿ</li></ul><p>è¿™ä¸‰ä¸ªé—®é¢˜çš„å…·ä½“è§£å†³æ–¹æ¡ˆï¼Œä¹Ÿå°±æ˜¯æœ¬æ–‡æ¥ä¸‹æ¥è¦è®²è§£çš„å†…å®¹ã€‚</p><h1 id="å¯¹è±¡å·²æ­»å—ï¼Ÿ"><a href="#å¯¹è±¡å·²æ­»å—ï¼Ÿ" class="headerlink" title="å¯¹è±¡å·²æ­»å—ï¼Ÿ"></a>å¯¹è±¡å·²æ­»å—ï¼Ÿ</h1><p>åœ¨å †é‡Œå­˜æ”¾ç€Javaä¸–ç•Œä¸­å‡ ä¹æ‰€æœ‰çš„å¯¹è±¡å®ä¾‹ï¼Œåƒåœ¾æ”¶é›†å™¨åœ¨å¯¹å †è¿›è¡Œå›æ”¶å‰ï¼Œé¦–è¦çš„å°±æ˜¯ç¡®å®šè¿™äº›å¯¹è±¡ä¸­å“ªäº›è¿˜â€œå­˜æ´»â€ç€ï¼Œå“ªäº›å·²ç»â€œæ­»å»â€ï¼ˆå³ä¸å¯èƒ½å†è¢«ä»»ä½•é€”å¾„ä½¿ç”¨çš„å¯¹è±¡ï¼‰ã€‚</p><h4 id="å¼•ç”¨è®¡æ•°ç®—æ³•"><a href="#å¼•ç”¨è®¡æ•°ç®—æ³•" class="headerlink" title="å¼•ç”¨è®¡æ•°ç®—æ³•"></a>å¼•ç”¨è®¡æ•°ç®—æ³•</h4><p>å¼•ç”¨è®¡æ•°ç®—æ³•æ˜¯åœ¨JVMä¸­è¢«æ‘’å¼ƒçš„ä¸€ç§å¯¹è±¡å­˜æ´»åˆ¤å®šç®—æ³•ï¼Œä¸è¿‡å®ƒä¹Ÿæœ‰ä¸€äº›çŸ¥åçš„åº”ç”¨åœºæ™¯ï¼ˆå¦‚Pythonã€FlashPlayerï¼‰ï¼Œå› æ­¤åœ¨è¿™é‡Œä¹Ÿç®€å•ä»‹ç»ä¸€ä¸‹ã€‚</p><p>ç”¨å¼•ç”¨è®¡æ•°å™¨åˆ¤æ–­å¯¹è±¡æ˜¯å¦å­˜æ´»çš„è¿‡ç¨‹æ˜¯è¿™æ ·çš„ï¼š<strong>ç»™å¯¹è±¡ä¸­æ·»åŠ ä¸€ä¸ªå¼•ç”¨è®¡æ•°å™¨ï¼Œæ¯å½“æœ‰ä¸€ä¸ªåœ°æ–¹å¼•ç”¨å®ƒæ—¶ï¼Œè®¡æ•°å™¨åŠ 1ï¼›å½“å¼•ç”¨å¤±æ•ˆæ—¶ï¼Œè®¡æ•°å™¨å‡1ï¼›ä»»ä½•æ—¶åˆ»è®¡æ•°å™¨ä¸º0çš„å¯¹è±¡å°±æ˜¯ä¸å¯èƒ½å†è¢«ä½¿ç”¨çš„ã€‚</strong></p><p>å¼•ç”¨è®¡æ•°ç®—æ³•çš„å®ç°ç®€å•ï¼Œåˆ¤å®šæ•ˆç‡ä¹Ÿå¾ˆé«˜ï¼Œå¤§éƒ¨åˆ†æƒ…å†µä¸‹æ˜¯ä¸€ä¸ªä¸é”™çš„ç®—æ³•ã€‚å®ƒæ²¡æœ‰è¢«JVMé‡‡ç”¨çš„åŸå› æ˜¯<strong>å®ƒå¾ˆéš¾è§£å†³å¯¹è±¡ä¹‹é—´å¾ªç¯å¼•ç”¨çš„é—®é¢˜</strong>ã€‚ä¾‹å¦‚ä»¥ä¸‹ä¾‹å­ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * testGC()æ–¹æ³•æ‰§è¡Œåï¼ŒobjAå’ŒobjBä¼šä¸ä¼šè¢«GCå‘¢ï¼Ÿ </span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ReferenceCountingGC</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Object instance = <span class="keyword">null</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> _1MB = <span class="number">1024</span> * <span class="number">1024</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è¿™ä¸ªæˆå‘˜å±æ€§çš„å”¯ä¸€æ„ä¹‰å°±æ˜¯å ç‚¹å†…å­˜ï¼Œä»¥ä¾¿åœ¨èƒ½åœ¨GCæ—¥å¿—ä¸­çœ‹æ¸…æ¥šæ˜¯å¦æœ‰å›æ”¶è¿‡</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">byte</span>[] bigSize = <span class="keyword">new</span> <span class="keyword">byte</span>[<span class="number">2</span> * _1MB];</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">testGC</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        ReferenceCountingGC objA = <span class="keyword">new</span> ReferenceCountingGC();</span><br><span class="line">        ReferenceCountingGC objB = <span class="keyword">new</span> ReferenceCountingGC();</span><br><span class="line">        objA.instance = objB;</span><br><span class="line">        objB.instance = objA;</span><br><span class="line"></span><br><span class="line">        objA = <span class="keyword">null</span>;</span><br><span class="line">        objB = <span class="keyword">null</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// å‡è®¾åœ¨è¿™è¡Œå‘ç”ŸGCï¼ŒobjAå’ŒobjBæ˜¯å¦èƒ½è¢«å›æ”¶ï¼Ÿ</span></span><br><span class="line">        System.gc();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åœ¨ä¸Šé¢è¿™æ®µä»£ç ä¸­ï¼Œå¯¹è±¡objA å’Œå¯¹è±¡objBéƒ½æœ‰å­—æ®µinstanceï¼Œèµ‹å€¼ä»¤<code>objA.instance = objB;</code>ã€<code>objB.instance = objA;</code>ï¼Œé™¤æ­¤ä¹‹å¤–ï¼Œè¿™ä¸¤ä¸ªå¯¹è±¡å†æ— å¼•ç”¨ã€‚å¦‚æœJVMé‡‡ç”¨å¼•ç”¨è®¡æ•°ç®—æ³•æ¥ç®¡ç†å†…å­˜ï¼Œ<strong>è¿™ä¸¤ä¸ªå¯¹è±¡ä¸å¯èƒ½å†è¢«è®¿é—®ï¼Œä½†æ˜¯ä»–ä»¬äº’ç›¸å¼•ç”¨ç€å¯¹æ–¹ï¼Œå¯¼è‡´å®ƒä»¬å¼•ç”¨è®¡æ•°ä¸ä¸º0ï¼Œæ‰€ä»¥å¼•ç”¨è®¡æ•°å™¨æ— æ³•é€šçŸ¥GCæ”¶é›†å™¨å›æ”¶å®ƒä»¬</strong>ã€‚</p><p>è€Œäº‹å®ä¸Šæ‰§è¡Œè¿™æ®µä»£ç ï¼ŒobjAå’ŒobjBæ˜¯å¯ä»¥è¢«å›æ”¶çš„ï¼Œä¸‹é¢ä¸€èŠ‚å°†ä»‹ç»JVMå®é™…ä½¿ç”¨çš„å­˜æ´»åˆ¤å®šç®—æ³•ã€‚</p><h4 id="å¯è¾¾æ€§åˆ†æç®—æ³•"><a href="#å¯è¾¾æ€§åˆ†æç®—æ³•" class="headerlink" title="å¯è¾¾æ€§åˆ†æç®—æ³•"></a>å¯è¾¾æ€§åˆ†æç®—æ³•</h4><p>åœ¨ä¸»æµå•†ç”¨ç¨‹åºè¯­è¨€çš„å®ç°ä¸­ï¼Œéƒ½æ˜¯é€šè¿‡<strong>å¯è¾¾æ€§åˆ†æï¼ˆtracing GCï¼‰</strong>æ¥åˆ¤å®šå¯¹è±¡æ˜¯å¦å­˜æ´»çš„ã€‚æ­¤ç®—æ³•çš„åŸºæœ¬æ€è·¯æ˜¯ï¼šé€šè¿‡ä¸€ç³»åˆ—çš„ç§°ä¸º<strong>â€œGC Rootsâ€</strong>çš„å¯¹è±¡ä½œä¸ºèµ·ç‚¹ï¼Œä»è¿™äº›èŠ‚ç‚¹å‘ä¸‹æœç´¢ï¼Œæœç´¢æ‰€èµ°è¿‡çš„è·¯å¾„ç§°ä¸º<strong>å¼•ç”¨é“¾ï¼ˆReference Chainï¼‰</strong>ï¼Œå½“ä¸€ä¸ªå¯¹è±¡åˆ°GC Rootsæ²¡æœ‰ä»»ä½•å¼•ç”¨é“¾ç›¸è¿ï¼ˆç”¨å›¾è®ºçš„è¯æ¥è¯´ï¼Œå°±æ˜¯GC Roots åˆ°è¿™ä¸ªå¯¹è±¡ä¸å¯è¾¾ï¼‰æ—¶ï¼Œåˆ™è¯æ˜æ­¤å¯¹è±¡æ—¶ä¸å¯ç”¨çš„ã€‚ç”¨ä¸‹å›¾æ¥åŠ ä»¥è¯´æ˜ï¼š</p><center><img src="https://pic.yupoo.com/crowhawk/5d0246eb/0635cbe8.png"></center><p>ä¸Šå›¾ä¸­ï¼Œå¯¹è±¡object 5ã€object 6ã€object 7è™½ç„¶äº’æœ‰å…³è”ï¼Œä½†æ˜¯å®ƒä»¬åˆ°GC Rootsæ˜¯ä¸å¯è¾¾çš„ï¼Œæ‰€ä»¥å®ƒä»¬å°†ä¼šè¢«åˆ¤å®šä¸ºæ˜¯å¯å›æ”¶çš„å¯¹è±¡ã€‚</p><p>å¯ä»¥çœ‹åˆ°ï¼ŒGC Rootsåœ¨å¯¹è±¡å›¾ä¹‹å¤–ï¼Œæ˜¯ç‰¹åˆ«å®šä¹‰çš„<strong>â€œèµ·ç‚¹â€</strong>ï¼Œä¸å¯èƒ½è¢«å¯¹è±¡å›¾å†…çš„å¯¹è±¡æ‰€å¼•ç”¨ã€‚</p><p>å‡†ç¡®åœ°è¯´ï¼Œ<strong>GC Rootså…¶å®ä¸æ˜¯ä¸€ç»„å¯¹è±¡ï¼Œè€Œé€šå¸¸æ˜¯ä¸€ç»„ç‰¹åˆ«ç®¡ç†çš„æŒ‡å‘å¼•ç”¨ç±»å‹å¯¹è±¡çš„æŒ‡é’ˆ</strong>ï¼Œè¿™äº›æŒ‡é’ˆæ˜¯tracing GCçš„traceçš„èµ·ç‚¹ã€‚å®ƒä»¬ä¸æ˜¯å¯¹è±¡å›¾é‡Œçš„å¯¹è±¡ï¼Œå¯¹è±¡ä¹Ÿä¸å¯èƒ½å¼•ç”¨åˆ°è¿™äº›â€œå¤–éƒ¨â€çš„æŒ‡é’ˆï¼Œè¿™ä¹Ÿæ˜¯tracing GCç®—æ³•ä¸ä¼šå‡ºç°å¾ªç¯å¼•ç”¨é—®é¢˜çš„åŸºæœ¬ä¿è¯ã€‚å› æ­¤ä¹Ÿå®¹æ˜“å¾—å‡ºï¼Œ<strong>åªæœ‰å¼•ç”¨ç±»å‹çš„å˜é‡æ‰è¢«è®¤ä¸ºæ˜¯Rootsï¼Œå€¼ç±»å‹çš„å˜é‡æ°¸è¿œä¸è¢«è®¤ä¸ºæ˜¯Roots</strong>ã€‚åªæœ‰æ·±åˆ»ç†è§£å¼•ç”¨ç±»å‹å’Œå€¼ç±»å‹çš„å†…å­˜åˆ†é…å’Œç®¡ç†çš„ä¸åŒï¼Œæ‰èƒ½çŸ¥é“ä¸ºä»€ä¹ˆrootåªèƒ½æ˜¯å¼•ç”¨ç±»å‹ã€‚</p><p>åœ¨Javaä¸­ï¼Œå¯ä½œä¸ºGC Rootsçš„å¯¹è±¡åŒ…æ‹¬ä»¥ä¸‹å‡ ç§ï¼š</p><ul><li><strong>è™šæ‹Ÿæœºæ ˆï¼ˆæ ˆå¸§ä¸­çš„å±€éƒ¨å˜é‡è¡¨ï¼ŒLocal Variable Tableï¼‰</strong>ä¸­å¼•ç”¨çš„å¯¹è±¡ã€‚</li><li><strong>æ–¹æ³•åŒºä¸­<em>ç±»é™æ€å±æ€§</em></strong>å¼•ç”¨çš„å¯¹è±¡ã€‚</li><li><strong>æ–¹æ³•åŒºä¸­<em>å¸¸é‡</em></strong>å¼•ç”¨çš„å¯¹è±¡ã€‚</li><li><strong>æœ¬åœ°æ–¹æ³•æ ˆä¸­JNIï¼ˆå³ä¸€èˆ¬è¯´çš„Nativeæ–¹æ³•ï¼‰</strong>å¼•ç”¨çš„å¯¹è±¡ã€‚</li></ul><p>çœ‹åˆ°è¿™é‡Œä½ å¯èƒ½è¦é—®ï¼Œé€‰æ‹©è¿™äº›å¯¹è±¡çš„ä¾æ®æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿ</p><p>å¯ä»¥æ¦‚æ‹¬å¾—å‡ºï¼Œå¯ä½œä¸ºGC Rootsçš„èŠ‚ç‚¹ä¸»è¦åœ¨<strong>å…¨å±€æ€§çš„å¼•ç”¨</strong>ä¸<strong>æ‰§è¡Œä¸Šä¸‹æ–‡</strong>ä¸­ã€‚è¦æ˜ç¡®çš„æ˜¯ï¼Œtracing gcå¿…é¡»<strong>ä»¥å½“å‰å­˜æ´»çš„å¯¹è±¡é›†ä¸ºRoots</strong>ï¼Œå› æ­¤å¿…é¡»é€‰å–ç¡®å®šå­˜æ´»çš„å¼•ç”¨ç±»å‹å¯¹è±¡ã€‚GCç®¡ç†çš„åŒºåŸŸæ˜¯Javaå †ï¼Œ<strong>è™šæ‹Ÿæœºæ ˆ</strong>ã€<strong>æ–¹æ³•åŒº</strong>å’Œ<strong>æœ¬åœ°æ–¹æ³•æ ˆ</strong>ä¸è¢«GCæ‰€ç®¡ç†ï¼Œå› æ­¤é€‰ç”¨è¿™äº›åŒºåŸŸå†…å¼•ç”¨çš„å¯¹è±¡ä½œä¸ºGC Rootsï¼Œæ˜¯<strong>ä¸ä¼šè¢«GCæ‰€å›æ”¶</strong>çš„ã€‚å…¶ä¸­è™šæ‹Ÿæœºæ ˆå’Œæœ¬åœ°æ–¹æ³•æ ˆéƒ½æ˜¯çº¿ç¨‹ç§æœ‰çš„å†…å­˜åŒºåŸŸï¼Œåªè¦çº¿ç¨‹æ²¡æœ‰ç»ˆæ­¢ï¼Œå°±èƒ½ç¡®ä¿å®ƒä»¬ä¸­å¼•ç”¨çš„å¯¹è±¡çš„å­˜æ´»ã€‚è€Œæ–¹æ³•åŒºä¸­ç±»é™æ€å±æ€§å¼•ç”¨çš„å¯¹è±¡æ˜¯æ˜¾ç„¶å­˜æ´»çš„ã€‚å¸¸é‡å¼•ç”¨çš„å¯¹è±¡åœ¨å½“å‰å¯èƒ½å­˜æ´»ï¼Œå› æ­¤ï¼Œä¹Ÿå¯èƒ½æ˜¯GC rootsçš„ä¸€éƒ¨åˆ†ã€‚</p><h4 id="å†è°ˆå¼•ç”¨"><a href="#å†è°ˆå¼•ç”¨" class="headerlink" title="å†è°ˆå¼•ç”¨"></a>å†è°ˆå¼•ç”¨</h4><p>æ— è®ºæ˜¯é€šè¿‡å¼•ç”¨è®¡æ•°ç®—æ³•åˆ¤æ–­å¯¹è±¡çš„å¼•ç”¨æ•°é‡ï¼Œè¿˜æ˜¯é€šè¿‡å¯è¾¾æ€§åˆ†æç®—æ³•åˆ¤æ–­å¯¹è±¡æ˜¯å¦å¯è¾¾ï¼Œåˆ¤å®šå¯¹è±¡æ˜¯å¦å¯è¢«å›æ”¶éƒ½ä¸å¼•ç”¨æœ‰å…³ã€‚åœ¨JDK1.2ä¹‹å‰ï¼ŒJavaä¸­çš„åº”ç”¨å®šä¹‰è·Ÿå¾ˆä¼ ç»Ÿï¼Œå¦‚è‹¥referenceç±»å‹çš„æ•°æ®å¼•ç”¨äº†ä¸€å—å†…å­˜åœ°å€ï¼Œåˆ™è¿™å—å†…å­˜ä»£è¡¨ä¸€ä¸ªå¼•ç”¨ï¼Œè¿™æ ·ä¸€ä¸ªå¯¹è±¡ä»…æœ‰è¢«å¼•ç”¨æˆ–æ²¡æœ‰è¢«å¼•ç”¨ä¸¤ç§çŠ¶æ€ï¼Œå¯¹äºä¸€äº›â€œ<strong>é£Ÿä¹‹æ— å‘³ï¼Œå¼ƒä¹‹å¯æƒœ</strong>â€çš„æ— æ³•æè¿°ã€‚</p><p>JDK1.2ä¹‹åï¼ŒJava æä¾›äº†å››ç§å¼ºåº¦ä¸åŒçš„å¼•ç”¨ç±»å‹ã€‚</p><h5 id="å¼ºå¼•ç”¨"><a href="#å¼ºå¼•ç”¨" class="headerlink" title="å¼ºå¼•ç”¨"></a>å¼ºå¼•ç”¨</h5><p>è¢«å¼ºå¼•ç”¨å…³è”çš„å¯¹è±¡ä¸ä¼šè¢«å›æ”¶ã€‚</p><p>ä½¿ç”¨ new ä¸€ä¸ªæ–°å¯¹è±¡çš„æ–¹å¼æ¥åˆ›å»ºå¼ºå¼•ç”¨ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Object obj = <span class="keyword">new</span> Object();</span><br></pre></td></tr></table></figure><h5 id="è½¯å¼•ç”¨"><a href="#è½¯å¼•ç”¨" class="headerlink" title="è½¯å¼•ç”¨"></a>è½¯å¼•ç”¨</h5><p>è¢«è½¯å¼•ç”¨å…³è”çš„å¯¹è±¡åªæœ‰åœ¨å†…å­˜ä¸å¤Ÿçš„æƒ…å†µä¸‹æ‰ä¼šè¢«å›æ”¶ã€‚</p><p>ä½¿ç”¨ SoftReference ç±»æ¥åˆ›å»ºè½¯å¼•ç”¨ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Object obj = <span class="keyword">new</span> Object();</span><br><span class="line">SoftReference&lt;Object&gt; sf = <span class="keyword">new</span> SoftReference&lt;Object&gt;(obj);</span><br><span class="line">obj = <span class="keyword">null</span>;  <span class="comment">// ä½¿å¯¹è±¡åªè¢«è½¯å¼•ç”¨å…³è”</span></span><br></pre></td></tr></table></figure><h5 id="å¼±å¼•ç”¨"><a href="#å¼±å¼•ç”¨" class="headerlink" title="å¼±å¼•ç”¨"></a>å¼±å¼•ç”¨</h5><p>è¢«å¼±å¼•ç”¨å…³è”çš„å¯¹è±¡ä¸€å®šä¼šè¢«å›æ”¶ï¼Œä¹Ÿå°±æ˜¯è¯´å®ƒåªèƒ½å­˜æ´»åˆ°ä¸‹ä¸€æ¬¡åƒåœ¾å›æ”¶å‘ç”Ÿä¹‹å‰ã€‚</p><p>ä½¿ç”¨ WeakReference ç±»æ¥å®ç°å¼±å¼•ç”¨ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Object obj = <span class="keyword">new</span> Object();</span><br><span class="line">WeakReference&lt;Object&gt; wf = <span class="keyword">new</span> WeakReference&lt;Object&gt;(obj);</span><br><span class="line">obj = <span class="keyword">null</span>;</span><br></pre></td></tr></table></figure><h5 id="è™šå¼•ç”¨"><a href="#è™šå¼•ç”¨" class="headerlink" title="è™šå¼•ç”¨"></a>è™šå¼•ç”¨</h5><p>åˆç§°ä¸ºå¹½çµå¼•ç”¨æˆ–è€…å¹»å½±å¼•ç”¨ã€‚ä¸€ä¸ªå¯¹è±¡æ˜¯å¦æœ‰è™šå¼•ç”¨çš„å­˜åœ¨ï¼Œå®Œå…¨ä¸ä¼šå¯¹å…¶ç”Ÿå­˜æ—¶é—´æ„æˆå½±å“ï¼Œä¹Ÿæ— æ³•é€šè¿‡è™šå¼•ç”¨å–å¾—ä¸€ä¸ªå¯¹è±¡ã€‚</p><p>ä¸ºä¸€ä¸ªå¯¹è±¡è®¾ç½®è™šå¼•ç”¨å…³è”çš„å”¯ä¸€ç›®çš„å°±æ˜¯èƒ½åœ¨è¿™ä¸ªå¯¹è±¡è¢«å›æ”¶æ—¶æ”¶åˆ°ä¸€ä¸ªç³»ç»Ÿé€šçŸ¥ã€‚</p><p>ä½¿ç”¨ PhantomReference æ¥å®ç°è™šå¼•ç”¨ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Object obj = <span class="keyword">new</span> Object();</span><br><span class="line">PhantomReference&lt;Object&gt; pf = <span class="keyword">new</span> PhantomReference&lt;Object&gt;(obj);</span><br><span class="line">obj = <span class="keyword">null</span>;</span><br></pre></td></tr></table></figure><h4 id="ä¸¤æ¬¡æ ‡è®°ä¸-finalize-æ–¹æ³•"><a href="#ä¸¤æ¬¡æ ‡è®°ä¸-finalize-æ–¹æ³•" class="headerlink" title="ä¸¤æ¬¡æ ‡è®°ä¸ finalize()æ–¹æ³•"></a>ä¸¤æ¬¡æ ‡è®°ä¸ finalize()æ–¹æ³•</h4><p>å³ä½¿åœ¨å¯è¾¾æ€§åˆ†æç®—æ³•ä¸­ä¸å¯è¾¾çš„å¯¹è±¡ï¼Œä¹Ÿä¸æ˜¯ä¸€å®šä¼šæ­»äº¡çš„ï¼Œå®ƒä»¬æš‚æ—¶éƒ½å¤„äº<strong>â€œç¼“åˆ‘â€</strong>é˜¶æ®µï¼Œè¦çœŸæ­£å®£å‘Šä¸€ä¸ªå¯¹è±¡â€œæ­»äº¡â€ï¼Œè‡³å°‘è¦ç»å†ä¸¤æ¬¡æ ‡è®°è¿‡ç¨‹ï¼š</p><p>å¦‚æœå¯¹è±¡åœ¨è¿›è¡Œå¯è¾¾æ€§åˆ†æåå‘ç°æ²¡æœ‰ä¸ GC Rootsç›¸è¿æ¥çš„å¼•ç”¨é“¾ï¼Œé‚£å®ƒå°†ä¼šè¢«<strong>ç¬¬ä¸€æ¬¡æ ‡è®°</strong>å¹¶ä¸”è¿›è¡Œä¸€æ¬¡ç­›é€‰ï¼Œç­›é€‰çš„æ¡ä»¶æ˜¯<strong>æ­¤å¯¹è±¡æ˜¯å¦æœ‰å¿…è¦æ‰§è¡Œ<code>finaliza()</code>æ–¹æ³•</strong>ã€‚å½“å¯¹è±¡æ²¡æœ‰è¦†ç›–<code>finaliza()</code>æ–¹æ³•ï¼Œæˆ–è€…<code>finaliza()</code>æ–¹æ³•å·²ç»è¢«è™šæ‹Ÿæœºè°ƒç”¨è¿‡ï¼Œè™šæ‹Ÿæœºå°†è¿™ä¸¤ç§æƒ…å†µéƒ½è§†ä¸ºâ€œæ²¡æœ‰å¿…è¦æ‰§è¡Œâ€ã€‚</p><p>å¦‚æœè¿™ä¸ªå¯¹è±¡è¢«åˆ¤å®šä¸ºæœ‰å¿…è¦æ‰§è¡Œ<code>finaliza()</code>æ–¹æ³•ï¼Œé‚£ä¹ˆæ­¤å¯¹è±¡å°†ä¼šæ”¾ç½®åœ¨ä¸€ä¸ªå«åš F-Queue çš„é˜Ÿåˆ—ä¸­ï¼Œå¹¶åœ¨ç¨åç”±ä¸€ä¸ªè™šæ‹Ÿæœºè‡ªåŠ¨å»ºç«‹çš„ã€ä½ä¼˜å…ˆçº§çš„Finalizerçº¿ç¨‹å»æ‰§è¡Œå®ƒã€‚è¿™é‡Œæ‰€è°“çš„â€œæ‰§è¡Œâ€æ˜¯æŒ‡è™šæ‹Ÿæœºä¼šè§¦å‘æ­¤æ–¹æ³•ï¼Œä½†å¹¶ä¸æ‰¿è¯ºä¼šç­‰å¾…å®ƒè¿è¡Œç»“æŸï¼ŒåŸå› æ˜¯ï¼šå¦‚æœä¸€ä¸ªå¯¹è±¡åœ¨<code>finaliza()</code>æ–¹æ³•ä¸­æ‰§è¡Œç¼“æ…¢ï¼Œæˆ–è€…å‘ç”Ÿäº†æ­»å¾ªç¯ï¼ˆæ›´æç«¯çš„æƒ…å†µï¼‰ï¼Œå°†å¾ˆå¯èƒ½å¯¼è‡´F-Queue é˜Ÿåˆ—ä¸­çš„å…¶å®ƒå¯¹è±¡æ°¸ä¹…å¤„äºç­‰å¾…ï¼Œç”šè‡³å¯¼è‡´æ•´ä¸ªå†…å­˜å›æ”¶ç³»ç»Ÿå´©æºƒã€‚</p><p><code>finaliza()</code>æ–¹æ³•æ˜¯å¯¹è±¡é€ƒè„±æ­»äº¡å‘½è¿çš„æœ€åä¸€æ¬¡æœºä¼šï¼Œç¨åGCå°†å¯¹F-Queue é˜Ÿåˆ—ä¸­çš„å¯¹è±¡è¿›è¡Œ<strong>ç¬¬äºŒæ¬¡å°è§„æ¨¡çš„æ ‡è®°</strong>ã€‚å¦‚æœå¯¹è±¡æƒ³åœ¨<code>finaliza()</code>æ–¹æ³•ä¸­æˆåŠŸæ‹¯æ•‘è‡ªå·±ï¼Œ<strong>åªè¦é‡æ–°ä¸å¼•ç”¨é“¾ä¸Šçš„ä»»ä½•ä¸€ä¸ªå¯¹è±¡å»ºç«‹å…³è”å³å¯ï¼Œä¾‹å¦‚æŠŠè‡ªå·±ï¼ˆthiså…³é”®å­—ï¼‰èµ‹å€¼ç»™æŸä¸ªç±»å˜é‡æˆ–è€…å¯¹è±¡çš„æˆå‘˜å˜é‡ï¼Œè¿™æ ·åœ¨ç¬¬äºŒæ¬¡æ ‡è®°æ—¶å®ƒå°†è¢«ç§»å‡ºâ€œå³å°†å›æ”¶â€çš„é›†åˆ</strong>ï¼›å¦‚æœå¯¹è±¡è¿™æ—¶å€™è¿˜æ²¡æœ‰é€ƒè„±ï¼ŒåŸºæœ¬ä¸Šå®ƒå°±çœŸçš„è¢«å›æ”¶äº†ã€‚</p><p>å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œå¦‚æœä»£ç ä¸­æœ‰ä¸¤æ®µä¸€æ¨¡ä¸€æ ·çš„ä»£ç æ®µï¼Œæ‰§è¡Œç»“æœå´æ˜¯ä¸€æ¬¡é€ƒè„±æˆåŠŸï¼Œä¸€æ¬¡å¤±è´¥ã€‚è¿™æ˜¯å› ä¸ºä»»ä½•ä¸€ä¸ªå¯¹è±¡çš„<code>finalize()</code>æ–¹æ³•éƒ½åªä¼šè¢«ç³»ç»Ÿè°ƒç”¨ä¸€æ¬¡ï¼Œå¦‚æœå¯¹è±¡é¢ä¸´ä¸‹ä¸€æ¬¡å›æ”¶ï¼Œå®ƒçš„<code>finalize()</code>æ–¹æ³•ä¸ä¼šå†è¢«æ‰§è¡Œï¼Œå› æ­¤ç¬¬äºŒæ¬¡é€ƒè„±è¡ŒåŠ¨å¤±è´¥ã€‚</p><p>éœ€è¦è¯´æ˜çš„æ˜¯ï¼Œä½¿ç”¨<code>finalize()</code>æ–¹æ³•æ¥â€œæ‹¯æ•‘â€å¯¹è±¡æ˜¯ä¸å€¼å¾—æå€¡çš„ï¼Œå› ä¸ºå®ƒä¸æ˜¯C/C++ä¸­çš„ææ„å‡½æ•°ï¼Œè€Œæ˜¯Javaåˆšè¯ç”Ÿæ—¶ä¸ºäº†ä½¿C/C++ç¨‹åºå‘˜æ›´å®¹æ˜“æ¥å—å®ƒæ‰€åšçš„ä¸€ä¸ªå¦¥åã€‚<strong>å®ƒçš„è¿è¡Œä»£ä»·é«˜æ˜‚ï¼Œä¸ç¡®å®šæ€§å¤§ï¼Œæ— æ³•ä¿è¯å„ä¸ªå¯¹è±¡çš„è°ƒç”¨é¡ºåºã€‚</strong><code>finalize()</code>èƒ½åšçš„å·¥ä½œï¼Œä½¿ç”¨<code>try-finally</code>æˆ–è€…å…¶å®ƒæ–¹æ³•éƒ½æ›´é€‚åˆã€åŠæ—¶ï¼Œæ‰€ä»¥ç¬”è€…å»ºè®®å¤§å®¶å¯ä»¥å¿˜æ‰æ­¤æ–¹æ³•å­˜åœ¨ã€‚</p><h4 id="å›æ”¶æ–¹æ³•åŒº"><a href="#å›æ”¶æ–¹æ³•åŒº" class="headerlink" title="å›æ”¶æ–¹æ³•åŒº"></a>å›æ”¶æ–¹æ³•åŒº</h4><p>å¾ˆå¤šäººè®¤ä¸ºæ–¹æ³•åŒºæ²¡æœ‰åƒåœ¾å›æ”¶ï¼ŒJavaè™šæ‹Ÿæœºè§„èŒƒä¸­ç¡®å®è¯´è¿‡ä¸è¦æ±‚ï¼Œè€Œä¸”åœ¨æ–¹æ³•åŒºä¸­è¿›è¡Œåƒåœ¾æ”¶é›†çš„â€œæ€§ä»·æ¯”â€è¾ƒä½ï¼šåœ¨å †ä¸­ï¼Œå°¤å…¶æ˜¯æ–°ç”Ÿä»£ï¼Œå¸¸è§„åº”ç”¨è¿›è¡Œä¸€æ¬¡åƒåœ¾æ”¶é›†å¯ä»¥å›æ”¶70%~95%çš„ç©ºé—´ï¼Œè€Œæ–¹æ³•åŒºçš„æ•ˆç‡è¿œä½äºæ­¤ã€‚åœ¨JDK 1.8ä¸­ï¼ŒJVMæ‘’å¼ƒäº†æ°¸ä¹…ä»£ï¼Œç”¨å…ƒç©ºé—´æ¥ä½œä¸ºæ–¹æ³•åŒºçš„å®ç°ï¼Œä¸‹é¢ä»‹ç»çš„å°†æ˜¯å…ƒç©ºé—´çš„åƒåœ¾å›æ”¶ã€‚</p><p>å…ƒç©ºé—´çš„å†…å­˜ç®¡ç†ç”±<strong>å…ƒç©ºé—´è™šæ‹Ÿæœº</strong>æ¥å®Œæˆã€‚å…ˆå‰ï¼Œå¯¹äºç±»çš„å…ƒæ•°æ®æˆ‘ä»¬éœ€è¦ä¸åŒçš„åƒåœ¾å›æ”¶å™¨è¿›è¡Œå¤„ç†ï¼Œç°åœ¨åªéœ€è¦æ‰§è¡Œå…ƒç©ºé—´è™šæ‹Ÿæœºçš„C++ä»£ç å³å¯å®Œæˆã€‚<strong>åœ¨å…ƒç©ºé—´ä¸­ï¼Œç±»å’Œå…¶å…ƒæ•°æ®çš„ç”Ÿå‘½å‘¨æœŸ</strong>å’Œ<strong>å…¶å¯¹åº”çš„ç±»åŠ è½½å™¨</strong>æ˜¯ç›¸åŒçš„ã€‚è¯å¥è¯è¯´ï¼Œ<strong>åªè¦ç±»åŠ è½½å™¨å­˜æ´»ï¼Œå…¶åŠ è½½çš„ç±»çš„å…ƒæ•°æ®ä¹Ÿæ˜¯å­˜æ´»çš„</strong>ï¼Œå› è€Œä¸ä¼šè¢«å›æ”¶æ‰ã€‚</p><p>æˆ‘ä»¬ä»è¡Œæ–‡åˆ°ç°åœ¨æåˆ°çš„å…ƒç©ºé—´ç¨å¾®æœ‰ç‚¹ä¸ä¸¥è°¨ã€‚å‡†ç¡®çš„æ¥è¯´ï¼Œ<strong>æ¯ä¸€ä¸ª<em>ç±»åŠ è½½å™¨çš„å­˜å‚¨åŒºåŸŸ</em>éƒ½ç§°ä½œä¸€ä¸ªå…ƒç©ºé—´ï¼Œæ‰€æœ‰çš„å…ƒç©ºé—´åˆåœ¨ä¸€èµ·å°±æ˜¯æˆ‘ä»¬ä¸€ç›´è¯´çš„å…ƒç©ºé—´ã€‚</strong>å½“ä¸€ä¸ªç±»åŠ è½½å™¨è¢«åƒåœ¾å›æ”¶å™¨æ ‡è®°ä¸ºä¸å†å­˜æ´»ï¼Œå…¶å¯¹åº”çš„å…ƒç©ºé—´ä¼šè¢«å›æ”¶ã€‚åœ¨å…ƒç©ºé—´çš„å›æ”¶è¿‡ç¨‹ä¸­æ²¡æœ‰é‡å®šä½å’Œå‹ç¼©ç­‰æ“ä½œã€‚ä½†æ˜¯å…ƒç©ºé—´å†…çš„å…ƒæ•°æ®ä¼šè¿›è¡Œæ‰«ææ¥ç¡®å®šJavaå¼•ç”¨ã€‚</p><h1 id="åƒåœ¾æ”¶é›†ç®—æ³•"><a href="#åƒåœ¾æ”¶é›†ç®—æ³•" class="headerlink" title="åƒåœ¾æ”¶é›†ç®—æ³•"></a>åƒåœ¾æ”¶é›†ç®—æ³•</h1><p>æœ¬èŠ‚å°†ä»‹ç»å‡ ç§åƒåœ¾æ”¶é›†ç®—æ³•çš„æ€æƒ³åŠå…¶å‘å±•è¿‡ç¨‹ï¼Œå…·ä½“çš„å®ç°å°†åœ¨ç¨åä»‹ç»ã€‚</p><h4 id="æ ‡è®°ï¼æ¸…é™¤ï¼ˆMark-Sweepï¼‰ç®—æ³•"><a href="#æ ‡è®°ï¼æ¸…é™¤ï¼ˆMark-Sweepï¼‰ç®—æ³•" class="headerlink" title="æ ‡è®°ï¼æ¸…é™¤ï¼ˆMark-Sweepï¼‰ç®—æ³•"></a>æ ‡è®°ï¼æ¸…é™¤ï¼ˆMark-Sweepï¼‰ç®—æ³•</h4><p><strong>æ ‡è®°ï¼æ¸…é™¤ï¼ˆMark-Sweepï¼‰</strong>ç®—æ³•æ˜¯æœ€åŸºç¡€çš„åƒåœ¾æ”¶é›†ç®—æ³•ï¼Œåç»­çš„æ”¶é›†ç®—æ³•éƒ½æ˜¯åŸºäºå®ƒçš„æ€è·¯å¹¶å¯¹å…¶ä¸è¶³è¿›è¡Œæ”¹è¿›è€Œå¾—åˆ°çš„ã€‚é¡¾åæ€ä¹‰ï¼Œç®—æ³•åˆ†æˆâ€œæ ‡è®°â€ã€â€œæ¸…é™¤â€ä¸¤ä¸ªé˜¶æ®µï¼šé¦–å…ˆæ ‡è®°å‡ºæ‰€æœ‰éœ€è¦å›æ”¶çš„å¯¹è±¡ï¼Œåœ¨æ ‡è®°å®Œæˆåç»Ÿä¸€å›æ”¶æ‰€æœ‰è¢«æ ‡è®°çš„å¯¹è±¡ï¼Œæ ‡è®°è¿‡ç¨‹åœ¨å‰ä¸€èŠ‚è®²è¿°å¯¹è±¡æ ‡è®°åˆ¤å®šæ—¶å·²ç»è®²è¿‡äº†ã€‚</p><p>æ ‡è®°ï¼æ¸…é™¤ç®—æ³•çš„ä¸è¶³ä¸»è¦æœ‰ä»¥ä¸‹ä¸¤ç‚¹ï¼š</p><ul><li><strong>ç©ºé—´é—®é¢˜</strong>ï¼Œæ ‡è®°æ¸…é™¤ä¹‹åä¼šäº§ç”Ÿå¤§é‡ä¸è¿ç»­çš„<strong>å†…å­˜ç¢ç‰‡</strong>ï¼Œç©ºé—´ç¢ç‰‡å¤ªå¤šå¯èƒ½ä¼šå¯¼è‡´ä»¥ååœ¨ç¨‹åºè¿è¡Œè¿‡ç¨‹ä¸­éœ€è¦åˆ†é…è¾ƒå¤§å¯¹è±¡æ—¶ï¼Œæ— æ³•æ‰¾åˆ°è¶³å¤Ÿçš„è¿ç»­å†…å­˜è€Œä¸å¾—ä¸è§¦å‘å¦ä¸€æ¬¡åƒåœ¾æ”¶é›†åŠ¨ä½œã€‚</li><li><strong>æ•ˆç‡é—®é¢˜</strong>ï¼Œå› ä¸ºå†…å­˜ç¢ç‰‡çš„å­˜åœ¨ï¼Œæ“ä½œä¼šå˜å¾—æ›´åŠ è´¹æ—¶ï¼Œå› ä¸ºæŸ¥æ‰¾ä¸‹ä¸€ä¸ªå¯ç”¨ç©ºé—²å—å·²ä¸å†æ˜¯ä¸€ä¸ªç®€å•æ“ä½œã€‚</li></ul><p>æ ‡è®°ï¼æ¸…é™¤ç®—æ³•çš„æ‰§è¡Œè¿‡ç¨‹å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><center><img src="https://pic.yupoo.com/crowhawk/5a3494ae/efc6204a.png"></center><h4 id="å¤åˆ¶ï¼ˆCopyingï¼‰ç®—æ³•"><a href="#å¤åˆ¶ï¼ˆCopyingï¼‰ç®—æ³•" class="headerlink" title="å¤åˆ¶ï¼ˆCopyingï¼‰ç®—æ³•"></a>å¤åˆ¶ï¼ˆCopyingï¼‰ç®—æ³•</h4><p>ä¸ºäº†è§£å†³æ ‡è®°-æ¸…é™¤ç®—æ³•çš„æ•ˆç‡é—®é¢˜ï¼Œä¸€ç§ç§°ä¸º<strong>â€œå¤åˆ¶â€ï¼ˆCopyingï¼‰</strong>çš„æ”¶é›†ç®—æ³•å‡ºç°äº†ï¼Œæ€æƒ³ä¸ºï¼šå®ƒ<strong>å°†å¯ç”¨å†…å­˜æŒ‰å®¹é‡åˆ†æˆå¤§å°ç›¸ç­‰çš„ä¸¤å—</strong>ï¼Œæ¯æ¬¡åªä½¿ç”¨å…¶ä¸­çš„ä¸€å—ã€‚<strong>å½“è¿™ä¸€å—å†…å­˜ç”¨å®Œï¼Œå°±å°†è¿˜å­˜æ´»ç€çš„å¯¹è±¡å¤åˆ¶åˆ°å¦ä¸€å—ä¸Šé¢</strong>ï¼Œç„¶åå†æŠŠå·²ä½¿ç”¨è¿‡çš„å†…å­˜ç©ºé—´ä¸€æ¬¡æ¸…ç†æ‰ã€‚</p><p>è¿™æ ·åšä½¿å¾—<strong>æ¯æ¬¡éƒ½æ˜¯å¯¹æ•´ä¸ªåŠåŒºè¿›è¡Œå†…å­˜å›æ”¶</strong>ï¼Œå†…å­˜åˆ†é…æ—¶ä¹Ÿå°±<strong>ä¸ç”¨è€ƒè™‘å†…å­˜ç¢ç‰‡</strong>ç­‰å¤æ‚æƒ…å†µï¼Œåªè¦<strong>ç§»åŠ¨å †é¡¶æŒ‡é’ˆï¼ŒæŒ‰é¡ºåºåˆ†é…å†…å­˜</strong>å³å¯ï¼Œå®ç°ç®€å•ï¼Œè¿è¡Œé«˜æ•ˆã€‚åªæ˜¯è¿™ç§ç®—æ³•çš„ä»£ä»·æ˜¯<strong>å°†å†…å­˜ç¼©å°ä¸ºåŸæ¥çš„ä¸€åŠ</strong>ï¼Œä»£ä»·å¯èƒ½è¿‡é«˜äº†ã€‚å¤åˆ¶ç®—æ³•çš„æ‰§è¡Œè¿‡ç¨‹å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><center><img src="https://pic.yupoo.com/crowhawk/62b8a3a8/f1cada8a.png"></center><big><strong>Minor GCä¸å¤åˆ¶ç®—æ³•</strong></big><p><strong>ç°åœ¨çš„å•†ä¸šè™šæ‹Ÿæœºéƒ½ä½¿ç”¨å¤åˆ¶ç®—æ³•æ¥å›æ”¶æ–°ç”Ÿä»£ã€‚</strong>æ–°ç”Ÿä»£çš„GCåˆå«<strong>â€œMinor GCâ€</strong>ï¼ŒIBMå…¬å¸çš„ä¸“é—¨ç ”ç©¶è¡¨æ˜ï¼šæ–°ç”Ÿä»£ä¸­çš„å¯¹è±¡98%æ˜¯<strong>â€œæœç”Ÿå¤•æ­»â€</strong>çš„ï¼Œæ‰€ä»¥Minor GCéå¸¸é¢‘ç¹ï¼Œä¸€èˆ¬å›æ”¶é€Ÿåº¦ä¹Ÿæ¯”è¾ƒå¿«ï¼ŒåŒæ—¶<strong>â€œæœç”Ÿå¤•æ­»â€</strong>çš„ç‰¹æ€§ä¹Ÿä½¿å¾—Minor GCä½¿ç”¨å¤åˆ¶ç®—æ³•æ—¶ä¸éœ€è¦æŒ‰ç…§1:1çš„æ¯”ä¾‹æ¥åˆ’åˆ†æ–°ç”Ÿä»£å†…å­˜ç©ºé—´ã€‚</p><big><strong>Minor GCè¿‡ç¨‹</strong></big><p>äº‹å®ä¸Šï¼Œæ–°ç”Ÿä»£å°†å†…å­˜åˆ†ä¸º<strong>ä¸€å—è¾ƒå¤§çš„Edenç©ºé—´</strong>å’Œ<strong>ä¸¤å—è¾ƒå°çš„Survivorç©ºé—´ï¼ˆFrom Survivorå’ŒTo Survivorï¼‰</strong>ï¼Œ<strong>æ¯æ¬¡Minor GCéƒ½ä½¿ç”¨Edenå’ŒFrom Survivor</strong>ï¼Œå½“å›æ”¶æ—¶ï¼Œ<strong>å°†Edenå’ŒFrom Survivorä¸­è¿˜å­˜æ´»ç€çš„å¯¹è±¡éƒ½ä¸€æ¬¡æ€§åœ°å¤åˆ¶åˆ°å¦å¤–ä¸€å—To Survivorç©ºé—´ä¸Š</strong>ï¼Œæœ€åæ¸…ç†æ‰Edenå’Œåˆšä½¿ç”¨çš„Survivorç©ºé—´ã€‚<strong>ä¸€æ¬¡Minor GCç»“æŸçš„æ—¶å€™</strong>ï¼Œ<strong>Eden</strong>ç©ºé—´å’Œ<strong>From Survivor</strong>ç©ºé—´éƒ½æ˜¯ç©ºçš„ï¼Œè€Œ<strong>To Survivor</strong>ç©ºé—´é‡Œé¢å­˜å‚¨ç€å­˜æ´»çš„å¯¹è±¡ã€‚<strong>åœ¨ä¸‹æ¬¡MinorGCçš„æ—¶å€™</strong>ï¼Œä¸¤ä¸ªSurvivorç©ºé—´äº¤æ¢ä»–ä»¬çš„æ ‡ç­¾ï¼Œç°åœ¨æ˜¯ç©ºçš„<strong>â€œFromâ€ Survivor</strong>æ ‡è®°æˆä¸º<strong>â€œToâ€</strong>ï¼Œ<strong>â€œToâ€ Survivor</strong>æ ‡è®°ä¸º<strong>â€œFromâ€</strong>ã€‚å› æ­¤ï¼Œåœ¨MinorGCç»“æŸçš„æ—¶å€™ï¼ŒEdenç©ºé—´æ˜¯ç©ºçš„ï¼Œä¸¤ä¸ªSurvivorç©ºé—´ä¸­çš„ä¸€ä¸ªæ˜¯ç©ºçš„ï¼Œè€Œå¦ä¸€ä¸ªå­˜å‚¨ç€å­˜æ´»çš„å¯¹è±¡ã€‚</p><p>HotSpotè™šæ‹Ÿæœºé»˜è®¤çš„<strong>Eden : Survivor</strong>çš„æ¯”ä¾‹æ˜¯<strong>8 : 1</strong>ï¼Œç”±äºä¸€å…±æœ‰ä¸¤å—Survivorï¼Œæ‰€ä»¥<strong>æ¯æ¬¡æ–°ç”Ÿä»£ä¸­å¯ç”¨å†…å­˜ç©ºé—´ä¸ºæ•´ä¸ªæ–°ç”Ÿä»£å®¹é‡çš„90%ï¼ˆ80%ï¼‹10%ï¼‰</strong>ï¼Œåªæœ‰10%çš„å®¹é‡ä¼šè¢«â€œæµªè´¹â€ã€‚</p><big><strong>åˆ†é…æ‹…ä¿</strong></big><p>ä¸Šæ–‡è¯´çš„98%çš„å¯¹è±¡å¯å›æ”¶åªæ˜¯ä¸€èˆ¬åœºæ™¯ä¸‹çš„æ•°æ®ï¼Œæˆ‘ä»¬æ²¡æœ‰åŠæ³•ä¿è¯æ¯æ¬¡å›æ”¶éƒ½åªæœ‰ä¸å¤šäº10%çš„å¯¹è±¡å­˜æ´»ï¼Œ<strong>å½“Survivorç©ºé—´ä¸å¤Ÿç”¨æ—¶</strong>ï¼Œéœ€è¦ä¾èµ–<strong>è€å¹´ä»£å†…å­˜</strong>è¿›è¡Œ<strong>åˆ†é…æ‹…ä¿ï¼ˆHandle Promotionï¼‰</strong>ã€‚å¦‚æœå¦å¤–ä¸€å—Survivorä¸Šæ²¡æœ‰è¶³å¤Ÿç©ºé—´å­˜æ”¾ä¸Šä¸€æ¬¡æ–°ç”Ÿä»£æ”¶é›†ä¸‹æ¥çš„å­˜æ´»å¯¹è±¡ï¼Œè¿™äº›å¯¹è±¡å°†ç›´æ¥é€šè¿‡åˆ†é…æ‹…ä¿æœºåˆ¶è¿›å…¥è€å¹´ä»£ã€‚</p><h5 id="æ ‡è®°ï¼æ•´ç†ï¼ˆMark-Compactï¼‰ç®—æ³•"><a href="#æ ‡è®°ï¼æ•´ç†ï¼ˆMark-Compactï¼‰ç®—æ³•" class="headerlink" title="æ ‡è®°ï¼æ•´ç†ï¼ˆMark-Compactï¼‰ç®—æ³•"></a>æ ‡è®°ï¼æ•´ç†ï¼ˆMark-Compactï¼‰ç®—æ³•</h5><p>å¤åˆ¶ç®—æ³•åœ¨å¯¹è±¡å­˜æ´»ç‡è¾ƒé«˜æ—¶è¦è¿›è¡Œè¾ƒå¤šçš„å¤åˆ¶æ“ä½œï¼Œæ•ˆç‡å°†ä¼šå˜ä½ã€‚æ›´å…³é”®çš„æ˜¯ï¼šå¦‚æœä¸æƒ³æµªè´¹50%çš„ç©ºé—´ï¼Œå°±éœ€è¦æœ‰é¢å¤–çš„ç©ºé—´è¿›è¡Œåˆ†é…æ‹…ä¿ï¼Œä»¥åº”å¯¹è¢«ä½¿ç”¨çš„å†…å­˜ä¸­æ‰€æœ‰å¯¹è±¡éƒ½100%å­˜æ´»çš„æç«¯æƒ…å†µï¼Œæ‰€ä»¥åœ¨<strong>è€å¹´ä»£ä¸€èˆ¬ä¸èƒ½ç›´æ¥é€‰ç”¨å¤åˆ¶ç®—æ³•</strong>ã€‚</p><p>æ ¹æ®è€å¹´ä»£çš„ç‰¹ç‚¹ï¼Œ<strong>æ ‡è®°ï¼æ•´ç†ï¼ˆMark-Compactï¼‰</strong>ç®—æ³•è¢«æå‡ºæ¥ï¼Œä¸»è¦æ€æƒ³ä¸ºï¼šæ­¤ç®—æ³•çš„æ ‡è®°è¿‡ç¨‹ä¸<strong>æ ‡è®°ï¼æ¸…é™¤</strong>ç®—æ³•ä¸€æ ·ï¼Œä½†åç»­æ­¥éª¤ä¸æ˜¯ç›´æ¥å¯¹å¯å›æ”¶å¯¹è±¡è¿›è¡Œæ¸…ç†ï¼Œè€Œæ˜¯<strong>è®©æ‰€æœ‰å­˜æ´»çš„å¯¹è±¡éƒ½å‘ä¸€ç«¯ç§»åŠ¨ï¼Œç„¶åç›´æ¥æ¸…ç†æ‰è¾¹ç•Œä»¥å¤–çš„å†…å­˜ã€‚</strong>å…·ä½“ç¤ºæ„å›¾å¦‚ä¸‹æ‰€ç¤ºï¼š</p><center><img src="https://pic.yupoo.com/crowhawk/d046244a/d3d3277f.png"></center><h5 id="åˆ†ä»£æ”¶é›†ï¼ˆGenerational-Collectionï¼‰ç®—æ³•"><a href="#åˆ†ä»£æ”¶é›†ï¼ˆGenerational-Collectionï¼‰ç®—æ³•" class="headerlink" title="åˆ†ä»£æ”¶é›†ï¼ˆGenerational Collectionï¼‰ç®—æ³•"></a>åˆ†ä»£æ”¶é›†ï¼ˆGenerational Collectionï¼‰ç®—æ³•</h5><p>å½“å‰å•†ä¸šè™šæ‹Ÿæœºçš„åƒåœ¾æ”¶é›†éƒ½é‡‡ç”¨<strong>åˆ†ä»£æ”¶é›†ï¼ˆGenerational Collectionï¼‰ç®—æ³•</strong>ï¼Œæ­¤ç®—æ³•ç›¸è¾ƒäºå‰å‡ ç§æ²¡æœ‰ä»€ä¹ˆæ–°çš„ç‰¹å¾ï¼Œä¸»è¦æ€æƒ³ä¸ºï¼šæ ¹æ®å¯¹è±¡å­˜æ´»å‘¨æœŸçš„ä¸åŒå°†å†…å­˜åˆ’åˆ†ä¸ºå‡ å—ï¼Œä¸€èˆ¬æ˜¯æŠŠJavaå †åˆ†ä¸ºæ–°ç”Ÿä»£å’Œè€å¹´ä»£ï¼Œè¿™æ ·å°±å¯ä»¥æ ¹æ®å„ä¸ªå¹´ä»£çš„ç‰¹ç‚¹é‡‡ç”¨æœ€é€‚åˆçš„æ”¶é›†ç®—æ³•ï¼š</p><ul><li><strong>æ–°ç”Ÿä»£</strong><br>åœ¨æ–°ç”Ÿä»£ä¸­ï¼Œæ¯æ¬¡åƒåœ¾æ”¶é›†æ—¶éƒ½å‘ç°æœ‰å¤§æ‰¹å¯¹è±¡æ­»å»ï¼Œåªæœ‰å°‘é‡å­˜æ´»ï¼Œé‚£å°±é€‰ç”¨<strong>å¤åˆ¶ç®—æ³•</strong>ï¼Œåªéœ€è¦ä»˜å‡ºå°‘é‡å­˜æ´»å¯¹è±¡çš„å¤åˆ¶æˆæœ¬å°±å¯ä»¥å®Œæˆæ”¶é›†ã€‚</li><li><strong>è€å¹´ä»£</strong><br>åœ¨è€å¹´ä»£ä¸­ï¼Œå› ä¸ºå¯¹è±¡å­˜æ´»ç‡é«˜ã€æ²¡æœ‰é¢å¤–ç©ºé—´å¯¹å®ƒè¿›è¡Œåˆ†é…æ‹…ä¿ï¼Œå°±å¿…é¡»ä½¿ç”¨<strong>â€œæ ‡è®°-æ¸…é™¤â€</strong>æˆ–<strong>â€œæ ‡è®°-æ•´ç†â€</strong>ç®—æ³•æ¥è¿›è¡Œå›æ”¶ã€‚</li></ul><h1 id="HotSpotçš„ç®—æ³•å®ç°"><a href="#HotSpotçš„ç®—æ³•å®ç°" class="headerlink" title="HotSpotçš„ç®—æ³•å®ç°"></a>HotSpotçš„ç®—æ³•å®ç°</h1><p>å‰é¢ä¸¤å¤§èŠ‚ä¸»è¦ä»ç†è®ºä¸Šä»‹ç»äº†å¯¹è±¡å­˜æ´»åˆ¤å®šç®—æ³•å’Œåƒåœ¾æ”¶é›†ç®—æ³•ï¼Œè€Œåœ¨HotSpotè™šæ‹Ÿæœºä¸Šå®ç°è¿™äº›ç®—æ³•æ—¶ï¼Œå¿…é¡»å¯¹ç®—æ³•çš„æ‰§è¡Œæ•ˆç‡æœ‰ä¸¥æ ¼çš„è€ƒé‡ï¼Œæ‰èƒ½ä¿è¯è™šæ‹Ÿæœºé«˜æ•ˆè¿è¡Œã€‚</p><h4 id="æšä¸¾æ ¹èŠ‚ç‚¹"><a href="#æšä¸¾æ ¹èŠ‚ç‚¹" class="headerlink" title="æšä¸¾æ ¹èŠ‚ç‚¹"></a>æšä¸¾æ ¹èŠ‚ç‚¹</h4><p>ä»å¯è¾¾æ€§åˆ†æä¸­<strong>ä»GC RootsèŠ‚ç‚¹æ‰¾å¼•ç”¨é“¾</strong>è¿™ä¸ªæ“ä½œä¸ºä¾‹ï¼Œå¯ä½œä¸ºGC Rootsçš„èŠ‚ç‚¹ä¸»è¦åœ¨<strong>å…¨å±€æ€§çš„å¼•ç”¨</strong>ï¼ˆä¾‹å¦‚å¸¸é‡æˆ–ç±»é™æ€å±æ€§ï¼‰ä¸<strong>æ‰§è¡Œä¸Šä¸‹æ–‡</strong>ï¼ˆä¾‹å¦‚æ ˆå¸§ä¸­çš„å±€éƒ¨å˜é‡è¡¨ï¼‰ä¸­ï¼Œç°åœ¨å¾ˆå¤šåº”ç”¨ä»…ä»…æ–¹æ³•åŒºå°±æœ‰æ•°ç™¾å…†ï¼Œå¦‚æœè¦é€ä¸ªæ£€æŸ¥è¿™é‡Œé¢çš„å¼•ç”¨ï¼Œé‚£ä¹ˆå¿…ç„¶ä¼šæ¶ˆè€—å¾ˆå¤šæ—¶é—´ã€‚</p><big><strong>GCåœé¡¿ï¼ˆâ€Stop The Worldâ€ï¼‰</strong></big><p>å¦å¤–ï¼Œå¯è¾¾æ€§åˆ†æå·¥ä½œå¿…é¡»åœ¨ä¸€ä¸ª<strong>èƒ½ç¡®ä¿ä¸€è‡´æ€§çš„å¿«ç…§</strong>ä¸­è¿›è¡Œâ€”â€”è¿™é‡Œ<strong>â€œä¸€è‡´æ€§â€</strong>çš„æ„æ€æ˜¯æŒ‡<strong>åœ¨æ•´ä¸ªåˆ†ææœŸé—´æ•´ä¸ªæ‰§è¡Œç³»ç»Ÿçœ‹èµ·æ¥å°±åƒè¢«å†»ç»“åœ¨æŸä¸ªæ—¶é—´ç‚¹ä¸Š</strong>ï¼Œä¸å¯ä»¥å‡ºç°åˆ†æè¿‡ç¨‹ä¸­å¯¹è±¡å¼•ç”¨å…³ç³»è¿˜åœ¨ä¸æ–­å˜åŒ–çš„æƒ…å†µï¼Œè¿™æ˜¯ä¿è¯åˆ†æç»“æœå‡†ç¡®æ€§çš„åŸºç¡€ã€‚è¿™ç‚¹æ˜¯å¯¼è‡´GCè¿›è¡Œæ—¶å¿…é¡»<strong>åœé¡¿æ‰€æœ‰Javaæ‰§è¡Œçº¿ç¨‹</strong>ï¼ˆSunå°†è¿™ä»¶äº‹æƒ…ç§°ä¸º<strong>â€œStop The Worldâ€</strong>ï¼‰çš„å…¶ä¸­ä¸€ä¸ªé‡è¦åŸå› ï¼Œå³ä½¿æ˜¯åœ¨å·ç§°ï¼ˆå‡ ä¹ï¼‰ä¸ä¼šå‘ç”Ÿåœé¡¿çš„CMSæ”¶é›†å™¨ä¸­ï¼Œæšä¸¾æ ¹èŠ‚ç‚¹æ—¶ä¹Ÿæ˜¯å¿…é¡»è¦åœé¡¿çš„ã€‚</p><big><strong>å‡†ç¡®å¼GCä¸OopMap</strong></big><p>ç”±äºç›®å‰çš„ä¸»æµJavaè™šæ‹Ÿæœºä½¿ç”¨çš„éƒ½æ˜¯<strong>å‡†ç¡®å¼GCï¼ˆå³ä½¿ç”¨å‡†ç¡®å¼å†…å­˜ç®¡ç†ï¼Œè™šæ‹Ÿæœºå¯ç”¨çŸ¥é“å†…å­˜ä¸­æŸä¸ªä½ç½®çš„æ•°æ®å…·ä½“æ˜¯ä»€ä¹ˆç±»å‹ï¼‰</strong>ï¼Œæ‰€ä»¥å½“æ‰§è¡Œç³»ç»Ÿåœé¡¿ä¸‹æ¥åï¼Œå¹¶ä¸éœ€è¦ä¸€ä¸ªä¸æ¼åœ°æ£€æŸ¥å®Œæ‰€æœ‰æ‰§è¡Œä¸Šä¸‹æ–‡å’Œå…¨å±€çš„å¼•ç”¨ä½ç½®ï¼Œè™šæ‹Ÿæœºåº”å½“æ˜¯æœ‰åŠæ³•ç›´æ¥å¾—çŸ¥å“ªäº›åœ°æ–¹å­˜æ”¾ç€å¯¹è±¡å¼•ç”¨ã€‚åœ¨HotSpotçš„å®ç°ä¸­ï¼Œæ˜¯ä½¿ç”¨ä¸€ç»„ç§°ä¸º<strong>OopMap</strong>çš„æ•°æ®ç»“æ„æ¥è¾¾åˆ°è¿™ä¸ªç›®çš„çš„ï¼Œåœ¨ç±»åŠ è½½å®Œæˆçš„æ—¶å€™ï¼ŒHotSpotå°±æŠŠ<strong>å¯¹è±¡å†…ä»€ä¹ˆåç§»é‡ä¸Šæ˜¯ä»€ä¹ˆç±»å‹çš„æ•°æ®</strong>è®¡ç®—å‡ºæ¥ï¼Œåœ¨JITç¼–è¯‘è¿‡ç¨‹ä¸­ï¼Œä¹Ÿä¼šåœ¨ç‰¹å®šçš„ä½ç½®è®°å½•ä¸‹<strong>æ ˆå’Œå¯„å­˜å™¨ä¸­å“ªäº›ä½ç½®æ˜¯å¼•ç”¨</strong>ã€‚è¿™æ ·ï¼ŒGCåœ¨æ‰«ææ—¶å°±å¯ä»¥ç›´æ¥å¾—çŸ¥è¿™äº›ä¿¡æ¯äº†ã€‚</p><h4 id="å®‰å…¨ç‚¹ï¼ˆSafepointï¼‰â€”â€”è¿›è¡ŒGCæ—¶ç¨‹åºåœé¡¿çš„ä½ç½®"><a href="#å®‰å…¨ç‚¹ï¼ˆSafepointï¼‰â€”â€”è¿›è¡ŒGCæ—¶ç¨‹åºåœé¡¿çš„ä½ç½®" class="headerlink" title="å®‰å…¨ç‚¹ï¼ˆSafepointï¼‰â€”â€”è¿›è¡ŒGCæ—¶ç¨‹åºåœé¡¿çš„ä½ç½®"></a>å®‰å…¨ç‚¹ï¼ˆSafepointï¼‰â€”â€”è¿›è¡ŒGCæ—¶ç¨‹åºåœé¡¿çš„ä½ç½®</h4><p>åœ¨OopMapçš„ååŠ©ä¸‹ï¼ŒHotSpotå¯ä»¥å¿«é€Ÿä¸”å‡†ç¡®åœ°å®ŒæˆGC Rootsæšä¸¾ï¼Œä½†ä¸€ä¸ªå¾ˆç°å®çš„é—®é¢˜éšä¹‹è€Œæ¥ï¼šå¯èƒ½å¯¼è‡´å¼•ç”¨å…³ç³»å˜åŒ–ï¼Œæˆ–è€…è¯´OopMapå†…å®¹å˜åŒ–çš„æŒ‡ä»¤éå¸¸å¤šï¼Œ<strong>å¦‚æœä¸ºæ¯ä¸€æ¡æŒ‡ä»¤éƒ½ç”Ÿæˆå¯¹åº”çš„OopMapï¼Œé‚£å°†ä¼šéœ€è¦å¤§é‡çš„é¢å¤–ç©ºé—´ï¼Œè¿™æ ·GCçš„ç©ºé—´æˆæœ¬å°†ä¼šå˜å¾—å¾ˆé«˜ã€‚</strong></p><p>ä¸ºæ­¤ï¼ŒHotSpoté€‰æ‹©ä¸ä¸ºæ¯æ¡æŒ‡ä»¤éƒ½ç”ŸæˆOopMapï¼Œè€Œæ˜¯åªåœ¨â€œç‰¹å®šçš„ä½ç½®â€è®°å½•è¿™äº›ä¿¡æ¯ï¼Œè¿™äº›ä½ç½®ä¾¿è¢«ç§°ä¸º<strong>å®‰å…¨ç‚¹ï¼ˆSafepointï¼‰</strong>ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œ<strong>ç¨‹åºæ‰§è¡Œæ—¶å¹¶éåœ¨æ‰€æœ‰åœ°æ–¹éƒ½èƒ½åœé¡¿ä¸‹æ¥å¼€å§‹GCï¼Œåªæœ‰åœ¨åˆ°è¾¾å®‰å…¨ç‚¹æ—¶æ‰èƒ½æš‚åœ</strong>ã€‚Safepointçš„é€‰å®šæ—¢ä¸èƒ½å¤ªå°‘ä»¥è‡´äºè®©GCç­‰å¾…æ—¶é—´å¤ªé•¿ï¼Œä¹Ÿä¸èƒ½è¿‡äºé¢‘ç¹ä»¥è‡´äºè¿‡åˆ†å¢å¤§è¿è¡Œæ—¶çš„è´Ÿè·ã€‚æ‰€ä»¥ï¼Œå®‰å…¨ç‚¹çš„é€‰å®šåŸºæœ¬ä¸Šæ˜¯ä»¥ç¨‹åº<strong>â€œæ˜¯å¦å…·æœ‰è®©ç¨‹åºé•¿æ—¶é—´æ‰§è¡Œçš„ç‰¹å¾â€</strong>ä¸ºæ ‡å‡†è¿›è¡Œé€‰å®šçš„â€”â€”å› ä¸ºæ¯æ¡æŒ‡ä»¤æ‰§è¡Œçš„æ—¶é—´éƒ½éå¸¸çŸ­æš‚ï¼Œç¨‹åºä¸å¤ªå¯èƒ½å› ä¸ºæŒ‡ä»¤æµé•¿åº¦å¤ªé•¿è¿™ä¸ªåŸå› è€Œè¿‡é•¿æ—¶é—´è¿è¡Œï¼Œâ€œé•¿æ—¶é—´æ‰§è¡Œâ€çš„æœ€æ˜æ˜¾ç‰¹å¾å°±æ˜¯<strong>æŒ‡ä»¤åºåˆ—å¤ç”¨</strong>ï¼Œä¾‹å¦‚<strong>æ–¹æ³•è°ƒç”¨</strong>ã€<strong>å¾ªç¯è·³è½¬</strong>ã€<strong>å¼‚å¸¸è·³è½¬</strong>ç­‰ï¼Œæ‰€ä»¥å…·æœ‰è¿™äº›åŠŸèƒ½çš„æŒ‡ä»¤æ‰ä¼šäº§ç”ŸSafepointã€‚</p><p>å¯¹äºSefepointï¼Œå¦ä¸€ä¸ªéœ€è¦è€ƒè™‘çš„é—®é¢˜æ˜¯å¦‚ä½•<strong>åœ¨GCå‘ç”Ÿæ—¶è®©æ‰€æœ‰çº¿ç¨‹ï¼ˆè¿™é‡Œä¸åŒ…æ‹¬æ‰§è¡ŒJNIè°ƒç”¨çš„çº¿ç¨‹ï¼‰éƒ½â€œè·‘â€åˆ°æœ€è¿‘çš„å®‰å…¨ç‚¹ä¸Šå†åœé¡¿ä¸‹æ¥</strong>ã€‚è¿™é‡Œæœ‰ä¸¤ç§æ–¹æ¡ˆå¯ä¾›é€‰æ‹©ï¼š</p><ul><li><strong>æŠ¢å…ˆå¼ä¸­æ–­ï¼ˆPreemptive Suspensionï¼‰</strong><br>æŠ¢å…ˆå¼ä¸­æ–­ä¸éœ€è¦çº¿ç¨‹çš„æ‰§è¡Œä»£ç ä¸»åŠ¨å»é…åˆï¼Œ<strong>åœ¨GCå‘ç”Ÿæ—¶ï¼Œé¦–å…ˆæŠŠæ‰€æœ‰çº¿ç¨‹å…¨éƒ¨ä¸­æ–­ï¼Œå¦‚æœå‘ç°æœ‰çº¿ç¨‹ä¸­æ–­çš„åœ°æ–¹ä¸åœ¨å®‰å…¨ç‚¹ä¸Šï¼Œå°±æ¢å¤çº¿ç¨‹ï¼Œè®©å®ƒâ€œè·‘â€åˆ°å®‰å…¨ç‚¹ä¸Šã€‚</strong>ç°åœ¨å‡ ä¹æ²¡æœ‰è™šæ‹Ÿæœºå®ç°é‡‡ç”¨æŠ¢å…ˆå¼ä¸­æ–­æ¥æš‚åœçº¿ç¨‹ä»è€Œå“åº”GCäº‹ä»¶ã€‚</li><li><strong>ä¸»åŠ¨å¼ä¸­æ–­ï¼ˆVoluntary Suspensionï¼‰</strong>ï¼š<br>ä¸»åŠ¨å¼ä¸­æ–­çš„æ€æƒ³æ˜¯å½“GCéœ€è¦ä¸­æ–­çº¿ç¨‹çš„æ—¶å€™ï¼Œä¸ç›´æ¥å¯¹çº¿ç¨‹æ“ä½œï¼Œä»…ä»…ç®€å•åœ°<strong>è®¾ç½®ä¸€ä¸ªæ ‡å¿—</strong>ï¼Œå„ä¸ªçº¿ç¨‹æ‰§è¡Œæ—¶ä¸»åŠ¨å»è½®è¯¢è¿™ä¸ªæ ‡å¿—ï¼Œå‘ç°ä¸­æ–­æ ‡å¿—ä¸ºçœŸæ—¶å°±è‡ªå·±ä¸­æ–­æŒ‚èµ·ã€‚<strong>è½®è¯¢æ ‡å¿—çš„åœ°æ–¹å’Œå®‰å…¨ç‚¹æ˜¯é‡åˆçš„</strong>ï¼Œå¦å¤–<strong>å†åŠ ä¸Šåˆ›å»ºå¯¹è±¡éœ€è¦åˆ†é…å†…å­˜çš„åœ°æ–¹</strong>ã€‚</li></ul><h4 id="å®‰å…¨åŒºåŸŸï¼ˆSafe-Regionï¼‰"><a href="#å®‰å…¨åŒºåŸŸï¼ˆSafe-Regionï¼‰" class="headerlink" title="å®‰å…¨åŒºåŸŸï¼ˆSafe Regionï¼‰"></a>å®‰å…¨åŒºåŸŸï¼ˆSafe Regionï¼‰</h4><p><strong>Safepoint</strong>æœºåˆ¶ä¿è¯äº†<strong>ç¨‹åºæ‰§è¡Œæ—¶</strong>ï¼Œåœ¨ä¸å¤ªé•¿çš„æ—¶é—´å†…å°±ä¼šé‡åˆ°å¯è¿›å…¥GCçš„Safepointã€‚ä½†æ˜¯ï¼Œ<strong>ç¨‹åºâ€œä¸æ‰§è¡Œâ€çš„æ—¶å€™ï¼ˆå¦‚çº¿ç¨‹å¤„äºSleepçŠ¶æ€æˆ–BlockedçŠ¶æ€ï¼‰</strong>ï¼Œè¿™æ—¶çº¿ç¨‹æ— æ³•å“åº”JVMçš„ä¸­æ–­è¯·æ±‚ï¼Œâ€œèµ°åˆ°â€å®‰å…¨çš„åœ°æ–¹å»ä¸­æ–­æŒ‚èµ·ï¼Œè¿™æ—¶å€™å°±éœ€è¦<strong>å®‰å…¨åŒºåŸŸï¼ˆSafe Regionï¼‰</strong>æ¥è§£å†³ã€‚</p><p>å®‰å…¨åŒºåŸŸæ˜¯æŒ‡<strong>åœ¨ä¸€æ®µä»£ç ç‰‡æ®µä¹‹ä¸­ï¼Œå¼•ç”¨å…³ç³»ä¸ä¼šå‘ç”Ÿå˜åŒ–ã€‚åœ¨è¿™ä¸ªåŒºåŸŸä¸­çš„ä»»æ„åœ°æ–¹å¼€å§‹GCéƒ½æ˜¯å®‰å…¨çš„ã€‚</strong>æˆ‘ä»¬ä¹Ÿå¯ä»¥æŠŠSafe Regionçœ‹åšæ˜¯è¢«æ‰©å±•äº†çš„Safepointã€‚</p><p>åœ¨çº¿ç¨‹æ‰§è¡Œåˆ°Safe Regionä¸­çš„ä»£ç æ—¶ï¼Œé¦–å…ˆ<strong>æ ‡è¯†è‡ªå·±å·²ç»è¿›å…¥äº†Safe Region</strong>ï¼Œé‚£æ ·ï¼Œå½“åœ¨è¿™æ®µæ—¶é—´é‡ŒJVMè¦å‘èµ·GCæ—¶ï¼Œå°±ä¸ç”¨ç®¡æ ‡è¯†è‡ªå·±ä¸ºSafe RegionçŠ¶æ€çš„çº¿ç¨‹äº†ã€‚<strong>åœ¨çº¿ç¨‹è¦ç¦»å¼€Safe Regionæ—¶ï¼Œå®ƒè¦æ£€æŸ¥ç³»ç»Ÿæ˜¯å¦å·²ç»å®Œæˆäº†æ ¹èŠ‚ç‚¹æšä¸¾ï¼ˆæˆ–è€…æ˜¯æ•´ä¸ªGCè¿‡ç¨‹ï¼‰</strong>ï¼Œå¦‚æœå®Œæˆäº†ï¼Œé‚£çº¿ç¨‹å°±ç»§ç»­æ‰§è¡Œï¼Œå¦åˆ™å®ƒå°±å¿…é¡»ç­‰å¾…ç›´åˆ°æ”¶åˆ°å¯ä»¥å®‰å…¨ç¦»å¼€Safe Regionçš„ä¿¡å·ä¸ºæ­¢ã€‚</p><h1 id="å†…å­˜åˆ†é…ç­–ç•¥"><a href="#å†…å­˜åˆ†é…ç­–ç•¥" class="headerlink" title="å†…å­˜åˆ†é…ç­–ç•¥"></a>å†…å­˜åˆ†é…ç­–ç•¥</h1><p>Javaçš„è‡ªåŠ¨å†…å­˜ç®¡ç†æœ€ç»ˆå¯ä»¥å½’ç»“ä¸ºè‡ªåŠ¨åŒ–åœ°è§£å†³äº†ä¸¤ä¸ªé—®é¢˜ï¼š</p><ul><li><strong>ç»™å¯¹è±¡åˆ†é…å†…å­˜</strong></li><li><strong>å›æ”¶åˆ†é…ç»™å¯¹è±¡çš„å†…å­˜</strong></li></ul><p>å¯¹è±¡çš„å†…å­˜åˆ†é…é€šå¸¸æ˜¯åœ¨å †ä¸Šåˆ†é…ï¼ˆé™¤æ­¤ä»¥å¤–è¿˜æœ‰å¯èƒ½ç»è¿‡JITç¼–è¯‘åè¢«æ‹†æ•£ä¸ºæ ‡é‡ç±»å‹å¹¶é—´æ¥åœ°æ ˆä¸Šåˆ†é…ï¼‰ï¼Œå¯¹è±¡ä¸»è¦åˆ†é…åœ¨æ–°ç”Ÿä»£çš„EdenåŒºä¸Šï¼Œå¦‚æœå¯åŠ¨äº†æœ¬åœ°çº¿ç¨‹åˆ†é…ç¼“å†²ï¼Œå°†æŒ‰çº¿ç¨‹ä¼˜å…ˆåœ¨TLABä¸Šåˆ†é…ã€‚å°‘æ•°æƒ…å†µä¸‹ä¹Ÿå¯èƒ½ä¼šç›´æ¥åˆ†é…åœ¨è€å¹´ä»£ä¸­ï¼Œåˆ†é…çš„è§„åˆ™å¹¶ä¸æ˜¯å›ºå®šçš„ï¼Œå®é™…å–å†³äºåƒåœ¾æ”¶é›†å™¨çš„å…·ä½“ç»„åˆä»¥åŠè™šæ‹Ÿæœºä¸­ä¸å†…å­˜ç›¸å…³çš„å‚æ•°çš„è®¾ç½®ã€‚è‡³äºå†…å­˜å›æ”¶ç­–ç•¥ï¼Œåœ¨ä¸Šæ–‡å·²ç»æè¿°å¾—å¾ˆè¯¦å°½äº†ã€‚</p><p>ä¸‹é¢ä»¥ä½¿ç”¨Serial/Serial Oldæ”¶é›†å™¨ï¼ˆå°†åœ¨ä¸‹ä¸€ç¯‡æ–‡ç« ä¸­è®²è§£ï¼‰ä¸ºä¾‹ï¼Œä»‹ç»å†…å­˜åˆ†é…çš„ç­–ç•¥ã€‚</p><h4 id="å¯¹è±¡ä¼˜å…ˆåœ¨EdenåŒºåˆ†é…"><a href="#å¯¹è±¡ä¼˜å…ˆåœ¨EdenåŒºåˆ†é…" class="headerlink" title="å¯¹è±¡ä¼˜å…ˆåœ¨EdenåŒºåˆ†é…"></a>å¯¹è±¡ä¼˜å…ˆåœ¨EdenåŒºåˆ†é…</h4><p>å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œå¯¹è±¡åœ¨æ–°ç”Ÿä»£çš„EdenåŒºä¸­åˆ†é…ã€‚<strong>å½“EdenåŒºæ²¡æœ‰è¶³å¤Ÿç©ºé—´è¿›è¡Œåˆ†é…æ—¶ï¼Œè™šæ‹Ÿæœºå°†å‘èµ·ä¸€æ¬¡Minor GCã€‚</strong></p><h4 id="å¤§å¯¹è±¡ç›´æ¥è¿›å…¥è€å¹´ä»£"><a href="#å¤§å¯¹è±¡ç›´æ¥è¿›å…¥è€å¹´ä»£" class="headerlink" title="å¤§å¯¹è±¡ç›´æ¥è¿›å…¥è€å¹´ä»£"></a>å¤§å¯¹è±¡ç›´æ¥è¿›å…¥è€å¹´ä»£</h4><p>æ‰€è°“çš„å¤§å¯¹è±¡æ˜¯æŒ‡ï¼Œéœ€è¦å¤§é‡è¿ç»­å†…å­˜ç©ºé—´çš„Javaå¯¹è±¡ï¼Œæœ€å…¸å‹çš„å¤§å¯¹è±¡å°±æ˜¯å¾ˆé•¿çš„å­—ç¬¦ä¸²ä»¥åŠæ•°ç»„ã€‚å¤§å¯¹è±¡å¯¹è™šæ‹Ÿæœºçš„å†…å­˜åˆ†é…æ¥è¯´æ˜¯ä¸€ä¸ªåæ¶ˆæ¯ï¼ˆå°¤å…¶æ˜¯é‡åˆ°æœç”Ÿå¤•ç­çš„â€œçŸ­å‘½å¤§å¯¹è±¡â€ï¼Œå†™ç¨‹åºæ—¶åº”é¿å…ï¼‰ï¼Œ<strong>ç»å¸¸å‡ºç°å¤§å¯¹è±¡å®¹æ˜“å¯¼è‡´å†…å­˜è¿˜æœ‰ä¸å°‘ç©ºé—´æ—¶å°±æå‰è§¦å‘GCä»¥è·å–è¶³å¤Ÿçš„è¿ç»­ç©ºé—´æ¥å®‰ç½®å®ƒä»¬</strong>ã€‚</p><p>è™šæ‹Ÿæœºæä¾›äº†ä¸€ä¸ª<strong>-XX:PretenureSizeThreshold</strong>å‚æ•°ï¼Œä»¤å¤§äºè¿™ä¸ªè®¾ç½®å€¼çš„å¯¹è±¡ç›´æ¥åœ¨è€å¹´ä»£åˆ†é…ã€‚è¿™æ ·åšçš„ç›®çš„æ˜¯<strong>é¿å…åœ¨EdenåŒºåŠä¸¤ä¸ªSurvivoråŒºä¹‹é—´å‘ç”Ÿå¤§é‡çš„å†…å­˜å¤åˆ¶</strong>ï¼ˆæ–°ç”Ÿä»£é‡‡ç”¨å¤åˆ¶ç®—æ³•å›æ”¶å†…å­˜ï¼‰ã€‚</p><h4 id="é•¿æœŸå­˜æ´»çš„å¯¹è±¡å°†è¿›å…¥è€å¹´ä»£"><a href="#é•¿æœŸå­˜æ´»çš„å¯¹è±¡å°†è¿›å…¥è€å¹´ä»£" class="headerlink" title="é•¿æœŸå­˜æ´»çš„å¯¹è±¡å°†è¿›å…¥è€å¹´ä»£"></a>é•¿æœŸå­˜æ´»çš„å¯¹è±¡å°†è¿›å…¥è€å¹´ä»£</h4><p>æ—¢ç„¶è™šæ‹Ÿæœºé‡‡ç”¨äº†åˆ†ä»£æ”¶é›†çš„æ€æƒ³æ¥ç®¡ç†å†…å­˜ï¼Œé‚£ä¹ˆå†…å­˜å›æ”¶æ—¶å°±å¿…é¡»èƒ½è¯†åˆ«å“ªäº›å¯¹è±¡åº”æ”¾åœ¨æ–°ç”Ÿä»£ï¼Œå“ªäº›å¯¹è±¡åº”æ”¾åœ¨è€å¹´ä»£ä¸­ã€‚ä¸ºäº†åšåˆ°è¿™ç‚¹ï¼Œè™šæ‹Ÿæœºç»™æ¯ä¸ªå¯¹è±¡å®šä¹‰äº†ä¸€ä¸ª<strong>å¯¹è±¡å¹´é¾„ï¼ˆAgeï¼‰è®¡æ•°å™¨</strong>ã€‚<strong>å¦‚æœå¯¹è±¡åœ¨Edenå‡ºç”Ÿå¹¶ç»è¿‡ç¬¬ä¸€æ¬¡Minor GCåä»ç„¶å­˜æ´»ï¼Œå¹¶ä¸”èƒ½è¢«Survivorå®¹çº³çš„è¯ï¼Œå°†è¢«ç§»åŠ¨åˆ°Survivorç©ºé—´ä¸­ï¼Œå¹¶ä¸”å¯¹è±¡å¹´é¾„è®¾ä¸º1ã€‚å¯¹è±¡åœ¨SurvivoråŒºä¸­æ¯â€œç†¬è¿‡â€ä¸€æ¬¡Minor GCï¼Œå¹´é¾„å°±å¢åŠ 1å²ï¼Œå½“å®ƒçš„å¹´é¾„å¢åŠ åˆ°ä¸€å®šç¨‹åº¦ï¼ˆé»˜è®¤ä¸º15å²ï¼‰ï¼Œå°±å°†ä¼šè¢«æ™‹å‡åˆ°è€å¹´ä»£ä¸­ã€‚</strong>å¯¹è±¡æ™‹å‡è€å¹´ä»£çš„å¹´é¾„é˜ˆå€¼ï¼Œå¯ä»¥é€šè¿‡å‚æ•°<strong>-XX:MaxTenuringThreshold</strong>è®¾ç½®ã€‚</p><h4 id="åŠ¨æ€å¯¹è±¡å¹´é¾„åˆ¤å®š"><a href="#åŠ¨æ€å¯¹è±¡å¹´é¾„åˆ¤å®š" class="headerlink" title="åŠ¨æ€å¯¹è±¡å¹´é¾„åˆ¤å®š"></a>åŠ¨æ€å¯¹è±¡å¹´é¾„åˆ¤å®š</h4><p>ä¸ºäº†èƒ½æ›´å¥½åœ°é€‚åº”ä¸åŒç¨‹åºçš„å†…å­˜çŠ¶å†µï¼Œè™šæ‹Ÿæœºå¹¶ä¸æ˜¯æ°¸è¿œåœ°è¦æ±‚å¯¹è±¡çš„å¹´é¾„å¿…é¡»è¾¾åˆ°äº†<strong>MaxTenuringThreshold</strong>æ‰èƒ½æ™‹å‡è€å¹´ä»£ï¼Œ<strong>å¦‚æœåœ¨Survivorç©ºé—´ä¸­ç›¸åŒå¹´é¾„æ‰€æœ‰å¯¹è±¡å¤§å°çš„æ€»å’Œå¤§äºSurvivorç©ºé—´çš„ä¸€åŠï¼Œå¹´é¾„å¤§äºæˆ–ç­‰äºè¯¥å¹´é¾„çš„å¯¹è±¡å°±å¯ä»¥ç›´æ¥è¿›å…¥è€å¹´ä»£</strong>ï¼Œæ— é¡»ç­‰åˆ°<strong>MaxTenuringThreshold</strong>ä¸­è¦æ±‚çš„å¹´é¾„ã€‚</p><h4 id="ç©ºé—´åˆ†é…æ‹…ä¿"><a href="#ç©ºé—´åˆ†é…æ‹…ä¿" class="headerlink" title="ç©ºé—´åˆ†é…æ‹…ä¿"></a>ç©ºé—´åˆ†é…æ‹…ä¿</h4><p><strong>åœ¨å‘ç”ŸMinor GCä¹‹å‰</strong>ï¼Œè™šæ‹Ÿæœºä¼šå…ˆæ£€æŸ¥è€å¹´ä»£æœ€å¤§å¯ç”¨çš„è¿ç»­ç©ºé—´æ˜¯å¦å¤§äºæ–°ç”Ÿä»£æ‰€æœ‰å¯¹è±¡æ€»ç©ºé—´ï¼Œå¦‚æœè¿™ä¸ªæ¡ä»¶æˆç«‹ï¼Œé‚£ä¹ˆMinor GCå¯ä»¥ç¡®ä¿æ˜¯å®‰å…¨çš„ã€‚å¦‚æœä¸æˆç«‹ï¼Œåˆ™è™šæ‹Ÿæœºä¼šæŸ¥çœ‹<strong>HandlePromotionFailure</strong>è®¾ç½®å€¼æ˜¯å¦å…è®¸æ‹…ä¿å¤±è´¥ã€‚å¦‚æœå…è®¸ï¼Œé‚£ä¹ˆä¼šç»§ç»­æ£€æŸ¥è€å¹´ä»£æœ€å¤§å¯ç”¨çš„è¿ç»­ç©ºé—´æ˜¯å¦å¤§äºå†æ¬¡æ™‹å‡åˆ°è€å¹´ä»£å¯¹è±¡çš„å¹³å‡å¤§å°ï¼Œå¦‚æœå¤§äºï¼Œå°†å°è¯•ç€è¿›è¡Œä¸€æ¬¡Minor GCï¼Œå°½ç®¡è¿™æ¬¡Minor GCæ˜¯æœ‰é£é™©çš„ï¼›å¦‚æœå°äºï¼Œæˆ–è€…<strong>HandlePromotionFailure</strong>è®¾ç½®ä¸å…è®¸å†’é™©ï¼Œé‚£è¿™æ—¶ä¹Ÿè¦æ”¹ä¸ºè¿›è¡Œä¸€æ¬¡<strong>Full GC</strong>ã€‚</p><p>å‰é¢æåˆ°è¿‡ï¼Œæ–°ç”Ÿä»£ä½¿ç”¨å¤åˆ¶æ”¶é›†ç®—æ³•ï¼Œä½†ä¸ºäº†å†…å­˜åˆ©ç”¨ç‡ï¼Œåªä½¿ç”¨å…¶ä¸­ä¸€ä¸ªSurvivorç©ºé—´æ¥ä½œä¸ºè½®æ¢å¤‡ä»½ï¼Œå› æ­¤<strong>å½“å‡ºç°å¤§é‡å¯¹è±¡åœ¨Minor GCåä»ç„¶å­˜æ´»çš„æƒ…å†µï¼ˆæœ€æç«¯çš„æƒ…å†µå°±æ˜¯å†…å­˜å›æ”¶åæ–°ç”Ÿä»£ä¸­æ‰€æœ‰å¯¹è±¡éƒ½å­˜æ´»ï¼‰ï¼Œå°±éœ€è¦è€å¹´ä»£è¿›è¡Œåˆ†é…æ‹…ä¿ï¼ŒæŠŠSurvivoræ— æ³•å®¹çº³çš„å¯¹è±¡ç›´æ¥è¿›å…¥è€å¹´ä»£ã€‚</strong>ä¸ç”Ÿæ´»ä¸­çš„è´·æ¬¾æ‹…ä¿ç±»ä¼¼ï¼Œè€å¹´ä»£è¦è¿›è¡Œè¿™æ ·çš„æ‹…ä¿ï¼Œå‰ææ˜¯è€å¹´ä»£æœ¬èº«è¿˜æœ‰å®¹çº³è¿™äº›å¯¹è±¡çš„å‰©ä½™ç©ºé—´ï¼Œä¸€å…±æœ‰å¤šå°‘å¯¹è±¡ä¼šæ´»ä¸‹æ¥åœ¨å®é™…å®Œæˆå†…å­˜å›æ”¶ä¹‹å‰æ˜¯æ— æ³•æ˜ç¡®çŸ¥é“çš„ï¼Œæ‰€ä»¥åªå¥½å–ä¹‹å‰æ¯ä¸€æ¬¡å›æ”¶æ™‹å‡åˆ°è€å¹´ä»£å¯¹è±¡å®¹é‡çš„å¹³å‡å¤§å°å€¼ä½œä¸ºç»éªŒå€¼ï¼Œä¸è€å¹´ä»£çš„å‰©ä½™ç©ºé—´è¿›è¡Œæ¯”è¾ƒï¼Œå†³å®šæ˜¯å¦è¿›è¡ŒFull GCæ¥è®©è€å¹´ä»£è…¾å‡ºæ›´å¤šç©ºé—´ã€‚</p><p>å–å¹³å‡å€¼è¿›è¡Œæ¯”è¾ƒå…¶å®ä»ç„¶æ˜¯ä¸€ç§åŠ¨æ€æ¦‚ç‡çš„æ‰‹æ®µï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå¦‚æœæŸæ¬¡Minor GCå­˜æ´»åçš„å¯¹è±¡çªå¢ï¼Œè¿œè¿œé«˜äºå¹³å‡å€¼çš„è¯ï¼Œä¾ç„¶ä¼šå¯¼è‡´<strong>æ‹…ä¿å¤±è´¥ï¼ˆHandle Promotion Failureï¼‰</strong>ã€‚å¦‚æœå‡ºç°äº†<strong>HandlePromotionFailure</strong>å¤±è´¥ï¼Œé‚£å°±åªå¥½åœ¨å¤±è´¥åé‡æ–°å‘èµ·ä¸€æ¬¡Full GCã€‚è™½ç„¶æ‹…ä¿å¤±è´¥æ—¶ç»•çš„åœˆå­æ˜¯æœ€å¤§çš„ï¼Œä½†å¤§éƒ¨åˆ†æƒ…å†µä¸‹éƒ½è¿˜æ˜¯ä¼šå°†<strong>HandlePromotionFailure</strong>å¼€å…³æ‰“å¼€ï¼Œé¿å…Full GCè¿‡äºé¢‘ç¹ã€‚</p><h1 id="Full-GCçš„è§¦å‘æ¡ä»¶"><a href="#Full-GCçš„è§¦å‘æ¡ä»¶" class="headerlink" title="Full GCçš„è§¦å‘æ¡ä»¶"></a>Full GCçš„è§¦å‘æ¡ä»¶</h1><p>å¯¹äºMinor GCï¼Œå…¶è§¦å‘æ¡ä»¶éå¸¸ç®€å•ï¼Œå½“EdenåŒºç©ºé—´æ»¡æ—¶ï¼Œå°±å°†è§¦å‘ä¸€æ¬¡Minor GCã€‚è€ŒFull GCåˆ™ç›¸å¯¹å¤æ‚ï¼Œå› æ­¤æœ¬èŠ‚æˆ‘ä»¬ä¸»è¦ä»‹ç»Full GCçš„è§¦å‘æ¡ä»¶ã€‚</p><h4 id="è°ƒç”¨System-gc"><a href="#è°ƒç”¨System-gc" class="headerlink" title="è°ƒç”¨System.gc()"></a>è°ƒç”¨System.gc()</h4><p>æ­¤æ–¹æ³•çš„è°ƒç”¨æ˜¯å»ºè®®JVMè¿›è¡ŒFull GC,è™½ç„¶åªæ˜¯å»ºè®®è€Œéä¸€å®š,ä½†å¾ˆå¤šæƒ…å†µä¸‹å®ƒä¼šè§¦å‘ Full GC,ä»è€Œå¢åŠ Full GCçš„é¢‘ç‡,ä¹Ÿå³å¢åŠ äº†é—´æ­‡æ€§åœé¡¿çš„æ¬¡æ•°ã€‚å› æ­¤å¼ºçƒˆå»ºè®®èƒ½ä¸ä½¿ç”¨æ­¤æ–¹æ³•å°±ä¸è¦ä½¿ç”¨ï¼Œè®©è™šæ‹Ÿæœºè‡ªå·±å»ç®¡ç†å®ƒçš„å†…å­˜ï¼Œå¯é€šè¿‡<strong>-XX:+ DisableExplicitGC</strong>æ¥ç¦æ­¢RMIè°ƒç”¨System.gc()ã€‚</p><h4 id="è€å¹´ä»£ç©ºé—´ä¸è¶³"><a href="#è€å¹´ä»£ç©ºé—´ä¸è¶³" class="headerlink" title="è€å¹´ä»£ç©ºé—´ä¸è¶³"></a>è€å¹´ä»£ç©ºé—´ä¸è¶³</h4><p>è€å¹´ä»£ç©ºé—´ä¸è¶³çš„å¸¸è§åœºæ™¯ä¸ºå‰æ–‡æ‰€è®²çš„<strong>å¤§å¯¹è±¡ç›´æ¥è¿›å…¥è€å¹´ä»£</strong>ã€<strong>é•¿æœŸå­˜æ´»çš„å¯¹è±¡è¿›å…¥è€å¹´ä»£</strong>ç­‰ï¼Œå½“æ‰§è¡ŒFull GCåç©ºé—´ä»ç„¶ä¸è¶³ï¼Œåˆ™æŠ›å‡ºå¦‚ä¸‹é”™è¯¯ï¼š<br><code>Java.lang.OutOfMemoryError: Java heap space</code><br>ä¸ºé¿å…ä»¥ä¸Šä¸¤ç§çŠ¶å†µå¼•èµ·çš„Full GCï¼Œè°ƒä¼˜æ—¶åº”å°½é‡åšåˆ°è®©å¯¹è±¡åœ¨Minor GCé˜¶æ®µè¢«å›æ”¶ã€è®©å¯¹è±¡åœ¨æ–°ç”Ÿä»£å¤šå­˜æ´»ä¸€æ®µæ—¶é—´åŠä¸è¦åˆ›å»ºè¿‡å¤§çš„å¯¹è±¡åŠæ•°ç»„ã€‚</p><h4 id="ç©ºé—´åˆ†é…æ‹…ä¿å¤±è´¥"><a href="#ç©ºé—´åˆ†é…æ‹…ä¿å¤±è´¥" class="headerlink" title="ç©ºé—´åˆ†é…æ‹…ä¿å¤±è´¥"></a>ç©ºé—´åˆ†é…æ‹…ä¿å¤±è´¥</h4><p>å‰æ–‡ä»‹ç»è¿‡ï¼Œä½¿ç”¨å¤åˆ¶ç®—æ³•çš„Minor GCéœ€è¦è€å¹´ä»£çš„å†…å­˜ç©ºé—´ä½œæ‹…ä¿ï¼Œå¦‚æœå‡ºç°äº†<strong>HandlePromotionFailure</strong>æ‹…ä¿å¤±è´¥ï¼Œåˆ™ä¼šè§¦å‘Full GCã€‚</p><h4 id="JDK-1-7åŠä»¥å‰çš„æ°¸ä¹…ä»£ç©ºé—´ä¸è¶³"><a href="#JDK-1-7åŠä»¥å‰çš„æ°¸ä¹…ä»£ç©ºé—´ä¸è¶³" class="headerlink" title="JDK 1.7åŠä»¥å‰çš„æ°¸ä¹…ä»£ç©ºé—´ä¸è¶³"></a>JDK 1.7åŠä»¥å‰çš„æ°¸ä¹…ä»£ç©ºé—´ä¸è¶³</h4><p>åœ¨JDK 1.7åŠä»¥å‰ï¼ŒHotSpotè™šæ‹Ÿæœºä¸­çš„æ–¹æ³•åŒºæ˜¯ç”¨æ°¸ä¹…ä»£å®ç°çš„ï¼Œæ°¸ä¹…ä»£ä¸­å­˜æ”¾çš„ä¸ºä¸€äº›classçš„ä¿¡æ¯ã€å¸¸é‡ã€é™æ€å˜é‡ç­‰æ•°æ®ï¼Œå½“ç³»ç»Ÿä¸­è¦åŠ è½½çš„ç±»ã€åå°„çš„ç±»å’Œè°ƒç”¨çš„æ–¹æ³•è¾ƒå¤šæ—¶ï¼ŒPermanet Generationå¯èƒ½ä¼šè¢«å æ»¡ï¼Œåœ¨æœªé…ç½®ä¸ºé‡‡ç”¨CMS GCçš„æƒ…å†µä¸‹ä¹Ÿä¼šæ‰§è¡ŒFull GCã€‚å¦‚æœç»è¿‡Full GCä»ç„¶å›æ”¶ä¸äº†ï¼Œé‚£ä¹ˆJVMä¼šæŠ›å‡ºå¦‚ä¸‹é”™è¯¯ä¿¡æ¯ï¼š<br><code>java.lang.OutOfMemoryError: PermGen space</code><br>ä¸ºé¿å…PermGenå æ»¡é€ æˆFull GCç°è±¡ï¼Œå¯é‡‡ç”¨çš„æ–¹æ³•ä¸ºå¢å¤§PermGenç©ºé—´æˆ–è½¬ä¸ºä½¿ç”¨CMS GCã€‚</p><p>åœ¨JDK 1.8ä¸­ç”¨å…ƒç©ºé—´æ›¿æ¢äº†æ°¸ä¹…ä»£ä½œä¸ºæ–¹æ³•åŒºçš„å®ç°ï¼Œå…ƒç©ºé—´æ˜¯æœ¬åœ°å†…å­˜ï¼Œå› æ­¤å‡å°‘äº†ä¸€ç§Full GCè§¦å‘çš„å¯èƒ½æ€§ã€‚</p><h4 id="Concurrent-Mode-Failure"><a href="#Concurrent-Mode-Failure" class="headerlink" title="Concurrent Mode Failure"></a>Concurrent Mode Failure</h4><p>æ‰§è¡ŒCMS GCçš„è¿‡ç¨‹ä¸­åŒæ—¶æœ‰å¯¹è±¡è¦æ”¾å…¥è€å¹´ä»£ï¼Œè€Œæ­¤æ—¶è€å¹´ä»£ç©ºé—´ä¸è¶³ï¼ˆæœ‰æ—¶å€™â€œç©ºé—´ä¸è¶³â€æ˜¯CMS GCæ—¶å½“å‰çš„æµ®åŠ¨åƒåœ¾è¿‡å¤šå¯¼è‡´æš‚æ—¶æ€§çš„ç©ºé—´ä¸è¶³è§¦å‘Full GCï¼‰ï¼Œä¾¿ä¼šæŠ¥<code>Concurrent Mode Failure</code>é”™è¯¯ï¼Œå¹¶è§¦å‘Full GCã€‚</p><h1 id="å°ç»“"><a href="#å°ç»“" class="headerlink" title="å°ç»“"></a>å°ç»“</h1><p>æœ¬æ–‡ç®€è¦åœ°ä»‹ç»äº†HotSpotè™šæ‹Ÿæœºå¦‚ä½•å»å‘èµ·å†…å­˜å›æ”¶çš„é—®é¢˜ï¼Œä¹Ÿè§£ç­”äº†æ–‡ç« å¼€å¤´æå‡ºçš„ä¸‰ä¸ªé—®é¢˜ä¸­çš„å‰ä¸¤ä¸ªâ€”â€”â€œå“ªäº›å†…å­˜éœ€è¦å›æ”¶â€å’Œâ€œä½•æ—¶å›æ”¶â€ï¼ŒåŒæ—¶å¯¹äºç¬¬ä¸‰ä¸ªé—®é¢˜â€”â€”â€œå¦‚ä½•å›æ”¶â€ï¼Œåœ¨åŸç†å±‚é¢ä½œå‡ºäº†è§£ç­”ã€‚åœ¨ä¸‹ä¸€ç¯‡æ–‡ç« ä¸­ï¼Œç¬”è€…å°†é€šè¿‡ä»‹ç»å‡ ç§å…·ä½“çš„åƒåœ¾æ”¶é›†å™¨ï¼Œæ¥æ›´æ·±å…¥åœ°å›ç­”ç¬¬ä¸‰ä¸ªé—®é¢˜ã€‚</p><h1 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h1><ul><li><a href="https://book.douban.com/subject/24722612/" target="_blank" rel="noopener">ã€Šæ·±å…¥ç†è§£Javaè™šæ‹Ÿæœºâ€”â€”JVMé«˜çº§ç‰¹æ€§ä¸æœ€ä½³å®è·µã€‹ï¼å‘¨å¿—æ˜</a></li><li><a href="https://github.com/CyC2018/CS-Notes/blob/master/docs/notes/Java%20%E8%99%9A%E6%8B%9F%E6%9C%BA.md" target="_blank" rel="noopener">CS-Noteâ€”â€”Javaï¼šjavaè™šæ‹Ÿæœº</a></li><li><a href="https://www.ibm.com/developerworks/cn/java/j-lo-JVMGarbageCollection/index.html" target="_blank" rel="noopener">JVM åƒåœ¾å›æ”¶å™¨å·¥ä½œåŸç†åŠä½¿ç”¨å®ä¾‹ä»‹ç»</a></li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;blockquote&gt;
&lt;p&gt;&lt;a href=&quot;https://meandni.com/2019/01/05/winter_vacation/&quot;&gt;2019å¤§ä¸‰çš„å¯’å‡è®¡åˆ’&lt;/a&gt;â€”â€”åˆ©ç”¨åœ¨å…¬å¸æ¯å¤©æ—©èµ·çš„æ—¶é—´è¯»ä¹¦ï¼Œç¬¬ä¸€æœ¬æ˜¯å‘¨å¿—æ˜è€å¸ˆçš„ã€Šæ·±å…¥ç†è§£Javaè™šæ‹Ÿæœºâ€”â€”JVMé«˜çº§ç‰¹æ€§ä¸æœ€ä½³
      
    
    </summary>
    
      <category term="æ•´ç†" scheme="https://meandni.com/categories/%E6%95%B4%E7%90%86/"/>
    
    
      <category term="è¯»ä¹¦" scheme="https://meandni.com/tags/%E8%AF%BB%E4%B9%A6/"/>
    
      <category term="jvm" scheme="https://meandni.com/tags/jvm/"/>
    
  </entry>
  
  <entry>
    <title>ã€Šæ·±å…¥ç†è§£javaè™šæ‹Ÿæœºã€‹ç¬”è®°1â€”â€”Javaå†…å­˜åŒºåŸŸä¸Javaå¯¹è±¡</title>
    <link href="https://meandni.com/2019/01/10/jvm_note1/"/>
    <id>https://meandni.com/2019/01/10/jvm_note1/</id>
    <published>2019-01-10T03:02:02.000Z</published>
    <updated>2019-01-11T04:32:18.840Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p><a href="https://meandni.com/2019/01/05/winter_vacation/">2019å¤§ä¸‰çš„å¯’å‡è®¡åˆ’</a>â€”â€”åˆ©ç”¨åœ¨å…¬å¸æ¯å¤©æ—©èµ·çš„æ—¶é—´è¯»ä¹¦ï¼Œç¬¬ä¸€æœ¬æ˜¯å‘¨å¿—æ˜è€å¸ˆçš„ã€Šæ·±å…¥ç†è§£Javaè™šæ‹Ÿæœºâ€”â€”JVMé«˜çº§ç‰¹æ€§ä¸æœ€ä½³å®è·µã€‹ï¼Œè¿™ä¸€ç³»åˆ—æ˜¯é€šè¿‡å¯¹åŸæ–‡çš„æ‹œè¯»ä¸è‡ªå·±ç†è§£åŠ ä¸Šç½‘ç»œä¸Šçš„èµ„æ–™æ–‡ç« æ•´ç†å‡ºçš„è¯»ä¹¦ç¬”è®°ã€‚</p></blockquote><h1 id="è¿è¡Œæ—¶æ•°æ®åŒºåŸŸ"><a href="#è¿è¡Œæ—¶æ•°æ®åŒºåŸŸ" class="headerlink" title="è¿è¡Œæ—¶æ•°æ®åŒºåŸŸ"></a>è¿è¡Œæ—¶æ•°æ®åŒºåŸŸ</h1><p>JVMè½½æ‰§è¡ŒJavaç¨‹åºçš„è¿‡ç¨‹ä¸­ä¼šæŠŠå®ƒæ‰€ç®¡ç†çš„å†…å­˜åˆ’åˆ†ä¸ºè‹¥å¹²ä¸ªä¸åŒçš„æ•°æ®åŒºåŸŸã€‚è¿™äº›åŒºåŸŸéƒ½æœ‰å„è‡ªçš„ç”¨é€”ï¼Œä»¥åŠåˆ›å»ºå’Œé”€æ¯çš„æ—¶é—´ï¼Œæœ‰çš„åŒºåŸŸéšç€è™šæ‹Ÿæœºè¿›ç¨‹çš„å¯åŠ¨è€Œå­˜åœ¨ï¼Œæœ‰äº›åŒºåŸŸåˆ™æ˜¯ä¾èµ–ç”¨æˆ·çº¿ç¨‹çš„å¯åŠ¨å’Œç»“æŸè€Œå»ºç«‹å’Œé”€æ¯ã€‚å…·ä½“å¦‚ä¸‹å›¾æ‰€ç¤ºï¼šï¼ˆå…¶ä¸­ç¨‹åºè®¡æ•°å™¨ã€Javaè™šæ‹Ÿæœºæ ˆã€æœ¬åœ°æ–¹æ³•æ ˆä¸ºçº¿ç¨‹ç§æœ‰ï¼›Javaå †ã€æ–¹æ³•åŒºä½çº¿ç¨‹å…±äº«çš„å†…å­˜åŒºåŸŸã€‚ï¼‰</p><figure class="image-bubble">                <div class="img-lightbox">                    <div class="overlay"></div>                    <img src="https://pic.yupoo.com/crowhawk/3d24df02/776c8d55.png" alt="" title="">                </div>                <div class="image-caption"></div>            </figure><h4 id="ç¨‹åºè®¡æ•°å™¨ï¼ˆProgram-Counter-Registerï¼‰"><a href="#ç¨‹åºè®¡æ•°å™¨ï¼ˆProgram-Counter-Registerï¼‰" class="headerlink" title="ç¨‹åºè®¡æ•°å™¨ï¼ˆProgram Counter Registerï¼‰"></a>ç¨‹åºè®¡æ•°å™¨ï¼ˆProgram Counter Registerï¼‰</h4><p><strong>ç¨‹åºè®¡æ•°å™¨ï¼ˆProgram Counter Registerï¼‰</strong>æ˜¯ä¸€å—è¾ƒå°çš„å†…å­˜ç©ºé—´ï¼Œå¯ä»¥çœ‹ä½œæ˜¯å½“å‰çº¿ç¨‹æ‰€æ‰§è¡Œçš„å­—èŠ‚ç çš„<strong>è¡Œå·æŒ‡ç¤ºå™¨</strong>ã€‚åœ¨è™šæ‹Ÿæœºæ¦‚å¿µæ¨¡å‹ä¸­ï¼Œ<strong>å­—èŠ‚ç è§£é‡Šå™¨</strong>å·¥ä½œæ—¶å°±æ˜¯é€šè¿‡æ”¹å˜è®¡æ•°å™¨çš„å€¼æ¥é€‰å–ä¸‹ä¸€æ¡éœ€è¦æ‰§è¡Œçš„å­—èŠ‚ç æŒ‡ä»¤ï¼Œåˆ†æ”¯ã€å¾ªç¯ã€è·³è½¬ã€å¼‚å¸¸å¤„ç†ã€çº¿ç¨‹æ¢å¤ç­‰åŸºç¡€åŠŸèƒ½éƒ½éœ€è¦ä¾èµ–è¿™ä¸ªè®¡æ•°å™¨æ¥å®Œæˆã€‚</p><p>ç¨‹åºè®¡æ•°å™¨æ˜¯ä¸€å—<strong>â€œçº¿ç¨‹ç§æœ‰â€</strong>çš„å†…å­˜ï¼Œå¦‚ä¸Šæ–‡çš„å›¾æ‰€ç¤ºï¼Œæ¯æ¡çº¿ç¨‹éƒ½æœ‰ä¸€ä¸ªç‹¬ç«‹çš„ç¨‹åºè®¡æ•°å™¨ï¼Œå„æ¡çº¿ç¨‹ä¹‹é—´çš„è®¡æ•°å™¨äº’ä¸å½±å“ï¼Œç‹¬ç«‹å­˜å‚¨ã€‚è¿™æ ·è®¾è®¡ä½¿å¾—åœ¨å¤šçº¿ç¨‹ç¯å¢ƒä¸‹ï¼Œçº¿ç¨‹åˆ‡æ¢åèƒ½æ¢å¤åˆ°æ­£ç¡®çš„æ‰§è¡Œä½ç½®ã€‚</p><p>å¦‚æœçº¿ç¨‹æ­£åœ¨æ‰§è¡Œçš„æ˜¯ä¸€ä¸ª<strong>Javaæ–¹æ³•</strong>ï¼Œè¿™ä¸ªè®¡æ•°å™¨è®°å½•çš„æ˜¯æ­£åœ¨æ‰§è¡Œçš„<strong>è™šæ‹Ÿæœºå­—èŠ‚ç æŒ‡ä»¤çš„åœ°å€</strong>ï¼›è‹¥æ‰§è¡Œçš„æ˜¯<strong>Nativeæ–¹æ³•</strong>ï¼Œåˆ™<strong>è®¡æ•°å™¨ä¸ºç©ºï¼ˆUndefinedï¼‰</strong>ï¼ˆå› ä¸ºå¯¹äºNativeæ–¹æ³•è€Œè¨€ï¼Œå®ƒçš„æ–¹æ³•ä½“å¹¶ä¸æ˜¯ç”±Javaå­—èŠ‚ç æ„æˆçš„ï¼Œè‡ªç„¶æ— æ³•åº”ç”¨ä¸Šè¿°çš„â€œå­—èŠ‚ç æŒ‡ä»¤çš„åœ°å€â€çš„æ¦‚å¿µï¼‰ã€‚ç¨‹åºè®¡æ•°å™¨ä¹Ÿæ˜¯å”¯ä¸€ä¸€ä¸ªåœ¨Javaè™šæ‹Ÿæœºè§„èŒƒä¸­<strong>æ²¡æœ‰</strong>è§„å®šä»»ä½•<strong>OutOfMemoryError</strong>æƒ…å†µçš„å†…å­˜åŒºåŸŸã€‚</p><h4 id="Javaè™šæ‹Ÿæœºæ ˆï¼ˆJava-Virtual-Machine-Stacksï¼‰"><a href="#Javaè™šæ‹Ÿæœºæ ˆï¼ˆJava-Virtual-Machine-Stacksï¼‰" class="headerlink" title="Javaè™šæ‹Ÿæœºæ ˆï¼ˆJava Virtual Machine Stacksï¼‰"></a>Javaè™šæ‹Ÿæœºæ ˆï¼ˆJava Virtual Machine Stacksï¼‰</h4><p><strong>Javaè™šæ‹Ÿæœºæ ˆï¼ˆJava Virtual Machine Stacksï¼‰</strong>æè¿°çš„æ˜¯<strong>Javaæ–¹æ³•æ‰§è¡Œçš„å†…å­˜æ¨¡å‹</strong>ï¼šæ¯ä¸ªæ–¹æ³•åœ¨æ‰§è¡Œçš„åŒæ—¶éƒ½ä¼šåˆ›å»ºä¸€ä¸ª<strong>æ ˆå¸§ï¼ˆStack Frameï¼‰</strong>ï¼Œæ ˆå¸§ä¸­å­˜å‚¨ç€<strong>å±€éƒ¨å˜é‡è¡¨</strong>ã€<strong>æ“ä½œæ•°æ ˆ</strong>ã€<strong>åŠ¨æ€é“¾æ¥</strong>ã€<strong>æ–¹æ³•å‡ºå£</strong>ç­‰ä¿¡æ¯ã€‚<strong>æ¯ä¸€ä¸ªæ–¹æ³•ä»è°ƒç”¨ç›´è‡³æ‰§è¡Œå®Œæˆçš„è¿‡ç¨‹ï¼Œä¼šå¯¹åº”ä¸€ä¸ªæ ˆå¸§åœ¨è™šæ‹Ÿæœºæ ˆä¸­å…¥æ ˆåˆ°å‡ºæ ˆçš„è¿‡ç¨‹ã€‚</strong>ä¸ç¨‹åºè®¡æ•°å™¨ä¸€æ ·ï¼ŒJavaè™šæ‹Ÿæœºæ ˆä¹Ÿæ˜¯<strong>çº¿ç¨‹ç§æœ‰</strong>çš„ã€‚</p><p>å‡½æ•°çš„è°ƒç”¨æœ‰å®Œç¾çš„åµŒå¥—å…³ç³»â€”â€”è°ƒç”¨è€…çš„ç”Ÿå‘½æœŸæ€»æ˜¯é•¿äºè¢«è°ƒç”¨è€…çš„ç”Ÿå‘½æœŸï¼Œå¹¶ä¸”åè€…åœ¨å‰è€…çš„ä¹‹å†…ã€‚è¿™æ ·ï¼Œè¢«è°ƒç”¨è€…çš„å±€éƒ¨ä¿¡æ¯æ‰€å ç©ºé—´çš„åˆ†é…æ€»æ˜¯åäºè°ƒç”¨è€…çš„ï¼ˆåå…¥ï¼‰ï¼Œè€Œå…¶é‡Šæ”¾åˆ™æ€»æ˜¯å…ˆäºè°ƒç”¨è€…çš„ï¼ˆå…ˆå‡ºï¼‰ï¼Œæ‰€ä»¥æ­£å¥½å¯ä»¥æ»¡è¶³æ ˆçš„LIFOé¡ºåºï¼Œé€‰ç”¨æ ˆè¿™ç§æ•°æ®ç»“æ„æ¥å®ç°è°ƒç”¨æ ˆæ˜¯ä¸€ç§å¾ˆè‡ªç„¶çš„é€‰æ‹©ã€‚</p><p><strong>å±€éƒ¨å˜é‡è¡¨</strong>ä¸­å­˜æ”¾äº†ç¼–è¯‘æœŸå¯çŸ¥çš„å„ç§ï¼š</p><ul><li><strong>åŸºæœ¬æ•°æ®ç±»å‹</strong>(boolenã€byteã€charã€shortã€intã€ floatã€ longã€doubleï¼‰</li><li><strong>å¯¹è±¡å¼•ç”¨</strong>ï¼ˆreferenceç±»å‹ï¼Œå®ƒä¸ç­‰äºå¯¹è±¡æœ¬èº«ï¼Œå¯èƒ½æ˜¯ä¸€ä¸ªæŒ‡å‘å¯¹è±¡èµ·å§‹åœ°å€çš„æŒ‡é’ˆï¼Œä¹Ÿå¯èƒ½æ˜¯æŒ‡å‘ä¸€ä¸ªä»£è¡¨å¯¹è±¡çš„å¥æŸ„æˆ–å…¶ä»–ä¸æ­¤å¯¹è±¡ç›¸å…³çš„ä½ç½®ï¼‰</li><li><strong>returnAddressç±»å‹</strong>ï¼ˆæŒ‡å‘äº†ä¸€æ¡å­—èŠ‚ç æŒ‡ä»¤çš„åœ°å€ï¼‰</li></ul><p>å…¶ä¸­64ä½é•¿åº¦çš„longå’Œdoubleç±»å‹çš„æ•°æ®ä¼šå ç”¨2ä¸ªå±€éƒ¨å˜é‡ç©ºé—´ï¼ˆSlotï¼‰ï¼Œå…¶ä½™æ•°æ®ç±»å‹åªå ç”¨1ä¸ªã€‚<strong>å±€éƒ¨å˜é‡è¡¨æ‰€éœ€çš„å†…å­˜ç©ºé—´åœ¨ç¼–è¯‘æœŸé—´å®Œæˆåˆ†é…</strong>ï¼Œå½“è¿›å…¥ä¸€ä¸ªæ–¹æ³•æ—¶ï¼Œè¿™ä¸ªæ–¹æ³•éœ€è¦åœ¨å¸§ä¸­åˆ†é…å¤šå¤§çš„å±€éƒ¨å˜é‡ç©ºé—´æ˜¯å®Œå…¨ç¡®å®šçš„ï¼Œåœ¨æ–¹æ³•è¿è¡ŒæœŸé—´ä¸ä¼šæ”¹å˜å±€éƒ¨å˜é‡è¡¨çš„å¤§å°ã€‚</p><p>Javaè™šæ‹Ÿæœºè§„èŒƒä¸­å¯¹è¿™ä¸ªåŒºåŸŸè§„å®šäº†ä¸¤ç§å¼‚å¸¸çŠ¶å†µï¼š</p><ul><li><strong>StackOverflowError</strong>ï¼šçº¿ç¨‹è¯·æ±‚çš„æ ˆæ·±åº¦å¤§äºè™šæ‹Ÿæœºæ‰€å…è®¸çš„æ·±åº¦ï¼Œå°†ä¼šæŠ›å‡ºæ­¤å¼‚å¸¸ã€‚</li><li><strong>OutOfMemoryError</strong>ï¼šå½“å¯åŠ¨æ€æ‰©å±•çš„è™šæ‹Ÿæœºæ ˆåœ¨æ‰©å±•æ—¶æ— æ³•ç”³è¯·åˆ°è¶³å¤Ÿçš„å†…å­˜ï¼Œå°±ä¼šæŠ›å‡ºè¯¥å¼‚å¸¸ã€‚</li></ul><h4 id="æœ¬åœ°æ–¹æ³•æ ˆï¼ˆNative-Method-Stackï¼‰"><a href="#æœ¬åœ°æ–¹æ³•æ ˆï¼ˆNative-Method-Stackï¼‰" class="headerlink" title="æœ¬åœ°æ–¹æ³•æ ˆï¼ˆNative Method Stackï¼‰"></a>æœ¬åœ°æ–¹æ³•æ ˆï¼ˆNative Method Stackï¼‰</h4><p><strong>æœ¬åœ°æ–¹æ³•æ ˆï¼ˆNative Method Stackï¼‰</strong>ä¸Javaè™šæ‹Ÿæœºæ ˆä½œç”¨å¾ˆç›¸ä¼¼ï¼Œå®ƒä»¬çš„åŒºåˆ«åœ¨äºè™šæ‹Ÿæœºæ ˆä¸ºè™šæ‹Ÿæœºæ‰§è¡ŒJavaæ–¹æ³•ï¼ˆå³å­—èŠ‚ç ï¼‰æœåŠ¡ï¼Œè€Œæœ¬åœ°æ–¹æ³•æ ˆåˆ™ä¸ºè™šæ‹Ÿæœºä½¿ç”¨åˆ°çš„Nativeæ–¹æ³•æœåŠ¡ã€‚</p><p>åœ¨è™šæ‹Ÿæœºè§„èŒƒä¸­å¯¹æœ¬åœ°æ–¹æ³•æ ˆä¸­ä½¿ç”¨çš„è¯­è¨€ã€æ–¹å¼å’Œæ•°æ®ç»“æ„å¹¶æ— å¼ºåˆ¶è§„å®šï¼Œå› æ­¤å…·ä½“çš„è™šæ‹Ÿæœºå¯å®ç°å®ƒã€‚ç”šè‡³<strong>æœ‰çš„è™šæ‹Ÿæœºï¼ˆSun HotSpotè™šæ‹Ÿæœºï¼‰ç›´æ¥æŠŠæœ¬åœ°æ–¹æ³•æ ˆå’Œè™šæ‹Ÿæœºæ ˆåˆäºŒä¸ºä¸€</strong>ã€‚ä¸è™šæ‹Ÿæœºä¸€æ ·ï¼Œæœ¬åœ°æ–¹æ³•æ ˆä¼šæŠ›å‡º<strong>StackOverflowError</strong>å’Œ<strong>OutOfMemoryError</strong>å¼‚å¸¸ã€‚</p><h4 id="Javaå †ï¼ˆHeapï¼‰"><a href="#Javaå †ï¼ˆHeapï¼‰" class="headerlink" title="Javaå †ï¼ˆHeapï¼‰"></a>Javaå †ï¼ˆHeapï¼‰</h4><p>å¯¹äºå¤§å¤šæ•°åº”ç”¨è€Œè¨€ï¼Œ<strong>Javaå †ï¼ˆHeapï¼‰</strong>æ˜¯Javaè™šæ‹Ÿæœºæ‰€ç®¡ç†çš„å†…å­˜ä¸­æœ€å¤§çš„ä¸€å—ï¼Œå®ƒ<strong>è¢«æ‰€æœ‰çº¿ç¨‹å…±äº«çš„</strong>ï¼Œåœ¨è™šæ‹Ÿæœºå¯åŠ¨æ—¶åˆ›å»ºã€‚æ­¤å†…å­˜åŒºåŸŸ<strong>å”¯ä¸€çš„ç›®çš„</strong>æ˜¯<strong>å­˜æ”¾å¯¹è±¡å®ä¾‹</strong>ï¼Œå‡ ä¹æ‰€æœ‰çš„å¯¹è±¡å®ä¾‹éƒ½åœ¨è¿™é‡Œåˆ†é…å†…å­˜ï¼Œä¸”æ¯æ¬¡åˆ†é…çš„ç©ºé—´æ˜¯<strong>ä¸å®šé•¿</strong>çš„ã€‚åœ¨Heap ä¸­åˆ†é…ä¸€å®šçš„å†…å­˜æ¥ä¿å­˜å¯¹è±¡å®ä¾‹ï¼Œå®é™…ä¸Šåªæ˜¯ä¿å­˜<strong>å¯¹è±¡å®ä¾‹çš„å±æ€§å€¼</strong>ï¼Œ<strong>å±æ€§çš„ç±»å‹</strong>å’Œ<strong>å¯¹è±¡æœ¬èº«çš„ç±»å‹æ ‡è®°</strong>ç­‰ï¼Œ<strong>å¹¶ä¸ä¿å­˜å¯¹è±¡çš„æ–¹æ³•ï¼ˆæ–¹æ³•æ˜¯æŒ‡ä»¤ï¼Œä¿å­˜åœ¨Stackä¸­ï¼‰</strong>,åœ¨Heap ä¸­åˆ†é…ä¸€å®šçš„å†…å­˜ä¿å­˜å¯¹è±¡å®ä¾‹å’Œå¯¹è±¡çš„åºåˆ—åŒ–æ¯”è¾ƒç±»ä¼¼ã€‚å¯¹è±¡å®ä¾‹åœ¨Heap ä¸­åˆ†é…å¥½ä»¥åï¼Œéœ€è¦<strong>åœ¨Stackä¸­ä¿å­˜ä¸€ä¸ª4å­—èŠ‚çš„Heap å†…å­˜åœ°å€</strong>ï¼Œç”¨æ¥å®šä½è¯¥å¯¹è±¡å®ä¾‹åœ¨Heap ä¸­çš„ä½ç½®ï¼Œä¾¿äºæ‰¾åˆ°è¯¥å¯¹è±¡å®ä¾‹ã€‚</p><p>Javaè™šæ‹Ÿæœºè§„èŒƒä¸­æè¿°é“ï¼šæ‰€æœ‰çš„å¯¹è±¡å®ä¾‹ä»¥åŠæ•°ç»„éƒ½è¦åœ¨å †ä¸Šåˆ†é…ï¼Œä½†æ˜¯éšç€JITç¼–è¯‘å™¨çš„å‘å±•å’Œé€ƒé€¸åˆ†ææŠ€æœ¯é€æ¸æˆç†Ÿï¼Œæ ˆä¸Šåˆ†é…ã€æ ‡é‡æ›¿æ¢ä¼˜åŒ–æŠ€æœ¯å°†ä¼šå¯¼è‡´ä¸€äº›å¾®å¦™çš„å˜åŒ–å‘ç”Ÿï¼Œæ‰€æœ‰çš„å¯¹è±¡éƒ½åœ¨å †ä¸Šåˆ†é…çš„å®šè®ºä¹Ÿå¹¶ä¸<strong>â€œç»å¯¹â€</strong>äº†ã€‚</p><p>Javaå †æ˜¯åƒåœ¾æ”¶é›†å™¨ç®¡ç†çš„ä¸»è¦åŒºåŸŸï¼Œå› æ­¤ä¹Ÿè¢«ç§°ä¸º<strong>â€œGCå †ï¼ˆGarbage Collected Heapï¼‰â€</strong>ã€‚ä»å†…å­˜å›æ”¶çš„è§’åº¦çœ‹å†…å­˜ç©ºé—´å¯å¦‚ä¸‹åˆ’åˆ†ï¼š<br><figure class="image-bubble">                <div class="img-lightbox">                    <div class="overlay"></div>                    <img src="https://pic.yupoo.com/crowhawk/5cf46998/fe5079d3.png" alt="" title="">                </div>                <div class="image-caption"></div>            </figure></p><ul><li><strong>æ–°ç”Ÿä»£ï¼ˆYoungï¼‰</strong>ï¼š æ–°ç”Ÿæˆçš„å¯¹è±¡ä¼˜å…ˆå­˜æ”¾åœ¨æ–°ç”Ÿä»£ä¸­ï¼Œæ–°ç”Ÿä»£å¯¹è±¡æœç”Ÿå¤•æ­»ï¼Œå­˜æ´»ç‡å¾ˆä½ã€‚åœ¨æ–°ç”Ÿä»£ä¸­ï¼Œå¸¸è§„åº”ç”¨è¿›è¡Œä¸€æ¬¡åƒåœ¾æ”¶é›†ä¸€èˆ¬å¯ä»¥å›æ”¶70% ~ 95% çš„ç©ºé—´ï¼Œå›æ”¶æ•ˆç‡å¾ˆé«˜ã€‚æ–°ç”Ÿä»£åˆå¯ç»†åˆ†ä¸º<strong>Edenç©ºé—´</strong>ã€<strong>From Survivorç©ºé—´</strong>ã€<strong>To Survivorç©ºé—´</strong>ï¼Œé»˜è®¤æ¯”ä¾‹ä¸º8:1:1ã€‚å®ƒä»¬çš„å…·ä½“ä½œç”¨å°†åœ¨ä¸‹ä¸€ç¯‡æ–‡ç« è®²è§£GCæ—¶ä»‹ç»ã€‚</li><li><strong>è€å¹´ä»£ï¼ˆTenured/Oldï¼‰</strong>ï¼šåœ¨æ–°ç”Ÿä»£ä¸­ç»å†äº†å¤šæ¬¡ï¼ˆå…·ä½“çœ‹è™šæ‹Ÿæœºé…ç½®çš„é˜€å€¼ï¼‰GCåä»ç„¶å­˜æ´»ä¸‹æ¥çš„å¯¹è±¡ä¼šè¿›å…¥è€å¹´ä»£ä¸­ã€‚è€å¹´ä»£ä¸­çš„å¯¹è±¡ç”Ÿå‘½å‘¨æœŸè¾ƒé•¿ï¼Œå­˜æ´»ç‡æ¯”è¾ƒé«˜ï¼Œåœ¨è€å¹´ä»£ä¸­è¿›è¡ŒGCçš„é¢‘ç‡ç›¸å¯¹è€Œè¨€è¾ƒä½ï¼Œè€Œä¸”å›æ”¶çš„é€Ÿåº¦ä¹Ÿæ¯”è¾ƒæ…¢ã€‚</li><li><strong>æ°¸ä¹…ä»£ï¼ˆPermï¼‰</strong>ï¼šæ°¸ä¹…ä»£å­˜å‚¨ç±»ä¿¡æ¯ã€å¸¸é‡ã€é™æ€å˜é‡ã€å³æ—¶ç¼–è¯‘å™¨ç¼–è¯‘åçš„ä»£ç ç­‰æ•°æ®ï¼Œå¯¹è¿™ä¸€åŒºåŸŸè€Œè¨€ï¼ŒJavaè™šæ‹Ÿæœºè§„èŒƒæŒ‡å‡ºå¯ä»¥ä¸è¿›è¡Œåƒåœ¾æ”¶é›†ï¼Œä¸€èˆ¬è€Œè¨€ä¸ä¼šè¿›è¡Œåƒåœ¾å›æ”¶ã€‚</li></ul><p>å…¶ä¸­<strong>æ–°ç”Ÿä»£å’Œè€å¹´ä»£ç»„æˆäº†Javaå †çš„å…¨éƒ¨å†…å­˜åŒºåŸŸ</strong>ï¼Œè€Œ<strong>æ°¸ä¹…ä»£ä¸å±äºå †ç©ºé—´ï¼Œå®ƒåœ¨JDK 1.8ä»¥å‰è¢«Sun HotSpotè™šæ‹Ÿæœºç”¨ä½œæ–¹æ³•åŒºçš„å®ç°</strong>ï¼Œå…³äºæ–¹æ³•åŒºçš„å…·ä½“å†…å®¹å°†åœ¨ç¨åä»‹ç»ã€‚</p><h4 id="æ–¹æ³•åŒºï¼ˆMethod-Areaï¼‰"><a href="#æ–¹æ³•åŒºï¼ˆMethod-Areaï¼‰" class="headerlink" title="æ–¹æ³•åŒºï¼ˆMethod Areaï¼‰"></a>æ–¹æ³•åŒºï¼ˆMethod Areaï¼‰</h4><p><strong>æ–¹æ³•åŒºï¼ˆMethod Areaï¼‰</strong>ä¸Javaå †ä¸€æ ·ï¼Œæ˜¯å„ä¸ªçº¿ç¨‹å…±äº«çš„å†…å­˜åŒºåŸŸã€‚<strong>Object Class Data(ç±»å®šä¹‰æ•°æ®)</strong>æ˜¯å­˜å‚¨åœ¨æ–¹æ³•åŒºçš„ï¼Œæ­¤å¤–ï¼Œ<strong>å¸¸é‡</strong>ã€<strong>é™æ€å˜é‡</strong>ã€<strong>JITç¼–è¯‘åçš„ä»£ç </strong>ä¹Ÿå­˜å‚¨åœ¨æ–¹æ³•åŒºã€‚æ­£å› ä¸ºæ–¹æ³•åŒºæ‰€å­˜å‚¨çš„æ•°æ®ä¸å †æœ‰ä¸€ç§ç±»æ¯”å…³ç³»ï¼Œæ‰€ä»¥å®ƒè¿˜è¢«ç§°ä¸º <strong>Non-Heap</strong>ã€‚</p> <big><strong>JDK 1.8ä»¥å‰çš„æ°¸ä¹…ä»£ï¼ˆPermGenï¼‰</strong></big><p>Javaè™šæ‹Ÿæœºè§„èŒƒå¯¹æ–¹æ³•åŒºçš„é™åˆ¶éå¸¸å®½æ¾ï¼Œé™¤äº†å’ŒJavaå †ä¸€æ ·ä¸éœ€è¦è¿ç»­çš„å†…å­˜å’Œå¯ä»¥é€‰æ‹©å›ºå®šå¤§å°æˆ–è€…å¯æ‰©å±•å¤–ï¼Œè¿˜å¯ä»¥é€‰æ‹©ä¸å®ç°åƒåœ¾æ”¶é›†ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼ŒJavaè™šæ‹Ÿæœºè§„èŒƒåªæ˜¯è§„å®šäº†æ–¹æ³•åŒºçš„æ¦‚å¿µå’Œå®ƒçš„ä½œç”¨ï¼Œå¹¶æ²¡æœ‰è§„å®šå¦‚ä½•å»å®ç°å®ƒã€‚<strong>å¯¹äºJDK 1.8ä¹‹å‰çš„ç‰ˆæœ¬ï¼ŒHotSpotè™šæ‹Ÿæœºè®¾è®¡å›¢é˜Ÿé€‰æ‹©æŠŠGCåˆ†ä»£æ”¶é›†æ‰©å±•è‡³æ–¹æ³•åŒºï¼Œå³ç”¨æ°¸ä¹…ä»£æ¥å®ç°æ–¹æ³•åŒº</strong>ï¼Œè¿™æ ·HotSpotçš„åƒåœ¾æ”¶é›†å™¨å¯ä»¥åƒç®¡ç†Javaå †ä¸€æ ·ç®¡ç†è¿™éƒ¨åˆ†å†…å­˜ï¼Œèƒ½å¤Ÿçœå»ä¸“é—¨ä¸ºæ–¹æ³•åŒºç¼–å†™å†…å­˜ç®¡ç†ä»£ç çš„å·¥ä½œã€‚å¯¹äºå…¶ä»–çš„è™šæ‹Ÿæœºï¼ˆå¦‚<strong>Oracle JRockit</strong>ã€<strong>IBM J9</strong>ç­‰ï¼‰æ¥è¯´æ˜¯ä¸å­˜åœ¨æ°¸ä¹…ä»£çš„æ¦‚å¿µçš„ã€‚</p><p>å¦‚æœè¿è¡Œæ—¶æœ‰å¤§é‡çš„ç±»äº§ç”Ÿï¼Œå¯èƒ½ä¼šå¯¼è‡´æ–¹æ³•åŒºè¢«å¡«æ»¡ï¼Œç›´è‡³æº¢å‡ºã€‚å¸¸è§çš„åº”ç”¨åœºæ™¯å¦‚ï¼š</p><ul><li>Springå’ŒORMæ¡†æ¶ä½¿ç”¨CGLibæ“çºµå­—èŠ‚ç å¯¹ç±»è¿›è¡Œå¢å¼ºï¼Œå¢å¼ºçš„ç±»è¶Šå¤šï¼Œå°±éœ€è¦è¶Šå¤§çš„æ–¹æ³•åŒºæ¥ä¿è¯åŠ¨æ€ç”Ÿæˆçš„Classå¯ä»¥åŠ è½½å…¥å†…å­˜ã€‚</li><li>å¤§é‡JSPæˆ–åŠ¨æ€äº§ç”ŸJSPæ–‡ä»¶çš„åº”ç”¨ï¼ˆJSPç¬¬ä¸€æ¬¡è¿è¡Œæ—¶éœ€è¦ç¼–è¯‘ä¸ºJavaç±»ï¼‰ã€‚</li><li>åŸºäºOSGiçš„åº”ç”¨ï¼ˆå³ä½¿æ˜¯åŒä¸€ä¸ªç±»æ–‡ä»¶ï¼Œè¢«ä¸åŒçš„ç±»åŠ è½½å™¨åŠ è½½ä¹Ÿä¼šè§†ä¸ºä¸åŒçš„ç±»ï¼‰ã€‚<br>â€¦â€¦</li></ul><p>è¿™äº›éƒ½ä¼šå¯¼è‡´æ–¹æ³•åŒºæº¢å‡ºï¼ŒæŠ¥å‡º<code>java.lang.OutOfMemoryError: PermGen space</code>ã€‚</p><big><strong>JDK 1.8çš„å…ƒç©ºé—´ï¼ˆMetaspaceï¼‰â€”â€” ä¹¦ä¸­æ²¡æœ‰çš„å†…å®¹</strong></big><p>åœ¨JDK 1.8ä¸­ï¼ŒHotSpotè™šæ‹Ÿæœºè®¾è®¡å›¢é˜Ÿä¸ºäº†ä¿ƒè¿›<strong>HotSpot</strong>ä¸ <strong>JRockit</strong>çš„èåˆï¼Œä¿®æ”¹äº†æ–¹æ³•åŒºçš„å®ç°ï¼Œç§»é™¤äº†æ°¸ä¹…ä»£ï¼Œé€‰æ‹©ä½¿ç”¨<strong>æœ¬åœ°åŒ–çš„å†…å­˜ç©ºé—´</strong>ï¼ˆè€Œä¸æ˜¯JVMçš„å†…å­˜ç©ºé—´ï¼‰å­˜æ”¾ç±»çš„å…ƒæ•°æ®ï¼Œè¿™ä¸ªç©ºé—´å«åš<strong>å…ƒç©ºé—´ï¼ˆMetaspaceï¼‰</strong>ã€‚</p><p>åšäº†è¿™ä¸ªæ”¹åŠ¨ä»¥åï¼Œ<code>java.lang.OutOfMemoryError: PermGen</code>çš„ç©ºé—´é—®é¢˜å°†ä¸å¤å­˜åœ¨ï¼Œå¹¶ä¸”ä¸å†éœ€è¦è°ƒæ•´å’Œç›‘æ§è¿™ä¸ªå†…å­˜ç©ºé—´ã€‚ä¸”è™šæ‹Ÿæœºéœ€è¦ä¸ºæ–¹æ³•åŒºè®¾è®¡é¢å¤–çš„GCç­–ç•¥ï¼šå¦‚æœç±»å…ƒæ•°æ®çš„ç©ºé—´å ç”¨è¾¾åˆ°å‚æ•°<strong>â€œMaxMetaspaceSizeâ€</strong>è®¾ç½®çš„å€¼ï¼Œå°†ä¼šè§¦å‘å¯¹æ­»äº¡å¯¹è±¡å’Œç±»åŠ è½½å™¨çš„åƒåœ¾å›æ”¶ã€‚ ä¸ºäº†é™åˆ¶åƒåœ¾å›æ”¶çš„é¢‘ç‡å’Œå»¶è¿Ÿï¼Œé€‚å½“çš„ç›‘æ§å’Œè°ƒä¼˜<strong>å…ƒç©ºé—´</strong>æ˜¯éå¸¸æœ‰å¿…è¦çš„ã€‚å…ƒç©ºé—´è¿‡å¤šçš„åƒåœ¾æ”¶é›†å¯èƒ½è¡¨ç¤ºç±»ã€ç±»åŠ è½½å™¨å†…å­˜æ³„æ¼æˆ–å¯¹ä½ çš„åº”ç”¨ç¨‹åºæ¥è¯´ç©ºé—´å¤ªå°äº†ã€‚</p><p>å…ƒç©ºé—´çš„å†…å­˜ç®¡ç†ç”±<strong>å…ƒç©ºé—´è™šæ‹Ÿæœº</strong>æ¥å®Œæˆã€‚å…ˆå‰ï¼Œå¯¹äºç±»çš„å…ƒæ•°æ®æˆ‘ä»¬éœ€è¦ä¸åŒçš„åƒåœ¾å›æ”¶å™¨è¿›è¡Œå¤„ç†ï¼Œç°åœ¨åªéœ€è¦æ‰§è¡Œå…ƒç©ºé—´è™šæ‹Ÿæœºçš„C++ä»£ç å³å¯å®Œæˆã€‚<strong>åœ¨å…ƒç©ºé—´ä¸­ï¼Œç±»å’Œå…¶å…ƒæ•°æ®çš„ç”Ÿå‘½å‘¨æœŸ</strong>å’Œ<strong>å…¶å¯¹åº”çš„ç±»åŠ è½½å™¨</strong>æ˜¯ç›¸åŒçš„ã€‚è¯å¥è¯è¯´ï¼Œ<strong>åªè¦ç±»åŠ è½½å™¨å­˜æ´»ï¼Œå…¶åŠ è½½çš„ç±»çš„å…ƒæ•°æ®ä¹Ÿæ˜¯å­˜æ´»çš„</strong>ï¼Œå› è€Œä¸ä¼šè¢«å›æ”¶æ‰ã€‚</p><p>æˆ‘ä»¬ä»è¡Œæ–‡åˆ°ç°åœ¨æåˆ°çš„å…ƒç©ºé—´ç¨å¾®æœ‰ç‚¹ä¸ä¸¥è°¨ã€‚å‡†ç¡®çš„æ¥è¯´ï¼Œ<strong>æ¯ä¸€ä¸ª<em>ç±»åŠ è½½å™¨çš„å­˜å‚¨åŒºåŸŸ</em>éƒ½ç§°ä½œä¸€ä¸ªå…ƒç©ºé—´ï¼Œæ‰€æœ‰çš„å…ƒç©ºé—´åˆåœ¨ä¸€èµ·å°±æ˜¯æˆ‘ä»¬ä¸€ç›´è¯´çš„å…ƒç©ºé—´ã€‚</strong>å½“ä¸€ä¸ªç±»åŠ è½½å™¨è¢«åƒåœ¾å›æ”¶å™¨æ ‡è®°ä¸ºä¸å†å­˜æ´»ï¼Œå…¶å¯¹åº”çš„å…ƒç©ºé—´ä¼šè¢«å›æ”¶ã€‚åœ¨å…ƒç©ºé—´çš„å›æ”¶è¿‡ç¨‹ä¸­æ²¡æœ‰é‡å®šä½å’Œå‹ç¼©ç­‰æ“ä½œã€‚ä½†æ˜¯å…ƒç©ºé—´å†…çš„å…ƒæ•°æ®ä¼šè¿›è¡Œæ‰«ææ¥ç¡®å®šJavaå¼•ç”¨ã€‚</p><p><strong>å…ƒç©ºé—´è™šæ‹Ÿæœº</strong>è´Ÿè´£å…ƒç©ºé—´çš„åˆ†é…ï¼Œå…¶é‡‡ç”¨çš„å½¢å¼ä¸º<strong>ç»„å—åˆ†é…</strong>ã€‚ç»„å—çš„å¤§å°å› ç±»åŠ è½½å™¨çš„ç±»å‹è€Œå¼‚ã€‚åœ¨å…ƒç©ºé—´è™šæ‹Ÿæœºä¸­å­˜åœ¨ä¸€ä¸ª<strong>å…¨å±€çš„ç©ºé—²ç»„å—åˆ—è¡¨</strong>ã€‚å½“ä¸€ä¸ªç±»åŠ è½½å™¨éœ€è¦ç»„å—æ—¶ï¼Œå®ƒå°±ä¼šä»è¿™ä¸ªå…¨å±€çš„ç»„å—åˆ—è¡¨ä¸­è·å–å¹¶ç»´æŒä¸€ä¸ªè‡ªå·±çš„ç»„å—åˆ—è¡¨ã€‚å½“ä¸€ä¸ªç±»åŠ è½½å™¨ä¸å†å­˜æ´»ï¼Œé‚£ä¹ˆå…¶æŒæœ‰çš„ç»„å—å°†ä¼šè¢«é‡Šæ”¾ï¼Œå¹¶è¿”å›ç»™å…¨å±€ç»„å—åˆ—è¡¨ã€‚ç±»åŠ è½½å™¨æŒæœ‰çš„ç»„å—åˆä¼šè¢«åˆ†æˆå¤šä¸ªå—ï¼Œæ¯ä¸€ä¸ªå—å­˜å‚¨ä¸€ä¸ªå•å…ƒçš„å…ƒä¿¡æ¯ã€‚ç»„å—ä¸­çš„å—<strong>æ˜¯çº¿æ€§åˆ†é…ï¼ˆæŒ‡é’ˆç¢°æ’åˆ†é…å½¢å¼ï¼‰</strong>ã€‚ç»„å—åˆ†é…è‡ªå†…å­˜æ˜ å°„åŒºåŸŸã€‚è¿™äº›å…¨å±€çš„è™šæ‹Ÿå†…å­˜æ˜ å°„åŒºåŸŸä»¥é“¾è¡¨å½¢å¼è¿æ¥ï¼Œä¸€æ—¦æŸä¸ªè™šæ‹Ÿå†…å­˜æ˜ å°„åŒºåŸŸæ¸…ç©ºï¼Œè¿™éƒ¨åˆ†å†…å­˜å°±ä¼šè¿”å›ç»™æ“ä½œç³»ç»Ÿã€‚</p><center><img src="https://pic.yupoo.com/crowhawk/cdaea117/7bdf00c4.png"></center><p>ä¸Šå›¾å±•ç¤ºçš„æ˜¯è™šæ‹Ÿå†…å­˜æ˜ å°„åŒºåŸŸå¦‚ä½•è¿›è¡Œå…ƒç»„å—çš„åˆ†é…ã€‚ç±»åŠ è½½å™¨1å’Œ3è¡¨æ˜ä½¿ç”¨äº†åå°„æˆ–è€…ä¸ºåŒ¿åç±»åŠ è½½å™¨ï¼Œä»–ä»¬ä½¿ç”¨äº†ç‰¹å®šå¤§å°ç»„å—ã€‚ è€Œç±»åŠ è½½å™¨2å’Œ4æ ¹æ®å…¶å†…éƒ¨æ¡ç›®çš„æ•°é‡ä½¿ç”¨å°å‹æˆ–è€…ä¸­å‹çš„ç»„å—ã€‚</p><big><strong>è¿è¡Œæ—¶å¸¸é‡æ± ï¼ˆRuntime Constant Poolï¼‰</strong></big><p><strong>è¿è¡Œæ—¶å¸¸é‡æ± ï¼ˆRuntime Constant Poolï¼‰</strong>æ˜¯æ–¹æ³•åŒºçš„ä¸€éƒ¨åˆ†ã€‚<strong>Classæ–‡ä»¶</strong>ä¸­é™¤äº†æœ‰ç±»çš„ç‰ˆæœ¬ã€å­—æ®µã€æ–¹æ³•ã€æ¥å£ç­‰æè¿°ä¿¡æ¯å¤–ï¼Œè¿˜æœ‰ä¸€é¡¹ä¿¡æ¯æ˜¯<strong>å¸¸é‡æ± ï¼ˆConstant Pool Tableï¼‰</strong>ï¼Œç”¨äºå­˜æ”¾ç¼–è¯‘æœŸç”Ÿæˆçš„å„ç§å­—é¢é‡å’Œç¬¦å·å¼•ç”¨ï¼Œ<strong>è¿™éƒ¨åˆ†å†…å®¹å°†åœ¨ç±»åŠ è½½åè¿›å…¥æ–¹æ³•åŒºçš„è¿è¡Œæ—¶å¸¸é‡æ± å­˜æ”¾</strong>ã€‚</p><p>Javaè™šæ‹Ÿæœºå¯¹Classæ–‡ä»¶æ¯ä¸€éƒ¨åˆ†ï¼ˆè‡ªç„¶åŒ…æ‹¬å¸¸é‡æ± ï¼‰çš„æ ¼å¼æœ‰ä¸¥æ ¼è§„å®šï¼Œæ¯ä¸€ä¸ªå­—èŠ‚ç”¨äºå­˜å‚¨é‚£ç§æ•°æ®éƒ½å¿…é¡»ç¬¦åˆè§„èŒƒä¸Šçš„è¦æ±‚æ‰ä¼šè¢«è™šæ‹Ÿæœºè®¤å¯ã€è£…è½½å’Œæ‰§è¡Œã€‚ä½†<strong>å¯¹äºè¿è¡Œæ—¶å¸¸é‡æ± ï¼ŒJavaè™šæ‹Ÿæœºè§„èŒƒæ²¡æœ‰åšä»»ä½•æœ‰å…³ç»†èŠ‚çš„è¦æ±‚</strong>ï¼Œä¸åŒçš„æä¾›å•†å®ç°çš„è™šæ‹Ÿæœºå¯ä»¥æŒ‰ç…§è‡ªå·±çš„éœ€æ±‚æ¥å®ç°æ­¤å†…å­˜åŒºåŸŸã€‚ä¸è¿‡ä¸€èˆ¬è€Œè¨€ï¼Œé™¤äº†ä¿å­˜<strong>Classæ–‡ä»¶ä¸­çš„æè¿°ç¬¦å·å¼•ç”¨</strong>å¤–ï¼Œè¿˜ä¼šæŠŠ<strong>ç¿»è¯‘å‡ºçš„ç›´æ¥å¼•ç”¨</strong>ä¹Ÿå­˜å‚¨åœ¨è¿è¡Œæ—¶å¸¸é‡æ± ä¸­ã€‚</p><p>è¿è¡Œæ—¶å¸¸é‡æ± ç›¸å¯¹äºClassæ–‡ä»¶å¸¸é‡æ± çš„å¦å¤–ä¸€ä¸ªé‡è¦ç‰¹å¾æ˜¯å…·å¤‡<strong>åŠ¨æ€æ€§</strong>ï¼ŒJavaè¯­è¨€å¹¶ä¸è¦æ±‚å¸¸é‡ä¸€å®šåªæœ‰ç¼–è¯‘å™¨æ‰èƒ½äº§ç”Ÿï¼Œä¹Ÿå°±æ˜¯<strong>å¹¶éç½®å…¥Classæ–‡ä»¶ä¸­çš„å¸¸é‡æ± çš„å†…å®¹æ‰èƒ½è¿›å…¥æ–¹æ³•åŒºè¿è¡Œæ—¶å¸¸é‡æ± ï¼Œè¿è¡ŒæœŸé—´ä¹Ÿå¯èƒ½å°†æ–°çš„å¸¸é‡æ”¾å…¥æ± ä¸­</strong>ï¼Œæ­¤ç‰¹æ€§è¢«å¼€å‘äººå‘˜åˆ©ç”¨å¾—æ¯”è¾ƒå¤šçš„ä¾¿æ˜¯Stringç±»çš„<code>intern()</code>æ–¹æ³•ã€‚</p><h4 id="ç›´æ¥å†…å­˜"><a href="#ç›´æ¥å†…å­˜" class="headerlink" title="ç›´æ¥å†…å­˜"></a>ç›´æ¥å†…å­˜</h4><p><strong>ç›´æ¥å†…å­˜ï¼ˆDirect Memoryï¼‰</strong>å¹¶ä¸æ˜¯è™šæ‹Ÿæœº<strong>è¿è¡Œæ—¶æ•°æ®åŒº</strong>çš„ä¸€éƒ¨åˆ†ï¼Œä¹Ÿä¸æ˜¯Javaè™šæ‹Ÿæœºè§„èŒƒä¸­å®šä¹‰çš„å†…å­˜åŒºåŸŸã€‚ä½†è¿™éƒ¨åˆ†å†…å­˜ä¹Ÿè¢«é¢‘ç¹è¿ç”¨ï¼Œè€Œå´å¯èƒ½å¯¼è‡´<strong>OutOfMemoryError</strong>å¼‚å¸¸å‡ºç°ï¼Œæ‰€ä»¥è¿™é‡Œæ”¾åˆ°ä¸€èµ·è®²è§£ã€‚</p><p>ä»¥<strong>NIOï¼ˆNew Input/Outputï¼‰</strong>ç±»ä¸ºä¾‹ï¼ŒNIOå¼•å…¥äº†ä¸€ç§åŸºäºé€šé“ï¼ˆChannelï¼‰ä¸ç¼“å†²åŒºï¼ˆBufferï¼‰çš„I/Oæ–¹å¼ï¼Œå®ƒå¯ä»¥ä½¿ç”¨Nativeå‡½æ•°åº“ç›´æ¥åˆ†é…å †å¤–å†…å­˜ï¼Œç„¶åé€šè¿‡ä¸€ä¸ªå­˜å‚¨åœ¨Javaå †ä¸­çš„DirectByteBufferå¯¹è±¡ä½œä¸ºè¿™å—å†…å­˜çš„å¼•ç”¨è¿›è¡Œæ“ä½œã€‚è¿™æ ·èƒ½é¿å…åœ¨Javaå †å’ŒNativeå †ä¸­æ¥å›å¤åˆ¶æ•°æ®ï¼Œåœ¨ä¸€äº›åœºæ™¯é‡Œæ˜¾è‘—æé«˜æ€§èƒ½ã€‚</p><p>æœ¬æœºç›´æ¥å†…å­˜çš„åˆ†é…ä¸ä¼šå—åˆ°Javaå †å¤§å°çš„é™åˆ¶ï¼Œä½†æ˜¯æ—¢ç„¶æ˜¯å†…å­˜ï¼Œè¿˜æ˜¯ä¼šå—åˆ°æœ¬æœºæ€»å†…å­˜ï¼ˆåŒ…æ‹¬RAMä»¥åŠSWAPåŒºæˆ–åˆ†é¡µæ–‡ä»¶ï¼‰å¤§å°ä»¥åŠå¤„ç†å™¨å¯»å€ç©ºé—´çš„é™åˆ¶ã€‚æœåŠ¡å™¨ç®¡ç†å‘˜åœ¨é…ç½®è™šæ‹Ÿæœºå‚æ•°æ—¶ï¼Œä¼šæ ¹æ®å®é™…å†…å­˜è®¾ç½®-Xmxç­‰å‚æ•°ä¿¡æ¯ï¼Œä½†ç»å¸¸å¿½ç•¥ç›´æ¥å†…å­˜ï¼Œä½¿å¾—å„ä¸ªå†…å­˜åŒºåŸŸæ€»å’Œå¤§äºç‰©ç†å†…å­˜é™åˆ¶ï¼ˆåŒ…æ‹¬ç‰©ç†çš„å’Œæ“ä½œç³»ç»Ÿçš„é™åˆ¶ï¼‰ï¼Œä»è€Œå¯¼è‡´åŠ¨æ€æ‰©å±•æ—¶å‡ºç°<strong>OutOfMemoryError</strong>å¼‚å¸¸ã€‚</p><h1 id="HotSpotä¸­çš„å¯¹è±¡"><a href="#HotSpotä¸­çš„å¯¹è±¡" class="headerlink" title="HotSpotä¸­çš„å¯¹è±¡"></a>HotSpotä¸­çš„å¯¹è±¡</h1><h4 id="å¯¹è±¡çš„åˆ›å»º"><a href="#å¯¹è±¡çš„åˆ›å»º" class="headerlink" title="å¯¹è±¡çš„åˆ›å»º"></a>å¯¹è±¡çš„åˆ›å»º</h4><p>Javaçš„å¯¹è±¡åˆ›å»ºå¤§è‡´æœ‰å¦‚ä¸‹å››ç§æ–¹å¼ï¼š</p><ul><li><strong>newå…³é”®å­—</strong><br>è¿™åº”è¯¥æ˜¯æˆ‘ä»¬æœ€å¸¸è§å’Œæœ€å¸¸ç”¨æœ€ç®€å•çš„åˆ›å»ºå¯¹è±¡çš„æ–¹å¼ã€‚</li><li><strong>ä½¿ç”¨<code>newInstance()</code>æ–¹æ³•</strong><br>è¿™é‡ŒåŒ…æ‹¬<strong>Class</strong>ç±»çš„<code>newInstance()</code>æ–¹æ³•å’Œ<strong>Constructor</strong>ç±»çš„<code>newInstance()</code>æ–¹æ³•ï¼ˆå‰è€…å…¶å®ä¹Ÿæ˜¯è°ƒç”¨çš„åè€…ï¼‰ã€‚</li><li><strong>ä½¿ç”¨<code>clone()</code>æ–¹æ³•</strong><br>è¦ä½¿ç”¨<code>clone()</code>æ–¹æ³•æˆ‘ä»¬å¿…é¡»å®ç°å®ç°<strong>Cloneable</strong>æ¥å£ï¼Œç”¨<code>clone()</code>æ–¹æ³•åˆ›å»ºå¯¹è±¡å¹¶ä¸ä¼šè°ƒç”¨ä»»ä½•æ„é€ å‡½æ•°ã€‚å³æˆ‘ä»¬æ‰€è¯´çš„<strong>æµ…æ‹·è´</strong>ã€‚</li><li><strong>ååºåˆ—åŒ–</strong><br>è¦å®ç°ååºåˆ—åŒ–æˆ‘ä»¬éœ€è¦è®©æˆ‘ä»¬çš„ç±»å®ç°<strong>Serializable</strong>æ¥å£ã€‚å½“æˆ‘ä»¬åºåˆ—åŒ–å’Œååºåˆ—åŒ–ä¸€ä¸ªå¯¹è±¡ï¼ŒJVMä¼šç»™æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªå•ç‹¬çš„å¯¹è±¡ï¼Œåœ¨ååºåˆ—åŒ–æ—¶ï¼ŒJVMåˆ›å»ºå¯¹è±¡å¹¶ä¸ä¼šè°ƒç”¨ä»»ä½•æ„é€ å‡½æ•°ã€‚å³æˆ‘ä»¬æ‰€è¯´çš„<strong>æ·±æ‹·è´</strong>ã€‚</li></ul><p>ä¸Šé¢çš„å››ç§åˆ›å»ºå¯¹è±¡çš„æ–¹æ³•é™¤äº†ç¬¬ä¸€ç§ä½¿ç”¨newæŒ‡ä»¤ä¹‹å¤–ï¼Œå…¶ä»–ä¸‰ç§éƒ½æ˜¯ä½¿ç”¨<strong>invokespecial(æ„é€ å‡½æ•°çš„ç›´æ¥è°ƒç”¨)</strong>ã€‚è¿™é‡Œæˆ‘ä»¬åªè¯´newåˆ›å»ºå¯¹è±¡çš„æ–¹å¼ï¼Œå…³äºinvokespecialçš„å†…å®¹å°†åœ¨åç»­æ–‡ç« ä¸­ä»‹ç»ã€‚ä¸‹é¢æˆ‘ä»¬æ¥çœ‹çœ‹å½“è™šæ‹Ÿæœºé‡åˆ°newæŒ‡ä»¤çš„æ—¶å€™å¯¹è±¡æ˜¯å¦‚ä½•åˆ›å»ºçš„ã€‚</p><big><strong>1. ç±»åŠ è½½æ£€æŸ¥</strong></big><p>è™šæ‹Ÿæœºé‡åˆ°ä¸€æ¡newæŒ‡ä»¤æ—¶ï¼Œé¦–å…ˆå°†å»æ£€æŸ¥<strong>è¿™ä¸ªæŒ‡ä»¤çš„å‚æ•°æ˜¯å¦èƒ½åœ¨å¸¸é‡æ± ä¸­å®šä½åˆ°ä¸€ä¸ªç±»çš„ç¬¦å·å¼•ç”¨</strong>ï¼Œå¹¶ä¸”æ£€æŸ¥<strong>è¿™ä¸ªç¬¦å·å¼•ç”¨ä»£è¡¨çš„ç±»æ˜¯å¦å·²è¢«åŠ è½½ã€è§£æå’Œåˆå§‹åŒ–è¿‡çš„</strong>ï¼Œå¦‚æœæ²¡æœ‰ï¼Œåˆ™å¿…é¡»å…ˆæ‰§è¡Œç›¸åº”çš„ç±»åŠ è½½è¿‡ç¨‹ï¼Œå…³äºç±»åŠ è½½æœºåˆ¶å’Œç±»åŠ è½½å™¨çš„è¯¦ç»†å†…å®¹å°†åœ¨åç»­æ–‡ç« ä¸­ä»‹ç»ã€‚</p><big><strong>2. åˆ†é…å†…å­˜</strong></big><p>åœ¨ç±»åŠ è½½æ£€æŸ¥é€šè¿‡åï¼Œè™šæ‹Ÿæœºå°±å°†ä¸ºæ–°ç”Ÿå¯¹è±¡åˆ†é…å†…å­˜ã€‚å¯¹è±¡æ‰€éœ€å†…å­˜çš„å¤§å°åœ¨ç±»åŠ è½½å®Œæˆåä¾¿å¯å®Œå…¨ç¡®å®šï¼ˆå¦‚ä½•ç¡®å®šåœ¨ä¸‹ä¸€èŠ‚å¯¹è±¡å†…å­˜å¸ƒå±€æ—¶å†è¯¦ç»†è®²è§£ï¼‰ï¼Œä¸ºå¯¹è±¡åˆ†é…ç©ºé—´çš„ä»»åŠ¡å…·ä½“ä¾¿ç­‰åŒäº<strong>ä»Javaå †ä¸­åˆ’å‡ºä¸€å—å¤§å°ç¡®å®šçš„å†…å­˜ç©ºé—´</strong>ï¼Œå¯ä»¥åˆ†å¦‚ä¸‹ä¸¤ç§æƒ…å†µè®¨è®ºï¼š</p><ul><li><strong>Javaå †ä¸­å†…å­˜ç»å¯¹è§„æ•´</strong><br>æ‰€æœ‰ç”¨è¿‡çš„å†…å­˜éƒ½è¢«æ”¾åœ¨ä¸€è¾¹ï¼Œç©ºé—²çš„å†…å­˜è¢«æ”¾åœ¨å¦ä¸€è¾¹ï¼Œ<strong>ä¸­é—´æ”¾ç€ä¸€ä¸ªæŒ‡é’ˆä½œä¸ºåˆ†ç•Œç‚¹çš„æŒ‡ç¤ºå™¨</strong>ï¼Œé‚£æ‰€åˆ†é…å†…å­˜å°±ä»…ä»…æ˜¯æŠŠé‚£ä¸ªæŒ‡é’ˆå‘ç©ºé—²ç©ºé—´é‚£è¾¹æŒªåŠ¨ä¸€æ®µä¸å¯¹è±¡å¤§å°ç›¸ç­‰çš„è·ç¦»ï¼Œè¿™ç§åˆ†é…æ–¹å¼ç§°ä¸º<strong>â€œæŒ‡é’ˆç¢°æ’â€ï¼ˆBump The Pointerï¼‰</strong>ã€‚</li><li><strong>Javaå †ä¸­çš„å†…å­˜ä¸è§„æ•´</strong><br>å·²è¢«ä½¿ç”¨çš„å†…å­˜å’Œç©ºé—²çš„å†…å­˜ç›¸äº’äº¤é”™ï¼Œé‚£å°±æ²¡æœ‰åŠæ³•ç®€å•çš„è¿›è¡ŒæŒ‡é’ˆç¢°æ’äº†ï¼Œè™šæ‹Ÿæœºå°±å¿…é¡»<strong>ç»´æŠ¤ä¸€ä¸ªåˆ—è¡¨ï¼Œè®°å½•å“ªäº›å†…å­˜å—æ˜¯å¯ç”¨çš„</strong>ï¼Œåœ¨åˆ†é…çš„æ—¶å€™ä»åˆ—è¡¨ä¸­æ‰¾åˆ°ä¸€å—è¶³å¤Ÿå¤§çš„ç©ºé—´åˆ’åˆ†ç»™å¯¹è±¡å®ä¾‹ï¼Œå¹¶æ›´æ–°åˆ—è¡¨ä¸Šçš„è®°å½•ï¼Œè¿™ç§åˆ†é…æ–¹å¼ç§°ä¸º<strong>â€œç©ºé—²åˆ—è¡¨â€ï¼ˆFree Listï¼‰</strong>ã€‚</li></ul><p>é€‰æ‹©å“ªç§åˆ†é…æ–¹å¼ç”±Javaå †æ˜¯å¦è§„æ•´å†³å®šï¼Œè€ŒJavaå †æ˜¯å¦è§„æ•´åˆç”±æ‰€é‡‡ç”¨çš„<strong>åƒåœ¾æ”¶é›†å™¨æ˜¯å¦å¸¦æœ‰å‹ç¼©æ•´ç†åŠŸèƒ½</strong>å†³å®šã€‚å› æ­¤åœ¨ä½¿ç”¨Serialã€ParNewç­‰å¸¦<strong>Compact</strong>è¿‡ç¨‹çš„æ”¶é›†å™¨æ—¶ï¼Œç³»ç»Ÿé‡‡ç”¨çš„åˆ†é…ç®—æ³•æ˜¯<strong>æŒ‡é’ˆç¢°æ’</strong>ï¼Œè€Œä½¿ç”¨CMSè¿™ç§åŸºäº<strong>Mark-Sweep</strong>ç®—æ³•çš„æ”¶é›†å™¨æ—¶ï¼ˆè¯´æ˜ä¸€ä¸‹ï¼ŒCMSæ”¶é›†å™¨å¯ä»¥é€šè¿‡UseCMSCompactAtFullCollectionæˆ–CMSFullGCsBeforeCompactionæ¥æ•´ç†å†…å­˜ï¼‰ï¼Œå°±é€šå¸¸é‡‡ç”¨<strong>ç©ºé—²åˆ—è¡¨</strong>ã€‚å…³äºåƒåœ¾æ”¶é›†å™¨çš„å…·ä½“å†…å®¹å°†åœ¨ä¸‹ä¸€ç¯‡æ–‡ç« ä¸­ä»‹ç»ã€‚</p><p>é™¤å¦‚ä½•åˆ’åˆ†å¯ç”¨ç©ºé—´ä¹‹å¤–ï¼Œå¦å¤–ä¸€ä¸ªéœ€è¦è€ƒè™‘çš„é—®é¢˜æ˜¯å¯¹è±¡åˆ›å»ºåœ¨è™šæ‹Ÿæœºä¸­æ˜¯éå¸¸é¢‘ç¹çš„è¡Œä¸ºï¼Œå³ä½¿æ˜¯ä»…ä»…ä¿®æ”¹ä¸€ä¸ªæŒ‡é’ˆæ‰€æŒ‡å‘çš„ä½ç½®ï¼Œåœ¨å¹¶å‘æƒ…å†µä¸‹ä¹Ÿ<strong>å¹¶éçº¿ç¨‹å®‰å…¨</strong>çš„ï¼Œå¯èƒ½å‡ºç°æ­£åœ¨ç»™å¯¹è±¡Aåˆ†é…å†…å­˜ï¼ŒæŒ‡é’ˆè¿˜æ²¡æ¥å¾—åŠä¿®æ”¹ï¼Œå¯¹è±¡BåˆåŒæ—¶ä½¿ç”¨äº†åŸæ¥çš„æŒ‡é’ˆæ¥åˆ†é…å†…å­˜ã€‚è§£å†³è¿™ä¸ªé—®é¢˜æœ‰å¦‚ä¸‹ä¸¤ä¸ªæ–¹æ¡ˆï¼š</p><ul><li><strong>å¯¹åˆ†é…å†…å­˜ç©ºé—´çš„åŠ¨ä½œè¿›è¡ŒåŒæ­¥</strong><br>å®é™…ä¸Šè™šæ‹Ÿæœºæ˜¯é‡‡ç”¨<strong>CAS</strong>é…ä¸Š<strong>å¤±è´¥é‡è¯•</strong>çš„æ–¹å¼ä¿è¯æ›´æ–°æ“ä½œçš„åŸå­æ€§ã€‚</li><li><strong>æŠŠå†…å­˜åˆ†é…çš„åŠ¨ä½œæŒ‰ç…§çº¿ç¨‹åˆ’åˆ†åœ¨ä¸åŒçš„ç©ºé—´ä¹‹ä¸­è¿›è¡Œ</strong><br>å³æ¯ä¸ªçº¿ç¨‹åœ¨Javaå †ä¸­é¢„å…ˆåˆ†é…ä¸€å°å—å†…å­˜ï¼Œç§°ä¸º<strong>æœ¬åœ°çº¿ç¨‹åˆ†é…ç¼“å†²ï¼ˆTLAB ï¼ŒThread Local Allocation Bufferï¼‰</strong>ï¼Œå“ªä¸ªçº¿ç¨‹è¦åˆ†é…å†…å­˜ï¼Œå°±åœ¨å“ªä¸ªçº¿ç¨‹çš„TLABä¸Šåˆ†é…ï¼Œåªæœ‰TLABç”¨å®Œï¼Œåˆ†é…æ–°çš„TLABæ—¶æ‰éœ€è¦åŒæ­¥é”å®šã€‚è™šæ‹Ÿæœºæ˜¯å¦ä½¿ç”¨TLABï¼Œå¯ä»¥é€šè¿‡<strong>-XX:+/-UseTLAB</strong>å‚æ•°æ¥è®¾å®šã€‚</li></ul><big><strong>3. åˆå§‹åŒ–</strong></big><p>å†…å­˜åˆ†é…å®Œæˆä¹‹åï¼Œè™šæ‹Ÿæœºéœ€è¦<strong>å°†åˆ†é…åˆ°çš„å†…å­˜ç©ºé—´éƒ½åˆå§‹åŒ–ä¸ºé›¶å€¼ï¼ˆä¸åŒ…æ‹¬å¯¹è±¡å¤´ï¼‰</strong>ï¼Œå¦‚æœä½¿ç”¨TLABçš„è¯ï¼Œè¿™ä¸€ä¸ªå·¥ä½œä¹Ÿå¯ä»¥æå‰è‡³TLABåˆ†é…æ—¶è¿›è¡Œã€‚è¿™æ­¥æ“ä½œä¿è¯äº†å¯¹è±¡çš„å®ä¾‹å­—æ®µåœ¨Javaä»£ç ä¸­å¯ä»¥ä¸èµ‹åˆå§‹å€¼å°±ç›´æ¥ä½¿ç”¨ã€‚</p><big><strong>4. è®¾ç½®å¯¹è±¡å¤´</strong></big><p>æ¥ä¸‹æ¥ï¼Œè™šæ‹Ÿæœºè¦<strong>è®¾ç½®å¯¹è±¡çš„ä¿¡æ¯</strong>ï¼ˆå¦‚è¿™ä¸ªå¯¹è±¡æ˜¯å“ªä¸ªç±»çš„å®ä¾‹ã€å¦‚ä½•æ‰èƒ½æ‰¾åˆ°ç±»çš„å…ƒæ•°æ®ä¿¡æ¯ã€å¯¹è±¡çš„å“ˆå¸Œç ã€å¯¹è±¡çš„GCåˆ†ä»£å¹´é¾„ç­‰ä¿¡æ¯ï¼‰å¹¶å­˜æ”¾åœ¨å¯¹è±¡çš„<strong>å¯¹è±¡å¤´ï¼ˆObject Headerï¼‰</strong>ä¸­ã€‚æ ¹æ®è™šæ‹Ÿæœºå½“å‰çš„è¿è¡ŒçŠ¶æ€çš„ä¸åŒï¼Œå¦‚æ˜¯å¦å¯ç”¨åå‘é”ç­‰ï¼Œå¯¹è±¡å¤´ä¼šæœ‰ä¸åŒçš„è®¾ç½®æ–¹å¼ã€‚å…³äºå¯¹è±¡å¤´çš„å…·ä½“å†…å®¹ï¼Œåœ¨ä¸‹ä¸€èŠ‚å†è¯¦ç»†ä»‹ç»ã€‚</p><big><strong>5. æ‰§è¡Œ<code>&lt;init&gt;</code>æ–¹æ³•</strong></big><p>åœ¨ä¸Šé¢å·¥ä½œéƒ½å®Œæˆä¹‹åï¼Œåœ¨è™šæ‹Ÿæœºçš„è§†è§’æ¥çœ‹ï¼Œä¸€ä¸ªæ–°çš„å¯¹è±¡å·²ç»äº§ç”Ÿäº†ã€‚ä½†æ˜¯åœ¨Javaç¨‹åºçš„è§†è§’çœ‹æ¥ï¼Œå¯¹è±¡åˆ›å»ºæ‰åˆšåˆšå¼€å§‹â€”â€”<code>&lt;init&gt;</code>æ–¹æ³•è¿˜æ²¡æœ‰æ‰§è¡Œï¼Œæ‰€æœ‰çš„å­—æ®µéƒ½è¿˜ä¸ºé›¶å€¼ã€‚æ‰€ä»¥ä¸€èˆ¬æ¥è¯´ï¼ˆç”±å­—èŠ‚ç ä¸­æ˜¯å¦è·Ÿéšæœ‰invokespecialæŒ‡ä»¤æ‰€å†³å®šï¼‰ï¼ŒnewæŒ‡ä»¤ä¹‹åä¼šæ¥ç€æ‰§è¡Œ<code>&lt;init&gt;</code>æ–¹æ³•ï¼ŒæŠŠå¯¹è±¡æŒ‰ç…§ç¨‹åºå‘˜çš„æ„æ„¿è¿›è¡Œåˆå§‹åŒ–ï¼Œè¿™æ ·ä¸€ä¸ªçœŸæ­£å¯ç”¨çš„å¯¹è±¡æ‰ç®—å®Œå…¨äº§ç”Ÿå‡ºæ¥ã€‚</p><h4 id="å¯¹è±¡çš„å†…å­˜å¸ƒå±€"><a href="#å¯¹è±¡çš„å†…å­˜å¸ƒå±€" class="headerlink" title="å¯¹è±¡çš„å†…å­˜å¸ƒå±€"></a>å¯¹è±¡çš„å†…å­˜å¸ƒå±€</h4><p>HotSpotè™šæ‹Ÿæœºä¸­ï¼Œå¯¹è±¡åœ¨å†…å­˜ä¸­å­˜å‚¨çš„å¸ƒå±€å¯ä»¥åˆ†ä¸ºä¸‰å—åŒºåŸŸï¼š<strong>å¯¹è±¡å¤´ï¼ˆHeaderï¼‰</strong>ã€<strong>å®ä¾‹æ•°æ®ï¼ˆInstance Dataï¼‰</strong>å’Œ<strong>å¯¹é½å¡«å……ï¼ˆPaddingï¼‰</strong>ã€‚</p><big><strong>1. å¯¹è±¡å¤´</strong></big><p>HotSpotè™šæ‹Ÿæœºçš„å¯¹è±¡å¤´åŒ…æ‹¬ä¸¤éƒ¨åˆ†ä¿¡æ¯ï¼š</p><ul><li><strong>å¯¹è±¡è‡ªèº«çš„è¿è¡Œæ—¶æ•°æ® â€œMark Wordâ€</strong><br>å¦‚å“ˆå¸Œç ï¼ˆHashCodeï¼‰ã€GCåˆ†ä»£å¹´é¾„ã€é”çŠ¶æ€æ ‡å¿—ã€çº¿ç¨‹æŒæœ‰çš„é”ã€åå‘çº¿ç¨‹IDã€åå‘æ—¶é—´æˆ³ç­‰ç­‰ï¼Œè¿™éƒ¨åˆ†æ•°æ®çš„é•¿åº¦åœ¨32ä½å’Œ64ä½çš„è™šæ‹Ÿæœºï¼ˆæš‚ä¸è€ƒè™‘å¼€å¯å‹ç¼©æŒ‡é’ˆçš„åœºæ™¯ï¼‰ä¸­åˆ†åˆ«ä¸º32ä¸ªå’Œ64ä¸ªBitsï¼Œå®˜æ–¹ç§°å®ƒä¸º<strong>â€œMark Wordâ€</strong>ã€‚å¯¹è±¡éœ€è¦å­˜å‚¨çš„è¿è¡Œæ—¶æ•°æ®å¾ˆå¤šï¼Œå…¶å®å·²ç»è¶…å‡ºäº†32ã€64ä½Bitmapç»“æ„æ‰€èƒ½è®°å½•çš„é™åº¦ï¼Œä½†æ˜¯å¯¹è±¡å¤´ä¿¡æ¯æ˜¯ä¸å¯¹è±¡è‡ªèº«å®šä¹‰çš„æ•°æ®æ— å…³çš„é¢å¤–å­˜å‚¨æˆæœ¬ï¼Œè€ƒè™‘åˆ°è™šæ‹Ÿæœºçš„ç©ºé—´æ•ˆç‡ï¼ŒMark Wordè¢«è®¾è®¡æˆä¸€ä¸ª<strong>éå›ºå®šçš„æ•°æ®ç»“æ„</strong>ä»¥ä¾¿åœ¨æå°çš„ç©ºé—´å†…å­˜å‚¨å°½é‡å¤šçš„ä¿¡æ¯ï¼Œå®ƒä¼š<strong>æ ¹æ®å¯¹è±¡çš„çŠ¶æ€å¤ç”¨è‡ªå·±çš„å­˜å‚¨ç©ºé—´</strong>ã€‚ä¾‹å¦‚åœ¨32ä½çš„HotSpotè™šæ‹Ÿæœºä¸­å¯¹è±¡<strong>æœªè¢«é”å®š</strong>çš„çŠ¶æ€ä¸‹ï¼ŒMark Wordçš„32ä¸ªBitsç©ºé—´ä¸­çš„25Bitsç”¨äºå­˜å‚¨å¯¹è±¡å“ˆå¸Œç ï¼ˆHashCodeï¼‰ï¼Œ4Bitsç”¨äºå­˜å‚¨å¯¹è±¡åˆ†ä»£å¹´é¾„ï¼Œ2Bitsç”¨äºå­˜å‚¨é”æ ‡å¿—ä½ï¼Œ1Bitå›ºå®šä¸º0ï¼Œåœ¨å…¶ä»–çŠ¶æ€ï¼ˆè½»é‡çº§é”å®šã€é‡é‡çº§é”å®šã€GCæ ‡è®°ã€å¯åå‘ï¼‰ä¸‹å¯¹è±¡çš„å­˜å‚¨å†…å®¹å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</li></ul><center><img src="https://pic.yupoo.com/crowhawk/4f006175/8be38542.png"></center><ul><li><strong>ç±»å‹æŒ‡é’ˆ</strong><br>ç±»å‹æŒ‡é’ˆå³<strong>å¯¹è±¡æŒ‡å‘å®ƒçš„ç±»å…ƒæ•°æ®çš„æŒ‡é’ˆ</strong>ï¼Œè™šæ‹Ÿæœºé€šè¿‡è¿™ä¸ªæŒ‡é’ˆæ¥ç¡®å®šè¿™ä¸ªå¯¹è±¡æ˜¯å“ªä¸ªç±»çš„å®ä¾‹ã€‚å¹¶ä¸æ˜¯æ‰€æœ‰çš„è™šæ‹Ÿæœºå®ç°éƒ½å¿…é¡»åœ¨å¯¹è±¡æ•°æ®ä¸Šä¿ç•™ç±»å‹æŒ‡é’ˆï¼Œæ¢å¥è¯è¯´<strong>æŸ¥æ‰¾å¯¹è±¡çš„å…ƒæ•°æ®ä¿¡æ¯å¹¶ä¸ä¸€å®šè¦ç»è¿‡å¯¹è±¡æœ¬èº«</strong>ï¼Œè¿™ç‚¹æˆ‘ä»¬åœ¨ä¸‹ä¸€èŠ‚è®¨è®ºã€‚å¦å¤–ï¼Œå¦‚æœå¯¹è±¡æ˜¯ä¸€ä¸ªJavaæ•°ç»„ï¼Œé‚£åœ¨å¯¹è±¡å¤´ä¸­è¿˜å¿…é¡»æœ‰ä¸€å—ç”¨äº<strong>è®°å½•æ•°ç»„é•¿åº¦</strong>çš„æ•°æ®ï¼Œå› ä¸ºè™šæ‹Ÿæœºå¯ä»¥é€šè¿‡æ™®é€šJavaå¯¹è±¡çš„å…ƒæ•°æ®ä¿¡æ¯ç¡®å®šJavaå¯¹è±¡çš„å¤§å°ï¼Œä½†æ˜¯ä»æ•°ç»„çš„å…ƒæ•°æ®ä¸­æ— æ³•ç¡®å®šæ•°ç»„çš„å¤§å°ã€‚</li></ul><big><strong>2. å®ä¾‹æ•°æ®</strong></big><p>å®ä¾‹æ•°æ®æ˜¯å¯¹è±¡çœŸæ­£å­˜å‚¨çš„æœ‰æ•ˆä¿¡æ¯ï¼Œä¹Ÿæ—¢æ˜¯æˆ‘ä»¬åœ¨ç¨‹åºä»£ç é‡Œé¢æ‰€å®šä¹‰çš„å„ç§ç±»å‹çš„å­—æ®µå†…å®¹ï¼Œæ— è®ºæ˜¯ä»çˆ¶ç±»ç»§æ‰¿ä¸‹æ¥çš„ï¼Œè¿˜æ˜¯åœ¨å­ç±»ä¸­å®šä¹‰çš„éƒ½éœ€è¦è®°å½•èµ·æ¥ã€‚è¿™éƒ¨åˆ†çš„å­˜å‚¨é¡ºåºä¼šå—åˆ°è™šæ‹Ÿæœºåˆ†é…ç­–ç•¥å‚æ•°ï¼ˆFieldsAllocationStyleï¼‰å’Œå­—æ®µåœ¨Javaæºç ä¸­å®šä¹‰é¡ºåºçš„å½±å“ã€‚HotSpotè™šæ‹Ÿæœºé»˜è®¤çš„åˆ†é…ç­–ç•¥ä¸ºlongs/doublesã€intsã€shorts/charsã€bytes/booleansã€oopsï¼ˆOrdinary Object Pointersï¼‰ï¼Œä»åˆ†é…ç­–ç•¥ä¸­å¯ä»¥çœ‹å‡ºï¼Œç›¸åŒå®½åº¦çš„å­—æ®µæ€»æ˜¯è¢«åˆ†é…åˆ°ä¸€èµ·ã€‚åœ¨æ»¡è¶³è¿™ä¸ªå‰ææ¡ä»¶çš„æƒ…å†µä¸‹ï¼Œåœ¨çˆ¶ç±»ä¸­å®šä¹‰çš„å˜é‡ä¼šå‡ºç°åœ¨å­ç±»ä¹‹å‰ã€‚å¦‚æœCompactFieldså‚æ•°å€¼ä¸ºtrueï¼ˆé»˜è®¤ä¸ºtrueï¼‰ï¼Œé‚£å­ç±»ä¹‹ä¸­è¾ƒçª„çš„å˜é‡ä¹Ÿå¯èƒ½ä¼šæ’å…¥åˆ°çˆ¶ç±»å˜é‡çš„ç©ºéš™ä¹‹ä¸­ã€‚</p><big><strong>3. å¯¹é½å¡«å……</strong></big><p>å¯¹é½å¡«å……å¹¶ä¸æ˜¯å¿…ç„¶å­˜åœ¨çš„ï¼Œä¹Ÿæ²¡æœ‰ç‰¹åˆ«çš„å«ä¹‰ï¼Œå®ƒä»…ä»…èµ·ç€å ä½ç¬¦çš„ä½œç”¨ã€‚ç”±äºHotSpot VMçš„è‡ªåŠ¨å†…å­˜ç®¡ç†ç³»ç»Ÿè¦æ±‚å¯¹è±¡èµ·å§‹åœ°å€å¿…é¡»æ˜¯8å­—èŠ‚çš„æ•´æ•°å€ï¼Œæ¢å¥è¯è¯´å°±æ˜¯å¯¹è±¡çš„å¤§å°å¿…é¡»æ˜¯8å­—èŠ‚çš„æ•´æ•°å€ã€‚å¯¹è±¡å¤´éƒ¨åˆ†æ­£å¥½ä¼¼8å­—èŠ‚çš„å€æ•°ï¼ˆ1å€æˆ–è€…2å€ï¼‰ï¼Œå› æ­¤å½“å¯¹è±¡å®ä¾‹æ•°æ®éƒ¨åˆ†æ²¡æœ‰å¯¹é½çš„è¯ï¼Œå°±éœ€è¦é€šè¿‡å¯¹é½å¡«å……æ¥è¡¥å…¨ã€‚</p><h4 id="å¯¹è±¡çš„è®¿é—®å®šä½"><a href="#å¯¹è±¡çš„è®¿é—®å®šä½" class="headerlink" title="å¯¹è±¡çš„è®¿é—®å®šä½"></a>å¯¹è±¡çš„è®¿é—®å®šä½</h4><p>æˆ‘ä»¬çš„Javaç¨‹åºéœ€è¦é€šè¿‡<strong>æ ˆä¸Šçš„å¯¹è±¡å¼•ç”¨ï¼ˆreferenceï¼‰æ•°æ®ï¼ˆå­˜å‚¨åœ¨æ ˆä¸Šçš„å±€éƒ¨å˜é‡è¡¨ä¸­ï¼‰</strong>æ¥æ“ä½œå †ä¸Šçš„å…·ä½“å¯¹è±¡ã€‚ç”±äºreferenceç±»å‹åœ¨Javaè™šæ‹Ÿæœºè§„èŒƒé‡Œé¢ä¹Ÿåªè§„å®šäº†æ˜¯ä¸€ä¸ªæŒ‡å‘å¯¹è±¡çš„å¼•ç”¨ï¼Œå¹¶æ²¡æœ‰å®šä¹‰è¿™ä¸ªå¼•ç”¨çš„å…·ä½“å®ç°ï¼Œå¯¹è±¡è®¿é—®æ–¹å¼ä¹Ÿæ˜¯å–å†³äºè™šæ‹Ÿæœºå®ç°è€Œå®šçš„ã€‚ä¸»æµçš„è®¿é—®æ–¹å¼æœ‰ä½¿ç”¨<strong>å¥æŸ„</strong>å’Œ<strong>ç›´æ¥æŒ‡é’ˆ</strong>ä¸¤ç§ã€‚</p><big><strong>1. ä½¿ç”¨å¥æŸ„è®¿é—®</strong></big><p>å¦‚æœä½¿ç”¨å¥æŸ„è®¿é—®çš„è¯ï¼Œ<strong>Javaå †ä¸­</strong>å°†ä¼šåˆ’åˆ†å‡ºä¸€å—å†…å­˜æ¥ä½œä¸º<strong>å¥æŸ„æ± </strong>ï¼Œreferenceä¸­å­˜å‚¨çš„å°±æ˜¯å¯¹è±¡çš„å¥æŸ„åœ°å€ï¼Œè€Œå¥æŸ„ä¸­åŒ…å«äº†<strong>å¯¹è±¡å®ä¾‹æ•°æ®</strong>ä¸<strong>ç±»å‹æ•°æ®</strong>çš„å„è‡ªçš„<strong>å…·ä½“åœ°å€ä¿¡æ¯</strong>ã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><figure class="image-bubble">                <div class="img-lightbox">                    <div class="overlay"></div>                    <img src="https://pic.yupoo.com/crowhawk/af3c02ef/bfd967c5.png" alt="" title="">                </div>                <div class="image-caption"></div>            </figure><big><strong>2. ä½¿ç”¨ç›´æ¥æŒ‡é’ˆè®¿é—®</strong></big><p>å¦‚æœä½¿ç”¨ç›´æ¥æŒ‡é’ˆè®¿é—®çš„è¯ï¼ŒJavaå †å¯¹è±¡çš„å¸ƒå±€ä¸­å°±å¿…é¡»è€ƒè™‘å¦‚ä½•æ”¾ç½®è®¿é—®ç±»å‹æ•°æ®çš„ç›¸å…³ä¿¡æ¯ï¼Œreferenceä¸­å­˜å‚¨çš„ç›´æ¥å°±æ˜¯å¯¹è±¡åœ°å€ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><figure class="image-bubble">                <div class="img-lightbox">                    <div class="overlay"></div>                    <img src="https://pic.yupoo.com/crowhawk/5c1acdb8/f5086a4d.png" alt="" title="">                </div>                <div class="image-caption"></div>            </figure><hr><p>è¿™ä¸¤ç§å¯¹è±¡è®¿é—®æ–¹å¼å„æœ‰ä¼˜åŠ¿ï¼Œä¸‹é¢åˆ†åˆ«æ¥è°ˆä¸€è°ˆï¼š</p><ul><li><strong>å¥æŸ„</strong><br>ä½¿ç”¨å¥æŸ„è®¿é—®çš„æœ€å¤§å¥½å¤„å°±æ˜¯<strong>referenceä¸­å­˜å‚¨çš„æ˜¯ç¨³å®šçš„å¥æŸ„åœ°å€</strong>ï¼Œåœ¨å¯¹è±¡è¢«ç§»åŠ¨ï¼ˆåƒåœ¾æ”¶é›†æ—¶ç§»åŠ¨å¯¹è±¡æ˜¯éå¸¸æ™®éçš„è¡Œä¸ºï¼‰æ—¶<strong>åªä¼šæ”¹å˜å¥æŸ„ä¸­çš„å®ä¾‹æ•°æ®æŒ‡é’ˆï¼Œè€Œreferenceæœ¬èº«ä¸éœ€è¦è¢«ä¿®æ”¹</strong>ã€‚</li><li><strong>ç›´æ¥æŒ‡é’ˆ</strong><br>ä½¿ç”¨ç›´æ¥æŒ‡é’ˆæ¥è®¿é—®æœ€å¤§çš„å¥½å¤„å°±æ˜¯<strong>é€Ÿåº¦æ›´å¿«</strong>ï¼Œå®ƒ<strong>èŠ‚çœäº†ä¸€æ¬¡æŒ‡é’ˆå®šä½çš„æ—¶é—´å¼€é”€</strong>ï¼Œç”±äºå¯¹è±¡è®¿é—®çš„åœ¨Javaä¸­éå¸¸é¢‘ç¹ï¼Œå› æ­¤è¿™ç±»å¼€é”€ç§¯å°æˆå¤šä¹Ÿæ˜¯ä¸€é¡¹ éå¸¸å¯è§‚çš„æ‰§è¡Œæˆæœ¬ã€‚ä»ä¸Šä¸€éƒ¨åˆ†è®²è§£çš„å¯¹è±¡å†…å­˜å¸ƒå±€å¯ä»¥çœ‹å‡ºï¼Œ<strong>HotSpotæ˜¯ä½¿ç”¨ç›´æ¥æŒ‡é’ˆè¿›è¡Œå¯¹è±¡è®¿é—®çš„</strong>ï¼Œä¸è¿‡åœ¨æ•´ä¸ªè½¯ä»¶å¼€å‘çš„èŒƒå›´æ¥ çœ‹ï¼Œå„ç§è¯­è¨€ã€æ¡†æ¶ä¸­ä½¿ç”¨å¥æŸ„æ¥è®¿é—®çš„æƒ…å†µä¹Ÿååˆ†å¸¸è§ã€‚</li></ul><h1 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h1><ul><li><a href="https://book.douban.com/subject/24722612/" target="_blank" rel="noopener">ã€Šæ·±å…¥ç†è§£Javaè™šæ‹Ÿæœºâ€”â€”JVMé«˜çº§ç‰¹æ€§ä¸æœ€ä½³å®è·µã€‹ï¼å‘¨å¿—æ˜</a></li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;blockquote&gt;
&lt;p&gt;&lt;a href=&quot;https://meandni.com/2019/01/05/winter_vacation/&quot;&gt;2019å¤§ä¸‰çš„å¯’å‡è®¡åˆ’&lt;/a&gt;â€”â€”åˆ©ç”¨åœ¨å…¬å¸æ¯å¤©æ—©èµ·çš„æ—¶é—´è¯»ä¹¦ï¼Œç¬¬ä¸€æœ¬æ˜¯å‘¨å¿—æ˜è€å¸ˆçš„ã€Šæ·±å…¥ç†è§£Javaè™šæ‹Ÿæœºâ€”â€”JVMé«˜çº§ç‰¹æ€§ä¸æœ€ä½³
      
    
    </summary>
    
      <category term="æ•´ç†" scheme="https://meandni.com/categories/%E6%95%B4%E7%90%86/"/>
    
    
      <category term="è¯»ä¹¦" scheme="https://meandni.com/tags/%E8%AF%BB%E4%B9%A6/"/>
    
      <category term="jvm" scheme="https://meandni.com/tags/jvm/"/>
    
  </entry>
  
  <entry>
    <title>2019å¹´å¯’å‡è®¡åˆ’</title>
    <link href="https://meandni.com/2019/01/05/winter_vacation/"/>
    <id>https://meandni.com/2019/01/05/winter_vacation/</id>
    <published>2019-01-05T09:30:52.000Z</published>
    <updated>2019-03-08T07:35:36.208Z</updated>
    
    <content type="html"><![CDATA[<h2 id="è¯»ä¹¦"><a href="#è¯»ä¹¦" class="headerlink" title="è¯»ä¹¦"></a>è¯»ä¹¦</h2><ul><li style="list-style: none"><input type="checkbox" checked> ç»†è¯»ã€ŠAndroid è¿›é˜¶ä¹‹å…‰ã€‹</li><li style="list-style: none"><input type="checkbox" checked> ç»†è¯»ã€ŠAndroid ç¾¤è‹±ä¼ ã€‹</li><li style="list-style: none"><input type="checkbox" checked> è¯»ã€ŠAndroid å¼€å‘è‰ºæœ¯æ¢ç´¢ã€‹</li><li style="list-style: none"><input type="checkbox"> è¯»ã€ŠAndroid éŸ³è§†é¢‘å¼€å‘ã€‹</li><li style="list-style: none"><input type="checkbox" checked> è¯»ã€Šæ·±å…¥ç†è§£ JAVA è™šæ‹Ÿæœºã€‹</li><li style="list-style: none"><input type="checkbox" checked> å¤ä¹  Java åŸºç¡€ï¼ˆã€Š Java ç¼–ç¨‹æ€æƒ³ã€‹ã€Cs-Noteï¼‰</li><li style="list-style: none"><input type="checkbox" checked> å¤ä¹ ã€Šç®—æ³•ï¼ˆç¬¬å››ç‰ˆï¼‰ã€‹</li><li style="list-style: none"><input type="checkbox"> è¯»ã€Škotlin å®æˆ˜ã€‹</li><li style="list-style: none"><input type="checkbox"> è¯»ã€Šæ·±åº¦å­¦ä¹ å…¥é—¨ï¼šåŸºäº python çš„ç†è®ºä¸å®ç°ã€‹</li><li style="list-style: none"><input type="checkbox" checked> é‡æ¸©ç»†è¯»ã€Šç¬¬ä¸€è¡Œä»£ç ã€‹</li><li style="list-style: none"><input type="checkbox" checked> é‡æ¸©ç»†è¯»ã€ŠThe Modern Javascript Tutorialã€‹</li></ul><h2 id="æ–‡ç« "><a href="#æ–‡ç« " class="headerlink" title="æ–‡ç« "></a>æ–‡ç« </h2><ul><li style="list-style: none"><input type="checkbox" checked> AndroidåŸºç¡€æ€»ç»“ï¼ˆä¾æ®ç¬¬ä¸€è¡Œä»£ç ï¼‰</li><li style="list-style: none"><input type="checkbox" checked> Androidè¿›é˜¶æ€»ç»“ï¼ˆä¾æ®è¿›é˜¶ä¹¦ç±ï¼‰</li><li style="list-style: none"><input type="checkbox" checked> è¾“å‡ºä¸¤æœ¬ä»¥ä¸Šè¯»ä¹¦ç¬”è®°</li><li style="list-style: none"><input type="checkbox" checked> è·Ÿç€ Google å­¦ä¹ æ¶æ„ç³»åˆ—</li><li style="list-style: none"><input type="checkbox" checked> 5 ç¯‡ä»¥ä¸Š Flutter å®æˆ˜æ–‡ç« </li><li style="list-style: none"><input type="checkbox" checked> ç¿»è¯‘ä¹¦ 4 ç« ä»¥ä¸Š</li></ul><h2 id="å®æˆ˜"><a href="#å®æˆ˜" class="headerlink" title="å®æˆ˜"></a>å®æˆ˜</h2><ul><li style="list-style: none"><input type="checkbox" checked> android æ¶æ„ç»„ä»¶å®æˆ˜ â€”â€” MVPã€MVVM</li><li style="list-style: none"><input type="checkbox" checked> Flutter æ ·ä¾‹å®æˆ˜</li><li style="list-style: none"><input type="checkbox" checked> Redux å®æˆ˜</li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;è¯»ä¹¦&quot;&gt;&lt;a href=&quot;#è¯»ä¹¦&quot; class=&quot;headerlink&quot; title=&quot;è¯»ä¹¦&quot;&gt;&lt;/a&gt;è¯»ä¹¦&lt;/h2&gt;&lt;ul&gt;
&lt;li style=&quot;list-style: none&quot;&gt;&lt;input type=&quot;checkbox&quot; checked&gt; ç»†è¯»ã€ŠAndr
      
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>å®æˆ˜ä¸­å­¦ä¹ Flutter1ï¼šç®€æ˜“èŠå¤©AppUI</title>
    <link href="https://meandni.com/2019/01/04/flutter-practice1/"/>
    <id>https://meandni.com/2019/01/04/flutter-practice1/</id>
    <published>2019-01-04T14:12:57.000Z</published>
    <updated>2019-01-13T10:51:13.683Z</updated>
    
    <content type="html"><![CDATA[<p>å¸Œæœ›å°½ä¸€ç‚¹ç‚¹è–„åŠ›è®©å¤§å®¶æœ‰å…´è¶£å­¦ä¹ è¿™é—¨æ–°æŠ€æœ¯ã€‚</p><p>è¿™é‡Œæš‚ä¸ä»‹ç»ç¯å¢ƒé…ç½®ç­‰æ“ä½œï¼Œä¸äº†è§£çš„æœ‹å‹è¯·å…ˆç§»æ­¥å®˜ç½‘ï¼š<a href="https://flutter.io/" target="_blank" rel="noopener">https://flutter.io/</a></p><p>å¼€å‘ç¯å¢ƒï¼šVS Code</p><p>æœ¬å¥—è¯¾ç¨‹é€‚åˆç›´æ¥ä¸Šæ‰‹ï¼Œæ— éœ€å„ç§åŸºç¡€ï¼ŒdartåŸºç¡€ä¹Ÿä¸éœ€è¦ï½ï½</p><h2 id="é¡¹ç›®å±•ç¤º"><a href="#é¡¹ç›®å±•ç¤º" class="headerlink" title="é¡¹ç›®å±•ç¤º"></a>é¡¹ç›®å±•ç¤º</h2><p>åºŸè¯ä¸å¤šè¯´äº†ï¼Œçœ‹ä¸‹è¿™æ¬¡æˆ‘ä»¬éœ€è¦å¼€å‘çš„UIç•Œé¢å§ï¼š</p><figure class="image-bubble">                <div class="img-lightbox">                    <div class="overlay"></div>                    <img src="/images/Flutter.gif" alt="Flutter" title="">                </div>                <div class="image-caption">Flutter</div>            </figure><h2 id="ä»£ç å®ç°"><a href="#ä»£ç å®ç°" class="headerlink" title="ä»£ç å®ç°"></a>ä»£ç å®ç°</h2><h3 id="é¦–å…ˆæˆ‘ä»¬æ›¿æ¢å…¥å£æ–‡ä»¶lib-main-dartä¸‹çš„ä»£ç "><a href="#é¦–å…ˆæˆ‘ä»¬æ›¿æ¢å…¥å£æ–‡ä»¶lib-main-dartä¸‹çš„ä»£ç " class="headerlink" title="é¦–å…ˆæˆ‘ä»¬æ›¿æ¢å…¥å£æ–‡ä»¶lib/main.dartä¸‹çš„ä»£ç "></a>é¦–å…ˆæˆ‘ä»¬æ›¿æ¢å…¥å£æ–‡ä»¶<code>lib/main.dart</code>ä¸‹çš„ä»£ç </h3><p>ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="string">'package:flutter/material.dart'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">void</span> main() =&gt; runApp(<span class="keyword">new</span> MyApp());</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyApp</span> <span class="keyword">extends</span> <span class="title">StatelessWidget</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li><p><code>import &#39;package:flutter/material.dart&#39;;</code></p><p> Flutteré»˜è®¤å¸®æˆ‘ä»¬å¯¼å…¥äº†<code>flutter/material.dart</code>åŒ…ï¼Œè¿™ä¸ªåŒ…ä¹Ÿæ˜¯æˆ‘ä»¬å¼€å‘FlutterAppå¿…å¤‡çš„åŒ…ï¼Œå…¶å®ä¹Ÿæ˜¯ä¸€ä¸ªUIåº“ï¼Œå…¶å†…éƒ¨å®ç°äº†å¤§é‡ä¼˜ç§€ç‚«é…·çš„ç»„ä»¶(Widgets)ï¼Œæœ‰Appç»“æ„å’Œå¯¼èˆªã€æŒ‰é’®ã€è¾“å…¥æ¡†å’Œé€‰æ‹©æ¡†ã€å¯¹è¯æ¡†ã€Alertã€Panelã€åŠ¨ç”»ç­‰ç­‰ç­‰ç­‰Material Designé£æ ¼çš„æ§ä»¶ã€‚</p><p>   Material Designï¼šç†Ÿæ‚‰Androidå¼€å‘çš„ç«¥é‹ä¸€å®šéå¸¸äº†è§£äº†ï¼Œæ˜¯è°·æ­Œæ¨å‡ºçš„ä¸€å¥—è§†è§‰è®¾è®¡è¯­è¨€ã€‚å…¶é£æ ¼ç®€å•å¤§æ–¹æ˜¯æˆ‘ä¸ªäººéå¸¸å–œæ¬¢çš„è®¾è®¡é£æ ¼ï¼Œæœ‰å…´è¶£çš„åŒå­¦å¯ä»¥å­¦ä¹ äº†è§£ä¸€ä¸‹<a href="https://material.io/guidelines/" target="_blank" rel="noopener">Material Designå®˜æ–¹åŸç‰ˆ</a>å’Œ<a href="http://wiki.jikexueyuan.com/project/material-design/material-design-intro/introduction.html" target="_blank" rel="noopener">Material Designä¸­æ–‡ç¿»è¯‘ç‰ˆ</a>ã€‚</p><p>   åœ¨æœ¬é¡¹ç›®ä¸­è¿˜éœ€å€’å…¥å…¶ä»–å“¦ä¸¤ä¸ªåº“ï¼š</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="string">'package:flutter/cupertino.dart'</span>;  <span class="comment">//IOSé£æ ¼é€‚é…</span></span><br><span class="line"><span class="keyword">import</span> <span class="string">'package:flutter/foundation.dart'</span>; <span class="comment">//flutteræ ¸å¿ƒåº“ä¹‹ä¸€</span></span><br></pre></td></tr></table></figure></li><li><p><code>void main() =&gt; runApp(new MyApp());</code></p><p>æ˜¯Dartç¨‹åºçš„å…¥å£ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼ŒFlutterç¨‹åºåœ¨è¿è¡Œçš„æ—¶å€™ï¼Œç¬¬ä¸€ä¸ªæ‰§è¡Œçš„å‡½æ•°å°±æ˜¯main()å‡½æ•°ï¼ŒFlutteré»˜è®¤ä¼šæ‰¾åˆ°<code>lib</code>ç›®å½•ä¸‹çš„<code>main.dart</code>å¹¶è¿è¡Œ<code>void main() =&gt; runApp(new MyApp());</code></p></li><li><p>ç¬¬ä¸€ä¸ªç»„ä»¶</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyApp</span> <span class="keyword">extends</span> <span class="title">StatelessWidget</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure><p>   è¿™æ˜¯æˆ‘ä»¬åœ¨ä¸»å‡½æ•°ä¸­è°ƒç”¨çš„ç¬¬ä¸€ä¸ªæ§ä»¶(Widget)ã€‚</p></li></ul><h3 id="å®šä¹‰æ·»åŠ ä¸¤ç§Theme-ä¸»é¢˜-åˆ†åˆ«é€‚é…Androidå’ŒIOS"><a href="#å®šä¹‰æ·»åŠ ä¸¤ç§Theme-ä¸»é¢˜-åˆ†åˆ«é€‚é…Androidå’ŒIOS" class="headerlink" title="å®šä¹‰æ·»åŠ ä¸¤ç§Theme(ä¸»é¢˜)åˆ†åˆ«é€‚é…Androidå’ŒIOS"></a>å®šä¹‰æ·»åŠ ä¸¤ç§Theme(ä¸»é¢˜)åˆ†åˆ«é€‚é…Androidå’ŒIOS</h3><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="string">'package:flutter/material.dart'</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="string">'package:flutter/cupertino.dart'</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="string">'package:flutter/foundation.dart'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">final</span> ThemeData iOSTheme = <span class="keyword">new</span> ThemeData(</span><br><span class="line">  primarySwatch: Colors.red,</span><br><span class="line">  primaryColor: Colors.grey[<span class="number">400</span>],</span><br><span class="line">  primaryColorBrightness: Brightness.dark,</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="keyword">final</span> ThemeData androidTheme = <span class="keyword">new</span> ThemeData(</span><br><span class="line">  primarySwatch: Colors.blue,</span><br><span class="line">  accentColor: Colors.green,</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="built_in">String</span> defaultUserName = <span class="string">"MeandNi"</span>; <span class="comment">//é»˜è®¤ç”¨æˆ·å</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">void</span> main() =&gt; runApp(<span class="keyword">new</span> MyApp());</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyApp</span> <span class="keyword">extends</span> <span class="title">StatelessWidget</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å…³æ³¨ä¸€ä¸‹å…¶ä¸­çš„primaryé¢œè‰²å¯¹åŒå¹³å°çš„è®¾ç½®ï¼Œå¹¶ä¸”æˆ‘ä»¬å°†ThemeDataå˜é‡è®¾ç½®ä¸ºfinalä¸å¯å˜çš„å˜é‡ã€‚</p><h3 id="å®šä¹‰ä¸€ä¸ªæ— çŠ¶æ€StatelessWidgetç»„ä»¶"><a href="#å®šä¹‰ä¸€ä¸ªæ— çŠ¶æ€StatelessWidgetç»„ä»¶" class="headerlink" title="å®šä¹‰ä¸€ä¸ªæ— çŠ¶æ€StatelessWidgetç»„ä»¶"></a>å®šä¹‰ä¸€ä¸ªæ— çŠ¶æ€<code>StatelessWidget</code>ç»„ä»¶</h3><p><strong>ç»§æ‰¿ StatelessWidgetï¼Œé€šè¿‡ build æ–¹æ³•è¿”å›ä¸€ä¸ªå¸ƒå±€å¥½çš„é™æ€æ§ä»¶</strong>ã€‚</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyApp</span> <span class="keyword">extends</span> <span class="title">StatelessWidget</span> </span>&#123;</span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  Widget build(BuildContext ctx) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> MaterialApp(</span><br><span class="line">      title: <span class="string">"Chat Application"</span>,</span><br><span class="line">      theme: defaultTargetPlatform == TargetPlatform.iOS</span><br><span class="line">          ? iOSTheme</span><br><span class="line">          : androidTheme,</span><br><span class="line">      home: <span class="keyword">new</span> Chat(),</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬åœ¨è¿™é‡Œè¿”å›äº†ä¸€ä¸ªMaterialAppï¼Œå…¶ä¸­å¯ä»¥è®¾ç½®<code>title(æ ‡é¢˜)</code>ã€<code>theme(ä¸»é¢˜)</code>ã€<code>home(ä¸»é¡µ)</code>ç­‰å±æ€§ã€‚</p><p>å…¶ä»–å±æ€§å‚è€ƒï¼š<a href="https://docs.flutter.io/flutter/widgets/WidgetsApp-class.html" target="_blank" rel="noopener">https://docs.flutter.io/flutter/widgets/WidgetsApp-class.html</a></p><p><code>title</code>ï¼šAppæ ‡é¢˜</p><p><code>theme</code>ï¼šAppä¸»é¢˜</p><p><code>home</code>ï¼šAppæ ¹è·¯å¾„</p><p>æˆ‘ä»¬é€šè¿‡åˆ¤æ–­ç”¨æˆ·å¹³å°ç»™å‡ºä¸åŒçš„ä¸»é¢˜ã€‚</p><h3 id="å®šä¹‰ä¸€ä¸ªæœ‰çŠ¶æ€StatefulWidgetç»„ä»¶-â€”â€”-Chat"><a href="#å®šä¹‰ä¸€ä¸ªæœ‰çŠ¶æ€StatefulWidgetç»„ä»¶-â€”â€”-Chat" class="headerlink" title="å®šä¹‰ä¸€ä¸ªæœ‰çŠ¶æ€StatefulWidgetç»„ä»¶ â€”â€” Chat"></a>å®šä¹‰ä¸€ä¸ªæœ‰çŠ¶æ€<code>StatefulWidget</code>ç»„ä»¶ â€”â€” Chat</h3><p><strong>ç»§æ‰¿ <code>StatefulWidget</code>ï¼Œé€šè¿‡ build æ–¹æ³•è¿”å›ä¸€ä¸ªå¸ƒå±€å¥½çš„åŠ¨æ€æ§ä»¶</strong>ã€‚æ‰€è°“åŠ¨æ€æ§ä»¶ï¼Œè¿™é‡Œæˆ‘ä»¬ä¸»è¦å…³æ³¨<figure class="highlight plain"><figcaption><span>State çš„ `build` æ–¹æ³•å»æ„å»ºæ§ä»¶ã€‚åœ¨ State ä¸­ï¼Œä½ å¯ä»¥åŠ¨æ€æ”¹å˜æ•°æ®ï¼Œè¿™ç±»ä¼¼ MVVM å®ç°ï¼Œåœ¨ `setState` ä¹‹åï¼Œæ”¹å˜çš„æ•°æ®ä¼šè§¦å‘ Widget é‡æ–°æ„å»ºåˆ·æ–°ã€‚è€Œä¸‹æ–¹ä»£ç ä¸­ï¼Œæˆ‘ä»¬å’‹Stateä¸­å®šä¹‰äº†_messagesã€_textControllerã€_isWritingä¸‰ä¸ªå˜é‡ï¼Œæˆ‘ä»¬éœ€è¦åœ¨æ”¹å˜ç€ä¸‰ä¸ªå˜é‡æ—¶è§¦å‘ Widget é‡æ–°åˆ·æ–°ã€‚</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">```dart</span><br><span class="line">class Chat extends StatefulWidget &#123;</span><br><span class="line">  @override</span><br><span class="line">  State createState() =&gt; new ChatWindow();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">class ChatWindow extends State&lt;Chat&gt; with TickerProviderStateMixin &#123;</span><br><span class="line">  final List&lt;Msg&gt; _messages = &lt;Msg&gt;[];</span><br><span class="line">  final TextEditingController _textController = new TextEditingController();</span><br><span class="line">  bool _isWriting = false;</span><br><span class="line"></span><br><span class="line">  @override</span><br><span class="line">  Widget build(BuildContext ctx) &#123;</span><br><span class="line">    return new Scaffold(</span><br><span class="line">      appBar: new AppBar(</span><br><span class="line">        title: new Text(&quot;Chat Application&quot;),</span><br><span class="line">        elevation:</span><br><span class="line">        Theme.of(ctx).platform == TargetPlatform.iOS ? 0.0 : 6.0,</span><br><span class="line">      ),</span><br><span class="line">      body: new Column(children: &lt;Widget&gt;[</span><br><span class="line">        new Flexible(</span><br><span class="line">            child: new ListView.builder(</span><br><span class="line">              itemBuilder: (_, int index) =&gt; _messages[index],</span><br><span class="line">              itemCount: _messages.length,</span><br><span class="line">              reverse: true,</span><br><span class="line">              padding: new EdgeInsets.all(6.0),</span><br><span class="line">            )),</span><br><span class="line">        new Divider(height: 1.0),</span><br><span class="line">        new Container(</span><br><span class="line">          child: _buildComposer(),</span><br><span class="line">          decoration: new BoxDecoration(color: Theme.of(ctx).cardColor),</span><br><span class="line">        ),</span><br><span class="line">      ]),</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure></p><h3 id="å®šä¹‰åº•éƒ¨è¾“å…¥æ¡†å’ŒsubmitæŒ‰é’®ï¼š"><a href="#å®šä¹‰åº•éƒ¨è¾“å…¥æ¡†å’ŒsubmitæŒ‰é’®ï¼š" class="headerlink" title="å®šä¹‰åº•éƒ¨è¾“å…¥æ¡†å’ŒsubmitæŒ‰é’®ï¼š"></a>å®šä¹‰åº•éƒ¨è¾“å…¥æ¡†å’ŒsubmitæŒ‰é’®ï¼š</h3><p>æ­¤Widgetè¢«æ”¾åœ¨ChatWindowçš„åº•éƒ¨ç”¨äºç”¨æˆ·çš„è¾“å…¥æäº¤ã€‚æˆ‘ä»¬å¯ä»¥æ”¾å…³æ³¨ç‚¹èšç„¦åœ¨<code>TextField</code>ç»„ä»¶ä¸Šï¼Œæˆ‘ä»¬é€šè¿‡å¯¹è¾“å…¥å€¼çš„ç›‘å¬ä¿®æ”¹_isWritingçš„å€¼å¹¶å¯¹è¾“å…¥æ¡†ç»„ä»¶å’Œä¸‹æ–¹çš„æŒ‰é’®ç»„ä»¶åˆ·æ–°è¾¾åˆ°ä¸€å®šç”¨æˆ·ä½“éªŒã€‚</p><p>å¯¹äºæ”¾æ¾æŒ‰é’®ï¼Œæˆ‘ä»¬åœ¨IOSç«¯ä½¿ç”¨<code>CupertinoButton</code>ï¼Œandroidç«¯ä½¿ç”¨<code>IconButton</code>ã€‚</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line">Widget _buildComposer() &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> IconTheme(</span><br><span class="line">      data: <span class="keyword">new</span> IconThemeData(color: Theme.of(context).accentColor),</span><br><span class="line">      child: <span class="keyword">new</span> Container(</span><br><span class="line">          margin: <span class="keyword">const</span> EdgeInsets.symmetric(horizontal: <span class="number">9.0</span>),</span><br><span class="line">          child: <span class="keyword">new</span> Row(</span><br><span class="line">            children: &lt;Widget&gt;[</span><br><span class="line">              <span class="keyword">new</span> Flexible(</span><br><span class="line">                child: <span class="keyword">new</span> TextField(</span><br><span class="line">                  controller: _textController,</span><br><span class="line">                  onChanged: (<span class="built_in">String</span> txt) &#123;</span><br><span class="line">                    setState(() &#123;</span><br><span class="line">                      _isWriting = txt.length &gt; <span class="number">0</span>;</span><br><span class="line">                    &#125;);</span><br><span class="line">                  &#125;,</span><br><span class="line">                  onSubmitted: _submitMsg,</span><br><span class="line">                  decoration:</span><br><span class="line">                  <span class="keyword">new</span> InputDecoration.collapsed(hintText: <span class="string">"Enter some text to send a message"</span>),</span><br><span class="line">                ),</span><br><span class="line">              ),</span><br><span class="line">              <span class="keyword">new</span> Container(</span><br><span class="line">                  margin: <span class="keyword">new</span> EdgeInsets.symmetric(horizontal: <span class="number">3.0</span>),</span><br><span class="line">                  child: Theme.of(context).platform == TargetPlatform.iOS</span><br><span class="line">                      ? <span class="keyword">new</span> CupertinoButton(</span><br><span class="line">                      child: <span class="keyword">new</span> Text(<span class="string">"Submit"</span>),</span><br><span class="line">                      onPressed: _isWriting ? () =&gt; _submitMsg(_textController.text)</span><br><span class="line">                          : <span class="keyword">null</span></span><br><span class="line">                  )</span><br><span class="line">                      : <span class="keyword">new</span> IconButton(</span><br><span class="line">                    icon: <span class="keyword">new</span> Icon(Icons.message),</span><br><span class="line">                    onPressed: _isWriting</span><br><span class="line">                        ? () =&gt; _submitMsg(_textController.text)</span><br><span class="line">                        : <span class="keyword">null</span>,</span><br><span class="line">                  )</span><br><span class="line">              ),</span><br><span class="line">            ],</span><br><span class="line">          ),</span><br><span class="line">          decoration: Theme.of(context).platform == TargetPlatform.iOS</span><br><span class="line">              ? <span class="keyword">new</span> BoxDecoration(</span><br><span class="line">              border:</span><br><span class="line">              <span class="keyword">new</span> Border(top: <span class="keyword">new</span> BorderSide(color: Colors.brown))) :</span><br><span class="line">          <span class="keyword">null</span></span><br><span class="line">      ),</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure><h3 id="å®šä¹‰å‘é€æ•°æ®çš„å‡½æ•°"><a href="#å®šä¹‰å‘é€æ•°æ®çš„å‡½æ•°" class="headerlink" title="å®šä¹‰å‘é€æ•°æ®çš„å‡½æ•°"></a>å®šä¹‰å‘é€æ•°æ®çš„å‡½æ•°</h3><p>é€šè¿‡<code>_textController</code>æ¸…é™¤è¾“å…¥æ¡†çš„æ—§æ•°æ®ã€‚å®šä¹‰<code>Msg</code>æ’å…¥åˆ°<code>_messages</code>æ•°ç»„ä¸­ã€‚</p><p>è¿™é‡Œæˆ‘ä»¬å¯ä»¥å…³æ³¨åŠ¨ç”»æ•ˆæœçš„æ“ä½œ,<code>animationController</code>å°†ä½œä¸ºä¼ è¾“ä¼ é€’åˆ°<code>Msg</code>ç»„ä»¶å½“ä¸­ã€‚</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">void</span> _submitMsg(<span class="built_in">String</span> txt) &#123;</span><br><span class="line">    _textController.clear();</span><br><span class="line">    setState(() &#123;</span><br><span class="line">      _isWriting = <span class="keyword">false</span>;</span><br><span class="line">    &#125;);</span><br><span class="line">    Msg msg = <span class="keyword">new</span> Msg(</span><br><span class="line">      txt: txt,</span><br><span class="line">      animationController: <span class="keyword">new</span> AnimationController(</span><br><span class="line">          vsync: <span class="keyword">this</span>,</span><br><span class="line">          duration: <span class="keyword">new</span> <span class="built_in">Duration</span>(milliseconds: <span class="number">800</span>)</span><br><span class="line">      ),</span><br><span class="line">    );</span><br><span class="line">    setState(() &#123;</span><br><span class="line">      _messages.insert(<span class="number">0</span>, msg);</span><br><span class="line">    &#125;);</span><br><span class="line">    msg.animationController.forward();</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure><h3 id="å®šä¹‰Msgæ¶ˆæ¯çš„æ¨¡ç‰ˆç»„ä»¶"><a href="#å®šä¹‰Msgæ¶ˆæ¯çš„æ¨¡ç‰ˆç»„ä»¶" class="headerlink" title="å®šä¹‰Msgæ¶ˆæ¯çš„æ¨¡ç‰ˆç»„ä»¶"></a>å®šä¹‰<code>Msg</code>æ¶ˆæ¯çš„æ¨¡ç‰ˆç»„ä»¶</h3><p>å®é™…ä¸Šæˆ‘ä»¬ç‚¹å‡»Submitæ¶ˆæ¯å‘é€æ—¶ï¼Œå‘é€çš„å°±æ˜¯è¿™æ ·ä¸€ä¸ª<code>StatelessWidget</code>ï¼Œå…¶ä¸­æºå¸¦ä¸¤ä¸ªå˜é‡ï¼š<code>txt</code>æ¶ˆæ¯å†…å®¹ã€<code>animationController</code>åŠ¨ç”»æ§åˆ¶å™¨ã€‚</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Msg</span> <span class="keyword">extends</span> <span class="title">StatelessWidget</span> </span>&#123;</span><br><span class="line">  Msg(&#123;<span class="keyword">this</span>.txt, <span class="keyword">this</span>.animationController&#125;);</span><br><span class="line">  <span class="keyword">final</span> <span class="built_in">String</span> txt;</span><br><span class="line">  <span class="keyword">final</span> AnimationController animationController;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  Widget build(BuildContext ctx) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> SizeTransition(</span><br><span class="line">      sizeFactor: <span class="keyword">new</span> CurvedAnimation(</span><br><span class="line">          parent: animationController, curve: Curves.easeOut),</span><br><span class="line">      axisAlignment: <span class="number">0.0</span>,</span><br><span class="line">      child: <span class="keyword">new</span> Container(</span><br><span class="line">        margin: <span class="keyword">const</span> EdgeInsets.symmetric(vertical: <span class="number">8.0</span>),</span><br><span class="line">        child: <span class="keyword">new</span> Row(</span><br><span class="line">          crossAxisAlignment: CrossAxisAlignment.start,</span><br><span class="line">          children: &lt;Widget&gt;[</span><br><span class="line">            <span class="keyword">new</span> Container(</span><br><span class="line">              margin: <span class="keyword">const</span> EdgeInsets.only(right: <span class="number">18.0</span>),</span><br><span class="line">              child: <span class="keyword">new</span> CircleAvatar(child: <span class="keyword">new</span> Text(defaultUserName[<span class="number">0</span>])),</span><br><span class="line">            ),</span><br><span class="line">            <span class="keyword">new</span> Expanded(</span><br><span class="line">              child: <span class="keyword">new</span> Column(</span><br><span class="line">                crossAxisAlignment: CrossAxisAlignment.start,</span><br><span class="line">                children: &lt;Widget&gt;[</span><br><span class="line">                  <span class="keyword">new</span> Text(defaultUserName, style: Theme.of(ctx).textTheme.subhead),</span><br><span class="line">                  <span class="keyword">new</span> Container(</span><br><span class="line">                    margin: <span class="keyword">const</span> EdgeInsets.only(top: <span class="number">6.0</span>),</span><br><span class="line">                    child: <span class="keyword">new</span> Text(txt),</span><br><span class="line">                  ),</span><br><span class="line">                ],</span><br><span class="line">              ),</span><br><span class="line">            ),</span><br><span class="line">          ],</span><br><span class="line">        ),</span><br><span class="line">      ),</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è‡³æ­¤æˆ‘ä»¬çš„ç¬¬ä¸€ä¸ªå®æˆ˜Appæ—§å¤§åŠŸå‘Šæˆäº†ï¼Œæ˜¯ä¸æ˜¯å¾ˆç®€å•çš„æ ·å­ï¼Œæ²¡é”™ï¼Œå°±æ˜¯è¿™ä¹ˆç®€å•å°±èƒ½åšå‡ºè¿™ä¹ˆæ¼‚äº®çš„UIï¼Œå…¶ä¸­æœ‰äº›FlutteråŸºç¡€å¯èƒ½æ²¡æœ‰æ¶‰åŠï¼Œå¦‚æœåˆéœ€è¦ä¼šå°½é‡æ›´æ–°ï¼</p><h2 id="å®Œæ•´ä»£ç "><a href="#å®Œæ•´ä»£ç " class="headerlink" title="å®Œæ•´ä»£ç "></a>å®Œæ•´ä»£ç </h2><p><a href="https://github.com/MeandNi/Flutter1-Chat_APP" target="_blank" rel="noopener">github demo</a></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;å¸Œæœ›å°½ä¸€ç‚¹ç‚¹è–„åŠ›è®©å¤§å®¶æœ‰å…´è¶£å­¦ä¹ è¿™é—¨æ–°æŠ€æœ¯ã€‚&lt;/p&gt;
&lt;p&gt;è¿™é‡Œæš‚ä¸ä»‹ç»ç¯å¢ƒé…ç½®ç­‰æ“ä½œï¼Œä¸äº†è§£çš„æœ‹å‹è¯·å…ˆç§»æ­¥å®˜ç½‘ï¼š&lt;a href=&quot;https://flutter.io/&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;https://flutter.io/
      
    
    </summary>
    
      <category term="åŸåˆ›" scheme="https://meandni.com/categories/%E5%8E%9F%E5%88%9B/"/>
    
    
      <category term="è‡ªå­¦" scheme="https://meandni.com/tags/%E8%87%AA%E5%AD%A6/"/>
    
      <category term="flutter" scheme="https://meandni.com/tags/flutter/"/>
    
  </entry>
  
  <entry>
    <title>ç»éªŒï¼šFlutteré¡¹ç›®IOSçœŸæœºéƒ¨ç½²åŠé—®é¢˜</title>
    <link href="https://meandni.com/2019/01/04/5671/"/>
    <id>https://meandni.com/2019/01/04/5671/</id>
    <published>2019-01-04T12:12:57.000Z</published>
    <updated>2019-01-04T12:42:21.401Z</updated>
    
    <content type="html"><![CDATA[<p>ç”¨flutterå¼€å‘iosåº”ç”¨åœ¨çœŸæœºè°ƒè¯•æ—¶å‡ºç°çš„é—®é¢˜ä»¥åŠå¤„ç†æ–¹å¼</p><h2 id="æ— æ³•è¿æ¥iphoneæ‰‹æœº"><a href="#æ— æ³•è¿æ¥iphoneæ‰‹æœº" class="headerlink" title="æ— æ³•è¿æ¥iphoneæ‰‹æœº"></a>æ— æ³•è¿æ¥iphoneæ‰‹æœº</h2><p>flutteræ‰¾ä¸åˆ°çœŸæœºï¼Œå·²ç»å®‰è£…Xcodeï¼ŒXcodeé‡Œé¢å¯ä»¥æ‰“å¼€çœŸæœºè¿è¡Œï¼Œä½†Android Studioç¯å¢ƒå’ŒVscodeç¯å¢ƒä¸‹ï¼Œä¸èƒ½æ‰¾åˆ°è¿æ¥çš„iPhoneçœŸæœºï¼Œå…¶å®å¾ˆç®€å•ï¼Œç»ˆç«¯è¿è¡Œä¸€ä¸‹:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flutter doctor</span><br></pre></td></tr></table></figure><p>å³å¯ï¼Œæ§åˆ¶å°æç¤ºå¦‚ä¸‹ï¼š</p><figure class="image-bubble">                <div class="img-lightbox">                    <div class="overlay"></div>                    <img src="http://pan.94ht.com/image-20190104201612194.png" alt="image-20190104201612194" title="">                </div>                <div class="image-caption">image-20190104201612194</div>            </figure><p>æŒ‰ç…§æç¤ºç»ˆç«¯æ‰§è¡Œ æˆªå›¾ç»¿è‰²éƒ¨åˆ†çš„å‘½ä»¤å³å¯ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">brew install --HEAD usbmuxd</span><br><span class="line">brew link usbmuxd</span><br><span class="line">brew install --HEAD libimobiledevice</span><br><span class="line">brew install ideviceinstaller</span><br></pre></td></tr></table></figure><h2 id="Signing-for-â€œxxxâ€-requires-a-development-team-Select-a-development-team"><a href="#Signing-for-â€œxxxâ€-requires-a-development-team-Select-a-development-team" class="headerlink" title="Signing for â€œxxxâ€ requires a development team. Select a development team"></a>Signing for â€œxxxâ€ requires a development team. Select a development team</h2><p>é¦–æ¬¡ç”¨vscodeè¿ä¸ŠçœŸæœºä»¥åï¼Œç‚¹å‡»è°ƒè¯•ï¼Œä¼šå‡ºç°å¦‚ä¸‹é—®é¢˜ï¼š</p><blockquote><p>No Provisioning Profile was found for your projectâ€™s Bundle Identifier or your<br>device. You can create a new Provisioning Profile for your project in Xcode for<br>your team by:<br>  1- Open the Flutter projectâ€™s Xcode target with<br>       open ios/Runner.xcworkspace<br>  2- Select the â€˜Runnerâ€™ project in the navigator then the â€˜Runnerâ€™ target<br>     in the project settings<br>  3- In the â€˜Generalâ€™ tab, make sure a â€˜Development Teamâ€™ is selected.<br>     You may need to:</p><pre><code>- Log in with your Apple ID in Xcode first- Ensure you have a valid unique Bundle ID- Register your device with your Apple Developer Account- Let Xcode automatically provision a profile for your app</code></pre><p>  4- Build or run your project again<br>Itâ€™s also possible that a previously installed app with the same Bundle<br>Identifier was signed with a different certificate.<br>For more information, please visit:<br>  <a href="https://flutter.io/setup/#deploy-to-ios-devices" target="_blank" rel="noopener">https://flutter.io/setup/#deploy-to-ios-devices</a><br>Or run on an iOS simulator without code signing<br>â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•<br>2018-10-27 12:09:29.004 ios-deploy[91734:221562][ !! ] Error 0xe8008015: A valid provisioning profile for this executable was not found. AMDeviceSecureInstallApplication(0, device, url, options, install_callback, 0)<br>Could not install build/ios/iphoneos/Runner.app on b53d6902af4ac5d5166a3125b9013886739c92d2.<br>Try launching Xcode and selecting â€œProduct &gt; Runâ€ to fix the problem:<br>  open ios/Runner.xcworkspace<br>Error launching application on xxxçš„ iPhone.<br>Exited (sigterm)</p></blockquote><p>ç”¨xcodeæ‰“å¼€ flutteré¡¹ç›®<code>/ios/Runner.xcworkspace</code> è¿™ä¸ªæ–‡ä»¶ï¼Œå¥½ï¼Œæˆ‘ä»¬æ‰‹åŠ¨æ‰“å¼€ï¼Œç‚¹å‡»ç¼–è¯‘ï¼Œæ­¤æ—¶ä¼šç¼–è¯‘ä¸é€šè¿‡ï½</p><p>å‡ºç°è¿™ä¸ªé—®é¢˜çš„åŸå› æ˜¯ä½ çš„xcode project ä¸­çš„teamæ²¡æœ‰é€‰æ‹©ï¼Œé€‰æ‹©æ–¹æ³•å¦‚ä¸‹ã€‚</p><figure class="image-bubble">                <div class="img-lightbox">                    <div class="overlay"></div>                    <img src="http://pan.94ht.com/QQ20190104-203008.png" alt="img" title="">                </div>                <div class="image-caption">img</div>            </figure><h2 id="ä¸å—ä¿¡ä»»çš„å¼€å‘è€…"><a href="#ä¸å—ä¿¡ä»»çš„å¼€å‘è€…" class="headerlink" title="ä¸å—ä¿¡ä»»çš„å¼€å‘è€…"></a>ä¸å—ä¿¡ä»»çš„å¼€å‘è€…</h2><p>è§£å†³æ–¹å¼ï¼šæ‰“å¼€æ‰‹æœºä¸Šçš„â€è®¾ç½®-&gt;é€šç”¨-&gt;è®¾å¤‡ç®¡ç†-&gt;å¼€å‘è€…åº”ç”¨â€ï¼Œè¿›å…¥ä»¥åï¼Œç‚¹å‡»â€ä¿¡ä»» <a href="mailto:xxxxx@xxx.com" target="_blank" rel="noopener">xxxxx@xxx.com</a>â€œ</p><h2 id="å‚è€ƒé“¾æ¥"><a href="#å‚è€ƒé“¾æ¥" class="headerlink" title="å‚è€ƒé“¾æ¥"></a>å‚è€ƒé“¾æ¥</h2><p>å®˜æ–¹é“¾æ¥ï¼š<a href="https://flutter.io/docs/get-started/install/macos" target="_blank" rel="noopener">https://flutter.io/docs/get-started/install/macos</a></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;ç”¨flutterå¼€å‘iosåº”ç”¨åœ¨çœŸæœºè°ƒè¯•æ—¶å‡ºç°çš„é—®é¢˜ä»¥åŠå¤„ç†æ–¹å¼&lt;/p&gt;
&lt;h2 id=&quot;æ— æ³•è¿æ¥iphoneæ‰‹æœº&quot;&gt;&lt;a href=&quot;#æ— æ³•è¿æ¥iphoneæ‰‹æœº&quot; class=&quot;headerlink&quot; title=&quot;æ— æ³•è¿æ¥iphoneæ‰‹æœº&quot;&gt;&lt;/a&gt;æ— æ³•è¿æ¥iphone
      
    
    </summary>
    
      <category term="æ•´ç†" scheme="https://meandni.com/categories/%E6%95%B4%E7%90%86/"/>
    
    
      <category term="flutter" scheme="https://meandni.com/tags/flutter/"/>
    
      <category term="æ€»ç»“" scheme="https://meandni.com/tags/%E6%80%BB%E7%BB%93/"/>
    
      <category term="é—®é¢˜" scheme="https://meandni.com/tags/%E9%97%AE%E9%A2%98/"/>
    
  </entry>
  
  <entry>
    <title>Androidè¿›é˜¶ä¹‹è·¯</title>
    <link href="https://meandni.com/2018/12/25/android-advanced/"/>
    <id>https://meandni.com/2018/12/25/android-advanced/</id>
    <published>2018-12-25T07:15:58.000Z</published>
    <updated>2019-01-19T03:39:04.892Z</updated>
    
    <content type="html"><![CDATA[<h2 id="è¯»ä¹¦è¿›é˜¶Android"><a href="#è¯»ä¹¦è¿›é˜¶Android" class="headerlink" title="è¯»ä¹¦è¿›é˜¶Android"></a>è¯»ä¹¦è¿›é˜¶Android</h2><p>å·²è¯»ï¼šã€ŠAndroidç¾¤è‹±ä¼ ã€‹</p><p>æ­£è¯»ï¼šã€ŠAndroidè¿›é˜¶ä¹‹å…‰ã€‹</p><p>æœªè¯»ï¼šã€ŠAndroidå¼€å‘è‰ºæœ¯æ¢ç´¢ã€‹</p><hr><h4 id="è¿›é˜¶çŸ¥è¯†ç‚¹ï¼š"><a href="#è¿›é˜¶çŸ¥è¯†ç‚¹ï¼š" class="headerlink" title="è¿›é˜¶çŸ¥è¯†ç‚¹ï¼š"></a>è¿›é˜¶çŸ¥è¯†ç‚¹ï¼š</h4><ul><li>Activityå¯åŠ¨æ¨¡å¼</li><li>Viewçš„æ»‘åŠ¨ä¸åŠ¨ç”»</li><li>Viewçš„äº‹ä»¶åˆ†å‘æœºåˆ¶</li><li>è‡ªå®šä¹‰Viewã€ViewGrroup</li><li>å¤šçº¿ç¨‹ç¼–ç¨‹ã€çº¿ç¨‹æ± ä½¿ç”¨ä¸åŸç†</li><li>ç½‘ç»œç¼–ç¨‹ã€ç½‘ç»œæ¡†æ¶ä½¿ç”¨ä¸åŸç†</li><li>è®¾è®¡æ¨¡å¼ï¼ˆå•ä¾‹ã€å·¥å‚â€¦â€¦ï¼‰</li><li>å¸¸ç”¨æ¡†æ¶åŸç†ï¼ˆRXJavaã€EventBusã€Dagger2â€¦â€¦ï¼‰</li><li>åº”ç”¨æ¶æ„ï¼ˆMVPã€MVVMï¼‰</li><li>æ€§èƒ½ä¼˜åŒ–</li><li>JNIå’ŒNDKç¼–ç¨‹</li></ul><hr><h4 id="ä¸“é¡¹è¿›é˜¶ï¼š"><a href="#ä¸“é¡¹è¿›é˜¶ï¼š" class="headerlink" title="ä¸“é¡¹è¿›é˜¶ï¼š"></a>ä¸“é¡¹è¿›é˜¶ï¼š</h4><ul><li>AndroidéŸ³è§†é¢‘</li><li>Androidé€šä¿¡</li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;è¯»ä¹¦è¿›é˜¶Android&quot;&gt;&lt;a href=&quot;#è¯»ä¹¦è¿›é˜¶Android&quot; class=&quot;headerlink&quot; title=&quot;è¯»ä¹¦è¿›é˜¶Android&quot;&gt;&lt;/a&gt;è¯»ä¹¦è¿›é˜¶Android&lt;/h2&gt;&lt;p&gt;å·²è¯»ï¼šã€ŠAndroidç¾¤è‹±ä¼ ã€‹&lt;/p&gt;
&lt;p&gt;æ­£è¯»ï¼šã€ŠAndroid
      
    
    </summary>
    
      <category term="åŸåˆ›" scheme="https://meandni.com/categories/%E5%8E%9F%E5%88%9B/"/>
    
    
      <category term="Android" scheme="https://meandni.com/tags/Android/"/>
    
      <category term="è¯»ä¹¦" scheme="https://meandni.com/tags/%E8%AF%BB%E4%B9%A6/"/>
    
  </entry>
  
</feed>
